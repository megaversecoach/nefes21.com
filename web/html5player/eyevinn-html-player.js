parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"KA2S":[function(require,module,exports) {
var t=function(t){"use strict";var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,r,e,n){var o=r&&r.prototype instanceof v?r:v,i=Object.create(o.prototype),a=new k(n||[]);return i._invoke=function(t,r,e){var n=f;return function(o,i){if(n===l)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return N()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var c=_(a,e);if(c){if(c===y)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===f)throw n=p,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=l;var u=h(t,r,e);if("normal"===u.type){if(n=e.done?p:s,u.arg===y)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n=p,e.method="throw",e.arg=u.arg)}}}(t,e,a),i}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=u;var f="suspendedStart",s="suspendedYield",l="executing",p="completed",y={};function v(){}function d(){}function g(){}var m={};m[i]=function(){return this};var w=Object.getPrototypeOf,L=w&&w(w(G([])));L&&L!==e&&n.call(L,i)&&(m=L);var x=g.prototype=v.prototype=Object.create(m);function E(t){["next","throw","return"].forEach(function(r){t[r]=function(t){return this._invoke(r,t)}})}function b(t){var r;this._invoke=function(e,o){function i(){return new Promise(function(r,i){!function r(e,o,i,a){var c=h(t[e],t,o);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?Promise.resolve(f.__await).then(function(t){r("next",t,i,a)},function(t){r("throw",t,i,a)}):Promise.resolve(f).then(function(t){u.value=t,i(u)},function(t){return r("throw",t,i,a)})}a(c.arg)}(e,o,r,i)})}return r=r?r.then(i,i):i()}}function _(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,_(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function j(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function O(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function G(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:N}}function N(){return{value:r,done:!0}}return d.prototype=x.constructor=g,g.constructor=d,g[c]=d.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===d||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},E(b.prototype),b.prototype[a]=function(){return this},t.AsyncIterator=b,t.async=function(r,e,n,o){var i=new b(u(r,e,n,o));return t.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},E(x),x[c]="Generator",x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=G,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return c.type="throw",c.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),h=n.call(a,"finallyLoc");if(u&&h){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),O(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;O(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:G(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=t}catch(r){Function("r","regeneratorRuntime = r")(t)}
},{}],"m4eR":[function(require,module,exports) {
module.exports=require("regenerator-runtime");
},{"regenerator-runtime":"KA2S"}],"fwsn":[function(require,module,exports) {
function n(n,t,o,r,e,i,u){try{var c=n[i](u),v=c.value}catch(a){return void o(a)}c.done?t(v):Promise.resolve(v).then(r,e)}function t(t){return function(){var o=this,r=arguments;return new Promise(function(e,i){var u=t.apply(o,r);function c(t){n(u,e,i,c,v,"next",t)}function v(t){n(u,e,i,c,v,"throw",t)}c(void 0)})}}module.exports=t;
},{}],"ZBnv":[function(require,module,exports) {
function n(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}module.exports=n;
},{}],"NoOd":[function(require,module,exports) {
function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function r(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}module.exports=r;
},{}],"Jibl":[function(require,module,exports) {
function t(o,e){return module.exports=t=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t},t(o,e)}module.exports=t;
},{}],"qngw":[function(require,module,exports) {
var e=require("./setPrototypeOf");function r(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),t&&e(r,t)}module.exports=r;
},{"./setPrototypeOf":"Jibl"}],"LNzP":[function(require,module,exports) {
function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(t)}function t(n){return"function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?module.exports=t=function(t){return o(t)}:module.exports=t=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":o(t)},t(n)}module.exports=t;
},{}],"VmQe":[function(require,module,exports) {
function e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}module.exports=e;
},{}],"GFCP":[function(require,module,exports) {
var e=require("../helpers/typeof"),r=require("./assertThisInitialized");function t(t,i){return!i||"object"!==e(i)&&"function"!=typeof i?r(t):i}module.exports=t;
},{"../helpers/typeof":"LNzP","./assertThisInitialized":"VmQe"}],"WQgz":[function(require,module,exports) {
function t(e){return module.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t(e)}module.exports=t;
},{}],"ucH8":[function(require,module,exports) {
module.exports={name:"eyevinn-html-player",version:"0.4.2",description:"Eyevinn HTML5 Player with support for HLS, MPEG-DASH and MSS",main:"index.js",scripts:{"build-js":"parcel build index.js --no-source-maps --out-dir build --out-file eyevinn-html-player.js","build-css":"parcel build styles/main.scss --no-source-maps --public-url ./ --out-dir build --out-file eyevinn-html-player.css",build:"npm run build-js && npm run build-css",start:"parcel ./demo/index.html",test:"jest --passWithNoTests",postversion:"git push && git push --tags"},author:"Jonas BirmÃ© <jonas.birme@eyevinn.se>",contributors:["Erik Hoffman <erik.hoffman@eyevinn.se>"],license:"Apache-2.0",dependencies:{dashjs:"^3.0.0","hls.js":"^0.12.4","shaka-player":"^2.5.6"},devDependencies:{"@babel/cli":"^7.8.3","@babel/core":"^7.8.3","@babel/plugin-transform-runtime":"^7.8.3","@babel/preset-env":"^7.8.3","@types/jest":"^24.0.23","babel-eslint":"^10.0.3","babel-jest":"^24.9.0","babel-loader":"^8.0.6","dotenv-vars":"^2.1.0",eslint:"^6.7.2","eslint-config-prettier":"^6.7.0","eslint-plugin-jest":"^23.1.1","eslint-plugin-prettier":"^3.1.1",jest:"^24.9.0","parcel-bundler":"^1.12.4",prettier:"^1.19.1",sass:"^1.23.7"}};
},{}],"Sxab":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerTechInterface=void 0;var e=n(require("@babel/runtime/helpers/classCallCheck")),t=n(require("@babel/runtime/helpers/createClass"));function n(e){return e&&e.__esModule?e:{default:e}}function i(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=r(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,u=!0,a=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return u=e.done,e},e:function(e){a=!0,o=e},f:function(){try{u||null==i.return||i.return()}finally{if(a)throw o}}}}function r(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var u=require("../../package.json").version,a=function(){function n(t,i){(0,e.default)(this,n),this.manifestUrl_=i,this.videoElement_=null,this.wrapperElement_=this.init_(t),this.eventListeners_={playing:[],paused:[],muted:[],unmuted:[]}}return(0,t.default)(n,[{key:"on",value:function(e,t){this.eventListeners_[e].push(t)}},{key:"attachControllerSkin",value:function(e){this.controllerSkin_=e}},{key:"play",value:function(e){var t=this;this.videoElement_.muted=!!e;var n,r=this.videoElement_.muted?"muted":"unmuted",o=i(this.eventListeners_[r]);try{for(o.s();!(n=o.n()).done;){(0,n.value)()}}catch(a){o.e(a)}finally{o.f()}var u=this.videoElement_.play();void 0!==u&&u.catch(function(){console.log("Auto-play was prevented, show big play button"),t.controllerSkin_.showBigPlayButton()}).then(function(){})}},{key:"pause",value:function(){this.videoElement_.pause()}},{key:"mute",value:function(){this.videoElement_.muted=!0}},{key:"unmute",value:function(){this.videoElement_.muted=!1}},{key:"load",value:function(){return new Promise(function(e,t){t("Missing implementation of load() in player tech.")})}},{key:"init_",value:function(e){var t=this;this.videoElement_=document.createElement("video"),this.videoElement_.className="eyevinn-player";var n=document.getElementById(e);return n.appendChild(this.videoElement_),n.style.setProperty("position","relative"),this.videoElement_.addEventListener("playing",function(){var e,n=i(t.eventListeners_.playing);try{for(n.s();!(e=n.n()).done;){(0,e.value)()}}catch(r){n.e(r)}finally{n.f()}}),this.videoElement_.addEventListener("pause",function(){var e,n=i(t.eventListeners_.paused);try{for(n.s();!(e=n.n()).done;){(0,e.value)()}}catch(r){n.e(r)}finally{n.f()}}),this.videoElement_.addEventListener("volumechange",function(){var e,n=t.videoElement_.muted?"muted":"unmuted",r=i(t.eventListeners_[n]);try{for(r.s();!(e=r.n()).done;){(0,e.value)()}}catch(o){r.e(o)}finally{r.f()}}),n}},{key:"version",get:function(){return u}},{key:"wrapper",get:function(){return this.wrapperElement_}},{key:"isPlaying",get:function(){return!this.videoElement_.paused}},{key:"isMuted",get:function(){return this.videoElement_.muted}},{key:"isLive",get:function(){throw new Error("Missing implementation of isLive() property in player tech.")}},{key:"duration",get:function(){return this.isLive?NaN:this.videoElement_.duration}},{key:"position",get:function(){return this.isLive?NaN:this.videoElement_.currentTime},set:function(e){this.isLive||(this.videoElement_.currentTime=e)}}]),n}();exports.PlayerTechInterface=a;
},{"@babel/runtime/helpers/classCallCheck":"ZBnv","@babel/runtime/helpers/createClass":"NoOd","../../package.json":"ucH8"}],"LbLF":[function(require,module,exports) {
var define;
var global = arguments[3];
var e,t=arguments[3];"undefined"!=typeof window&&function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof e&&e.amd?e([],r):"object"==typeof exports?exports.Hls=r():t.Hls=r()}(this,function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s="./src/hls.js")}({"./node_modules/eventemitter3/index.js":function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty,a="~";function n(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new s(r,i||e,n),l=a?a+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function u(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(a=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)i.call(e,t)&&r.push(a?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=a?a+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,s=new Array(n);i<n;i++)s[i]=r[i].fn;return s},u.prototype.listenerCount=function(e){var t=a?a+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,i,n,s){var o=a?a+e:e;if(!this._events[o])return!1;var l,u,d=this._events[o],c=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),c){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,i),!0;case 5:return d.fn.call(d.context,t,r,i,n),!0;case 6:return d.fn.call(d.context,t,r,i,n,s),!0}for(u=1,l=new Array(c-1);u<c;u++)l[u-1]=arguments[u];d.fn.apply(d.context,l)}else{var f,h=d.length;for(u=0;u<h;u++)switch(d[u].once&&this.removeListener(e,d[u].fn,void 0,!0),c){case 1:d[u].fn.call(d[u].context);break;case 2:d[u].fn.call(d[u].context,t);break;case 3:d[u].fn.call(d[u].context,t,r);break;case 4:d[u].fn.call(d[u].context,t,r,i);break;default:if(!l)for(f=1,l=new Array(c-1);f<c;f++)l[f-1]=arguments[f];d[u].fn.apply(d[u].context,l)}}return!0},u.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,i){var n=a?a+e:e;if(!this._events[n])return this;if(!t)return l(this,n),this;var s=this._events[n];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||l(this,n);else{for(var o=0,u=[],d=s.length;o<d;o++)(s[o].fn!==t||i&&!s[o].once||r&&s[o].context!==r)&&u.push(s[o]);u.length?this._events[n]=1===u.length?u[0]:u:l(this,n)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=a?a+e:e,this._events[t]&&l(this,t)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=a,u.EventEmitter=u,e.exports=u},"./node_modules/node-libs-browser/node_modules/events/events.js":function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function a(e){return"object"==typeof e&&null!==e}function n(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,s,o,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}if(n(r=this._events[e]))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(a(r))for(o=Array.prototype.slice.call(arguments,1),s=(u=r.slice()).length,l=0;l<s;l++)u[l].apply(this,o);return!0},r.prototype.addListener=function(e,t){var s;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(s=n(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=!1;function a(){this.removeListener(e,a),r||(r=!0,t.apply(this,arguments))}return a.listener=t,this.on(e,a),this},r.prototype.removeListener=function(e,t){var r,n,s,o;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(r)){for(o=s;o-- >0;)if(r[o]===t||r[o].listener&&r[o].listener===t){n=o;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,r){var i,a,n,s,o;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,a=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var i=o.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=o.normalizePath(i.path),o.buildURLFromParts(i)}var n=o.parseURL(t);if(!n)throw new Error("Error trying to parse relative URL.");if(n.scheme)return r.alwaysNormalize?(n.path=o.normalizePath(n.path),o.buildURLFromParts(n)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=a.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(u.netLoc=s.netLoc,"/"!==n.path[0]))if(n.path){var d=s.path,c=d.substring(0,d.lastIndexOf("/")+1)+n.path;u.path=o.normalizePath(c)}else u.path=s.path,n.params||(u.params=s.params,n.query||(u.query=s.query));return null===u.path&&(u.path=r.alwaysNormalize?o.normalizePath(n.path):n.path),o.buildURLFromParts(u)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o},"./node_modules/webworkify-webpack/index.js":function(e,t,r){function i(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var i=r(r.s=ENTRY_MODULE);return i.default||i}var a="[\\.|\\-|\\+|\\w|/|@]+",n="\\((/\\*.*?\\*/)?s?.*?("+a+").*?\\)";function s(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(e,t,i){var o={};o[i]=[];var l=t.toString(),u=l.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!u)return o;for(var d,c=u[1],f=new RegExp("(\\\\n|\\W)"+s(c)+n,"g");d=f.exec(l);)"dll-reference"!==d[3]&&o[i].push(d[3]);for(f=new RegExp("\\("+s(c)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+n,"g");d=f.exec(l);)e[d[2]]||(o[i].push(d[1]),e[d[2]]=r(d[1]).m),o[d[2]]=o[d[2]]||[],o[d[2]].push(d[4]);for(var h,p=Object.keys(o),g=0;g<p.length;g++)for(var v=0;v<o[p[g]].length;v++)h=o[p[g]][v],isNaN(1*h)||(o[p[g]][v]=1*o[p[g]][v]);return o}function l(e){return Object.keys(e).reduce(function(t,r){return t||e[r].length>0},!1)}e.exports=function(e,t){t=t||{};var a={main:r.m},n=t.all?{main:Object.keys(a.main)}:function(e,t){for(var r={main:[t]},i={main:[]},a={main:{}};l(r);)for(var n=Object.keys(r),s=0;s<n.length;s++){var u=n[s],d=r[u].pop();if(a[u]=a[u]||{},!a[u][d]&&e[u][d]){a[u][d]=!0,i[u]=i[u]||[],i[u].push(d);for(var c=o(e,e[u][d],u),f=Object.keys(c),h=0;h<f.length;h++)r[f[h]]=r[f[h]]||[],r[f[h]]=r[f[h]].concat(c[f[h]])}}return i}(a,e),s="";Object.keys(n).filter(function(e){return"main"!==e}).forEach(function(e){for(var t=0;n[e][t];)t++;n[e].push(t),a[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",s=s+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+n[e].map(function(t){return JSON.stringify(t)+": "+a[e][t].toString()}).join(",")+"});\n"}),s=s+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+n.main.map(function(e){return JSON.stringify(e)+": "+a.main[e].toString()}).join(",")+"}))(self);";var u=new window.Blob([s],{type:"text/javascript"});if(t.bare)return u;var d=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),c=new window.Worker(d);return c.objectURL=d,c}},"./src/config.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/controller/abr-controller.js"),a=r("./src/controller/buffer-controller.js"),n=r("./src/controller/cap-level-controller.js"),s=r("./src/controller/fps-controller.js"),o=r("./src/utils/xhr-loader.js"),l=r("./src/controller/audio-track-controller.js"),u=r("./src/controller/audio-stream-controller.js"),d=r("./src/utils/cues.js"),c=r("./src/controller/timeline-controller.js"),f=r("./src/controller/subtitle-track-controller.js"),h=r("./src/controller/subtitle-stream-controller.js"),p=r("./src/controller/eme-controller.js"),g=r("./src/utils/mediakeys-helper.js");t.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:o.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:i.default,bufferController:a.default,capLevelController:n.default,fpsController:s.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:g.requestMediaKeySystemAccess},t.hlsDefaultConfig.subtitleStreamController=h.SubtitleStreamController,t.hlsDefaultConfig.subtitleTrackController=f.default,t.hlsDefaultConfig.timelineController=c.default,t.hlsDefaultConfig.cueHandler=d,t.hlsDefaultConfig.enableCEA708Captions=!0,t.hlsDefaultConfig.enableWebVTT=!0,t.hlsDefaultConfig.captionsTextTrack1Label="English",t.hlsDefaultConfig.captionsTextTrack1LanguageCode="en",t.hlsDefaultConfig.captionsTextTrack2Label="Spanish",t.hlsDefaultConfig.captionsTextTrack2LanguageCode="es",t.hlsDefaultConfig.audioStreamController=u.default,t.hlsDefaultConfig.audioTrackController=l.default,t.hlsDefaultConfig.emeController=p.default},"./src/controller/abr-controller.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/event-handler.js"),o=r("./src/utils/buffer-helper.js"),l=r("./src/errors.js"),u=r("./src/utils/logger.js"),d=r("./src/utils/ewma-bandwidth-estimator.js"),c=window.performance,f=function(t){function r(e){var r=t.call(this,e,n.default.FRAG_LOADING,n.default.FRAG_LOADED,n.default.FRAG_BUFFERED,n.default.ERROR)||this;return r.lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(r),r}return a(r,t),r.prototype.destroy=function(){this.clearTimer(),s.default.prototype.destroy.call(this)},r.prototype.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r=this.hls,i=r.config,a=t.level,n=void 0,s=void 0;r.levels[a].details.live?(n=i.abrEwmaFastLive,s=i.abrEwmaSlowLive):(n=i.abrEwmaFastVoD,s=i.abrEwmaSlowVoD),this._bwEstimator=new d.default(r,s,n,i.abrEwmaDefaultEstimate)}},r.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var i=r.loader,a=e.minAutoLevel;if(!i||i.stats&&i.stats.aborted)return u.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var s=i.stats;if(t&&s&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var l=c.now()-s.trequest,d=Math.abs(t.playbackRate);if(l>500*r.duration/d){var f=e.levels,h=Math.max(1,s.bw?s.bw/8:1e3*s.loaded/l),p=f[r.level],g=p.realBitrate?Math.max(p.realBitrate,p.bitrate):p.bitrate,v=s.total?s.total:Math.max(s.loaded,Math.round(r.duration*g/8)),m=t.currentTime,y=(v-s.loaded)/h,E=(o.BufferHelper.bufferInfo(t,m,e.config.maxBufferHole).end-m)/d;if(E<2*r.duration/d&&y>E){var _=void 0,T=void 0;for(T=r.level-1;T>a;T--){var S=f[T].realBitrate?Math.max(f[T].realBitrate,f[T].bitrate):f[T].bitrate;if((_=r.duration*S/(6.4*h))<E)break}_<y&&(u.logger.warn("loading too slow, abort fragment loading and switch to level "+T+":fragLoadedDelay["+T+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+_.toFixed(1)+"<"+y.toFixed(1)+":"+E.toFixed(1)),e.nextLoadLevel=T,this._bwEstimator.sample(l,s.loaded),i.abort(),this.clearTimer(),e.trigger(n.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:s}))}}}}},r.prototype.onFragLoaded=function(t){var r=t.frag;if("main"===r.type&&e.isFinite(r.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=r.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[r.level],a=(i.loaded?i.loaded.bytes:0)+t.stats.loaded,n=(i.loaded?i.loaded.duration:0)+t.frag.duration;i.loaded={bytes:a,duration:n},i.realBitrate=Math.round(8*a/n)}if(t.frag.bitrateTest){var s=t.stats;s.tparsed=s.tbuffered=s.tload,this.onFragBuffered(t)}}},r.prototype.onFragBuffered=function(t){var r=t.stats,i=t.frag;if(!0!==r.aborted&&"main"===i.type&&e.isFinite(i.sn)&&(!i.bitrateTest||r.tload===r.tbuffered)){var a=r.tparsed-r.trequest;u.logger.log("latency/loading/parsing/append/kbps:"+Math.round(r.tfirst-r.trequest)+"/"+Math.round(r.tload-r.tfirst)+"/"+Math.round(r.tparsed-r.tload)+"/"+Math.round(r.tbuffered-r.tparsed)+"/"+Math.round(8*r.loaded/(r.tbuffered-r.trequest))),this._bwEstimator.sample(a,r.loaded),r.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}},r.prototype.onError=function(e){switch(e.details){case l.ErrorDetails.FRAG_LOAD_ERROR:case l.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},r.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},Object.defineProperty(r.prototype,"nextAutoLevel",{get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_nextABRAutoLevel",{get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,i=e.config,a=e.minAutoLevel,n=e.media,s=this.lastLoadedFragLevel,l=this.fragCurrent?this.fragCurrent.duration:0,d=n?n.currentTime:0,c=n&&0!==n.playbackRate?Math.abs(n.playbackRate):1,f=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,h=(o.BufferHelper.bufferInfo(n,d,i.maxBufferHole).end-d)/c,p=this._findBestLevel(s,l,f,a,t,h,i.abrBandWidthFactor,i.abrBandWidthUpFactor,r);if(p>=0)return p;u.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var g=l?Math.min(l,i.maxStarvationDelay):i.maxStarvationDelay,v=i.abrBandWidthFactor,m=i.abrBandWidthUpFactor;if(0===h){var y=this.bitrateTestDelay;if(y)g=(l?Math.min(l,i.maxLoadingDelay):i.maxLoadingDelay)-y,u.logger.trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*g)+" ms"),v=m=1}return p=this._findBestLevel(s,l,f,a,t,h+g,v,m,r),Math.max(p,0)},enumerable:!0,configurable:!0}),r.prototype._findBestLevel=function(e,t,r,i,a,n,s,o,l){for(var d=a;d>=i;d--){var c=l[d];if(c){var f=c.details,h=f?f.totalduration/f.fragments.length:t,p=!!f&&f.live,g=void 0;g=d<=e?s*r:o*r;var v=l[d].realBitrate?Math.max(l[d].realBitrate,l[d].bitrate):l[d].bitrate,m=v*h/g;if(u.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+d+"/"+Math.round(g)+"/"+v+"/"+h+"/"+n+"/"+m),g>v&&(!m||p&&!this.bitrateTestDelay||m<n))return d}}return-1},r}(s.default);t.default=f}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/audio-stream-controller.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/utils/binary-search.js"),s=r("./src/utils/buffer-helper.js"),o=r("./src/demux/demuxer.js"),l=r("./src/events.js"),u=r("./src/controller/level-helper.js"),d=r("./src/utils/time-ranges.js"),c=r("./src/errors.js"),f=r("./src/utils/logger.js"),h=r("./src/utils/discontinuities.js"),p=r("./src/controller/fragment-tracker.js"),g=r("./src/loader/fragment.js"),v=r("./src/controller/base-stream-controller.js"),m=window.performance,y=function(t){function r(e,r){var i=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.AUDIO_TRACKS_UPDATED,l.default.AUDIO_TRACK_SWITCHING,l.default.AUDIO_TRACK_LOADED,l.default.KEY_LOADED,l.default.FRAG_LOADED,l.default.FRAG_PARSING_INIT_SEGMENT,l.default.FRAG_PARSING_DATA,l.default.FRAG_PARSED,l.default.ERROR,l.default.BUFFER_RESET,l.default.BUFFER_CREATED,l.default.BUFFER_APPENDED,l.default.BUFFER_FLUSHED,l.default.INIT_PTS_FOUND)||this;return i.fragmentTracker=r,i.config=e.config,i.audioCodecSwap=!1,i._state=v.State.STOPPED,i.initPTS=[],i.waitingFragment=null,i.videoTrackCC=null,i}return a(r,t),r.prototype.onInitPtsFound=function(e){var t=e.id,r=e.frag.cc,i=e.initPTS;"main"===t&&(this.initPTS[r]=i,this.videoTrackCC=r,f.logger.log("InitPTS for cc: "+r+" found from video track: "+i),this.state===v.State.WAITING_INIT_PTS&&this.tick())},r.prototype.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(f.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=v.State.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=v.State.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=v.State.STOPPED},Object.defineProperty(r.prototype,"state",{get:function(){return this._state},set:function(e){if(this.state!==e){var t=this.state;this._state=e,f.logger.log("audio stream:"+t+"->"+e)}},enumerable:!0,configurable:!0}),r.prototype.doTick=function(){var t,r,i,a=this.hls,o=a.config;switch(this.state){case v.State.ERROR:case v.State.PAUSED:case v.State.BUFFER_FLUSHING:break;case v.State.STARTING:this.state=v.State.WAITING_TRACK,this.loadedmetadata=!1;break;case v.State.IDLE:var u=this.tracks;if(!u)break;if(!this.media&&(this.startFragRequested||!o.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var d=this.mediaBuffer?this.mediaBuffer:this.media,c=this.videoBuffer?this.videoBuffer:this.media,g=s.BufferHelper.bufferInfo(d,t,o.maxBufferHole),y=s.BufferHelper.bufferInfo(c,t,o.maxBufferHole),E=g.len,_=g.end,T=this.fragPrevious,S=Math.min(o.maxBufferLength,o.maxMaxBufferLength),b=Math.max(S,y.len),A=this.audioSwitch,R=this.trackId;if((E<b||A)&&R<u.length){if(void 0===(i=u[R].details)){this.state=v.State.WAITING_TRACK;break}if(!A&&this._streamEnded(g,i))return this.hls.trigger(l.default.BUFFER_EOS,{type:"audio"}),void(this.state=v.State.ENDED);var D=i.fragments,L=D.length,w=D[0].start,O=D[L-1].start+D[L-1].duration,k=void 0;if(A)if(i.live&&!i.PTSKnown)f.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),_=0;else if(_=t,i.PTSKnown&&t<w){if(!(g.end>w||g.nextStart))return;f.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=w+.05}if(i.initSegment&&!i.initSegment.data)k=i.initSegment;else if(_<=w){if(k=D[0],null!==this.videoTrackCC&&k.cc!==this.videoTrackCC&&(k=h.findFragWithCC(D,this.videoTrackCC)),i.live&&k.loadIdx&&k.loadIdx===this.fragLoadIdx){var I=g.nextStart?g.nextStart:w;return f.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(I+.05)),void(this.media.currentTime=I+.05)}}else{var P=void 0,C=o.maxFragLookUpTolerance,x=T?D[T.sn-D[0].sn+1]:void 0,F=function(e){var t=Math.min(C,e.duration);return e.start+e.duration-t<=_?1:e.start-t>_&&e.start?-1:0};_<O?(_>O-C&&(C=0),P=x&&!F(x)?x:n.default.search(D,F)):P=D[L-1],P&&(k=P,w=P.start,T&&k.level===T.level&&k.sn===T.sn&&(k.sn<i.endSN?(k=D[k.sn+1-i.startSN],f.logger.log("SN just loaded, load next one: "+k.sn)):k=null))}k&&(k.encrypted?(f.logger.log("Loading key for "+k.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+R),this.state=v.State.KEY_LOADING,a.trigger(l.default.KEY_LOADING,{frag:k})):(f.logger.log("Loading "+k.sn+", cc: "+k.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+R+", currentTime:"+t+",bufferEnd:"+_.toFixed(3)),this.fragCurrent=k,(A||this.fragmentTracker.getState(k)===p.FragmentState.NOT_LOADED)&&(this.startFragRequested=!0,e.isFinite(k.sn)&&(this.nextLoadPosition=k.start+k.duration),a.trigger(l.default.FRAG_LOADING,{frag:k}),this.state=v.State.FRAG_LOADING)))}break;case v.State.WAITING_TRACK:(r=this.tracks[this.trackId])&&r.details&&(this.state=v.State.IDLE);break;case v.State.FRAG_LOADING_WAITING_RETRY:var M=m.now(),N=this.retryDate,j=(d=this.media)&&d.seeking;(!N||M>=N||j)&&(f.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=v.State.IDLE);break;case v.State.WAITING_INIT_PTS:var U=this.videoTrackCC;if(void 0===this.initPTS[U])break;var B=this.waitingFragment;if(B){var G=B.frag.cc;U!==G?(r=this.tracks[this.trackId]).details&&r.details.live&&(f.logger.warn("Waiting fragment CC ("+G+") does not match video track CC ("+U+")"),this.waitingFragment=null,this.state=v.State.IDLE):(this.state=v.State.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=v.State.IDLE;break;case v.State.STOPPED:case v.State.FRAG_LOADING:case v.State.PARSING:case v.State.PARSED:case v.State.ENDED:}},r.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},r.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(f.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},r.prototype.onAudioTracksUpdated=function(e){f.logger.log("audio tracks updated"),this.tracks=e.audioTracks},r.prototype.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=v.State.PAUSED,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=v.State.IDLE),this.tick()},r.prototype.onAudioTrackLoaded=function(t){var r=t.details,i=t.id,a=this.tracks[i],n=r.totalduration,s=0;if(f.logger.log("track "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+n),r.live){var o=a.details;o&&r.fragments.length>0?(u.mergeDetails(o,r),s=r.fragments[0].start,r.PTSKnown?f.logger.log("live audio playlist sliding:"+s.toFixed(3)):f.logger.log("live audio playlist - outdated PTS, unknown sliding")):(r.PTSKnown=!1,f.logger.log("live audio playlist - first load, unknown sliding"))}else r.PTSKnown=!1;if(a.details=r,!this.startFragRequested){if(-1===this.startPosition){var l=r.startTimeOffset;e.isFinite(l)?(f.logger.log("start time offset found in playlist, adjust startPosition to "+l),this.startPosition=l):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===v.State.WAITING_TRACK&&(this.state=v.State.IDLE),this.tick()},r.prototype.onKeyLoaded=function(){this.state===v.State.KEY_LOADING&&(this.state=v.State.IDLE,this.tick())},r.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag;if(this.state===v.State.FRAG_LOADING&&t&&"audio"===r.type&&r.level===t.level&&r.sn===t.sn){var i=this.tracks[this.trackId],a=i.details,n=a.totalduration,s=t.level,u=t.sn,d=t.cc,c=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",h=this.stats=e.stats;if("initSegment"===u)this.state=v.State.IDLE,h.tparsed=h.tbuffered=m.now(),a.initSegment.data=e.payload,this.hls.trigger(l.default.FRAG_BUFFERED,{stats:h,frag:t,id:"audio"}),this.tick();else{this.state=v.State.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new o.default(this.hls,"audio"));var p=this.initPTS[d],g=a.initSegment?a.initSegment.data:[];if(a.initSegment||void 0!==p){this.pendingBuffering=!0,f.logger.log("Demuxing "+u+" of ["+a.startSN+" ,"+a.endSN+"],track "+s);this.demuxer.push(e.payload,g,c,null,t,n,!1,p)}else f.logger.log("unknown video PTS for continuity counter "+d+", waiting for video PTS before demuxing audio frag "+u+" of ["+a.startSN+" ,"+a.endSN+"],track "+s),this.waitingFragment=e,this.state=v.State.WAITING_INIT_PTS}}this.fragLoadError=0},r.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===v.State.PARSING){var i=e.tracks,a=void 0;if(i.video&&delete i.video,a=i.audio){a.levelCodec=a.codec,a.id=e.id,this.hls.trigger(l.default.BUFFER_CODECS,i),f.logger.log("audio track:audio,container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var n=a.initSegment;if(n){var s={type:"audio",data:n,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.default.BUFFER_APPENDING,s))}this.tick()}}},r.prototype.onFragParsingData=function(t){var r=this,i=this.fragCurrent,a=t.frag;if(i&&"audio"===t.id&&"audio"===t.type&&a.sn===i.sn&&a.level===i.level&&this.state===v.State.PARSING){var n=this.trackId,s=this.tracks[n],o=this.hls;e.isFinite(t.endPTS)||(t.endPTS=t.startPTS+i.duration,t.endDTS=t.startDTS+i.duration),i.addElementaryStream(g.default.ElementaryStreamTypes.AUDIO),f.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),u.updateFragPTSDTS(s.details,i,t.startPTS,t.endPTS);var d=this.audioSwitch,h=this.media,p=!1;if(d&&h)if(h.readyState){var m=h.currentTime;f.logger.log("switching audio track : currentTime:"+m),m>=t.startPTS&&(f.logger.log("switching audio track : flushing all audio"),this.state=v.State.BUFFER_FLUSHING,o.trigger(l.default.BUFFER_FLUSHING,{startOffset:0,endOffset:e.POSITIVE_INFINITY,type:"audio"}),p=!0,this.audioSwitch=!1,o.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:n}))}else this.audioSwitch=!1,o.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:n});var y=this.pendingData;if(!y)return f.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void o.trigger(l.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&y.push({type:t.type,data:e,parent:"audio",content:"data"})}),!p&&y.length&&(y.forEach(function(e){r.state===v.State.PARSING&&(r.pendingBuffering=!0,r.hls.trigger(l.default.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},r.prototype.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===v.State.PARSING&&(this.stats.tparsed=m.now(),this.state=v.State.PARSED,this._checkAppendedParsed())},r.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},r.prototype.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},r.prototype.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==v.State.PARSING&&t!==v.State.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},r.prototype._checkAppendedParsed=function(){if(!(this.state!==v.State.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e){this.fragPrevious=e,t.tbuffered=m.now(),r.trigger(l.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var i=this.mediaBuffer?this.mediaBuffer:this.media;f.logger.log("audio buffered : "+d.default.toString(i.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=v.State.IDLE}this.tick()}},r.prototype.onError=function(t){var r=t.frag;if(!r||"audio"===r.type)switch(t.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:var i=t.frag;if(i&&"audio"!==i.type)break;if(!t.fatal){var a=this.fragLoadError;if(a?a++:a=1,a<=(o=this.config).fragLoadingMaxRetry){this.fragLoadError=a;var n=Math.min(Math.pow(2,a-1)*o.fragLoadingRetryDelay,o.fragLoadingMaxRetryTimeout);f.logger.warn("AudioStreamController: frag loading failed, retry in "+n+" ms"),this.retryDate=m.now()+n,this.state=v.State.FRAG_LOADING_WAITING_RETRY}else f.logger.error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=v.State.ERROR}break;case c.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case c.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case c.ErrorDetails.KEY_LOAD_ERROR:case c.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==v.State.ERROR&&(this.state=t.fatal?v.State.ERROR:v.State.IDLE,f.logger.warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ..."));break;case c.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===v.State.PARSING||this.state===v.State.PARSED)){var o,u=this.mediaBuffer,d=this.media.currentTime;if(u&&s.BufferHelper.isBuffered(u,d)&&s.BufferHelper.isBuffered(u,d+.5))(o=this.config).maxMaxBufferLength>=o.maxBufferLength&&(o.maxMaxBufferLength/=2,f.logger.warn("AudioStreamController: reduce max buffer length to "+o.maxMaxBufferLength+"s")),this.state=v.State.IDLE;else f.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=v.State.BUFFER_FLUSHING,this.hls.trigger(l.default.BUFFER_FLUSHING,{startOffset:0,endOffset:e.POSITIVE_INFINITY,type:"audio"})}}},r.prototype.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(f.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach(function(t){e.hls.trigger(l.default.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=v.State.PARSED):(this.state=v.State.IDLE,this.fragPrevious=null,this.tick())},r}(v.default);t.default=y}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/audio-track-controller.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/task-loop.js"),o=r("./src/utils/logger.js"),l=r("./src/errors.js"),u=function(e){function t(t){var r=e.call(this,t,n.default.MANIFEST_LOADING,n.default.MANIFEST_PARSED,n.default.AUDIO_TRACK_LOADED,n.default.AUDIO_TRACK_SWITCHED,n.default.LEVEL_LOADED,n.default.ERROR)||this;return r._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}return a(t,e),t.prototype.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},t.prototype.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(n.default.AUDIO_TRACKS_UPDATED,{audioTracks:t})},t.prototype.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)o.logger.warn("Invalid audio track id:",e.id);else{if(o.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},t.prototype.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},t.prototype.onLevelLoaded=function(e){var t=this.hls.levels[e.level];if(t.audioGroupIds){var r=t.audioGroupIds[t.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},t.prototype.onError=function(e){e.type===l.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===l.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(o.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},Object.defineProperty(t.prototype,"audioTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTrack",{get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1},enumerable:!0,configurable:!0}),t.prototype._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)o.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)o.logger.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];o.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var r=t.url,i=t.type,a=t.id;this.hls.trigger(n.default.AUDIO_TRACK_SWITCHING,{id:a,type:i,url:r}),this._loadTrackDetailsIfNeeded(t)}},t.prototype.doTick=function(){this._updateTrack(this._trackId)},t.prototype._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var r=this.tracks[this._trackId],i=null;if(r&&(i=r.name),this._selectDefaultTrack){var a=t.filter(function(e){return e.default});a.length?t=a:o.logger.warn("No default audio tracks defined")}var s=!1,u=function(){t.forEach(function(t){s||e.audioGroupId&&t.groupId!==e.audioGroupId||i&&i!==t.name||(e._setAudioTrack(t.id),s=!0)})};u(),s||(i=null,u()),s||(o.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(n.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},t.prototype._needsTrackLoading=function(e){var t=e.details,r=e.url;return!(t&&!t.live)&&!!r},t.prototype._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,r=e.id;o.logger.log("loading audio-track playlist for id: "+r),this.hls.trigger(n.default.AUDIO_TRACK_LOADING,{url:t,id:r})}},t.prototype._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,o.logger.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},t.prototype._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],r=t.name,i=t.language,a=t.groupId;o.logger.warn("Loading failed on audio track id: "+e+", group-id: "+a+', name/language: "'+r+'" / "'+i+'"');for(var n=e,s=0;s<this.tracks.length;s++){if(!this.trackIdBlacklist[s])if(this.tracks[s].name===r){n=s;break}}n!==e?(o.logger.log("Attempting audio-track fallback id:",n,"group-id:",this.tracks[n].groupId),this._setAudioTrack(n)):o.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+i+'"')},t}(s.default);t.default=u},"./src/controller/base-stream-controller.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/task-loop.js"),s=r("./src/controller/fragment-tracker.js"),o=r("./src/utils/buffer-helper.js"),l=r("./src/utils/logger.js");t.State={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};var u=function(r){function i(){return null!==r&&r.apply(this,arguments)||this}return a(i,r),i.prototype.doTick=function(){},i.prototype.startLoad=function(){},i.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=t.State.STOPPED},i.prototype._streamEnded=function(e,t){var r=this.fragCurrent,i=this.fragmentTracker;if(!t.live&&r&&!r.backtracked&&r.sn===t.endSN&&!e.nextStart){var a=i.getState(r);return a===s.FragmentState.PARTIAL||a===s.FragmentState.OK}return!1},i.prototype.onMediaSeeking=function(){var r=this.config,i=this.media,a=this.mediaBuffer,n=this.state,s=i?i.currentTime:null,u=o.BufferHelper.bufferInfo(a||i,s,this.config.maxBufferHole);if(e.isFinite(s)&&l.logger.log("media seeking to "+s.toFixed(3)),n===t.State.FRAG_LOADING){var d=this.fragCurrent;if(0===u.len&&d){var c=r.maxFragLookUpTolerance,f=d.start-c,h=d.start+d.duration+c;s<f||s>h?(d.loader&&(l.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),d.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=t.State.IDLE):l.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else n===t.State.ENDED&&(0===u.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=t.State.IDLE);i&&(this.lastCurrentTime=s),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=s),this.tick()},i.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},i.prototype.onHandlerDestroying=function(){this.stopLoad(),r.prototype.onHandlerDestroying.call(this)},i.prototype.onHandlerDestroyed=function(){this.state=t.State.STOPPED,this.fragmentTracker=null},i}(n.default);t.default=u}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/buffer-controller.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/event-handler.js"),o=r("./src/utils/logger.js"),l=r("./src/errors.js"),u=r("./src/utils/mediasource-helper.js").getMediaSource(),d=function(t){function r(e){var r=t.call(this,e,n.default.MEDIA_ATTACHING,n.default.MEDIA_DETACHING,n.default.MANIFEST_PARSED,n.default.BUFFER_RESET,n.default.BUFFER_APPENDING,n.default.BUFFER_CODECS,n.default.BUFFER_EOS,n.default.BUFFER_FLUSHING,n.default.LEVEL_PTS_UPDATED,n.default.LEVEL_UPDATED)||this;return r._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r.bufferCodecEventsExpected=0,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r.pendingTracks={},r.tracks={},r}return a(r,t),r.prototype.destroy=function(){s.default.prototype.destroy.call(this)},r.prototype.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var i=this.sourceBuffer.audio;if(Math.abs(i.timestampOffset-e.start)>.1){var a=i.updating;try{i.abort()}catch(n){o.logger.warn("can not abort audio buffer: "+n)}a?this.audioTimestampOffset=e.start:(o.logger.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+e.start),i.timestampOffset=e.start)}}},r.prototype.onManifestParsed=function(e){this.bufferCodecEventsExpected=e.altAudio?2:1,o.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},r.prototype.onMediaAttaching=function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new u;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},r.prototype.onMediaDetaching=function(){o.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(t){o.logger.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):o.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(n.default.MEDIA_DETACHED)},r.prototype.onMediaSourceOpen=function(){o.logger.log("media source opened"),this.hls.trigger(n.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},r.prototype.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},r.prototype.onMediaSourceClose=function(){o.logger.log("media source closed")},r.prototype.onMediaSourceEnded=function(){o.logger.log("media source ended")},r.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;o.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,r=this.segments.reduce(function(e,r){return r.parent===t?e+1:e},0),i={},a=this.sourceBuffer;for(var s in a)i[s]=a[s].buffered;this.hls.trigger(n.default.BUFFER_APPENDED,{parent:t,pending:r,timeRanges:i}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration(),0===r&&this.flushLiveBackBuffer()},r.prototype.onSBUpdateError=function(e){o.logger.error("sourceBuffer error:",e),this.hls.trigger(n.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.prototype.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(i){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},r.prototype.onBufferCodecs=function(e){var t=this;if(!Object.keys(this.sourceBuffer).length){Object.keys(e).forEach(function(r){t.pendingTracks[r]=e[r]});var r=this.mediaSource;this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),r&&"open"===r.readyState&&this.checkPendingTracks()}},r.prototype.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var i in e)if(!t[i]){var a=e[i],s=a.levelCodec||a.codec,u=a.container+";codecs="+s;o.logger.log("creating sourceBuffer("+u+")");try{var d=t[i]=r.addSourceBuffer(u);d.addEventListener("updateend",this.onsbue),d.addEventListener("error",this.onsbe),this.tracks[i]={codec:s,container:a.container},a.buffer=d}catch(c){o.logger.error("error while trying to add sourceBuffer:"+c.message),this.hls.trigger(n.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:c,mimeType:u})}}this.hls.trigger(n.default.BUFFER_CREATED,{tracks:e})},r.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},r.prototype.onBufferAppendFail=function(e){o.logger.error("sourceBuffer error:",e.event),this.hls.trigger(n.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.prototype.onBufferEos=function(e){var t=this.sourceBuffer,r=e.type;for(var i in t)r&&i!==r||t[i].ended||(t[i].ended=!0,o.logger.log(i+" sourceBuffer now EOS"));this.checkEos()},r.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var i=e[r];if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}o.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(a){o.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},r.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},r.prototype.flushLiveBackBuffer=function(){if(this._live){var e=this.hls.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))for(var t=this.media.currentTime,r=this.sourceBuffer,i=Object.keys(r),a=t-Math.max(e,this._levelTargetDuration),n=i.length-1;n>=0;n--){var s=i[n],o=r[s].buffered;o.length>0&&a>o.start(0)&&this.removeBufferRange(s,r[s],0,a)}}},r.prototype.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},r.prototype.updateMediaElementDuration=function(){var t,r=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer)if(!0===this.sourceBuffer[i].updating)return;t=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===r.liveDurationInfinity?(o.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||!e.isFinite(t))&&(o.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},r.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var i in r)t+=r[i].buffered.length}catch(a){o.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(n.default.BUFFER_FLUSHED)}},r.prototype.doAppending=function(){var e=this.hls,t=this.segments,r=this.sourceBuffer;if(Object.keys(r).length){if(this.media.error)return this.segments=[],void o.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(t&&t.length){var i=t.shift();try{var a=r[i.type];a?a.updating?t.unshift(i):(a.ended=!1,this.parent=i.parent,a.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(u){o.logger.error("error while trying to append buffer:"+u.message),t.unshift(i);var s={type:l.ErrorTypes.MEDIA_ERROR,parent:i.parent};22!==u.code?(this.appendError?this.appendError++:this.appendError=1,s.details=l.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry?(o.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],s.fatal=!0,e.trigger(n.default.ERROR,s)):(s.fatal=!1,e.trigger(n.default.ERROR,s))):(this.segments=[],s.details=l.ErrorDetails.BUFFER_FULL_ERROR,s.fatal=!1,e.trigger(n.default.ERROR,s))}}}},r.prototype.flushBuffer=function(e,t,r){var i,a=this.sourceBuffer;if(Object.keys(a).length){if(o.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var n in a)if(!r||n===r){if((i=a[n]).ended=!1,i.updating)return o.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(n,i,e,t))return this.flushBufferCounter++,!1}}else o.logger.warn("abort flushing too many retries");o.logger.log("buffer flushed")}return!0},r.prototype.removeBufferRange=function(e,t,r,i){try{for(var a=0;a<t.buffered.length;a++){var n=t.buffered.start(a),s=t.buffered.end(a),l=Math.max(n,r),u=Math.min(s,i);if(Math.min(u,s)-l>.5)return o.logger.log("sb remove "+e+" ["+l+","+u+"], of ["+n+","+s+"], pos:"+this.media.currentTime),t.remove(l,u),!0}}catch(d){o.logger.warn("removeBufferRange failed",d)}return!1},r}(s.default);t.default=d}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/cap-level-controller.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=function(t){function r(r){var i=t.call(this,r,n.default.FPS_DROP_LEVEL_CAPPING,n.default.MEDIA_ATTACHING,n.default.MANIFEST_PARSED,n.default.BUFFER_CODECS,n.default.MEDIA_DETACHING)||this;return i.autoLevelCapping=e.POSITIVE_INFINITY,i.firstLevel=null,i.levels=[],i.media=null,i.restrictedLevels=[],i.timer=null,i}return a(r,t),r.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this._stopCapping())},r.prototype.onFpsDropLevelCapping=function(e){r.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},r.prototype.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},r.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this._startCapping()},r.prototype.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this._startCapping()},r.prototype.onLevelsUpdated=function(e){this.levels=e.levels},r.prototype.onMediaDetaching=function(){this._stopCapping()},r.prototype.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},r.prototype.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var i=this.levels.filter(function(i,a){return r.isLevelAllowed(a,t.restrictedLevels)&&a<=e});return r.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},r.prototype._startCapping=function(){this.timer||(this.autoLevelCapping=e.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},r.prototype._stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=e.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},Object.defineProperty(r.prototype,"mediaWidth",{get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=r.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"mediaHeight",{get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=r.contentScaleFactor),e},enumerable:!0,configurable:!0}),Object.defineProperty(r,"contentScaleFactor",{get:function(){var e=1;try{e=window.devicePixelRatio}catch(t){}return e},enumerable:!0,configurable:!0}),r.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},r.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var i,a,n=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=r)&&(i=o,!(a=e[s+1])||i.width!==a.width||i.height!==a.height)){n=s;break}}return n},r}(r("./src/event-handler.js").default);t.default=s}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/eme-controller.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/event-handler.js"),s=r("./src/events.js"),o=r("./src/errors.js"),l=r("./src/utils/logger.js"),u=window.XMLHttpRequest,d="com.widevine.alpha",c="com.microsoft.playready",f=function(e){function t(t){var r=e.call(this,t,s.default.MEDIA_ATTACHED,s.default.MANIFEST_PARSED)||this;return r._widevineLicenseUrl=t.config.widevineLicenseUrl,r._licenseXhrSetup=t.config.licenseXhrSetup,r._emeEnabled=t.config.emeEnabled,r._requestMediaKeySystemAccess=t.config.requestMediaKeySystemAccessFunc,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._isMediaEncrypted=!1,r._requestLicenseFailureCount=0,r}return a(t,e),t.prototype.getLicenseServerUrl=function(e){var t;switch(e){case d:t=this._widevineLicenseUrl;break;default:t=null}return t||(l.logger.error('No license server URL configured for key-system "'+e+'"'),this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),t},t.prototype._attemptKeySystemAccess=function(e,t,r){var i=this,a=function(e,t,r){switch(e){case d:return function(e,t,r){var i={videoCapabilities:[]};return t.forEach(function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})}),[i]}(0,r);default:throw Error("Unknown key-system: "+e)}}(e,0,r);a?(l.logger.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(e,a).then(function(t){i._onMediaKeySystemAccessObtained(e,t)}).catch(function(t){l.logger.error('Failed to obtain key-system "'+e+'" access:',t)})):l.logger.warn("Can not create config for key-system (maybe because platform is not supported):",e)},Object.defineProperty(t.prototype,"requestMediaKeySystemAccess",{get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess},enumerable:!0,configurable:!0}),t.prototype._onMediaKeySystemAccessObtained=function(e,t){var r=this;l.logger.log('Access for key-system "'+e+'" obtained');var i={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(i),t.createMediaKeys().then(function(t){i.mediaKeys=t,l.logger.log('Media-keys created for key-system "'+e+'"'),r._onMediaKeysCreated()}).catch(function(e){l.logger.error("Failed to create media-keys:",e)})},t.prototype._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))})},t.prototype._onNewMediaKeySession=function(e){var t=this;l.logger.log("New key-system session "+e.sessionId),e.addEventListener("message",function(r){t._onKeySessionMessage(e,r.message)},!1)},t.prototype._onKeySessionMessage=function(e,t){l.logger.log("Got EME message event, creating license request"),this._requestLicense(t,function(t){l.logger.log("Received license data, updating key-session"),e.update(t)})},t.prototype._onMediaEncrypted=function(e,t){l.logger.log('Media is encrypted using "'+e+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=e,this._mediaEncryptionInitData=t,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},t.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return l.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});l.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},t.prototype._generateRequestWithPreferredKeySession=function(){var e=this,t=this._mediaKeysList[0];if(!t)return l.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(t.mediaKeysSessionInitialized)l.logger.warn("Key-Session already initialized but requested again");else{var r=t.mediaKeysSession;r||(l.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0}));var i=this._mediaEncryptionInitDataType,a=this._mediaEncryptionInitData;l.logger.log('Generating key-session request for "'+i+'" init data type'),t.mediaKeysSessionInitialized=!0,r.generateRequest(i,a).then(function(){l.logger.debug("Key-session generation succeeded")}).catch(function(t){l.logger.error("Error generating key-session request:",t),e.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},t.prototype._createLicenseXhr=function(e,t,r){var i=new u,a=this._licenseXhrSetup;try{if(a)try{a(i,e)}catch(n){i.open("POST",e,!0),a(i,e)}i.readyState||i.open("POST",e,!0)}catch(n){return l.logger.error("Error setting up key-system license XHR",n),void this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,e,t,r),i},t.prototype._onLicenseRequestReadyStageChange=function(e,t,r,i){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,l.logger.log("License request succeeded"),i(e.response);else{if(l.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount<=3){var a=3-this._requestLicenseFailureCount+1;return l.logger.warn("Retrying license request, "+a+" attempts left"),void this._requestLicense(r,i)}this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},t.prototype._generateLicenseRequestChallenge=function(e,t){var r;return e.mediaKeySystemDomain===c?l.logger.error("PlayReady is not supported (yet)"):e.mediaKeySystemDomain===d?r=t:l.logger.error("Unsupported key-system:",e.mediaKeySystemDomain),r},t.prototype._requestLicense=function(e,t){l.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return l.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(s.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});var i=this.getLicenseServerUrl(r.mediaKeySystemDomain),a=this._createLicenseXhr(i,e,t);l.logger.log("Sending license request to URL: "+i),a.send(this._generateLicenseRequestChallenge(r,e))},t.prototype.onMediaAttached=function(e){var t=this;if(this._emeEnabled){var r=e.media;this._media=r,r.addEventListener("encrypted",function(e){t._onMediaEncrypted(e.initDataType,e.initData)})}},t.prototype.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map(function(e){return e.audioCodec}),r=e.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess(d,t,r)}},t}(n.default);t.default=f},"./src/controller/fps-controller.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/event-handler.js"),o=r("./src/utils/logger.js"),l=window.performance,u=function(e){function t(t){return e.call(this,t,n.default.MEDIA_ATTACHING)||this}return a(t,e),t.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},t.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},t.prototype.checkFPS=function(e,t,r){var i=l.now();if(t){if(this.lastTime){var a=i-this.lastTime,s=r-this.lastDroppedFrames,u=t-this.lastDecodedFrames,d=1e3*s/a,c=this.hls;if(c.trigger(n.default.FPS_DROP,{currentDropped:s,currentDecoded:u,totalDroppedFrames:r}),d>0&&s>c.config.fpsDroppedMonitoringThreshold*u){var f=c.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=f)&&(f-=1,c.trigger(n.default.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:c.currentLevel}),c.autoLevelCapping=f,c.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},t.prototype.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},t}(s.default);t.default=u},"./src/controller/fragment-finders.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/binary-search.js");function a(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=e?1:r.start-i>e&&r.start?-1:0}function n(e,t,r){var i=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.endProgramDateTime-i>e}t.findFragmentByPDT=function(t,r,i){if(!Array.isArray(t)||!t.length||!e.isFinite(r))return null;if(r<t[0].programDateTime)return null;if(r>=t[t.length-1].endProgramDateTime)return null;i=i||0;for(var a=0;a<t.length;++a){var s=t[a];if(n(r,i,s))return s}return null},t.findFragmentByPTS=function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var s=e?t[e.sn-t[0].sn+1]:null;return s&&!a(r,n,s)?s:i.default.search(t,a.bind(null,r,n))},t.fragmentWithinToleranceTest=a,t.pdtWithinToleranceTest=n}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/fragment-tracker.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/event-handler.js"),s=r("./src/events.js");t.FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var o=function(r){function i(e){var t=r.call(this,e,s.default.BUFFER_APPENDED,s.default.FRAG_BUFFERED,s.default.FRAG_LOADED)||this;return t.bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=e.config,t}return a(i,r),i.prototype.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,n.default.prototype.destroy.call(this),r.prototype.destroy.call(this)},i.prototype.getBufferedFrag=function(e,t){var r=this.fragments,i=Object.keys(r).filter(function(i){var a=r[i];if(a.body.type!==t)return!1;if(!a.buffered)return!1;var n=a.body;return n.startPTS<=e&&e<=n.endPTS});if(0===i.length)return null;var a=i.pop();return r[a].body},i.prototype.detectEvictedFragments=function(e,t){var r,i,a=this;Object.keys(this.fragments).forEach(function(n){var s=a.fragments[n];if(!0===s.buffered){var o=s.range[e];if(o){r=o.time;for(var l=0;l<r.length;l++)if(i=r[l],!1===a.isTimeBuffered(i.startPTS,i.endPTS,t)){a.removeFragment(s.body);break}}}})},i.prototype.detectPartialFragments=function(e){var t=this,r=this.getFragmentKey(e),i=this.fragments[r];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach(function(r){if(e.hasElementaryStream(r)){var a=t.timeRanges[r];i.range[r]=t.getBufferedTimes(e.startPTS,e.endPTS,a)}}))},i.prototype.getBufferedTimes=function(e,t,r){for(var i,a,n=[],s=!1,o=0;o<r.length;o++){if(i=r.start(o)-this.bufferPadding,a=r.end(o)+this.bufferPadding,e>=i&&t<=a){n.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))});break}if(e<a&&t>i)n.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))}),s=!0;else if(t<=i)break}return{time:n,partial:s}},i.prototype.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},i.prototype.getPartialFragment=function(e){var t,r,i,a=this,n=null,s=0;return Object.keys(this.fragments).forEach(function(o){var l=a.fragments[o];a.isPartial(l)&&(r=l.body.startPTS-a.bufferPadding,i=l.body.endPTS+a.bufferPadding,e>=r&&e<=i&&(t=Math.min(e-r,i-e),s<=t&&(n=l.body,s=t)))}),n},i.prototype.getState=function(e){var r=this.getFragmentKey(e),i=this.fragments[r],a=t.FragmentState.NOT_LOADED;return void 0!==i&&(a=i.buffered?!0===this.isPartial(i)?t.FragmentState.PARTIAL:t.FragmentState.OK:t.FragmentState.APPENDING),a},i.prototype.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},i.prototype.isTimeBuffered=function(e,t,r){for(var i,a,n=0;n<r.length;n++){if(i=r.start(n)-this.bufferPadding,a=r.end(n)+this.bufferPadding,e>=i&&t<=a)return!0;if(t<=i)return!1}return!1},i.prototype.onFragLoaded=function(t){var r=t.frag;e.isFinite(r.sn)&&!r.bitrateTest&&(this.fragments[this.getFragmentKey(r)]={body:r,range:Object.create(null),buffered:!1})},i.prototype.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var r=t.timeRanges[e];t.detectEvictedFragments(e,r)})},i.prototype.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},i.prototype.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},i.prototype.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},i.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},i}(n.default);t.FragmentTracker=o}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/gap-controller.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/buffer-helper.js"),a=r("./src/errors.js"),n=r("./src/events.js"),s=r("./src/utils/logger.js"),o=function(){function e(e,t,r,i){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=i,this.stallReported=!1}return e.prototype.poll=function(e,t){var r=this.config,a=this.media,n=a.currentTime,o=window.performance.now();if(n!==e)return this.stallReported&&(s.logger.warn("playback not stuck anymore @"+n+", after "+Math.round(o-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,void(this.nudgeRetry=0);if(!(a.ended||!a.buffered.length||a.readyState>2||a.seeking&&i.BufferHelper.isBuffered(a,n))){var l=o-this.stalled,u=i.BufferHelper.bufferInfo(a,n,r.maxBufferHole);this.stalled?(l>=1e3&&this._reportStall(u.len),this._tryFixBufferStall(u,l)):this.stalled=o}},e.prototype._tryFixBufferStall=function(e,t){var r=this.config,i=this.fragmentTracker,a=this.media.currentTime,n=i.getPartialFragment(a);n&&this._trySkipBufferHole(n),e.len>.5&&t>1e3*r.highBufferWatchdogPeriod&&(this.stalled=null,this._tryNudgeBuffer())},e.prototype._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,s.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer"),t.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},e.prototype._trySkipBufferHole=function(e){for(var t=this.hls,r=this.media,i=r.currentTime,o=0,l=0;l<r.buffered.length;l++){var u=r.buffered.start(l);if(i>=o&&i<u)return r.currentTime=Math.max(u,r.currentTime+.1),s.logger.warn("skipping hole, adjusting currentTime from "+i+" to "+r.currentTime),this.stalled=null,void t.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+r.currentTime,frag:e});o=r.buffered.end(l)}},e.prototype._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,i=r.currentTime,o=(this.nudgeRetry||0)+1;if(this.nudgeRetry=o,o<e.nudgeMaxRetry){var l=i+o*e.nudgeOffset;s.logger.log("adjust currentTime from "+i+" to "+l),r.currentTime=l,t.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else s.logger.error("still stuck in high buffer @"+i+" after "+e.nudgeMaxRetry+", raise fatal error"),t.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}();t.default=o},"./src/controller/id3-track-controller.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/event-handler.js"),o=r("./src/demux/id3.js"),l=r("./src/utils/texttrack-utils.js"),u=function(e){function t(t){var r=e.call(this,t,n.default.MEDIA_ATTACHED,n.default.MEDIA_DETACHING,n.default.FRAG_PARSING_METADATA)||this;return r.id3Track=void 0,r.media=void 0,r}return a(t,e),t.prototype.destroy=function(){s.default.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(e){this.media=e.media,this.media},t.prototype.onMediaDetaching=function(){l.clearCurrentCues(this.id3Track),this.id3Track=void 0,this.media=void 0},t.prototype.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return l.sendAddTrackEvent(r,this.media),r}return this.media.addTextTrack("metadata","id3")},t.prototype.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,a=0;a<r.length;a++){var n=o.default.getID3Frames(r[a].data);if(n){var s=r[a].pts,l=a<r.length-1?r[a+1].pts:t.endPTS;s===l&&(l+=1e-4);for(var u=0;u<n.length;u++){var d=n[u];if(!o.default.isTimeStampFrame(d)){var c=new i(s,l,"");c.value=d,this.id3Track.addCue(c)}}}}},t}(s.default);t.default=u},"./src/controller/level-controller.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n,s=r("./src/events.js"),o=r("./src/event-handler.js"),l=r("./src/utils/logger.js"),u=r("./src/errors.js"),d=r("./src/utils/codecs.js"),c=r("./src/controller/level-helper.js"),f=(window.performance,function(e){function t(t){var r=e.call(this,t,s.default.MANIFEST_LOADED,s.default.LEVEL_LOADED,s.default.AUDIO_TRACK_SWITCHED,s.default.FRAG_LOADED,s.default.ERROR)||this;return r.canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,n=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}return a(t,e),t.prototype.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},t.prototype.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},t.prototype.stopLoad=function(){this.canload=!1},t.prototype.onManifestLoaded=function(e){var t,r=[],i=[],a={},o=null,f=!1,h=!1;if(e.levels.forEach(function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,f=f||!!e.videoCodec,h=h||!!e.audioCodec,n&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(o=a[e.bitrate])?o.url.push(e.url):(e.url=[e.url],e.urlId=0,a[e.bitrate]=e,r.push(e)),t&&(t.AUDIO&&(h=!0,c.addGroupId(o||e,"audio",t.AUDIO)),t.SUBTITLES&&c.addGroupId(o||e,"text",t.SUBTITLES))}),f&&h&&(r=r.filter(function(e){return!!e.videoCodec})),r=r.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||d.isCodecSupportedInMp4(t,"audio"))&&(!r||d.isCodecSupportedInMp4(r,"video"))}),e.audioTracks&&(i=e.audioTracks.filter(function(e){return!e.audioCodec||d.isCodecSupportedInMp4(e.audioCodec,"audio")})).forEach(function(e,t){e.id=t}),r.length>0){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var p=0;p<r.length;p++)if(r[p].bitrate===t){this._firstLevel=p,l.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(s.default.MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:e.stats,audio:h,video:f,altAudio:i.some(function(e){return!!e.url})})}else this.hls.trigger(s.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},Object.defineProperty(t.prototype,"levels",{get:function(){return this._levels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))},enumerable:!0,configurable:!0}),t.prototype.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){l.logger.log("switching to level "+e),this.currentLevelIndex=e;var i=t[e];i.level=e,r.trigger(s.default.LEVEL_SWITCHING,i)}var a=t[e],n=a.details;if(!n||n.live){var o=a.urlId;r.trigger(s.default.LEVEL_LOADING,{url:a.url[o],level:e,id:o})}}else r.trigger(s.default.ERROR,{type:u.ErrorTypes.OTHER_ERROR,details:u.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},Object.defineProperty(t.prototype,"manualLevel",{get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstLevel",{get:function(){return this._firstLevel},set:function(e){this._firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startLevel",{get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e},enumerable:!0,configurable:!0}),t.prototype.onError=function(e){if(e.fatal)e.type===u.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,i=!1;switch(e.details){case u.ErrorDetails.FRAG_LOAD_ERROR:case u.ErrorDetails.FRAG_LOAD_TIMEOUT:case u.ErrorDetails.KEY_LOAD_ERROR:case u.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,i=!0;break;case u.ErrorDetails.LEVEL_LOAD_ERROR:case u.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case u.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,r=!0}void 0!==t&&this.recoverLevel(e,t,r,i)}},t.prototype.recoverLevel=function(e,t,r,i){var a,n,s,o=this,u=this.hls.config,d=e.details,c=this._levels[t];if(c.loadError++,c.fragmentError=i,r){if(!(this.levelRetryCount+1<=u.levelLoadingMaxRetry))return l.logger.error("level controller, cannot recover from "+d+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);n=Math.min(Math.pow(2,this.levelRetryCount)*u.levelLoadingRetryDelay,u.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return o.loadLevel()},n),e.levelRetry=!0,this.levelRetryCount++,l.logger.warn("level controller, "+d+", retry in "+n+" ms, current retry count is "+this.levelRetryCount)}(r||i)&&((a=c.url.length)>1&&c.loadError<a?(c.urlId=(c.urlId+1)%a,c.details=void 0,l.logger.warn("level controller, "+d+" for level "+t+": switching to redundant URL-id "+c.urlId)):-1===this.manualLevelIndex?(s=0===t?this._levels.length-1:t-1,l.logger.warn("level controller, "+d+": switch to "+s),this.hls.nextAutoLevel=this.currentLevelIndex=s):i&&(l.logger.warn("level controller, "+d+": reload a fragment"),this.currentLevelIndex=null))},t.prototype.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var r=this._levels[t.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},t.prototype.onLevelLoaded=function(e){var t=this,r=e.level,i=e.details;if(r===this.currentLevelIndex){var a=this._levels[r];if(a.fragmentError||(a.loadError=0,this.levelRetryCount=0),i.live){var n=c.computeReloadInterval(a.details,i,e.stats.trequest);l.logger.log("live playlist, reload in "+Math.round(n)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},n)}else this.clearTimer()}},t.prototype.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var i=-1,a=0;a<r.audioGroupIds.length;a++)if(r.audioGroupIds[a]===t){i=a;break}i!==r.urlId&&(r.urlId=i,this.startLoad())}},t.prototype.loadLevel=function(){if(l.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,r=e.urlId,i=e.url[r];l.logger.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(s.default.LEVEL_LOADING,{url:i,level:t,id:r})}}},Object.defineProperty(t.prototype,"nextLoadLevel",{get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)},enumerable:!0,configurable:!0}),t}(o.default));t.default=f},"./src/controller/level-helper.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/logger.js");function a(t,r,a){var n=t[r],s=t[a],o=s.startPTS;e.isFinite(o)?a>r?(n.duration=o-n.start,n.duration<0&&i.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(s.duration=n.start-o,s.duration<0&&i.logger.warn("negative duration computed for frag "+s.sn+",level "+s.level+", there should be some duration drift between playlist and fragment!")):s.start=a>r?n.start+n.duration:Math.max(n.start-s.duration,0)}function n(t,r,i,n,s,o){var l=i;if(e.isFinite(r.startPTS)){var u=Math.abs(r.startPTS-i);e.isFinite(r.deltaPTS)?r.deltaPTS=Math.max(u,r.deltaPTS):r.deltaPTS=u,l=Math.max(i,r.startPTS),i=Math.min(i,r.startPTS),n=Math.max(n,r.endPTS),s=Math.min(s,r.startDTS),o=Math.max(o,r.endDTS)}var d=i-r.start;r.start=r.startPTS=i,r.maxStartPTS=l,r.endPTS=n,r.startDTS=s,r.endDTS=o,r.duration=n-i;var c,f,h,p=r.sn;if(!t||p<t.startSN||p>t.endSN)return 0;for(c=p-t.startSN,(f=t.fragments)[c]=r,h=c;h>0;h--)a(f,h,h-1);for(h=c;h<f.length-1;h++)a(f,h,h+1);return t.PTSKnown=!0,d}function s(e,t,r){if(e&&t)for(var i=Math.max(e.startSN,t.startSN)-t.startSN,a=Math.min(e.endSN,t.endSN)-t.startSN,n=t.startSN-e.startSN,s=i;s<=a;s++){var o=e.fragments[n+s],l=t.fragments[s];if(!o||!l)break;r(o,l,s)}}function o(e,t){var r=t.startSN-e.startSN,i=e.fragments,a=t.fragments;if(!(r<0||r>i.length))for(var n=0;n<a.length;n++)a[n].start+=i[r].start}t.addGroupId=function(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}},t.updatePTS=a,t.updateFragPTSDTS=n,t.mergeDetails=function(t,r){r.initSegment&&t.initSegment&&(r.initSegment=t.initSegment);var a,l=0;if(s(t,r,function(t,i){l=t.cc-i.cc,e.isFinite(t.startPTS)&&(i.start=i.startPTS=t.startPTS,i.endPTS=t.endPTS,i.duration=t.duration,i.backtracked=t.backtracked,i.dropped=t.dropped,a=i),r.PTSKnown=!0}),r.PTSKnown){if(l){i.logger.log("discontinuity sliding from playlist, take drift into account");for(var u=r.fragments,d=0;d<u.length;d++)u[d].cc+=l}a?n(r,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):o(t,r),r.PTSKnown=t.PTSKnown}},t.mergeSubtitlePlaylists=function(e,t,r){void 0===r&&(r=0);var i=-1;s(e,t,function(e,t,r){t.start=e.start,i=r});var a=t.fragments;if(i<0)a.forEach(function(e){e.start+=r});else for(var n=i+1;n<a.length;n++)a[n].start=a[n-1].start+a[n-1].duration},t.mapFragmentIntersection=s,t.adjustSliding=o,t.computeReloadInterval=function(e,t,r){var i=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),a=i/2;return e&&t.endSN===e.endSN&&(i=a),r&&(i=Math.max(a,i-(window.performance.now()-r))),Math.round(i)}}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/stream-controller.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/utils/binary-search.js"),s=r("./src/utils/buffer-helper.js"),o=r("./src/demux/demuxer.js"),l=r("./src/events.js"),u=r("./src/controller/fragment-tracker.js"),d=r("./src/loader/fragment.js"),c=r("./src/loader/playlist-loader.js"),f=r("./src/controller/level-helper.js"),h=r("./src/utils/time-ranges.js"),p=r("./src/errors.js"),g=r("./src/utils/logger.js"),v=r("./src/utils/discontinuities.js"),m=r("./src/controller/fragment-finders.js"),y=r("./src/controller/gap-controller.js"),E=r("./src/controller/base-stream-controller.js"),_=function(t){function r(e,r){var i=t.call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.MANIFEST_LOADING,l.default.MANIFEST_PARSED,l.default.LEVEL_LOADED,l.default.KEY_LOADED,l.default.FRAG_LOADED,l.default.FRAG_LOAD_EMERGENCY_ABORTED,l.default.FRAG_PARSING_INIT_SEGMENT,l.default.FRAG_PARSING_DATA,l.default.FRAG_PARSED,l.default.ERROR,l.default.AUDIO_TRACK_SWITCHING,l.default.AUDIO_TRACK_SWITCHED,l.default.BUFFER_CREATED,l.default.BUFFER_APPENDED,l.default.BUFFER_FLUSHED)||this;return i.fragmentTracker=r,i.config=e.config,i.audioCodecSwap=!1,i._state=E.State.STOPPED,i.stallReported=!1,i.gapController=null,i}return a(r,t),r.prototype.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=r.startLevel;-1===i&&(i=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=i,this.loadedmetadata=!1}t>0&&-1===e&&(g.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=E.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=E.State.STOPPED},r.prototype.stopLoad=function(){this.forceStartLoad=!1,t.prototype.stopLoad.call(this)},r.prototype.doTick=function(){switch(this.state){case E.State.BUFFER_FLUSHING:this.fragLoadError=0;break;case E.State.IDLE:this._doTickIdle();break;case E.State.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=E.State.IDLE);break;case E.State.FRAG_LOADING_WAITING_RETRY:var t=window.performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(g.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=E.State.IDLE);break;case E.State.ERROR:case E.State.STOPPED:case E.State.FRAG_LOADING:case E.State.PARSING:case E.State.PARSED:case E.State.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},r.prototype._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&t.startFragPrefetch)){var i;i=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var a=e.nextLoadLevel,n=this.levels[a];if(n){var o,u=n.bitrate;o=u?Math.max(8*t.maxBufferSize/u,t.maxBufferLength):t.maxBufferLength,o=Math.min(o,t.maxMaxBufferLength);var d=s.BufferHelper.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,i,t.maxBufferHole),c=d.len;if(!(c>=o)){g.logger.trace("buffer length of "+c.toFixed(3)+" is below max of "+o.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=a;var f=n.details;if(!f||f.live&&this.levelLastLoaded!==a)this.state=E.State.WAITING_LEVEL;else{if(this._streamEnded(d,f)){var h={};return this.altAudio&&(h.type="video"),this.hls.trigger(l.default.BUFFER_EOS,h),void(this.state=E.State.ENDED)}this._fetchPayloadOrEos(i,d,f)}}}}},r.prototype._fetchPayloadOrEos=function(e,t,r){var i=this.fragPrevious,a=this.level,n=r.fragments,s=n.length;if(0!==s){var o,l=n[0].start,u=n[s-1].start+n[s-1].duration,d=t.end;if(r.initSegment&&!r.initSegment.data)o=r.initSegment;else if(r.live){var c=this.config.initialLiveManifestSize;if(s<c)return void g.logger.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+c);if(null===(o=this._ensureFragmentAtLivePoint(r,d,l,u,i,n,s)))return}else d<l&&(o=n[0]);o||(o=this._findFragment(l,i,s,n,d,u,r)),o&&(o.encrypted?(g.logger.log("Loading key for "+o.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+a),this._loadKey(o)):(g.logger.log("Loading "+o.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+a+", currentTime:"+e.toFixed(3)+",bufferEnd:"+d.toFixed(3)),this._loadFragment(o)))}},r.prototype._ensureFragmentAtLivePoint=function(e,t,r,i,a,s,o){var l,u=this.hls.config,d=this.media,c=void 0!==u.liveMaxLatencyDuration?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(r-u.maxFragLookUpTolerance,i-c)){var f=this.liveSyncPosition=this.computeLivePosition(r,e);g.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),t=f,d&&d.readyState&&d.duration>f&&(d.currentTime=f),this.nextLoadPosition=f}if(e.PTSKnown&&t>i&&d&&d.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(a)if(e.hasProgramDateTime)g.logger.log("live playlist, switching playlist, load frag with same PDT: "+a.programDateTime),l=m.findFragmentByPDT(s,a.endProgramDateTime,u.maxFragLookUpTolerance);else{var h=a.sn+1;if(h>=e.startSN&&h<=e.endSN){var p=s[h-e.startSN];a.cc===p.cc&&(l=p,g.logger.log("live playlist, switching playlist, load frag with next SN: "+l.sn))}l||(l=n.default.search(s,function(e){return a.cc-e.cc}))&&g.logger.log("live playlist, switching playlist, load frag with same CC: "+l.sn)}l||(l=s[Math.min(o-1,Math.round(o/2))],g.logger.log("live playlist, switching playlist, unknown, load middle frag : "+l.sn))}return l},r.prototype._findFragment=function(e,t,r,i,a,n,s){var o,l=this.hls.config;if(a<n){var u=a>n-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance;o=m.findFragmentByPTS(t,i,a,u)}else o=i[r-1];if(o){var d=o.sn-s.startSN,c=t&&o.level===t.level,f=i[d-1],h=i[d+1];if(t&&o.sn===t.sn)if(c&&!o.backtracked)if(o.sn<s.endSN){var p=t.deltaPTS;p&&p>l.maxBufferHole&&t.dropped&&d?(o=f,g.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(o=h,g.logger.log("SN just loaded, load next one: "+o.sn,o))}else o=null;else o.backtracked&&(h&&h.backtracked?(g.logger.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+h.sn),o=h):(g.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,f?(o=f).backtracked=!0:d&&(o=null)))}return o},r.prototype._loadKey=function(e){this.state=E.State.KEY_LOADING,this.hls.trigger(l.default.KEY_LOADING,{frag:e})},r.prototype._loadFragment=function(t){var r=this.fragmentTracker.getState(t);this.fragCurrent=t,this.startFragRequested=!0,e.isFinite(t.sn)&&!t.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),t.backtracked||r===u.FragmentState.NOT_LOADED||r===u.FragmentState.PARTIAL?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,this.hls.trigger(l.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new o.default(this.hls,"main")),this.state=E.State.FRAG_LOADING):r===u.FragmentState.APPENDING&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)},Object.defineProperty(r.prototype,"state",{get:function(){return this._state},set:function(e){if(this.state!==e){var t=this.state;this._state=e,g.logger.log("main stream:"+t+"->"+e),this.hls.trigger(l.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},enumerable:!0,configurable:!0}),r.prototype.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,c.default.LevelType.MAIN)},Object.defineProperty(r.prototype,"currentLevel",{get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"nextBufferedFrag",{get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null},enumerable:!0,configurable:!0}),r.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},Object.defineProperty(r.prototype,"nextLevel",{get:function(){var e=this.nextBufferedFrag;return e?e.level:-1},enumerable:!0,configurable:!0}),r.prototype._checkFragmentChanged=function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),s.BufferHelper.isBuffered(r,t)?e=this.getBufferedFrag(t):s.BufferHelper.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var i=e;if(i!==this.fragPlaying){this.hls.trigger(l.default.FRAG_CHANGED,{frag:i});var a=i.level;this.fragPlaying&&this.fragPlaying.level===a||this.hls.trigger(l.default.LEVEL_SWITCHED,{level:a}),this.fragPlaying=i}}},r.prototype.immediateLevelSwitch=function(){if(g.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t=this.media,r=void 0;t?(r=t.paused,t.pause()):r=!0,this.previouslyPaused=r}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,e.POSITIVE_INFINITY)},r.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,s.BufferHelper.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},r.prototype.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var r,i=void 0,a=void 0;if((r=this.getBufferedFrag(t.currentTime))&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),t.paused)i=0;else{var n=this.hls.nextLoadLevel,s=this.levels[n],o=this.fragLastKbps;i=o&&this.fragCurrent?this.fragCurrent.duration*s.bitrate/(1e3*o)+1:0}if((a=this.getBufferedFrag(t.currentTime+i))&&(a=this.followingBufferedFrag(a))){var l=this.fragCurrent;l&&l.loader&&l.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(a.maxStartPTS,e.POSITIVE_INFINITY)}}},r.prototype.flushMainBuffer=function(e,t){this.state=E.State.BUFFER_FLUSHING;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(l.default.BUFFER_FLUSHING,r)},r.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new y.default(r,t,this.fragmentTracker,this.hls)},r.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(g.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},r.prototype.onMediaSeeked=function(){var t=this.media,r=t?t.currentTime:void 0;e.isFinite(r)&&g.logger.log("media seeked to "+r.toFixed(3)),this.tick()},r.prototype.onManifestLoading=function(){g.logger.log("trigger BUFFER_RESET"),this.hls.trigger(l.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},r.prototype.onManifestParsed=function(e){var t,r=!1,i=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(i=!0))}),this.audioCodecSwitch=r&&i,this.audioCodecSwitch&&g.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;var a=this.config;(a.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(a.startPosition)},r.prototype.onLevelLoaded=function(t){var r=t.details,i=t.level,a=this.levels[this.levelLastLoaded],n=this.levels[i],s=r.totalduration,o=0;if(g.logger.log("level "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+s),r.live){var u=n.details;u&&r.fragments.length>0?(f.mergeDetails(u,r),o=r.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(o,u),r.PTSKnown&&e.isFinite(o)?g.logger.log("live playlist sliding:"+o.toFixed(3)):(g.logger.log("live playlist - outdated PTS, unknown sliding"),v.alignStream(this.fragPrevious,a,r))):(g.logger.log("live playlist - first load, unknown sliding"),r.PTSKnown=!1,v.alignStream(this.fragPrevious,a,r))}else r.PTSKnown=!1;if(n.details=r,this.levelLastLoaded=i,this.hls.trigger(l.default.LEVEL_UPDATED,{details:r,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var d=r.startTimeOffset;e.isFinite(d)?(d<0&&(g.logger.log("negative start time offset "+d+", count from end of last fragment"),d=o+s+d),g.logger.log("start time offset found in playlist, adjust startPosition to "+d),this.startPosition=d):r.live?(this.startPosition=this.computeLivePosition(o,r),g.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===E.State.WAITING_LEVEL&&(this.state=E.State.IDLE),this.tick()},r.prototype.onKeyLoaded=function(){this.state===E.State.KEY_LOADING&&(this.state=E.State.IDLE,this.tick())},r.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=this.hls,i=this.levels,a=this.media,n=e.frag;if(this.state===E.State.FRAG_LOADING&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var s=e.stats,u=i[t.level],d=u.details;if(this.bitrateTest=!1,this.stats=s,g.logger.log("Loaded "+t.sn+" of ["+d.startSN+" ,"+d.endSN+"],level "+t.level),n.bitrateTest&&r.nextLoadLevel)this.state=E.State.IDLE,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),r.trigger(l.default.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===n.sn)this.state=E.State.IDLE,s.tparsed=s.tbuffered=window.performance.now(),d.initSegment.data=e.payload,r.trigger(l.default.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{g.logger.log("Parsing "+t.sn+" of ["+d.startSN+" ,"+d.endSN+"],level "+t.level+", cc "+t.cc),this.state=E.State.PARSING,this.pendingBuffering=!0,this.appended=!1,n.bitrateTest&&(n.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:n}));var c=!(a&&a.seeking)&&(d.PTSKnown||!d.live),f=d.initSegment?d.initSegment.data:[],h=this._getAudioCodec(u);(this.demuxer=this.demuxer||new o.default(this.hls,"main")).push(e.payload,f,h,u.videoCodec,t,d.totalduration,c)}}this.fragLoadError=0},r.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===E.State.PARSING){var i=e.tracks,a=void 0,n=void 0;if(i.audio&&this.altAudio&&delete i.audio,n=i.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(g.logger.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==n.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==n.container&&(s="mp4a.40.2",g.logger.log("Android: force audio codec to "+s)),n.levelCodec=s,n.id=e.id}for(a in(n=i.video)&&(n.levelCodec=this.levels[this.level].videoCodec,n.id=e.id),this.hls.trigger(l.default.BUFFER_CODECS,i),i){n=i[a],g.logger.log("main track:"+a+",container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var u=n.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.default.BUFFER_APPENDING,{type:a,data:u,parent:"main",content:"initSegment"}))}this.tick()}},r.prototype.onFragParsingData=function(t){var r=this,i=this.fragCurrent,a=t.frag;if(i&&"main"===t.id&&a.sn===i.sn&&a.level===i.level&&("audio"!==t.type||!this.altAudio)&&this.state===E.State.PARSING){var n=this.levels[this.level],s=i;if(e.isFinite(t.endPTS)||(t.endPTS=t.startPTS+i.duration,t.endDTS=t.startDTS+i.duration),!0===t.hasAudio&&s.addElementaryStream(d.default.ElementaryStreamTypes.AUDIO),!0===t.hasVideo&&s.addElementaryStream(d.default.ElementaryStreamTypes.VIDEO),g.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(s.dropped=t.dropped,s.dropped)if(s.backtracked)g.logger.warn("Already backtracked on this fragment, appending with the gap",s.sn);else{var o=n.details;if(!o||s.sn!==o.startSN)return g.logger.warn("missing video frame(s), backtracking fragment",s.sn),this.fragmentTracker.removeFragment(s),s.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=E.State.IDLE,this.fragPrevious=s,void this.tick();g.logger.warn("missing video frame(s) on first frag, appending with gap",s.sn)}else s.backtracked=!1;var u=f.updateFragPTSDTS(n.details,s,t.startPTS,t.endPTS,t.startDTS,t.endDTS),c=this.hls;c.trigger(l.default.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:u,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(e){e&&e.length&&r.state===E.State.PARSING&&(r.appended=!0,r.pendingBuffering=!0,c.trigger(l.default.BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"}))}),this.tick()}},r.prototype.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===E.State.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=E.State.PARSED,this._checkAppendedParsed())},r.prototype.onAudioTrackSwitching=function(t){var r=!!t.url,i=t.id;if(!r){if(this.mediaBuffer!==this.media){g.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var a=this.fragCurrent;a.loader&&(g.logger.log("switching to main audio track, cancel main fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=E.State.IDLE}var n=this.hls;n.trigger(l.default.BUFFER_FLUSHING,{startOffset:0,endOffset:e.POSITIVE_INFINITY,type:"audio"}),n.trigger(l.default.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},r.prototype.onAudioTrackSwitched=function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(g.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r,this.tick()},r.prototype.onBufferCreated=function(e){var t,r,i=e.tracks,a=!1;for(var n in i){var s=i[n];"main"===s.id?(r=n,t=s,"video"===n&&(this.videoBuffer=i[n].buffer)):a=!0}a&&t?(g.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},r.prototype.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==E.State.PARSING&&t!==E.State.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},r.prototype._checkAppendedParsed=function(){if(!(this.state!==E.State.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;g.logger.log("main buffered : "+h.default.toString(t.buffered)),this.fragPrevious=e;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(l.default.FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=E.State.IDLE}this.tick()}},r.prototype.onError=function(t){var r=t.frag||this.fragCurrent;if(!r||"main"===r.type){var i=!!this.media&&s.BufferHelper.isBuffered(this.media,this.media.currentTime)&&s.BufferHelper.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case p.ErrorDetails.FRAG_LOAD_ERROR:case p.ErrorDetails.FRAG_LOAD_TIMEOUT:case p.ErrorDetails.KEY_LOAD_ERROR:case p.ErrorDetails.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var a=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);g.logger.warn("mediaController: frag loading failed, retry in "+a+" ms"),this.retryDate=window.performance.now()+a,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=E.State.FRAG_LOADING_WAITING_RETRY}else g.logger.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=E.State.ERROR;break;case p.ErrorDetails.LEVEL_LOAD_ERROR:case p.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==E.State.ERROR&&(t.fatal?(this.state=E.State.ERROR,g.logger.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==E.State.WAITING_LEVEL||(this.state=E.State.IDLE));break;case p.ErrorDetails.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==E.State.PARSING&&this.state!==E.State.PARSED||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=E.State.IDLE):(g.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,e.POSITIVE_INFINITY)))}}},r.prototype._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,g.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},r.prototype._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},r.prototype.onFragLoadEmergencyAborted=function(){this.state=E.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},r.prototype.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(d.default.ElementaryStreamTypes.VIDEO,e.buffered),this.state=E.State.IDLE,this.fragPrevious=null},r.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},r.prototype.computeLivePosition=function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},r.prototype._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=e.seeking?t:this.startPosition;t!==r&&(g.logger.log("target start position not buffered, seek to buffered.start(0) "+r+" from current time "+t+" "),e.currentTime=r)},r.prototype._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(g.logger.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},Object.defineProperty(r.prototype,"liveSyncPosition",{get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e},enumerable:!0,configurable:!0}),r}(E.default);t.default=_}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/subtitle-stream-controller.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/utils/logger.js"),o=r("./src/crypt/decrypter.js"),l=r("./src/utils/buffer-helper.js"),u=r("./src/controller/fragment-finders.js"),d=r("./src/controller/fragment-tracker.js"),c=r("./src/controller/base-stream-controller.js"),f=r("./src/controller/level-helper.js"),h=window.performance,p=function(e){function t(t,r){var i=e.call(this,t,n.default.MEDIA_ATTACHED,n.default.MEDIA_DETACHING,n.default.ERROR,n.default.KEY_LOADED,n.default.FRAG_LOADED,n.default.SUBTITLE_TRACKS_UPDATED,n.default.SUBTITLE_TRACK_SWITCH,n.default.SUBTITLE_TRACK_LOADED,n.default.SUBTITLE_FRAG_PROCESSED,n.default.LEVEL_UPDATED)||this;return i.fragmentTracker=r,i.config=t.config,i.state=c.State.STOPPED,i.tracks=[],i.tracksBuffered=[],i.currentTrackId=-1,i.decrypter=new o.default(t,t.config),i.lastAVStart=0,i._onMediaSeeking=i.onMediaSeeking.bind(i),i}return a(t,e),t.prototype.onSubtitleFragProcessed=function(e){var t=e.frag,r=e.success;if(this.fragPrevious=t,this.state=c.State.IDLE,r){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var a,n=t.start,s=0;s<i.length;s++)if(n>=i[s].start&&n<=i[s].end){a=i[s];break}var o=t.start+t.duration;a?a.end=o:(a={start:n,end:o},i.push(a))}}},t.prototype.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=c.State.IDLE},t.prototype.onMediaDetaching=function(){this.media.removeEventListener("seeking",this._onMediaSeeking),this.media=null,this.state=c.State.STOPPED},t.prototype.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.state=c.State.IDLE)},t.prototype.onSubtitleTracksUpdated=function(e){var t=this;s.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]})},t.prototype.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},t.prototype.onSubtitleTrackLoaded=function(e){var t=e.id,r=e.details,i=this.currentTrackId,a=this.tracks,n=a[i];t>=a.length||t!==i||!n||(r.live&&f.mergeSubtitlePlaylists(n.details,r,this.lastAVStart),n.details=r,this.setInterval(500))},t.prototype.onKeyLoaded=function(){this.state===c.State.KEY_LOADING&&(this.state=c.State.IDLE)},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag.decryptdata,i=e.frag,a=this.hls;if(this.state===c.State.FRAG_LOADING&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&r&&r.key&&"AES-128"===r.method){var s=h.now();this.decrypter.decrypt(e.payload,r.key.buffer,r.iv.buffer,function(e){var t=h.now();a.trigger(n.default.FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:s,tdecrypt:t}})})}},t.prototype.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},t.prototype.doTick=function(){if(this.media)switch(this.state){case c.State.IDLE:var e=this,t=e.config,r=e.currentTrackId,i=e.fragmentTracker,a=e.media,o=e.tracks;if(!o||!o[r]||!o[r].details)break;var f=t.maxBufferHole,h=t.maxFragLookUpTolerance,p=Math.min(t.maxBufferLength,t.maxMaxBufferLength),g=l.BufferHelper.bufferedInfo(this._getBuffered(),a.currentTime,f),v=g.end,m=g.len,y=o[r].details,E=y.fragments,_=E.length,T=E[_-1].start+E[_-1].duration;if(m>p)return;var S=void 0,b=this.fragPrevious;v<T?(b&&y.hasProgramDateTime&&(S=u.findFragmentByPDT(E,b.endProgramDateTime,h)),S||(S=u.findFragmentByPTS(b,E,v,h))):S=E[_-1],S&&S.encrypted?(s.logger.log("Loading key for "+S.sn),this.state=c.State.KEY_LOADING,this.hls.trigger(n.default.KEY_LOADING,{frag:S})):S&&i.getState(S)===d.FragmentState.NOT_LOADED&&(this.fragCurrent=S,this.state=c.State.FRAG_LOADING,this.hls.trigger(n.default.FRAG_LOADING,{frag:S}))}else this.state=c.State.IDLE},t.prototype.stopLoad=function(){this.lastAVStart=0,e.prototype.stopLoad.call(this)},t.prototype._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},t.prototype.onMediaSeeking=function(){this.fragPrevious=null},t}(c.default);t.SubtitleStreamController=p},"./src/controller/subtitle-track-controller.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/event-handler.js"),o=r("./src/utils/logger.js"),l=r("./src/controller/level-helper.js"),u=function(t){function r(e){var r=t.call(this,e,n.default.MEDIA_ATTACHED,n.default.MEDIA_DETACHING,n.default.MANIFEST_LOADED,n.default.SUBTITLE_TRACK_LOADED)||this;return r.tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r}return a(r,t),r.prototype.destroy=function(){s.default.prototype.destroy.call(this)},r.prototype.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},r.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=null)},r.prototype.onManifestLoaded=function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.hls.trigger(n.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach(function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},r.prototype.onSubtitleTrackLoaded=function(e){var t=this,r=e.id,i=e.details,a=this.trackId,n=this.tracks,s=n[a];if(r>=n.length||r!==a||!s||this.stopped)this._clearReloadTimer();else if(o.logger.log("subtitle track "+r+" loaded"),i.live){var u=l.computeReloadInterval(s.details,i,e.stats.trequest);o.logger.log("Reloading live subtitle playlist in "+u+"ms"),this.timer=setTimeout(function(){t._loadCurrentTrack()},u)}else this._clearReloadTimer()},r.prototype.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},r.prototype.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},Object.defineProperty(r.prototype,"subtitleTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subtitleTrack",{get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))},enumerable:!0,configurable:!0}),r.prototype._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},r.prototype._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,r=this.hls,i=t[e];e<0||!i||i.details&&!i.details.live||(o.logger.log("Loading subtitle track "+e),r.trigger(n.default.SUBTITLE_TRACK_LOADING,{url:i.url,id:e}))},r.prototype._toggleTrackModes=function(e){var t=this.media,r=this.subtitleDisplay,i=this.trackId;if(t){var a=d(t.textTracks);if(-1===e)[].slice.call(a).forEach(function(e){e.mode="disabled"});else{var n=a[i];n&&(n.mode="disabled")}var s=a[e];s&&(s.mode=r?"showing":"hidden")}},r.prototype._setSubtitleTrackInternal=function(t){var r=this.hls,i=this.tracks;!e.isFinite(t)||t<-1||t>=i.length||(this.trackId=t,o.logger.log("Switching to subtitle track "+t),r.trigger(n.default.SUBTITLE_TRACK_SWITCH,{id:t}),this._loadCurrentTrack())},r.prototype._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=d(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack=e}},r}(s.default);function d(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];"subtitles"===i.kind&&i.label&&t.push(e[r])}return t}t.default=u}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/timeline-controller.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/event-handler.js"),o=r("./src/utils/cea-608-parser.js"),l=r("./src/utils/output-filter.js"),u=r("./src/utils/webvtt-parser.js"),d=r("./src/utils/logger.js"),c=r("./src/utils/texttrack-utils.js");function f(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}var h=function(t){function r(e){var r=t.call(this,e,n.default.MEDIA_ATTACHING,n.default.MEDIA_DETACHING,n.default.FRAG_PARSING_USERDATA,n.default.FRAG_DECRYPTED,n.default.MANIFEST_LOADING,n.default.MANIFEST_LOADED,n.default.FRAG_LOADED,n.default.LEVEL_SWITCHING,n.default.INIT_PTS_FOUND)||this;if(r.hls=e,r.config=e.config,r.enabled=!0,r.Cues=e.config.cueHandler,r.textTracks=[],r.tracks=[],r.unparsedVttFrags=[],r.initPTS=[],r.cueRanges=[],r.captionsTracks={},r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode}},r.config.enableCEA708Captions){var i=new l.default(r,"textTrack1"),a=new l.default(r,"textTrack2");r.cea608Parser=new o.default(0,i,a)}return r}return a(r,t),r.prototype.addCues=function(e,t,r,i){for(var a,n,s,o,l=this.cueRanges,u=!1,d=l.length;d--;){var c=l[d],f=(a=c[0],n=c[1],s=t,o=r,Math.min(n,o)-Math.max(a,s));if(f>=0&&(c[0]=Math.min(c[0],t),c[1]=Math.max(c[1],r),u=!0,f/(r-t)>.5))return}u||l.push([t,r]),this.Cues.newCue(this.captionsTracks[e],t,r,i)},r.prototype.onInitPtsFound=function(e){var t=this;if("main"===e.id&&(this.initPTS[e.frag.cc]=e.initPTS),this.unparsedVttFrags.length){var r=this.unparsedVttFrags;this.unparsedVttFrags=[],r.forEach(function(e){t.onFragLoaded(e)})}},r.prototype.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var i=t.textTracks[r];if(i[e])return i}return null},r.prototype.createCaptionsTrack=function(e){var t=this.captionsProperties[e],r=t.label,i=t.languageCode,a=this.captionsTracks;if(!a[e]){var n=this.getExistingTrack(e);if(n)a[e]=n,c.clearCurrentCues(a[e]),c.sendAddTrackEvent(a[e],this.media);else{var s=this.createTextTrack("captions",r,i);s&&(s[e]=!0,a[e]=s)}}},r.prototype.createTextTrack=function(e,t,r){var i=this.media;if(i)return i.addTextTrack(e,t,r)},r.prototype.destroy=function(){s.default.prototype.destroy.call(this)},r.prototype.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},r.prototype.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach(function(t){c.clearCurrentCues(e[t]),delete e[t]})},r.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks()},r.prototype._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)c.clearCurrentCues(t[r])}},r.prototype.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var r=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,i){var a;if(i<r.length){for(var n=null,s=0;s<r.length;s++)if(f(r[s],e)){n=r[s];break}n&&(a=n)}a||(a=t.createTextTrack("subtitles",e.name,e.lang)),e.default?a.mode=t.hls.subtitleDisplay?"showing":"hidden":a.mode="disabled",t.textTracks.push(a)})}},r.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},r.prototype.onFragLoaded=function(t){var r=t.frag,i=t.payload;if("main"===r.type){var a=r.sn;if(a!==this.lastSn+1){var s=this.cea608Parser;s&&s.reset()}this.lastSn=a}else if("subtitle"===r.type)if(i.byteLength){if(!e.isFinite(this.initPTS[r.cc]))return this.unparsedVttFrags.push(t),void(this.initPTS.length&&this.hls.trigger(n.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r}));var o=r.decryptdata;null!=o&&null!=o.key&&"AES-128"===o.method||this._parseVTTs(r,i)}else this.hls.trigger(n.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r})},r.prototype._parseVTTs=function(e,t){var r=this.vttCCs;r[e.cc]||(r[e.cc]={start:e.start,prevCC:this.prevCC,new:!0},this.prevCC=e.cc);var i=this.textTracks,a=this.hls;u.default.parse(t,this.initPTS[e.cc],r,e.cc,function(t){var r=i[e.level];"disabled"!==r.mode?(t.forEach(function(e){if(!r.cues.getCueById(e.id))try{r.addCue(e)}catch(i){var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,r.addCue(t)}}),a.trigger(n.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})):a.trigger(n.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},function(t){d.logger.log("Failed to parse VTT cue: "+t),a.trigger(n.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})})},r.prototype.onFragDecrypted=function(t){var r=t.payload,i=t.frag;if("subtitle"===i.type){if(!e.isFinite(this.initPTS[i.cc]))return void this.unparsedVttFrags.push(t);this._parseVTTs(i,r)}},r.prototype.onFragParsingUserdata=function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var r=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,r)}},r.prototype.extractCea608Data=function(e){for(var t,r,i,a=31&e[0],n=2,s=[],o=0;o<a;o++)t=e[n++],r=127&e[n++],i=127&e[n++],0===r&&0===i||0!=(4&t)&&0===(3&t)&&(s.push(r),s.push(i));return s},r}(s.default);t.default=h}).call(this,r("./src/polyfills/number.js").Number)},"./src/crypt/aes-crypto.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}();t.default=i},"./src/crypt/aes-decryptor.js":function(e,t,r){"use strict";function i(e){var t=e.byteLength,r=t&&new DataView(e).getUint8(t-1);return r?e.slice(0,t-r):e}Object.defineProperty(t,"__esModule",{value:!0}),t.removePadding=i;var a=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),i=0;i<4;i++)r[i]=t.getUint32(4*i);return r},e.prototype.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],a=r[1],n=r[2],s=r[3],o=this.invSubMix,l=o[0],u=o[1],d=o[2],c=o[3],f=new Uint32Array(256),h=0,p=0,g=0;for(g=0;g<256;g++)f[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var v=p^p<<1^p<<2^p<<3^p<<4;v=v>>>8^255&v^99,e[h]=v,t[v]=h;var m=f[h],y=f[m],E=f[y],_=257*f[v]^16843008*v;i[h]=_<<24|_>>>8,a[h]=_<<16|_>>>16,n[h]=_<<8|_>>>24,s[h]=_,_=16843009*E^65537*y^257*m^16843008*h,l[v]=_<<24|_>>>8,u[v]=_<<16|_>>>16,d[v]=_<<8|_>>>24,c[v]=_,h?(h=m^f[f[f[E^m]]],p^=f[f[p]]):h=p=1}},e.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,i=0;i<t.length&&r;)r=t[i]===this.key[i],i++;if(!r){this.key=t;var a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);var n,s,o,l,u=this.ksRows=4*(a+6+1),d=this.keySchedule=new Uint32Array(u),c=this.invKeySchedule=new Uint32Array(u),f=this.sBox,h=this.rcon,p=this.invSubMix,g=p[0],v=p[1],m=p[2],y=p[3];for(n=0;n<u;n++)n<a?o=d[n]=t[n]:(l=o,n%a==0?(l=f[(l=l<<8|l>>>24)>>>24]<<24|f[l>>>16&255]<<16|f[l>>>8&255]<<8|f[255&l],l^=h[n/a|0]<<24):a>6&&n%a==4&&(l=f[l>>>24]<<24|f[l>>>16&255]<<16|f[l>>>8&255]<<8|f[255&l]),d[n]=o=(d[n-a]^l)>>>0);for(s=0;s<u;s++)n=u-s,l=3&s?d[n]:d[n-4],c[s]=s<4||n<=4?l:g[f[l>>>24]]^v[f[l>>>16&255]]^m[f[l>>>8&255]]^y[f[255&l]],c[s]=c[s]>>>0}},e.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},e.prototype.decrypt=function(e,t,r,a){for(var n,s,o,l,u,d,c,f,h,p,g,v,m,y,E=this.keySize+6,_=this.invKeySchedule,T=this.invSBox,S=this.invSubMix,b=S[0],A=S[1],R=S[2],D=S[3],L=this.uint8ArrayToUint32Array_(r),w=L[0],O=L[1],k=L[2],I=L[3],P=new Int32Array(e),C=new Int32Array(P.length),x=this.networkToHostOrderSwap;t<P.length;){for(h=x(P[t]),p=x(P[t+1]),g=x(P[t+2]),v=x(P[t+3]),u=h^_[0],d=v^_[1],c=g^_[2],f=p^_[3],m=4,y=1;y<E;y++)n=b[u>>>24]^A[d>>16&255]^R[c>>8&255]^D[255&f]^_[m],s=b[d>>>24]^A[c>>16&255]^R[f>>8&255]^D[255&u]^_[m+1],o=b[c>>>24]^A[f>>16&255]^R[u>>8&255]^D[255&d]^_[m+2],l=b[f>>>24]^A[u>>16&255]^R[d>>8&255]^D[255&c]^_[m+3],u=n,d=s,c=o,f=l,m+=4;n=T[u>>>24]<<24^T[d>>16&255]<<16^T[c>>8&255]<<8^T[255&f]^_[m],s=T[d>>>24]<<24^T[c>>16&255]<<16^T[f>>8&255]<<8^T[255&u]^_[m+1],o=T[c>>>24]<<24^T[f>>16&255]<<16^T[u>>8&255]<<8^T[255&d]^_[m+2],l=T[f>>>24]<<24^T[u>>16&255]<<16^T[d>>8&255]<<8^T[255&c]^_[m+3],m+=3,C[t]=x(n^w),C[t+1]=x(l^O),C[t+2]=x(o^k),C[t+3]=x(s^I),w=h,O=p,k=g,I=v,t+=4}return a?i(C.buffer):C.buffer},e.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}();t.default=a},"./src/crypt/decrypter.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/crypt/aes-crypto.js"),a=r("./src/crypt/fast-aes-key.js"),n=r("./src/crypt/aes-decryptor.js"),s=r("./src/errors.js"),o=r("./src/utils/logger.js"),l=r("./src/events.js"),u=r("./src/utils/get-self-scope.js").getSelfScope(),d=function(){function e(e,t,r){var i=(void 0===r?{}:r).removePKCS7Padding,a=void 0===i||i;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=a,a)try{var n=u.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch(s){}this.disableWebCrypto=!this.subtle}return e.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.prototype.decrypt=function(e,t,r,s){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(o.logger.log("JS AES decrypt"),this.logEnabled=!1);var u=this.decryptor;u||(this.decryptor=u=new n.default),u.expandKey(t),s(u.decrypt(e,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(o.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var d=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new a.default(d,t)),this.fastAesKey.expandKey().then(function(a){new i.default(d,r).decrypt(e,a).catch(function(i){l.onWebCryptoError(i,e,t,r,s)}).then(function(e){s(e)})}).catch(function(i){l.onWebCryptoError(i,e,t,r,s)})}},e.prototype.onWebCryptoError=function(e,t,r,i,a){this.config.enableSoftwareAES?(o.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,i,a)):(o.logger.error("decrypting error : "+e.message),this.observer.trigger(l.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},e.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.default=d},"./src/crypt/fast-aes-key.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}();t.default=i},"./src/demux/aacdemuxer.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/demux/adts.js"),a=r("./src/utils/logger.js"),n=r("./src/demux/id3.js"),s=function(){function t(e,t,r){this.observer=e,this.config=r,this.remuxer=t}return t.prototype.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(e){if(!e)return!1;for(var t=(n.default.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(i.probe(e,t))return a.logger.log("ADTS sync word found !"),!0;return!1},t.prototype.append=function(t,r,s,o){for(var l=this._audioTrack,u=n.default.getID3Data(t,0)||[],d=n.default.getTimeStamp(u),c=e.isFinite(d)?90*d:9e4*r,f=0,h=c,p=t.length,g=u.length,v=[{pts:h,dts:h,data:u}];g<p-1;)if(i.isHeader(t,g)&&g+5<p){i.initTrackConfig(l,this.observer,t,g,l.manifestCodec);var m=i.appendFrame(l,t,g,c,f);if(!m){a.logger.log("Unable to parse AAC frame");break}g+=m.length,h=m.sample.pts,f++}else n.default.isHeader(t,g)?(u=n.default.getID3Data(t,g),v.push({pts:h,dts:h,data:u}),g+=u.length):g++;this.remuxer.remux(l,{samples:[]},{samples:v,inputTimeScale:9e4},{samples:[]},r,s,o)},t.prototype.destroy=function(){},t}();t.default=s}).call(this,r("./src/polyfills/number.js").Number)},"./src/demux/adts.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),a=r("./src/errors.js"),n=r("./src/events.js");function s(e,t,r,s){var o,l,u,d,c,f=navigator.userAgent.toLowerCase(),h=s,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(o=1+((192&t[r+2])>>>6),!((l=(60&t[r+2])>>>2)>p.length-1))return d=(1&t[r+2])<<2,d|=(192&t[r+3])>>>6,i.logger.log("manifest codec:"+s+",ADTS data:type:"+o+",sampleingIndex:"+l+"["+p[l]+"Hz],channelConfig:"+d),/firefox/i.test(f)?l>=6?(o=5,c=new Array(4),u=l-3):(o=2,c=new Array(2),u=l):-1!==f.indexOf("android")?(o=2,c=new Array(2),u=l):(o=5,c=new Array(4),s&&(-1!==s.indexOf("mp4a.40.29")||-1!==s.indexOf("mp4a.40.5"))||!s&&l>=6?u=l-3:((s&&-1!==s.indexOf("mp4a.40.2")&&(l>=6&&1===d||/vivaldi/i.test(f))||!s&&1===d)&&(o=2,c=new Array(2)),u=l)),c[0]=o<<3,c[0]|=(14&l)>>1,c[1]|=(1&l)<<7,c[1]|=d<<3,5===o&&(c[1]|=(14&u)>>1,c[2]=(1&u)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:p[l],channelCount:d,codec:"mp4a.40."+o,manifestCodec:h};e.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+l})}function o(e,t){return 255===e[t]&&240==(246&e[t+1])}function l(e,t){return 1&e[t+1]?7:9}function u(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function d(e){return 9216e4/e}function c(e,t,r,i,a){var n,s,o=e.length;if(n=l(e,t),s=u(e,t),(s-=n)>0&&t+n+s<=o)return{headerLength:n,frameLength:s,stamp:r+i*a}}t.getAudioConfig=s,t.isHeaderPattern=o,t.getHeaderLength=l,t.getFullFrameLength=u,t.isHeader=function(e,t){return!!(t+1<e.length&&o(e,t))},t.probe=function(e,t){if(t+1<e.length&&o(e,t)){var r=l(e,t);t+5<e.length&&(r=u(e,t));var i=t+r;if(i===e.length||i+1<e.length&&o(e,i))return!0}return!1},t.initTrackConfig=function(e,t,r,a,n){if(!e.samplerate){var o=s(t,r,a,n);e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,i.logger.log("parsed codec:"+e.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}},t.getFrameDuration=d,t.parseFrameHeader=c,t.appendFrame=function(e,t,r,i,a){var n=c(t,r,i,a,d(e.samplerate));if(n){var s=n.stamp,o=n.headerLength,l=n.frameLength,u={unit:t.subarray(r+o,r+o+l),pts:s,dts:s};return e.samples.push(u),e.len+=l,{sample:u,length:l+o}}}},"./src/demux/demuxer-inline.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=r("./src/events.js"),n=r("./src/errors.js"),s=r("./src/crypt/decrypter.js"),o=r("./src/demux/aacdemuxer.js"),l=r("./src/demux/mp4demuxer.js"),u=r("./src/demux/tsdemuxer.js"),d=r("./src/demux/mp3demuxer.js"),c=r("./src/remux/mp4-remuxer.js"),f=r("./src/remux/passthrough-remuxer.js"),h=r("./src/utils/get-self-scope.js"),p=r("./src/utils/logger.js"),g=h.getSelfScope();try{i=g.performance.now.bind(g.performance)}catch(m){p.logger.debug("Unable to use Performance API on this environment"),i=g.Date.now}var v=function(){function e(e,t,r,i){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=i}return e.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},e.prototype.push=function(e,t,r,n,o,l,u,d,c,f,h,p){var g=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var v=this.decrypter;null==v&&(v=this.decrypter=new s.default(this.observer,this.config));var m=i();v.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var s=i();g.observer.trigger(a.default.FRAG_DECRYPTED,{stats:{tstart:m,tdecrypt:s}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,o,l,u,d,c,f,h,p)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,o,l,u,d,c,f,h,p)},e.prototype.pushDecrypted=function(e,t,r,i,s,h,p,g,v,m,y,E){var _=this.demuxer;if(!_||(p||g)&&!this.probe(e)){for(var T=this.observer,S=this.typeSupported,b=this.config,A=[{demux:u.default,remux:c.default},{demux:l.default,remux:f.default},{demux:o.default,remux:c.default},{demux:d.default,remux:c.default}],R=0,D=A.length;R<D;R++){var L=A[R],w=L.demux.probe;if(w(e)){var O=this.remuxer=new L.remux(T,b,S,this.vendor);_=new L.demux(T,O,b,S),this.probe=w;break}}if(!_)return void T.trigger(a.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=_}var k=this.remuxer;(p||g)&&(_.resetInitSegment(r,i,s,m),k.resetInitSegment()),p&&(_.resetTimeStamp(E),k.resetTimeStamp(E)),"function"==typeof _.setDecryptData&&_.setDecryptData(t),_.append(e,h,v,y)},e}();t.default=v},"./src/demux/demuxer-worker.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/demux/demuxer-inline.js"),a=r("./src/events.js"),n=r("./src/utils/logger.js"),s=r("./node_modules/node-libs-browser/node_modules/events/events.js");t.default=function(e){var t=new s.EventEmitter;t.trigger=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(r))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",function(a){var s=a.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);e.demuxer=new i.default(t,s.typeSupported,o,s.vendor),n.enableLogs(o.debug),r("init",null);break;case"demux":e.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}}),t.on(a.default.FRAG_DECRYPTED,r),t.on(a.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(a.default.FRAG_PARSED,r),t.on(a.default.ERROR,r),t.on(a.default.FRAG_PARSING_METADATA,r),t.on(a.default.FRAG_PARSING_USERDATA,r),t.on(a.default.INIT_PTS_FOUND,r),t.on(a.default.FRAG_PARSING_DATA,function(t,r){var i=[],a={event:t,data:r};r.data1&&(a.data1=r.data1.buffer,i.push(r.data1.buffer),delete r.data1),r.data2&&(a.data2=r.data2.buffer,i.push(r.data2.buffer),delete r.data2),e.postMessage(a,i)})}},"./src/demux/demuxer.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./node_modules/webworkify-webpack/index.js"),a=r("./src/events.js"),n=r("./src/demux/demuxer-inline.js"),s=r("./src/utils/logger.js"),o=r("./src/errors.js"),l=r("./src/utils/mediasource-helper.js"),u=r("./src/utils/get-self-scope.js"),d=r("./src/observer.js"),c=u.getSelfScope(),f=l.getMediaSource(),h=function(){function t(e,t){var r=this;this.hls=e,this.id=t;var l=this.observer=new d.Observer,u=e.config,h=function(t,i){(i=i||{}).frag=r.frag,i.id=r.id,e.trigger(t,i)};l.on(a.default.FRAG_DECRYPTED,h),l.on(a.default.FRAG_PARSING_INIT_SEGMENT,h),l.on(a.default.FRAG_PARSING_DATA,h),l.on(a.default.FRAG_PARSED,h),l.on(a.default.ERROR,h),l.on(a.default.FRAG_PARSING_METADATA,h),l.on(a.default.FRAG_PARSING_USERDATA,h),l.on(a.default.INIT_PTS_FOUND,h);var p={mp4:f.isTypeSupported("video/mp4"),mpeg:f.isTypeSupported("audio/mpeg"),mp3:f.isTypeSupported('audio/mp4; codecs="mp3"')},g=navigator.vendor;if(u.enableWorker&&"undefined"!=typeof Worker){s.logger.log("demuxing in webworker");var v=void 0;try{v=this.w=i("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),v.addEventListener("message",this.onwmsg),v.onerror=function(t){e.trigger(a.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},v.postMessage({cmd:"init",typeSupported:p,vendor:g,id:t,config:JSON.stringify(u)})}catch(m){s.logger.warn("Error in worker:",m),s.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),v&&c.URL.revokeObjectURL(v.objectURL),this.demuxer=new n.default(l,p,u,g),this.w=void 0}}else this.demuxer=new n.default(l,p,u,g)}return t.prototype.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.prototype.push=function(t,r,i,a,n,o,l,u){var d=this.w,c=e.isFinite(n.startPTS)?n.startPTS:n.start,f=n.decryptdata,h=this.frag,p=!(h&&n.cc===h.cc),g=!(h&&n.level===h.level),v=h&&n.sn===h.sn+1,m=!g&&v;if(p&&s.logger.log(this.id+":discontinuity detected"),g&&s.logger.log(this.id+":switch detected"),this.frag=n,d)d.postMessage({cmd:"demux",data:t,decryptdata:f,initSegment:r,audioCodec:i,videoCodec:a,timeOffset:c,discontinuity:p,trackSwitch:g,contiguous:m,duration:o,accurateTimeOffset:l,defaultInitPTS:u},t instanceof ArrayBuffer?[t]:[]);else{var y=this.demuxer;y&&y.push(t,f,r,i,a,c,p,g,m,o,l,u)}},t.prototype.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":c.URL.revokeObjectURL(this.w.objectURL);break;case a.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},t}();t.default=h}).call(this,r("./src/polyfills/number.js").Number)},"./src/demux/exp-golomb.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),a=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}return e.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");i.set(e.subarray(r,r+a)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a},e.prototype.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},e.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&i.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},e.prototype.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},e.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},e.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},e.prototype.readBoolean=function(){return 1===this.readBits(1)},e.prototype.readUByte=function(){return this.readBits(8)},e.prototype.readUShort=function(){return this.readBits(16)},e.prototype.readUInt=function(){return this.readBits(32)},e.prototype.skipScalingList=function(e){var t,r=8,i=8;for(t=0;t<e;t++)0!==i&&(i=(r+this.readEG()+256)%256),r=0===i?r:i},e.prototype.readSPS=function(){var e,t,r,i,a,n,s,o=0,l=0,u=0,d=0,c=this.readUByte.bind(this),f=this.readBits.bind(this),h=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),v=this.skipEG.bind(this),m=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(c(),e=c(),f(5),g(3),c(),m(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var E=h();if(3===E&&g(1),m(),m(),g(1),p())for(n=3!==E?8:12,s=0;s<n;s++)p()&&y(s<6?16:64)}m();var _=h();if(0===_)h();else if(1===_)for(g(1),v(),v(),t=h(),s=0;s<t;s++)v();m(),g(1),r=h(),i=h(),0===(a=f(1))&&g(1),g(1),p()&&(o=h(),l=h(),u=h(),d=h());var T=[1,1];if(p()&&p())switch(c()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[c()<<8|c(),c()<<8|c()]}return{width:Math.ceil(16*(r+1)-2*o-2*l),height:(2-a)*(i+1)*16-(a?2:4)*(u+d),pixelRatio:T}},e.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();t.default=a},"./src/demux/id3.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,r){for(var i=r,a=0;e.isHeader(t,r);){a+=10,a+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(a+=10),r+=a}if(a>0)return t.subarray(i,i+a)},e._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},e.getTimeStamp=function(t){for(var r=e.getID3Frames(t),i=0;i<r.length;i++){var a=r[i];if(e.isTimeStampFrame(a))return e._readTimeStamp(a)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),i=e._readSize(t,4);return{type:r,size:i,data:t.subarray(10,10+i)}},e.getID3Frames=function(t){for(var r=0,i=[];e.isHeader(t,r);){for(var a=e._readSize(t,r+6),n=(r+=10)+a;r+8<n;){var s=e._getFrameData(t.subarray(r)),o=e._decodeFrame(s);o&&i.push(o),r+=s.size+10}e.isFooter(t,r)&&(r+=10)}return i},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,r&&(i+=47721858.84),Math.round(i)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data,!0),i=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:i.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,i=e._utf8ArrayToStr(t.data.subarray(r));r+=i.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:a}}var n=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:n}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,i=e._utf8ArrayToStr(t.data.subarray(r));r+=i.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:a}}var n=e._utf8ArrayToStr(t.data);return{key:t.type,data:n}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);for(var r,i,a,n=e.length,s="",o=0;o<n;){if(0===(r=e[o++])&&t)return s;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s+=String.fromCharCode(r);break;case 12:case 13:i=e[o++],s+=String.fromCharCode((31&r)<<6|63&i);break;case 14:i=e[o++],a=e[o++],s+=String.fromCharCode((15&r)<<12|(63&i)<<6|(63&a)<<0)}}return s},e}(),a=i._utf8ArrayToStr;t.utf8ArrayToStr=a,t.default=i},"./src/demux/mp3demuxer.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/demux/id3.js"),a=r("./src/utils/logger.js"),n=r("./src/demux/mpegaudio.js"),s=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}return e.prototype.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){var t,r,s=i.default.getID3Data(e,0);if(s&&void 0!==i.default.getTimeStamp(s))for(t=s.length,r=Math.min(e.length-1,t+100);t<r;t++)if(n.default.probe(e,t))return a.logger.log("MPEG Audio sync word found !"),!0;return!1},e.prototype.append=function(e,t,r,a){for(var s=i.default.getID3Data(e,0),o=i.default.getTimeStamp(s),l=o?90*o:9e4*t,u=s.length,d=e.length,c=0,f=0,h=this._audioTrack,p=[{pts:l,dts:l,data:s}];u<d;)if(n.default.isHeader(e,u)){var g=n.default.appendFrame(h,e,u,l,c);if(!g)break;u+=g.length,f=g.sample.pts,c++}else i.default.isHeader(e,u)?(s=i.default.getID3Data(e,u),p.push({pts:f,dts:f,data:s}),u+=s.length):u++;this.remuxer.remux(h,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},t,r,a)},e.prototype.destroy=function(){},e}();t.default=s},"./src/demux/mp4demuxer.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),a=r("./src/events.js"),n=Math.pow(2,32)-1,s=function(){function e(e,t){this.observer=e,this.remuxer=t}return e.prototype.resetTimeStamp=function(e){this.initPTS=e},e.prototype.resetInitSegment=function(t,r,i,n){if(t&&t.byteLength){var s=this.initData=e.parseInitSegment(t);null==r&&(r="mp4a.40.5"),null==i&&(i="avc1.42e01e");var o={};s.audio&&s.video?o.audiovideo={container:"video/mp4",codec:r+","+i,initSegment:n?t:null}:(s.audio&&(o.audio={container:"audio/mp4",codec:r,initSegment:n?t:null}),s.video&&(o.video={container:"video/mp4",codec:i,initSegment:n?t:null})),this.observer.trigger(a.default.FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else r&&(this.audioCodec=r),i&&(this.videoCodec=i)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},e.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},e.findBox=function(t,r){var i,a,n,s,o,l,u=[];if(t.data?(o=t.start,n=t.end,t=t.data):(o=0,n=t.byteLength),!r.length)return null;for(i=o;i<n;)l=(a=e.readUint32(t,i))>1?i+a:n,e.bin2str(t.subarray(i+4,i+8))===r[0]&&(1===r.length?u.push({data:t,start:i+8,end:l}):(s=e.findBox({data:t,start:i+8,end:l},r.slice(1))).length&&(u=u.concat(s))),i=l;return u},e.parseSegmentIndex=function(t){var r,i=e.findBox(t,["moov"])[0],a=i?i.end:null,n=0,s=e.findBox(t,["sidx"]);if(!s||!s[0])return null;r=[];var o=(s=s[0]).data[0];n=0===o?8:16;var l=e.readUint32(s,n);n+=4;n+=0===o?8:16,n+=2;var u=s.end+0,d=e.readUint16(s,n);n+=2;for(var c=0;c<d;c++){var f=n,h=e.readUint32(s,f);f+=4;var p=2147483647&h;if(1===(2147483648&h)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var g=e.readUint32(s,f);f+=4,r.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/l,start:u,end:u+p-1}}),u+=p,n=f+=4}return{earliestPresentationTime:0,timescale:l,version:o,referencesCount:d,references:r,moovEndOffset:a}},e.parseInitSegment=function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach(function(t){var a=e.findBox(t,["tkhd"])[0];if(a){var n=a.data[a.start],s=0===n?12:20,o=e.readUint32(a,s),l=e.findBox(t,["mdia","mdhd"])[0];if(l){s=0===(n=l.data[l.start])?12:20;var u=e.readUint32(l,s),d=e.findBox(t,["mdia","hdlr"])[0];if(d){var c={soun:"audio",vide:"video"}[e.bin2str(d.data.subarray(d.start+8,d.start+12))];if(c){var f=e.findBox(t,["mdia","minf","stbl","stsd"]);if(f.length){f=f[0];var h=e.bin2str(f.data.subarray(f.start+12,f.start+16));i.logger.log("MP4Demuxer:"+c+":"+h+" found")}r[o]={timescale:u,type:c},r[c]={timescale:u,id:o}}}}}}),r},e.getStartDTS=function(t,r){var i,a,n;return i=e.findBox(r,["moof","traf"]),a=[].concat.apply([],i.map(function(r){return e.findBox(r,["tfhd"]).map(function(i){var a,n;return a=e.readUint32(i,4),n=t[a].timescale||9e4,e.findBox(r,["tfdt"]).map(function(t){var r,i;return r=t.data[t.start],i=e.readUint32(t,4),1===r&&(i*=Math.pow(2,32),i+=e.readUint32(t,8)),i})[0]/n})})),n=Math.min.apply(null,a),isFinite(n)?n:0},e.offsetStartDTS=function(t,r,i){e.findBox(r,["moof","traf"]).map(function(r){return e.findBox(r,["tfhd"]).map(function(a){var s=e.readUint32(a,4),o=t[s].timescale||9e4;e.findBox(r,["tfdt"]).map(function(t){var r=t.data[t.start],a=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,a-i*o);else{a*=Math.pow(2,32),a+=e.readUint32(t,8),a-=i*o,a=Math.max(a,0);var s=Math.floor(a/(n+1)),l=Math.floor(a%(n+1));e.writeUint32(t,4,s),e.writeUint32(t,8,l)}})})})},e.prototype.append=function(t,r,i,n){var s=this.initData;s||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),s=this.initData);var o,l=this.initPTS;if(void 0===l){var u=e.getStartDTS(s,t);this.initPTS=l=u-r,this.observer.trigger(a.default.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(s,t,l),o=e.getStartDTS(s,t),this.remuxer.remux(s.audio,s.video,null,null,o,i,n,t)},e.prototype.destroy=function(){},e}();t.default=s},"./src/demux/mpegaudio.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,i,a){if(!(r+24>t.length)){var n=this.parseHeader(t,r);if(n&&r+n.frameLength<=t.length){var s=i+a*(9e4*n.samplesPerFrame/n.sampleRate),o={unit:t.subarray(r,r+n.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=n.channelCount,e.samplerate=n.sampleRate,e.samples.push(o),e.len+=n.frameLength,{sample:o,length:n.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,a=e[t+1]>>1&3,n=e[t+2]>>4&15,s=e[t+2]>>2&3,o=e[t+2]>>1&1;if(1!==r&&0!==n&&15!==n&&3!==s){var l=3===r?3-a:3===a?3:4,u=1e3*i.BitratesMap[14*l+n-1],d=3===r?0:2===r?1:2,c=i.SamplingRateMap[3*d+s],f=e[t+3]>>6==3?1:2,h=i.SamplesCoefficients[r][a],p=i.BytesInSlot[a],g=8*h*p;return{sampleRate:c,channelCount:f,frameLength:parseInt(h*u/c+o,10)*p,samplesPerFrame:g}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),i=4;r&&r.frameLength&&(i=r.frameLength);var a=t+i;if(a===e.length||a+1<e.length&&this.isHeaderPattern(e,a))return!0}return!1}};t.default=i},"./src/demux/sample-aes.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/crypt/decrypter.js"),a=function(){function e(e,t,r,a){this.decryptdata=r,this.discardEPB=a,this.decrypter=new i.default(e,t,{removePKCS7Padding:!1})}return e.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},e.prototype.decryptAacSample=function(e,t,r,i){var a=e[t].unit,n=a.subarray(16,a.length-a.length%16),s=n.buffer.slice(n.byteOffset,n.byteOffset+n.length),o=this;this.decryptBuffer(s,function(n){n=new Uint8Array(n),a.set(n,16),i||o.decryptAacSamples(e,t+1,r)})},e.prototype.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,i),!i)return}}},e.prototype.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),i=0,a=32;a<=e.length-16;a+=160,i+=16)r.set(e.subarray(a,a+16),i);return r},e.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,i=32;i<=e.length-16;i+=160,r+=16)e.set(t.subarray(r,r+16),i);return e},e.prototype.decryptAvcSample=function(e,t,r,i,a,n){var s=this.discardEPB(a.data),o=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(o.buffer,function(o){a.data=l.getAvcDecryptedUnit(s,o),n||l.decryptAvcSamples(e,t,r+1,i)})},e.prototype.decryptAvcSamples=function(e,t,r,i){for(;;t++,r=0){if(t>=e.length)return void i();for(var a=e[t].units;!(r>=a.length);r++){var n=a[r];if(!(n.length<=48||1!==n.type&&5!==n.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,i,n,s),!s)return}}}},e}();t.default=a},"./src/demux/tsdemuxer.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/demux/adts.js"),a=r("./src/demux/mpegaudio.js"),n=r("./src/events.js"),s=r("./src/demux/exp-golomb.js"),o=r("./src/demux/sample-aes.js"),l=r("./src/utils/logger.js"),u=r("./src/errors.js"),d={video:1,audio:2,id3:3,text:4},c=function(){function e(e,t,r,i){this.observer=e,this.config=r,this.typeSupported=i,this.remuxer=t,this.sampleAes=null}return e.prototype.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new o.default(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var r=e._syncOffset(t);return!(r<0)&&(r&&l.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),!0)},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:d[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},e.prototype.resetInitSegment=function(t,r,i,a){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",a),this._audioTrack=e.createTrack("audio",a),this._id3Track=e.createTrack("id3",a),this._txtTrack=e.createTrack("text",a),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=i,this._duration=a},e.prototype.resetTimeStamp=function(){},e.prototype.append=function(t,r,i,a){var s,o,d,c,f,h=t.length,p=!1;this.contiguous=i;var g=this.pmtParsed,v=this._avcTrack,m=this._audioTrack,y=this._id3Track,E=v.pid,_=m.pid,T=y.pid,S=this._pmtId,b=v.pesData,A=m.pesData,R=y.pesData,D=this._parsePAT,L=this._parsePMT,w=this._parsePES,O=this._parseAVCPES.bind(this),k=this._parseAACPES.bind(this),I=this._parseMPEGPES.bind(this),P=this._parseID3PES.bind(this),C=e._syncOffset(t);for(h-=(h+C)%188,s=C;s<h;s+=188)if(71===t[s]){if(o=!!(64&t[s+1]),d=((31&t[s+1])<<8)+t[s+2],(48&t[s+3])>>4>1){if((c=s+5+t[s+4])===s+188)continue}else c=s+4;switch(d){case E:o&&(b&&(f=w(b))&&void 0!==f.pts&&O(f,!1),b={data:[],size:0}),b&&(b.data.push(t.subarray(c,s+188)),b.size+=s+188-c);break;case _:o&&(A&&(f=w(A))&&void 0!==f.pts&&(m.isAAC?k(f):I(f)),A={data:[],size:0}),A&&(A.data.push(t.subarray(c,s+188)),A.size+=s+188-c);break;case T:o&&(R&&(f=w(R))&&void 0!==f.pts&&P(f),R={data:[],size:0}),R&&(R.data.push(t.subarray(c,s+188)),R.size+=s+188-c);break;case 0:o&&(c+=t[c]+1),S=this._pmtId=D(t,c);break;case S:o&&(c+=t[c]+1);var x=L(t,c,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(E=x.avc)>0&&(v.pid=E),(_=x.audio)>0&&(m.pid=_,m.isAAC=x.isAAC),(T=x.id3)>0&&(y.pid=T),p&&!g&&(l.logger.log("reparse from beginning"),p=!1,s=C-188),g=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(n.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});b&&(f=w(b))&&void 0!==f.pts?(O(f,!0),v.pesData=null):v.pesData=b,A&&(f=w(A))&&void 0!==f.pts?(m.isAAC?k(f):I(f),m.pesData=null):(A&&A.size&&l.logger.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=A),R&&(f=w(R))&&void 0!==f.pts?(P(f),y.pesData=null):y.pesData=R,null==this.sampleAes?this.remuxer.remux(m,v,y,this._txtTrack,r,i,a):this.decryptAndRemux(m,v,y,this._txtTrack,r,i,a)},e.prototype.decryptAndRemux=function(e,t,r,i,a,n,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){o.decryptAndRemuxAvc(e,t,r,i,a,n,s)})}else this.decryptAndRemuxAvc(e,t,r,i,a,n,s)},e.prototype.decryptAndRemuxAvc=function(e,t,r,i,a,n,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){o.remuxer.remux(e,t,r,i,a,n,s)})}else this.remuxer.remux(e,t,r,i,a,n,s)},e.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},e.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},e.prototype._parsePMT=function(e,t,r,i){var a,n,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(a=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){switch(n=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!i){l.logger.log("unkown stream type:"+e[t]);break}case 15:-1===s.audio&&(s.audio=n);break;case 21:-1===s.id3&&(s.id3=n);break;case 219:if(!i){l.logger.log("unkown stream type:"+e[t]);break}case 27:-1===s.avc&&(s.avc=n);break;case 3:case 4:r?-1===s.audio&&(s.audio=n,s.isAAC=!1):l.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:l.logger.warn("HEVC stream type found, not supported for now");break;default:l.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},e.prototype._parsePES=function(e){var t,r,i,a,n,s,o,u,d=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&c.length>1;){var f=new Uint8Array(c[0].length+c[1].length);f.set(c[0]),f.set(c[1],c[0].length),c[0]=f,c.splice(1,1)}if(1===((t=c[0])[0]<<16)+(t[1]<<8)+t[2]){if((i=(t[4]<<8)+t[5])&&i>e.size-6)return null;192&(r=t[7])&&((s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(s-=8589934592),64&r?((o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(o-=8589934592),s-o>54e5&&(l.logger.warn(Math.round((s-o)/9e4)+"s delta between PTS and DTS, align them"),s=o)):o=s),u=(a=t[8])+9,e.size-=u,n=new Uint8Array(e.size);for(var h=0,p=c.length;h<p;h++){var g=(t=c[h]).byteLength;if(u){if(u>g){u-=g;continue}t=t.subarray(u),g-=u,u=0}n.set(t,d),d+=g}return i&&(i-=a+3),{data:n,pts:s,dts:o,len:i}}return null},e.prototype.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,i=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(i||this.contiguous)?(e.id=i,r.push(e)):t.dropped++}e.debug.length&&l.logger.log(e.pts+"/"+e.dts+":"+e.debug)},e.prototype._parseAVCPES=function(e,t){var r,i,a,n=this,o=this._avcTrack,l=this._parseAVCNALu(e.data),u=this.avcSample,d=!1,c=this.pushAccesUnit.bind(this),f=function(e,t,r,i){return{key:e,pts:t,dts:r,units:[],debug:i}};e.data=null,u&&l.length&&!o.audFound&&(c(u,o),u=this.avcSample=f(!1,e.pts,e.dts,"")),l.forEach(function(t){switch(t.type){case 1:i=!0,u||(u=n.avcSample=f(!0,e.pts,e.dts,"")),u.frame=!0;var l=t.data;if(d&&l.length>4){var h=new s.default(l).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(u.key=!0)}break;case 5:i=!0,u||(u=n.avcSample=f(!0,e.pts,e.dts,"")),u.key=!0,u.frame=!0;break;case 6:i=!0,(r=new s.default(n.discardEPB(t.data))).readUByte();for(var p=0,g=0,v=!1,m=0;!v&&r.bytesAvailable>1;){p=0;do{p+=m=r.readUByte()}while(255===m);g=0;do{g+=m=r.readUByte()}while(255===m);if(4===p&&0!==r.bytesAvailable){if(v=!0,181===r.readUByte())if(49===r.readUShort())if(1195456820===r.readUInt())if(3===r.readUByte()){var y=r.readUByte(),E=31&y,_=[y,r.readUByte()];for(a=0;a<E;a++)_.push(r.readUByte()),_.push(r.readUByte()),_.push(r.readUByte());n._insertSampleInOrder(n._txtTrack.samples,{type:3,pts:e.pts,bytes:_})}}else if(g<r.bytesAvailable)for(a=0;a<g;a++)r.readUByte()}break;case 7:if(i=!0,d=!0,!o.sps){var T=(r=new s.default(t.data)).readSPS();o.width=T.width,o.height=T.height,o.pixelRatio=T.pixelRatio,o.sps=[t.data],o.duration=n._duration;var S=t.data.subarray(1,4),b="avc1.";for(a=0;a<3;a++){var A=S[a].toString(16);A.length<2&&(A="0"+A),b+=A}o.codec=b}break;case 8:i=!0,o.pps||(o.pps=[t.data]);break;case 9:i=!1,o.audFound=!0,u&&c(u,o),u=n.avcSample=f(!1,e.pts,e.dts,"");break;case 12:i=!1;break;default:i=!1,u&&(u.debug+="unknown NAL "+t.type+" ")}u&&i&&u.units.push(t)}),t&&u&&(c(u,o),this.avcSample=null)},e.prototype._insertSampleInOrder=function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var i=r-1;i>=0;i--)if(t.pts<e[i].pts){e.splice(i,0,t);break}}else e.push(t)},e.prototype._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var r=this._avcTrack.samples;t=r[r.length-1]}if(t){var i=t.units;e=i[i.length-1]}return e},e.prototype._parseAVCNALu=function(e){var t,r,i,a,n=0,s=e.byteLength,o=this._avcTrack,l=o.naluState||0,u=l,d=[],c=-1;for(-1===l&&(c=0,a=31&e[0],l=0,n=1);n<s;)if(t=e[n++],l)if(1!==l)if(t)if(1===t){var f,h;if(c>=0)i={data:e.subarray(c,n-l-1),type:a},d.push(i);else if(f=this._getLastNalUnit())if(u&&n<=4-u&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-u)),(r=n-l-1)>0)(h=new Uint8Array(f.data.byteLength+r)).set(f.data,0),h.set(e.subarray(0,r),f.data.byteLength),f.data=h;n<s?(c=n,a=31&e[n],l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;(c>=0&&l>=0&&(i={data:e.subarray(c,s),type:a,state:l},d.push(i)),0===d.length)&&((f=this._getLastNalUnit())&&((h=new Uint8Array(f.data.byteLength+e.byteLength)).set(f.data,0),h.set(e,f.data.byteLength),f.data=h));return o.naluState=l,d},e.prototype.discardEPB=function(e){for(var t,r,i=e.byteLength,a=[],n=1;n<i-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(a.push(n+2),n+=2):n++;if(0===a.length)return e;t=i-a.length,r=new Uint8Array(t);var s=0;for(n=0;n<t;s++,n++)s===a[0]&&(s++,a.shift()),r[n]=e[s];return r},e.prototype._parseAACPES=function(e){var t,r,a,s,o,d=this._audioTrack,c=e.data,f=e.pts,h=this.aacOverFlow,p=this.aacLastPTS;if(h){var g=new Uint8Array(h.byteLength+c.byteLength);g.set(h,0),g.set(c,h.byteLength),c=g}for(a=0,o=c.length;a<o-1&&!i.isHeader(c,a);a++);if(a){var v=void 0,m=void 0;if(a<o-1?(v="AAC PES did not start with ADTS header,offset:"+a,m=!1):(v="no ADTS header found in AAC PES",m=!0),l.logger.warn("parsing error:"+v),this.observer.trigger(n.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:m,reason:v}),m)return}if(i.initTrackConfig(d,this.observer,c,a,this.audioCodec),r=0,t=i.getFrameDuration(d.samplerate),h&&p){var y=p+t;Math.abs(y-f)>1&&(l.logger.log("AAC: align PTS for overlapping frames by "+Math.round((y-f)/90)),f=y)}for(;a<o;)if(i.isHeader(c,a)&&a+5<o){var E=i.appendFrame(d,c,a,f,r);if(!E)break;a+=E.length,s=E.sample.pts,r++}else a++;h=a<o?c.subarray(a,o):null,this.aacOverFlow=h,this.aacLastPTS=s},e.prototype._parseMPEGPES=function(e){for(var t=e.data,r=t.length,i=0,n=0,s=e.pts;n<r;)if(a.default.isHeader(t,n)){var o=a.default.appendFrame(this._audioTrack,t,n,s,i);if(!o)break;n+=o.length,i++}else n++},e.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},e}();t.default=c},"./src/errors.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},t.ErrorDetails={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},"./src/event-handler.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),a=r("./src/errors.js"),n=r("./src/events.js"),s={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},o=function(){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.hls=e,this.onEvent=this.onEvent.bind(this),this.handledEvents=t,this.useGenericHandler=!0,this.registerListeners()}return e.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.prototype.onHandlerDestroying=function(){},e.prototype.onHandlerDestroyed=function(){},e.prototype.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},e.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(s[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},e.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},e.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},e.prototype.onEventGeneric=function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(r){i.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.hls.trigger(n.default.ERROR,{type:a.ErrorTypes.OTHER_ERROR,details:a.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:r})}},e}();t.default=o},"./src/events.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},"./src/hls.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./node_modules/url-toolkit/src/url-toolkit.js"),s=r("./src/errors.js"),o=r("./src/loader/playlist-loader.js"),l=r("./src/loader/fragment-loader.js"),u=r("./src/loader/key-loader.js"),d=r("./src/controller/fragment-tracker.js"),c=r("./src/controller/stream-controller.js"),f=r("./src/controller/level-controller.js"),h=r("./src/controller/id3-track-controller.js"),p=r("./src/is-supported.js"),g=r("./src/utils/logger.js"),v=r("./src/config.js"),m=r("./src/events.js"),y=function(e){function t(r){void 0===r&&(r={});var i=e.call(this)||this,a=t.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in a)n in r||(r[n]=a[n]);if(void 0!==r.liveMaxLatencyDurationCount&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==r.liveMaxLatencyDuration&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||void 0===r.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');g.enableLogs(r.debug),i.config=r,i._autoLevelCapping=-1;var s=i.abrController=new r.abrController(i),p=new r.bufferController(i),v=new r.capLevelController(i),m=new r.fpsController(i),y=new o.default(i),E=new l.default(i),_=new u.default(i),T=new h.default(i),S=i.levelController=new f.default(i),b=new d.FragmentTracker(i),A=[S,i.streamController=new c.default(i,b)],R=r.audioStreamController;R&&A.push(new R(i,b)),i.networkControllers=A;var D=[y,E,_,s,p,v,m,T,b];if(R=r.audioTrackController){var L=new R(i);i.audioTrackController=L,D.push(L)}if(R=r.subtitleTrackController){var w=new R(i);i.subtitleTrackController=w,A.push(w)}if(R=r.emeController){var O=new R(i);i.emeController=O,D.push(O)}return(R=r.subtitleStreamController)&&A.push(new R(i,b)),(R=r.timelineController)&&D.push(new R(i)),i.coreComponents=D,i}return a(t,e),Object.defineProperty(t,"version",{get:function(){return"0.12.4"},enumerable:!0,configurable:!0}),t.isSupported=function(){return p.isSupported()},Object.defineProperty(t,"Events",{get:function(){return m.default},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorTypes",{get:function(){return s.ErrorTypes},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorDetails",{get:function(){return s.ErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DefaultConfig",{get:function(){return t.defaultConfig?t.defaultConfig:v.hlsDefaultConfig},set:function(e){t.defaultConfig=e},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){g.logger.log("destroy"),this.trigger(m.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},t.prototype.attachMedia=function(e){g.logger.log("attachMedia"),this.media=e,this.trigger(m.default.MEDIA_ATTACHING,{media:e})},t.prototype.detachMedia=function(){g.logger.log("detachMedia"),this.trigger(m.default.MEDIA_DETACHING),this.media=null},t.prototype.loadSource=function(e){e=n.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),g.logger.log("loadSource:"+e),this.url=e,this.trigger(m.default.MANIFEST_LOADING,{url:e})},t.prototype.startLoad=function(e){void 0===e&&(e=-1),g.logger.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})},t.prototype.stopLoad=function(){g.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},t.prototype.swapAudioCodec=function(){g.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},t.prototype.recoverMediaError=function(){g.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},Object.defineProperty(t.prototype,"levels",{get:function(){return this.levelController.levels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentLevel",{get:function(){return this.streamController.currentLevel},set:function(e){g.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextLevel",{get:function(){return this.streamController.nextLevel},set:function(e){g.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loadLevel",{get:function(){return this.levelController.level},set:function(e){g.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextLoadLevel",{get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstLevel",{get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){g.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startLevel",{get:function(){return this.levelController.startLevel},set:function(e){g.logger.log("set startLevel:"+e);-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoLevelCapping",{get:function(){return this._autoLevelCapping},set:function(e){g.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoLevelEnabled",{get:function(){return-1===this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"manualLevel",{get:function(){return this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minAutoLevel",{get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,i=0;i<r;i++){if((e[i].realBitrate?Math.max(e[i].realBitrate,e[i].bitrate):e[i].bitrate)>t)return i}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxAutoLevel",{get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextAutoLevel",{get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTracks",{get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTrack",{get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"liveSyncPosition",{get:function(){return this.streamController.liveSyncPosition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleTracks",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleTrack",{get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleDisplay",{get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)},enumerable:!0,configurable:!0}),t}(r("./src/observer.js").Observer);t.default=y},"./src/is-supported.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/mediasource-helper.js");t.isSupported=function(){var e=i.getMediaSource(),t=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!a}},"./src/loader/fragment-loader.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/event-handler.js"),o=r("./src/errors.js"),l=r("./src/utils/logger.js"),u=function(t){function r(e){var r=t.call(this,e,n.default.FRAG_LOADING)||this;return r.loaders={},r}return a(r,t),r.prototype.destroy=function(){var e=this.loaders;for(var r in e){var i=e[r];i&&i.destroy()}this.loaders={},t.prototype.destroy.call(this)},r.prototype.onFragLoading=function(t){var r=t.frag,i=r.type,a=this.loaders,n=this.hls.config,s=n.fLoader,o=n.loader;r.loaded=0;var u,d,c,f=a[i];f&&(l.logger.warn("abort previous fragment loader for type: "+i),f.abort()),f=a[i]=r.loader=n.fLoader?new s(n):new o(n),u={url:r.url,frag:r,responseType:"arraybuffer",progressData:!1};var h=r.byteRangeStartOffset,p=r.byteRangeEndOffset;e.isFinite(h)&&e.isFinite(p)&&(u.rangeStart=h,u.rangeEnd=p),d={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},f.load(u,d,c)},r.prototype.loadsuccess=function(e,t,r,i){void 0===i&&(i=null);var a=e.data,s=r.frag;s.loader=void 0,this.loaders[s.type]=void 0,this.hls.trigger(n.default.FRAG_LOADED,{payload:a,frag:s,stats:t,networkDetails:i})},r.prototype.loaderror=function(e,t,r){void 0===r&&(r=null);var i=t.frag,a=i.loader;a&&a.abort(),this.loaders[i.type]=void 0,this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},r.prototype.loadtimeout=function(e,t,r){void 0===r&&(r=null);var i=t.frag,a=i.loader;a&&a.abort(),this.loaders[i.type]=void 0,this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},r.prototype.loadprogress=function(e,t,r,i){void 0===i&&(i=null);var a=t.frag;a.loaded=e.loaded,this.hls.trigger(n.default.FRAG_LOAD_PROGRESS,{frag:a,stats:e,networkDetails:i})},r}(s.default);t.default=u}).call(this,r("./src/polyfills/number.js").Number)},"./src/loader/fragment.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./node_modules/url-toolkit/src/url-toolkit.js"),a=r("./src/loader/level-key.js"),n=function(){function t(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this.programDateTime=null,this.rawProgramDateTime=null,this._elementaryStreams=((e={})[t.ElementaryStreamTypes.AUDIO]=!1,e[t.ElementaryStreamTypes.VIDEO]=!1,e)}return Object.defineProperty(t,"ElementaryStreamTypes",{get:function(){return{AUDIO:"audio",VIDEO:"video"}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return!this._url&&this.relurl&&(this._url=i.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRange",{get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var e=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var r=this.lastByteRangeEndOffset;e[0]=r||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0],this._byteRange=e}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeStartOffset",{get:function(){return this.byteRange[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeEndOffset",{get:function(){return this.byteRange[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"decryptdata",{get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endProgramDateTime",{get:function(){if(!e.isFinite(this.programDateTime))return null;var t=e.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"encrypted",{get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)},enumerable:!0,configurable:!0}),t.prototype.addElementaryStream=function(e){this._elementaryStreams[e]=!0},t.prototype.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},t.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},t.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new a.default).method=e.method,r.baseuri=e.baseuri,r.reluri=e.reluri,r.iv=this.createInitializationVector(t)),r},t}();t.default=n}).call(this,r("./src/polyfills/number.js").Number)},"./src/loader/key-loader.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/event-handler.js"),o=r("./src/errors.js"),l=r("./src/utils/logger.js"),u=function(e){function t(t){var r=e.call(this,t,n.default.KEY_LOADING)||this;return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}return a(t,e),t.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},s.default.prototype.destroy.call(this)},t.prototype.onKeyLoading=function(e){var t=e.frag,r=t.type,i=this.loaders[r],a=t.decryptdata,s=a.uri;if(s!==this.decrypturl||null===this.decryptkey){var o=this.hls.config;i&&(l.logger.warn("abort previous key loader for type:"+r),i.abort()),t.loader=this.loaders[r]=new o.loader(o),this.decrypturl=s,this.decryptkey=null;var u,d,c;u={url:s,frag:t,responseType:"arraybuffer"},d={timeout:o.fragLoadingTimeOut,maxRetry:0,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(u,d,c)}else this.decryptkey&&(a.key=this.decryptkey,this.hls.trigger(n.default.KEY_LOADED,{frag:t}))},t.prototype.loadsuccess=function(e,t,r){var i=r.frag;this.decryptkey=i.decryptdata.key=new Uint8Array(e.data),i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(n.default.KEY_LOADED,{frag:i})},t.prototype.loaderror=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},t.prototype.loadtimeout=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},t}(s.default);t.default=u},"./src/loader/level-key.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./node_modules/url-toolkit/src/url-toolkit.js"),a=function(){function e(){this.method=null,this.key=null,this.iv=null,this._uri=null}return Object.defineProperty(e.prototype,"uri",{get:function(){return!this._uri&&this.reluri&&(this._uri=i.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri},enumerable:!0,configurable:!0}),e}();t.default=a},"./src/loader/level.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}return Object.defineProperty(t.prototype,"hasProgramDateTime",{get:function(){return!(!this.fragments[0]||!e.isFinite(this.fragments[0].programDateTime))},enumerable:!0,configurable:!0}),t}();t.default=r}).call(this,r("./src/polyfills/number.js").Number)},"./src/loader/m3u8-parser.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./node_modules/url-toolkit/src/url-toolkit.js"),a=r("./src/loader/fragment.js"),n=r("./src/loader/level.js"),s=r("./src/loader/level-key.js"),o=r("./src/utils/attr-list.js"),l=r("./src/utils/logger.js"),u=r("./src/utils/codecs.js"),d=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,c=/#EXT-X-MEDIA:(.*)/g,f=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),h=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,p=/\.(mp4|m4s|m4v|m4a)$/i,g=function(){function t(){}return t.findGroup=function(e,t){if(!e)return null;for(var r=null,i=0;i<e.length;i++){var a=e[i];a.id===t&&(r=a)}return r},t.convertAVC1ToAVCOTI=function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},t.resolve=function(e,t){return i.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(e,r){var i,a=[];function n(e,t){["video","audio"].forEach(function(r){var i=e.filter(function(e){return u.isCodecType(e,r)});if(i.length){var a=i.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});t[r+"Codec"]=a.length>0?a[0]:i[0],e=e.filter(function(e){return-1===i.indexOf(e)})}}),t.unknownCodecs=e}for(d.lastIndex=0;null!=(i=d.exec(e));){var s={},l=s.attrs=new o.default(i[1]);s.url=t.resolve(i[2],r);var c=l.decimalResolution("RESOLUTION");c&&(s.width=c.width,s.height=c.height),s.bitrate=l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),s.name=l.NAME,n([].concat((l.CODECS||"").split(/[ ,]+/)),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=t.convertAVC1ToAVCOTI(s.videoCodec)),a.push(s)}return a},t.parseMasterPlaylistMedia=function(e,r,i,a){var n;void 0===a&&(a=[]);var s=[],l=0;for(c.lastIndex=0;null!==(n=c.exec(e));){var u={},d=new o.default(n[1]);if(d.TYPE===i){if(u.groupId=d["GROUP-ID"],u.name=d.NAME,u.type=i,u.default="YES"===d.DEFAULT,u.autoselect="YES"===d.AUTOSELECT,u.forced="YES"===d.FORCED,d.URI&&(u.url=t.resolve(d.URI,r)),u.lang=d.LANGUAGE,u.name||(u.name=u.lang),a.length){var f=t.findGroup(a,u.groupId);u.audioCodec=f?f.codec:a[0].codec}u.id=l++,s.push(u)}}return s},t.parseLevelPlaylist=function(t,r,i,u,d){var c,g,m=0,y=0,E=new n.default(r),_=new s.default,T=0,S=null,b=new a.default,A=null;for(f.lastIndex=0;null!==(c=f.exec(t));){var R=c[1];if(R){b.duration=parseFloat(R);var D=(" "+c[2]).slice(1);b.title=D||null,b.tagList.push(D?["INF",R,D]:["INF",R])}else if(c[3]){if(e.isFinite(b.duration)){var L=m++;b.type=u,b.start=y,b.levelkey=_,b.sn=L,b.level=i,b.cc=T,b.urlId=d,b.baseurl=r,b.relurl=(" "+c[3]).slice(1),v(b,S),E.fragments.push(b),S=b,y+=b.duration,b=new a.default}}else if(c[4]){if(b.rawByteRange=(" "+c[4]).slice(1),S){var w=S.byteRangeEndOffset;w&&(b.lastByteRangeEndOffset=w)}}else if(c[5])b.rawProgramDateTime=(" "+c[5]).slice(1),b.tagList.push(["PROGRAM-DATE-TIME",b.rawProgramDateTime]),null===A&&(A=E.fragments.length);else{for(c=c[0].match(h),g=1;g<c.length&&void 0===c[g];g++);var O=(" "+c[g+1]).slice(1),k=(" "+c[g+2]).slice(1);switch(c[g]){case"#":b.tagList.push(k?[O,k]:[O]);break;case"PLAYLIST-TYPE":E.type=O.toUpperCase();break;case"MEDIA-SEQUENCE":m=E.startSN=parseInt(O);break;case"TARGETDURATION":E.targetduration=parseFloat(O);break;case"VERSION":E.version=parseInt(O);break;case"EXTM3U":break;case"ENDLIST":E.live=!1;break;case"DIS":T++,b.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":T=parseInt(O);break;case"KEY":var I=O,P=new o.default(I),C=P.enumeratedString("METHOD"),x=P.URI,F=P.hexadecimalInteger("IV");C&&(_=new s.default,x&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(C)>=0&&(_.method=C,_.baseuri=r,_.reluri=x,_.key=null,_.iv=F));break;case"START":var M=O,N=new o.default(M).decimalFloatingPoint("TIME-OFFSET");e.isFinite(N)&&(E.startTimeOffset=N);break;case"MAP":var j=new o.default(O);b.relurl=j.URI,b.rawByteRange=j.BYTERANGE,b.baseurl=r,b.level=i,b.type=u,b.sn="initSegment",E.initSegment=b,(b=new a.default).rawProgramDateTime=E.initSegment.rawProgramDateTime;break;default:l.logger.warn("line parsed but not handled: "+c)}}}return(b=S)&&!b.relurl&&(E.fragments.pop(),y-=b.duration),E.totalduration=y,E.averagetargetduration=y/E.fragments.length,E.endSN=m-1,E.startCC=E.fragments[0]?E.fragments[0].cc:0,E.endCC=T,!E.initSegment&&E.fragments.length&&E.fragments.every(function(e){return p.test(e.relurl)})&&(l.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(b=new a.default).relurl=E.fragments[0].relurl,b.baseurl=r,b.level=i,b.type=u,b.sn="initSegment",E.initSegment=b,E.needSidxRanges=!0),A&&function(e,t){for(var r=e[t],i=t-1;i>=0;i--){var a=e[i];a.programDateTime=r.programDateTime-1e3*a.duration,r=a}}(E.fragments,A),E},t}();function v(t,r){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):r&&r.programDateTime&&(t.programDateTime=r.endProgramDateTime),e.isFinite(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}t.default=g}).call(this,r("./src/polyfills/number.js").Number)},"./src/loader/playlist-loader.js":function(e,t,r){"use strict";(function(e){var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/events.js"),s=r("./src/event-handler.js"),o=r("./src/errors.js"),l=r("./src/utils/logger.js"),u=r("./src/demux/mp4demuxer.js"),d=r("./src/loader/m3u8-parser.js"),c=window.performance,f={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},h={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},p=function(t){function r(e){var r=t.call(this,e,n.default.MANIFEST_LOADING,n.default.LEVEL_LOADING,n.default.AUDIO_TRACK_LOADING,n.default.SUBTITLE_TRACK_LOADING)||this;return r.loaders={},r}return a(r,t),Object.defineProperty(r,"ContextType",{get:function(){return f},enumerable:!0,configurable:!0}),Object.defineProperty(r,"LevelType",{get:function(){return h},enumerable:!0,configurable:!0}),r.canHaveQualityLevels=function(e){return e!==f.AUDIO_TRACK&&e!==f.SUBTITLE_TRACK},r.mapContextToLevelType=function(e){switch(e.type){case f.AUDIO_TRACK:return h.AUDIO;case f.SUBTITLE_TRACK:return h.SUBTITLE;default:return h.MAIN}},r.getResponseUrl=function(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r},r.prototype.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,i=t.loader,a=new(r||i)(t);return e.loader=a,this.loaders[e.type]=a,a},r.prototype.getInternalLoader=function(e){return this.loaders[e.type]},r.prototype.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},r.prototype.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},r.prototype.destroy=function(){this.destroyInternalLoaders(),t.prototype.destroy.call(this)},r.prototype.onManifestLoading=function(e){this.load(e.url,{type:f.MANIFEST,level:0,id:null})},r.prototype.onLevelLoading=function(e){this.load(e.url,{type:f.LEVEL,level:e.level,id:e.id})},r.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:f.AUDIO_TRACK,level:null,id:e.id})},r.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:f.SUBTITLE_TRACK,level:null,id:e.id})},r.prototype.load=function(e,t){var r=this.hls.config;l.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var i,a,n,s,o=this.getInternalLoader(t);if(o){var u=o.context;if(u&&u.url===e)return l.logger.trace("playlist request ongoing"),!1;l.logger.warn("aborting previous loader for type: "+t.type),o.abort()}switch(t.type){case f.MANIFEST:i=r.manifestLoadingMaxRetry,a=r.manifestLoadingTimeOut,n=r.manifestLoadingRetryDelay,s=r.manifestLoadingMaxRetryTimeout;break;case f.LEVEL:i=0,a=r.levelLoadingTimeOut;break;default:i=r.levelLoadingMaxRetry,a=r.levelLoadingTimeOut,n=r.levelLoadingRetryDelay,s=r.levelLoadingMaxRetryTimeout}o=this.createInternalLoader(t),t.url=e,t.responseType=t.responseType||"";var d={timeout:a,maxRetry:i,retryDelay:n,maxRetryDelay:s},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return l.logger.debug("Calling internal loader delegate for URL: "+e),o.load(t,d,c),!0},r.prototype.loadsuccess=function(e,t,r,i){if(void 0===i&&(i=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,i);this.resetInternalLoader(r.type);var a=e.data;t.tload=c.now(),0===a.indexOf("#EXTM3U")?a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,r,i):this._handleMasterPlaylist(e,t,r,i):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",i)},r.prototype.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},r.prototype.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},r.prototype._handleMasterPlaylist=function(e,t,i,a){var s=this.hls,o=e.data,u=r.getResponseUrl(e,i),c=d.default.parseMasterPlaylist(o,u);if(c.length){var f=c.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),h=d.default.parseMasterPlaylistMedia(o,u,"AUDIO",f),p=d.default.parseMasterPlaylistMedia(o,u,"SUBTITLES");if(h.length){var g=!1;h.forEach(function(e){e.url||(g=!0)}),!1===g&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(l.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main"}))}s.trigger(n.default.MANIFEST_LOADED,{levels:c,audioTracks:h,subtitles:p,url:u,stats:t,networkDetails:a})}else this._handleManifestParsingError(e,i,"no level found in manifest",a)},r.prototype._handleTrackOrLevelPlaylist=function(t,i,a,s){var o=this.hls,l=a.id,u=a.level,h=a.type,p=r.getResponseUrl(t,a),g=e.isFinite(l)?l:0,v=e.isFinite(u)?u:g,m=r.mapContextToLevelType(a),y=d.default.parseLevelPlaylist(t.data,p,v,m,g);if(y.tload=i.tload,h===f.MANIFEST){var E={url:p,details:y};o.trigger(n.default.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:p,stats:i,networkDetails:s})}if(i.tparsed=c.now(),y.needSidxRanges){var _=y.initSegment.url;this.load(_,{isSidxRequest:!0,type:h,level:u,levelDetails:y,id:l,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else a.levelDetails=y,this._handlePlaylistLoaded(t,i,a,s)},r.prototype._handleSidxRequest=function(e,t){var r=u.default.parseSegmentIndex(new Uint8Array(e.data));if(r){var i=r.references,a=t.levelDetails;i.forEach(function(e,t){var r=e.info,i=a.fragments[t];0===i.byteRange.length&&(i.rawByteRange=String(1+r.end-r.start)+"@"+String(r.start))}),a.initSegment.rawByteRange=String(r.moovEndOffset)+"@0"}},r.prototype._handleManifestParsingError=function(e,t,r,i){this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:i})},r.prototype._handleNetworkError=function(e,t,r,i){var a,s;void 0===r&&(r=!1),void 0===i&&(i=null),l.logger.info("A network error occured while loading a "+e.type+"-type playlist");var u=this.getInternalLoader(e);switch(e.type){case f.MANIFEST:a=r?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,s=!0;break;case f.LEVEL:a=r?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,s=!1;break;case f.AUDIO_TRACK:a=r?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,s=!1;break;default:s=!1}u&&(u.abort(),this.resetInternalLoader(e.type));var d={type:o.ErrorTypes.NETWORK_ERROR,details:a,fatal:s,url:u.url,loader:u,context:e,networkDetails:t};i&&(d.response=i),this.hls.trigger(n.default.ERROR,d)},r.prototype._handlePlaylistLoaded=function(e,t,i,a){var s=i.type,o=i.level,l=i.id,u=i.levelDetails;if(u.targetduration)if(r.canHaveQualityLevels(i.type))this.hls.trigger(n.default.LEVEL_LOADED,{details:u,level:o||0,id:l||0,stats:t,networkDetails:a});else switch(s){case f.AUDIO_TRACK:this.hls.trigger(n.default.AUDIO_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:a});break;case f.SUBTITLE_TRACK:this.hls.trigger(n.default.SUBTITLE_TRACK_LOADED,{details:u,id:l,stats:t,networkDetails:a})}else this._handleManifestParsingError(e,i,"invalid target duration",a)},r}(s.default);t.default=p}).call(this,r("./src/polyfills/number.js").Number)},"./src/observer.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.emit.apply(this,[e,e].concat(t))},t}(r("./node_modules/eventemitter3/index.js").EventEmitter);t.Observer=n},"./src/polyfills/number.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/get-self-scope.js").getSelfScope().Number;t.Number=i,i.isFinite=i.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},"./src/remux/aac-helper.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}();t.default=i},"./src/remux/mp4-generator.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Math.pow(2,32)-1,a=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:i};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=n,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,l,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))},e.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),i=8,a=r.length,n=a;a--;)i+=r[a].byteLength;for((t=new Uint8Array(i))[0]=i>>24&255,t[1]=i>>16&255,t[2]=i>>8&255,t[3]=255&i,t.set(e,4),a=0,i=8;a<n;a++)t.set(r[a],i),i+=r[a].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var a=Math.floor(r/(i+1)),n=Math.floor(r%(i+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,a>>24,a>>16&255,a>>8&255,255&a,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,i){return e.box(e.types.moof,e.mfhd(t),e.traf(i,r))},e.moov=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(i))},e.mvhd=function(t,r){r*=t;var a=Math.floor(r/(i+1)),n=Math.floor(r%(i+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,a>>24,a>>16&255,a>>8&255,255&a,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,s)},e.sdtp=function(t){var r,i,a=t.samples||[],n=new Uint8Array(4+a.length);for(i=0;i<a.length;i++)r=a[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,n)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,i,a,n=[],s=[];for(r=0;r<t.sps.length;r++)a=(i=t.sps[r]).byteLength,n.push(a>>>8&255),n.push(255&a),n=n.concat(Array.prototype.slice.call(i));for(r=0;r<t.pps.length;r++)a=(i=t.pps[r]).byteLength,s.push(a>>>8&255),s.push(255&a),s=s.concat(Array.prototype.slice.call(i));var o=e.box(e.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(s))),l=t.width,u=t.height,d=t.pixelRatio[0],c=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,c>>24,c>>16&255,c>>8&255,255&c])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,a=t.duration*t.timescale,n=t.width,s=t.height,o=Math.floor(a/(i+1)),l=Math.floor(a%(i+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,s>>8&255,255&s,0,0]))},e.traf=function(t,r){var a=e.sdtp(t),n=t.id,s=Math.floor(r/(i+1)),o=Math.floor(r%(i+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,a.length+16+20+8+16+8+8),a)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var i,a,n,s,o,l,u=t.samples||[],d=u.length,c=12+16*d,f=new Uint8Array(c);for(r+=8+c,f.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,255&d,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),i=0;i<d;i++)n=(a=u[i]).duration,s=a.size,o=a.flags,l=a.cts,f.set([n>>>24&255,n>>>16&255,n>>>8&255,255&n,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*i);return e.box(e.types.trun,f)},e.initSegment=function(t){e.types||e.init();var r,i=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+i.byteLength)).set(e.FTYP),r.set(i,e.FTYP.byteLength),r},e}();t.default=a},"./src/remux/mp4-remuxer.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/remux/aac-helper.js"),a=r("./src/remux/mp4-generator.js"),n=r("./src/events.js"),s=r("./src/errors.js"),o=r("./src/utils/logger.js"),l=function(){function e(e,t,r,i){this.observer=e,this.config=t,this.typeSupported=r;var a=navigator.userAgent;this.isSafari=i&&i.indexOf("Apple")>-1&&a&&!a.match("CriOS"),this.ISGenerated=!1}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},e.prototype.resetInitSegment=function(){this.ISGenerated=!1},e.prototype.remux=function(e,t,r,i,a,s,l){if(this.ISGenerated||this.generateIS(e,t,a),this.ISGenerated){var u=e.samples.length,d=t.samples.length,c=a,f=a;if(u&&d){var h=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale;c+=Math.max(0,h),f+=Math.max(0,-h)}if(u){e.timescale||(o.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,a));var p=this.remuxAudio(e,c,s,l);if(d){var g=void 0;p&&(g=p.endPTS-p.startPTS),t.timescale||(o.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,a)),this.remuxVideo(t,f,s,g,l)}}else if(d){var v=this.remuxVideo(t,f,s,0,l);v&&e.codec&&this.remuxEmptyAudio(e,c,s,v)}}r.samples.length&&this.remuxID3(r,a),i.samples.length&&this.remuxText(i,a),this.observer.trigger(n.default.FRAG_PARSED)},e.prototype.generateIS=function(e,t,r){var i,l,u=this.observer,d=e.samples,c=t.samples,f=this.typeSupported,h="audio/mp4",p={},g={tracks:p},v=void 0===this._initPTS;if(v&&(i=l=1/0),e.config&&d.length&&(e.timescale=e.samplerate,o.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(f.mpeg?(h="audio/mpeg",e.codec=""):f.mp3&&(e.codec="mp3")),p.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&f.mpeg?new Uint8Array:a.default.initSegment([e]),metadata:{channelCount:e.channelCount}},v&&(i=l=d[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&c.length){var m=t.inputTimeScale;t.timescale=m,p.video={container:"video/mp4",codec:t.codec,initSegment:a.default.initSegment([t]),metadata:{width:t.width,height:t.height}},v&&(i=Math.min(i,c[0].pts-m*r),l=Math.min(l,c[0].dts-m*r),this.observer.trigger(n.default.INIT_PTS_FOUND,{initPTS:i}))}Object.keys(p).length?(u.trigger(n.default.FRAG_PARSING_INIT_SEGMENT,g),this.ISGenerated=!0,v&&(this._initPTS=i,this._initDTS=l)):u.trigger(n.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.prototype.remuxVideo=function(e,t,r,i,l){var u,d,c,f,h,p,g,v=8,m=e.timescale,y=e.samples,E=[],_=y.length,T=this._PTSNormalize,S=this._initPTS,b=this.nextAvcDts,A=this.isSafari;if(0!==_){A&&(r|=y.length&&b&&(l&&Math.abs(t-b/m)<.1||Math.abs(y[0].pts-b-S)<m/5)),r||(b=t*m),y.forEach(function(e){e.pts=T(e.pts-S,b),e.dts=T(e.dts-S,b)}),y.sort(function(e,t){var r=e.dts-t.dts,i=e.pts-t.pts;return r||i||e.id-t.id});var R=y.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(R<0){o.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(R/90)+" ms to overcome this issue");for(var D=0;D<y.length;D++)y[D].dts+=R}var L=y[0];h=Math.max(L.dts,0),f=Math.max(L.pts,0);var w=Math.round((h-b)/90);r&&w&&(w>1?o.logger.log("AVC:"+w+" ms hole between fragments detected,filling it"):w<-1&&o.logger.log("AVC:"+-w+" ms overlapping between fragments detected"),h=b,y[0].dts=h,f=Math.max(f-w,b),y[0].pts=f,o.logger.log("Video/PTS/DTS adjusted: "+Math.round(f/90)+"/"+Math.round(h/90)+",delta:"+w+" ms")),L=y[y.length-1],g=Math.max(L.dts,0),p=Math.max(L.pts,0,g),A&&(u=Math.round((g-h)/(y.length-1)));var O=0,k=0;for(D=0;D<_;D++){for(var I=y[D],P=I.units,C=P.length,x=0,F=0;F<C;F++)x+=P[F].data.length;k+=x,O+=C,I.length=x,I.dts=A?h+D*u:Math.max(I.dts,h),I.pts=Math.max(I.pts,I.dts)}var M=k+4*O+8;try{d=new Uint8Array(M)}catch(Z){return void this.observer.trigger(n.default.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:M,reason:"fail allocating video mdat "+M})}var N=new DataView(d.buffer);N.setUint32(0,M),d.set(a.default.types.mdat,4);for(D=0;D<_;D++){var j=y[D],U=j.units,B=0,G=void 0;for(F=0,C=U.length;F<C;F++){var K=U[F],H=K.data,V=K.data.byteLength;N.setUint32(v,V),v+=4,d.set(H,v),v+=V,B+=4+V}if(A)G=Math.max(0,u*Math.round((j.pts-j.dts)/u));else{if(D<_-1)u=y[D+1].dts-j.dts;else{var W=this.config,Y=j.dts-y[D>0?D-1:D].dts;if(W.stretchShortVideoTrack){var q=W.maxBufferHole,X=Math.floor(q*m),z=(i?f+i*m:this.nextAudioPts)-j.pts;z>X?((u=z-Y)<0&&(u=Y),o.logger.log("It is approximately "+z/90+" ms to the next segment; using duration "+u/90+" ms for the last video frame.")):u=Y}else u=Y}G=Math.round(j.pts-j.dts)}E.push({size:B,duration:u,cts:G,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:j.key?2:1,isNonSync:j.key?0:1}})}this.nextAvcDts=g+u;var Q=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,E.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var $=E[0].flags;$.dependsOn=2,$.isNonSync=0}e.samples=E,c=a.default.moof(e.sequenceNumber++,h,e),e.samples=[];var J={data1:c,data2:d,startPTS:f/m,endPTS:(p+u)/m,startDTS:h/m,endDTS:this.nextAvcDts/m,type:"video",hasAudio:!1,hasVideo:!0,nb:E.length,dropped:Q};return this.observer.trigger(n.default.FRAG_PARSING_DATA,J),J}},e.prototype.remuxAudio=function(e,t,r,l){var u,d,c,f,h,p,g,v=e.inputTimeScale,m=e.timescale,y=v/m,E=(e.isAAC?1024:1152)*y,_=this._PTSNormalize,T=this._initPTS,S=!e.isAAC&&this.typeSupported.mpeg,b=e.samples,A=[],R=this.nextAudioPts;if(r|=b.length&&R&&(l&&Math.abs(t-R/v)<.1||Math.abs(b[0].pts-R-T)<20*E),b.forEach(function(e){e.pts=e.dts=_(e.pts-T,t*v)}),0!==(b=b.filter(function(e){return e.pts>=0})).length){if(r||(R=l?t*v:b[0].pts),e.isAAC)for(var D=this.config.maxAudioFramesDrift,L=0,w=R;L<b.length;){var O,k=b[L];O=(j=k.pts)-w;var I=Math.abs(1e3*O/v);if(O<=-D*E)o.logger.warn("Dropping 1 audio frame @ "+(w/v).toFixed(3)+"s due to "+Math.round(I)+" ms overlap."),b.splice(L,1),e.len-=k.unit.length;else if(O>=D*E&&I<1e4&&w){var P=Math.round(O/E);o.logger.warn("Injecting "+P+" audio frame @ "+(w/v).toFixed(3)+"s due to "+Math.round(1e3*O/v)+" ms gap.");for(var C=0;C<P;C++){var x=Math.max(w,0);(c=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),c=k.unit.subarray()),b.splice(L,0,{unit:c,pts:x,dts:x}),e.len+=c.length,w+=E,L++}k.pts=k.dts=w,w+=E,L++}else Math.abs(O),k.pts=k.dts=w,w+=E,L++}C=0;for(var F=b.length;C<F;C++){var M=b[C],N=M.unit,j=M.pts;if(void 0!==g)d.duration=Math.round((j-g)/y);else{var U=Math.round(1e3*(j-R)/v),B=0;if(r&&e.isAAC&&U){if(U>0&&U<1e4)B=Math.round((j-R)/E),o.logger.log(U+" ms hole between AAC samples detected,filling it"),B>0&&((c=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(c=N.subarray()),e.len+=B*c.length);else if(U<-12){o.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(R/v).toFixed(3)+"s/"+(j/v).toFixed(3)+"s/"+-U+"ms"),e.len-=N.byteLength;continue}j=R}if(p=j,!(e.len>0))return;var G=S?e.len:e.len+8;u=S?0:8;try{f=new Uint8Array(G)}catch(X){return void this.observer.trigger(n.default.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:G,reason:"fail allocating audio mdat "+G})}S||(new DataView(f.buffer).setUint32(0,G),f.set(a.default.types.mdat,4));for(L=0;L<B;L++)(c=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),c=N.subarray()),f.set(c,u),u+=c.byteLength,d={size:c.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},A.push(d)}f.set(N,u);var K=N.byteLength;u+=K,d={size:K,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},A.push(d),g=j}var H=0,V=A.length;if(V>=2&&(H=A[V-2].duration,d.duration=H),V){this.nextAudioPts=R=g+y*H,e.len=0,e.samples=A,h=S?new Uint8Array:a.default.moof(e.sequenceNumber++,p/y,e),e.samples=[];var W=p/v,Y=R/v,q={data1:h,data2:f,startPTS:W,endPTS:Y,startDTS:W,endDTS:Y,type:"audio",hasAudio:!0,hasVideo:!1,nb:V};return this.observer.trigger(n.default.FRAG_PARSING_DATA,q),q}return null}},e.prototype.remuxEmptyAudio=function(e,t,r,a){var n=e.inputTimeScale,s=n/(e.samplerate?e.samplerate:n),l=this.nextAudioPts,u=(void 0!==l?l:a.startDTS*n)+this._initDTS,d=a.endDTS*n+this._initDTS,c=1024*s,f=Math.ceil((d-u)/c),h=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.logger.warn("remux empty Audio"),h){for(var p=[],g=0;g<f;g++){var v=u+g*c;p.push({unit:h,pts:v,dts:v}),e.len+=h.length}e.samples=p,this.remuxAudio(e,t,r)}else o.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},e.prototype.remuxID3=function(e){var t,r=e.samples.length,i=e.inputTimeScale,a=this._initPTS,s=this._initDTS;if(r){for(var o=0;o<r;o++)(t=e.samples[o]).pts=(t.pts-a)/i,t.dts=(t.dts-s)/i;this.observer.trigger(n.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},e.prototype.remuxText=function(e){e.samples.sort(function(e,t){return e.pts-t.pts});var t,r=e.samples.length,i=e.inputTimeScale,a=this._initPTS;if(r){for(var s=0;s<r;s++)(t=e.samples[s]).pts=(t.pts-a)/i;this.observer.trigger(n.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e.prototype._PTSNormalize=function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e},e}();t.default=l},"./src/remux/passthrough-remuxer.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/events.js"),a=function(){function e(e){this.observer=e}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(){},e.prototype.resetInitSegment=function(){},e.prototype.remux=function(e,t,r,a,n,s,o,l){var u=this.observer,d="";e&&(d+="audio"),t&&(d+="video"),u.trigger(i.default.FRAG_PARSING_DATA,{data1:l,startPTS:n,startDTS:n,type:d,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),u.trigger(i.default.FRAG_PARSED)},e}();t.default=a},"./src/task-loop.js":function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a=e.apply(this,[t].concat(r))||this;return a._tickInterval=null,a._tickTimer=null,a._tickCallCount=0,a._boundTick=a.tick.bind(a),a}return a(t,e),t.prototype.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.prototype.hasInterval=function(){return!!this._tickInterval},t.prototype.hasNextTick=function(){return!!this._tickTimer},t.prototype.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=setInterval(this._boundTick,e),!0)},t.prototype.clearInterval=function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.prototype.clearNextTick=function(){return!!this._tickTimer&&(clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.prototype.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},t.prototype.doTick=function(){},t}(r("./src/event-handler.js").default);t.default=n},"./src/utils/attr-list.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,a=function(){function t(e){for(var r in"string"==typeof e&&(e=t.parseAttrList(e)),e)e.hasOwnProperty(r)&&(this[r]=e[r])}return t.prototype.decimalInteger=function(t){var r=parseInt(this[t],10);return r>e.MAX_SAFE_INTEGER?1/0:r},t.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},t.prototype.hexadecimalIntegerAsNumber=function(t){var r=parseInt(this[t],16);return r>e.MAX_SAFE_INTEGER?1/0:r},t.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.prototype.enumeratedString=function(e){return this[e]},t.prototype.decimalResolution=function(e){var t=r.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},t.parseAttrList=function(e){var t,r={};for(i.lastIndex=0;null!==(t=i.exec(e));){var a=t[2];0===a.indexOf('"')&&a.lastIndexOf('"')===a.length-1&&(a=a.slice(1,-1)),r[t[1]]=a}return r},t}();t.default=a}).call(this,r("./src/polyfills/number.js").Number)},"./src/utils/binary-search.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={search:function(e,t){for(var r=0,i=e.length-1,a=null,n=null;r<=i;){var s=t(n=e[a=(r+i)/2|0]);if(s>0)r=a+1;else{if(!(s<0))return n;i=a-1}}return null}}},"./src/utils/buffer-helper.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}catch(a){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var i=e.buffered,a=[],n=void 0;for(n=0;n<i.length;n++)a.push({start:i.start(n),end:i.end(n)});return this.bufferedInfo(a,t,r)}}catch(s){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,r){var i,a,n,s,o,l=[];for(e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end}),o=0;o<e.length;o++){var u=l.length;if(u){var d=l[u-1].end;e[o].start-d<r?e[o].end>d&&(l[u-1].end=e[o].end):l.push(e[o])}else l.push(e[o])}for(o=0,i=0,a=n=t;o<l.length;o++){var c=l[o].start,f=l[o].end;if(t+r>=c&&t<f)a=c,i=(n=f)-t;else if(t+r<c){s=c;break}}return{len:i,start:a,end:n,nextStart:s}},e}();t.BufferHelper=i},"./src/utils/cea-608-parser.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},a=function(e){var t=e;return i.hasOwnProperty(e)&&(t=i[e]),String.fromCharCode(t)},n=15,s=100,o={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},l={17:2,18:4,21:6,22:8,23:10,19:13,20:15},u={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},d={25:2,26:4,29:6,30:8,31:10,27:13,28:15},c=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],f={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){this.verboseFilter[e];this.verboseLevel}},h=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},p=function(){function e(e,t,r,i,a){this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=i||"black",this.flash=a||!1}return e.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.prototype.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var i=t[r];e.hasOwnProperty(i)&&(this[i]=e[i])}},e.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.prototype.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},e.prototype.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},e.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),g=function(){function e(e,t,r,i,a,n){this.uchar=e||" ",this.penState=new p(t,r,i,a,n)}return e.prototype.reset=function(){this.uchar=" ",this.penState.reset()},e.prototype.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},e.prototype.setPenState=function(e){this.penState.copy(e)},e.prototype.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},e.prototype.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},e.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),v=function(){function e(){this.chars=[];for(var e=0;e<s;e++)this.chars.push(new g);this.pos=0,this.currPenState=new p}return e.prototype.equals=function(e){for(var t=!0,r=0;r<s;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<s;t++)this.chars[t].copy(e.chars[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<s;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},e.prototype.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(f.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>s&&(f.log("ERROR","Too large cursor position "+this.pos),this.pos=s)},e.prototype.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},e.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.prototype.insertChar=function(e){e>=144&&this.backSpace();var t=a(e);this.pos>=s?f.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},e.prototype.clearFromPos=function(e){var t;for(t=e;t<s;t++)this.chars[t].reset()},e.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.prototype.getTextString=function(){for(var e=[],t=!0,r=0;r<s;r++){var i=this.chars[r].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")},e.prototype.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),m=function(){function e(){this.rows=[];for(var e=0;e<n;e++)this.rows.push(new v);this.currRow=n-1,this.nrRollUpRows=null,this.reset()}return e.prototype.reset=function(){for(var e=0;e<n;e++)this.rows[e].clear();this.currRow=n-1},e.prototype.equals=function(e){for(var t=!0,r=0;r<n;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<n;t++)this.rows[t].copy(e.rows[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<n;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},e.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},e.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.prototype.insertChar=function(e){this.rows[this.currRow].insertChar(e)},e.prototype.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},e.prototype.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},e.prototype.setCursor=function(e){f.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},e.prototype.setPAC=function(e){f.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<n;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var s=a.rows[i].cueStartTime;if(s&&s<f.time)for(r=0;r<this.nrRollUpRows;r++)this.rows[t-this.nrRollUpRows+r+1].copy(a.rows[i+r])}}this.currRow=t;var o=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,u=Math.max(l-1,0);o.setCursor(e.indent),e.color=o.chars[u].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)},e.prototype.setBkgData=function(e){f.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},e.prototype.setRollUpRows=function(e){this.nrRollUpRows=e},e.prototype.rollUp=function(){if(null!==this.nrRollUpRows){f.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),f.log("INFO","Rolling up")}else f.log("DEBUG","roll_up but nrRollUpRows not set yet")},e.prototype.getDisplayText=function(e){e=e||!1;for(var t=[],r="",i=-1,a=0;a<n;a++){var s=this.rows[a].getTextString();s&&(i=a+1,e?t.push("Row "+i+": '"+s+"'"):t.push(s.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},e.prototype.getTextAndFormat=function(){return this.rows},e}(),y=function(){function e(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new m,this.nonDisplayedMemory=new m,this.lastOutputScreen=new m,this.currRollUpRow=this.displayedMemory.rows[n-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return e.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[n-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},e.prototype.getHandler=function(){return this.outputFilter},e.prototype.setHandler=function(e){this.outputFilter=e},e.prototype.setPAC=function(e){this.writeScreen.setPAC(e)},e.prototype.setBkgData=function(e){this.writeScreen.setBkgData(e)},e.prototype.setMode=function(e){e!==this.mode&&(this.mode=e,f.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},e.prototype.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";f.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(f.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.prototype.ccRCL=function(){f.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.prototype.ccBS=function(){f.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.prototype.ccAOF=function(){},e.prototype.ccAON=function(){},e.prototype.ccDER=function(){f.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.prototype.ccRU=function(e){f.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},e.prototype.ccFON=function(){f.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.prototype.ccRDC=function(){f.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.prototype.ccTR=function(){f.log("INFO","TR"),this.setMode("MODE_TEXT")},e.prototype.ccRTD=function(){f.log("INFO","RTD"),this.setMode("MODE_TEXT")},e.prototype.ccEDM=function(){f.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.prototype.ccCR=function(){f.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.prototype.ccENM=function(){f.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.prototype.ccEOC=function(){if(f.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,f.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.prototype.ccTO=function(e){f.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},e.prototype.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}f.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},e.prototype.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=f.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),!0===e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},e.prototype.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),E=function(){function e(e,t,r){this.field=e||1,this.outputs=[t,r],this.channels=[new y(1,t),new y(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return e.prototype.getHandler=function(e){return this.channels[e].getHandler()},e.prototype.setHandler=function(e,t){this.channels[e].setHandler(t)},e.prototype.addData=function(e,t){var r,i,a,n=!1;this.lastTime=e,f.setTime(e);for(var s=0;s<t.length;s+=2)if(i=127&t[s],a=127&t[s+1],0!==i||0!==a){if(f.log("DATA","["+h([t[s],t[s+1]])+"] -> ("+h([i,a])+")"),(r=this.parseCmd(i,a))||(r=this.parseMidrow(i,a)),r||(r=this.parsePAC(i,a)),r||(r=this.parseBackgroundAttributes(i,a)),!r)if(n=this.parseChars(i,a))if(this.currChNr&&this.currChNr>=0)this.channels[this.currChNr-1].insertChars(n);else f.log("WARNING","No channel found yet. TEXT-MODE?");r?this.dataCounters.cmd+=2:n?this.dataCounters.char+=2:(this.dataCounters.other+=2,f.log("WARNING","Couldn't parse cleaned data "+h([i,a])+" orig: "+h([t[s],t[s+1]])))}else this.dataCounters.padding+=2},e.prototype.parseCmd=function(e,t){var r=null;if(!((20===e||28===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,f.log("DEBUG","Repeated command ("+h([e,t])+") is dropped"),!0;r=20===e||23===e?1:2;var i=this.channels[r-1];return 20===e||28===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},e.prototype.parseMidrow=function(e,t){var r=null;return(17===e||25===e)&&t>=32&&t<=47&&((r=17===e?1:2)!==this.currChNr?(f.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[r-1].ccMIDROW(t),f.log("DEBUG","MIDROW ("+h([e,t])+")"),!0))},e.prototype.parsePAC=function(e,t){var r,i=null;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;r=e<=23?1:2,i=t>=64&&t<=95?1===r?o[e]:u[e]:1===r?l[e]:d[e];var a=this.interpretPAC(i,t);return this.channels[r-1].setPAC(a),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},e.prototype.interpretPAC=function(e,t){var r=t,i={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,i.underline=1==(1&r),r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((r-16)/2),i},e.prototype.parseChars=function(e,t){var r=null,i=null,n=null;if(e>=25?(r=2,n=e-8):(r=1,n=e),n>=17&&n<=19){var s=t;s=17===n?t+80:18===n?t+112:t+144,f.log("INFO","Special char '"+a(s)+"' in channel "+r),i=[s]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);if(i){var o=h(i);f.log("DEBUG","Char codes =  "+o.join(",")),this.lastCmdA=null,this.lastCmdB=null}return i},e.prototype.parseBackgroundAttributes=function(e,t){var r,i,a;return((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47)&&(r={},16===e||24===e?(i=Math.floor((t-32)/2),r.background=c[i],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),a=e<24?1:2,this.channels[a-1].setBkgData(r),this.lastCmdA=null,this.lastCmdB=null,!0)},e.prototype.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},e.prototype.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},e}();t.default=E},"./src/utils/codecs.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};t.isCodecType=function(e,t){var r=i[t];return!!r&&!0===r[e.slice(0,4)]},t.isCodecSupportedInMp4=function(e,t){return window.MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}},"./src/utils/cues.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/vttparser.js");t.newCue=function(e,t,r,a){for(var n,s,o,l,u,d=window.VTTCue||window.TextTrackCue,c=0;c<a.rows.length;c++)if(o=!0,l=0,u="",!(n=a.rows[c]).isEmpty()){for(var f=0;f<n.chars.length;f++)n.chars[f].uchar.match(/\s/)&&o?l++:(u+=n.chars[f].uchar,o=!1);n.cueStartTime=t,t===r&&(r+=1e-4),s=new d(t,r,i.fixLineBreaks(u.trim())),l>=16?l--:l++,navigator.userAgent.match(/Firefox\//)?s.line=c+1:s.line=c>7?c-2:c+1,s.align="left",s.position=Math.max(0,Math.min(100,l/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(s)}}},"./src/utils/discontinuities.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/binary-search.js"),a=r("./src/utils/logger.js");function n(e,t){for(var r=null,i=0;i<e.length;i+=1){var a=e[i];if(a&&a.cc===t){r=a;break}}return r}function s(e,t,r){var i=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(i=!0),i}function o(e,t){var r=e.fragments,i=t.fragments;if(i.length&&r.length){var s=n(r,i[0].cc);if(s&&(!s||s.startPTS))return s;a.logger.log("No frag in previous level to align on")}else a.logger.log("No fragments to align")}function l(e,t){t.fragments.forEach(function(t){if(t){var r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}}),t.PTSKnown=!0}function u(e,t,r){if(s(e,r,t)){var i=o(r.details,t);i&&(a.logger.log("Adjusting PTS using last level due to CC increase within current level"),l(i.start,t))}}function d(t,r){if(r&&r.fragments.length){if(!t.hasProgramDateTime||!r.hasProgramDateTime)return;var i=r.fragments[0].programDateTime,n=(t.fragments[0].programDateTime-i)/1e3+r.fragments[0].start;e.isFinite(n)&&(a.logger.log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3)),l(n,t))}}t.findFirstFragWithCC=n,t.findFragWithCC=function(e,t){return i.default.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})},t.shouldAlignOnDiscontinuities=s,t.findDiscontinuousReferenceFrag=o,t.adjustPts=l,t.alignStream=function(e,t,r){u(e,r,t),!r.PTSKnown&&t&&d(r,t.details)},t.alignDiscontinuities=u,t.alignPDT=d}).call(this,r("./src/polyfills/number.js").Number)},"./src/utils/ewma-bandwidth-estimator.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/ewma.js"),a=function(){function e(e,t,r,a){this.hls=e,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new i.default(t),this.fast_=new i.default(r)}return e.prototype.sample=function(e,t){var r=8e3*t/(e=Math.max(e,this.minDelayMs_)),i=e/1e3;this.fast_.sample(i,r),this.slow_.sample(i,r)},e.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},e.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.prototype.destroy=function(){},e}();t.default=a},"./src/utils/ewma.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}return e.prototype.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},e.prototype.getTotalWeight=function(){return this.totalWeight_},e.prototype.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}();t.default=i},"./src/utils/get-self-scope.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelfScope=function(){return"undefined"==typeof window?self:window}},"./src/utils/logger.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/get-self-scope.js");function a(){}var n={trace:a,debug:a,log:a,warn:a,info:a,error:a},s=n;var o=i.getSelfScope();function l(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t.forEach(function(t){s[t]=e[t]?e[t].bind(e):function(e){var t=o.console[e];return t?function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r[0]&&(r[0]=function(e,t){return t="["+e+"] > "+t}(e,r[0])),t.apply(o.console,r)}:a}(t)})}t.enableLogs=function(e){if(!0===e||"object"==typeof e){l(e,"debug","log","info","warn","error");try{s.log()}catch(t){s=n}}else s=n},t.logger=s},"./src/utils/mediakeys-helper.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;t.requestMediaKeySystemAccess=i},"./src/utils/mediasource-helper.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaSource=function(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}},"./src/utils/output-filter.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}return e.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},e.prototype.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},e}();t.default=i},"./src/utils/texttrack-utils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendAddTrackEvent=function(e,t){var r=null;try{r=new window.Event("addtrack")}catch(i){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)},t.clearCurrentCues=function(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}},"./src/utils/time-ranges.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={toString:function(e){for(var t="",r=e.length,i=0;i<r;i++)t+="["+e.start(i).toFixed(3)+","+e.end(i).toFixed(3)+"]";return t}}},"./src/utils/vttcue.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e="auto",t={"":!0,lr:!0,rl:!0},r={start:!0,middle:!0,end:!0,left:!0,right:!0};function i(e){return"string"==typeof e&&(!!r[e.toLowerCase()]&&e.toLowerCase())}function a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]=r[i]}return e}function n(r,n,s){var o=this,l=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),u={};l?o=document.createElement("custom"):u.enumerable=!0,o.hasBeenReset=!1;var d="",c=!1,f=r,h=n,p=s,g=null,v="",m=!0,y="auto",E="start",_=50,T="middle",S=50,b="middle";if(Object.defineProperty(o,"id",a({},u,{get:function(){return d},set:function(e){d=""+e}})),Object.defineProperty(o,"pauseOnExit",a({},u,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(o,"startTime",a({},u,{get:function(){return f},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",a({},u,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",a({},u,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",a({},u,{get:function(){return g},set:function(e){g=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",a({},u,{get:function(){return v},set:function(e){var r=function(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");v=r,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",a({},u,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",a({},u,{get:function(){return y},set:function(t){if("number"!=typeof t&&t!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",a({},u,{get:function(){return E},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",a({},u,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",a({},u,{get:function(){return T},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");T=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",a({},u,{get:function(){return S},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");S=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",a({},u,{get:function(){return b},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),o.displayState=void 0,l)return o}return n.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},n}()},"./src/utils/vttparser.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/vttcue.js"),a=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function n(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new a,this.regionList=[]}function s(){this.values=Object.create(null)}function o(e,t,r,i){var a=i?e.split(i):[e];for(var n in a)if("string"==typeof a[n]){var s=a[n].split(r);if(2===s.length)t(s[0],s[1])}}s.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var l=new i.default(0,0,0),u="middle"===l.align?"middle":"center";function d(e,t,r){var i=e;function a(){var t=function(e){function t(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+(0|i)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function n(){e=e.replace(/^\s+/,"")}if(n(),t.startTime=a(),n(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.substr(3),n(),t.endTime=a(),n(),function(e,t){var i=new s;o(e,function(e,t){switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){i.set(e,r[a].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var n=t.split(","),s=n[0];i.integer(e,s),i.percent(e,s)&&i.set("snapToLines",!1),i.alt(e,s,["auto"]),2===n.length&&i.alt("lineAlign",n[1],["start",u,"end"]);break;case"position":n=t.split(","),i.percent(e,n[0]),2===n.length&&i.alt("positionAlign",n[1],["start",u,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",u,"end","left","right"])}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");var a=i.get("line","auto");"auto"===a&&-1===l.line&&(a=-1),t.line=a,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",u);var n=i.get("position","auto");"auto"===n&&50===l.position&&(n="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=n}(e,t)}function c(e){return e.replace(/<br(?: \/)?>/gi,"\n")}t.fixLineBreaks=c,n.prototype={parse:function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=c(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var i=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),i}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var a=void 0;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var n=(a=r()).match(/^(Ã¯Â»Â¿)?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var s=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:a=r(),t.state){case"HEADER":/:/.test(a)?o(a,function(e,t){},/:/):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new i.default(0,0,""),t.state="CUE",-1===a.indexOf("--\x3e")){t.cue.id=a;continue}case"CUE":try{d(a,t.cue,t.regionList)}catch(u){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var l=-1!==a.indexOf("--\x3e");if(!a||l&&(s=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=a;continue;case"BADCUE":a||(t.state="ID");continue}}}catch(u){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}},t.default=n},"./src/utils/webvtt-parser.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/vttparser.js"),a=r("./src/demux/id3.js"),n=function(e,t,r){return e.substr(r||0,t.length)===t},s=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()},o={parse:function(t,r,o,l,u,d){var c,f=a.utf8ArrayToStr(new Uint8Array(t)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),h="00:00.000",p=0,g=0,v=0,m=[],y=!0,E=new i.default;E.oncue=function(e){var t=o[l],r=o.ccOffset;t&&t.new&&(void 0!==g?r=o.ccOffset=t.start:function(e,t,r){var i=e[t],a=e[i.prevCC];if(!a||!a.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;a&&a.new;)e.ccOffset+=i.start-a.start,i.new=!1,a=e[(i=a).prevCC];e.presentationOffset=r}(o,l,v)),v&&(r=v-o.presentationOffset),e.startTime+=r-g,e.endTime+=r-g,e.id=s(e.startTime.toString())+s(e.endTime.toString())+s(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&m.push(e)},E.onparsingerror=function(e){c=e},E.onflush=function(){c&&d?d(c):u(m)},f.forEach(function(t){if(y){if(n(t,"X-TIMESTAMP-MAP=")){y=!1,t.substr(16).split(",").forEach(function(e){n(e,"LOCAL:")?h=e.substr(6):n(e,"MPEGTS:")&&(p=parseInt(e.substr(7)))});try{r+(9e4*o[l].start||0)<0&&(r+=8589934592),p-=r,i=h,a=parseInt(i.substr(-3)),s=parseInt(i.substr(-6,2)),u=parseInt(i.substr(-9,2)),d=i.length>9?parseInt(i.substr(0,i.indexOf(":"))):0,g=(e.isFinite(a)&&e.isFinite(s)&&e.isFinite(u)&&e.isFinite(d)?(a+=1e3*s,a+=6e4*u,a+=36e5*d):-1)/1e3,v=p/9e4,-1===g&&(c=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(f){c=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(y=!1)}var i,a,s,u,d;E.parse(t+"\n")}),E.flush()}};t.default=o}).call(this,r("./src/polyfills/number.js").Number)},"./src/utils/xhr-loader.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),a=window.performance,n=window.XMLHttpRequest,s=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}return e.prototype.destroy=function(){this.abort(),this.loader=null},e.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:a.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},e.prototype.loadInternal=function(){var e,t=this.context;e=this.loader=new n;var r=this.stats;r.tfirst=0,r.loaded=0;var i=this.xhrSetup;try{if(i)try{i(e,t.url)}catch(a){e.open("GET",t.url,!0),i(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(a){return void this.callbacks.onError({code:e.status,text:a.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},e.prototype.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,n=this.stats,s=this.context,o=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(a.now(),n.trequest)),4===r){var l=t.status;if(l>=200&&l<300){n.tload=Math.max(n.tfirst,a.now());var u=void 0,d=void 0;d="arraybuffer"===s.responseType?(u=t.response).byteLength:(u=t.responseText).length,n.loaded=n.total=d;var c={url:t.responseURL,data:u};this.callbacks.onSuccess(c,n,s,t)}else n.retry>=o.maxRetry||l>=400&&l<499?(i.logger.error(l+" while loading "+s.url),this.callbacks.onError({code:l,text:t.statusText},s,t)):(i.logger.warn(l+" while loading "+s.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)},e.prototype.loadtimeout=function(){i.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.prototype.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var i=this.callbacks.onProgress;i&&i(r,this.context,null,t)},e}();t.default=s}}).default});
},{}],"K5S2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HlsPlayer=void 0;var e=a(require("@babel/runtime/helpers/classCallCheck")),t=a(require("@babel/runtime/helpers/createClass")),r=a(require("@babel/runtime/helpers/inherits")),n=a(require("@babel/runtime/helpers/possibleConstructorReturn")),i=a(require("@babel/runtime/helpers/getPrototypeOf")),u=require("./interface"),l=a(require("hls.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var t,r=(0,i.default)(e);if(o()){var u=(0,i.default)(this).constructor;t=Reflect.construct(r,arguments,u)}else t=r.apply(this,arguments);return(0,n.default)(this,t)}}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var c=function(n){(0,r.default)(u,n);var i=s(u);function u(t,r){return(0,e.default)(this,u),i.call(this,t,r)}return(0,t.default)(u,[{key:"load",value:function(){var e=this;return new Promise(function(t){var r=new l.default;l.default.isSupported?(r.attachMedia(e.videoElement_),r.on(l.default.Events.MEDIA_ATTACHED,function(){r.loadSource(e.manifestUrl_)}),r.on(l.default.Events.MANIFEST_PARSED,function(){}),r.on(l.default.Events.LEVEL_LOADED,function(r,n){e.isLive_=n.details.live,t()}),e.hls_=r):e.videoElement_.canPlayType("application/vnd.apple.mpegurl")&&(e.videoElement_.src=e.manifestUrl_,t())})}},{key:"isLive",get:function(){return this.hls_?this.isLive_:isNaN(this.videoElement_.duration)}}]),u}(u.PlayerTechInterface);exports.HlsPlayer=c;
},{"@babel/runtime/helpers/classCallCheck":"ZBnv","@babel/runtime/helpers/createClass":"NoOd","@babel/runtime/helpers/inherits":"qngw","@babel/runtime/helpers/possibleConstructorReturn":"GFCP","@babel/runtime/helpers/getPrototypeOf":"WQgz","./interface":"Sxab","hls.js":"LbLF"}],"wZ93":[function(require,module,exports) {
var global = arguments[3];
var define;
var t,e=arguments[3];!function(){var n="undefined"!=typeof window?window:e,r={};if(function(t,e){var n,r="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},a=void 0!==t&&t===this?this:void 0!==e&&null!=e?e:this;function o(){o=function(){},a.Symbol||(a.Symbol=u)}var s,u=(s=0,function(t){return"jscomp_symbol_"+(t||"")+s++});function c(){o();var t=a.Symbol.iterator;t||(t=a.Symbol.iterator=a.Symbol("iterator")),"function"!=typeof Array.prototype[t]&&r(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return l(this)}}),c=function(){}}function l(t){var e=0;return f(function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}})}function f(t){return c(),(t={next:t})[a.Symbol.iterator]=function(){return this},t}function h(t){c();var e=t[Symbol.iterator];return e?e.call(t):l(t)}function d(t,e){if(e){for(var n=a,i=t.split("."),o=0;o<i.length-1;o++){var s=i[o];s in n||(n[s]={}),n=n[s]}(s=e(o=n[i=i[i.length-1]]))!=o&&null!=s&&r(n,i,{configurable:!0,writable:!0,value:s})}}function p(t){return function(t){function e(e){return t.next(e)}function n(e){return t.throw(e)}return new Promise(function(r,i){!function t(a){a.done?r(a.value):Promise.resolve(a.value).then(e,n).then(t,i)}(t.next())})}(t())}d("Promise",function(t){function e(t){this.b=0,this.g=void 0,this.a=[];var e=this.c();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;n.prototype.b=function(t){null==this.a&&(this.a=[],this.f()),this.a.push(t)},n.prototype.f=function(){var t=this;this.c(function(){t.h()})};var i=a.setTimeout;n.prototype.c=function(t){i(t,0)},n.prototype.h=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.g(r)}}}this.a=null},n.prototype.g=function(t){this.c(function(){throw t})},e.prototype.c=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.s),reject:t(this.f)}},e.prototype.s=function(t){if(t===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.v(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.m(t):this.h(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(n){return void this.f(n)}"function"==typeof e?this.B(e,t):this.h(t)},e.prototype.f=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.g=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)o.b(this.a[t]);this.a=null}};var o=new n;return e.prototype.v=function(t){var e=this.c();t.ac(e.resolve,e.reject)},e.prototype.B=function(t,e){var n=this.c();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(n){a(n)}}:e}var i,a,o=new e(function(t,e){i=t,a=e});return this.ac(r(t,i),r(n,a)),o},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.ac=function(t,e){function n(){switch(r.b){case 1:t(r.g);break;case 2:e(r.g);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?o.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=h(t),a=i.next();!a.done;a=i.next())r(a.value).ac(e,n)})},e.all=function(t){var n=h(t),i=n.next();return i.done?r([]):new e(function(t,e){function a(e){return function(n){o[e]=n,0==--s&&t(o)}}var o=[],s=0;do{o.push(void 0),s++,r(i.value).ac(a(o.length-1),e),i=n.next()}while(!i.done)})},e}),d("Promise.prototype.finally",function(t){return t||function(t){return this.then(function(e){return Promise.resolve(t()).then(function(){return e})},function(e){return Promise.resolve(t()).then(function(){throw e})})}});var m,v="function"==typeof Object.create?Object.create:function(t){function e(){}return e.prototype=t,new e};if("function"==typeof Object.setPrototypeOf)m=Object.setPrototypeOf;else{var y;t:{var g={};try{g.__proto__={pe:!0},y=g.pe;break t}catch(s){}y=!1}m=y?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var b=m;function w(){this.g=!1,this.c=null,this.o=void 0,this.j=1,this.b=this.f=0,this.i=this.a=null}function T(t){if(t.g)throw new TypeError("Generator is already running");t.g=!0}function E(t,e){t.a={Cd:e,Jd:!0},t.j=t.f||t.b}function S(t,e,n){return t.j=n,{value:e}}function x(t){t.j=0}function k(t,e,n){t.f=e,null!=n&&(t.b=n)}function A(t,e){t.f=0,t.b=e||0}function I(t,e){t.j=e,t.f=0}function M(t){t.f=0;var e=t.a.Cd;return t.a=null,e}function N(t){t.i=[t.a],t.f=0,t.b=0}function P(t,e){var n=t.i.splice(0)[0];(n=t.a=t.a||n)?n.Jd?t.j=t.f||t.b:null!=n.A&&t.b<n.A?(t.j=n.A,t.a=null):t.j=t.b:t.j=e}function C(t){this.a=new w,this.b=t}function R(t,e,n,r){try{var i=e.call(t.a.c,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return t.a.g=!1,i;var a=i.value}catch(o){return t.a.c=null,E(t.a,o),D(t)}return t.a.c=null,r.call(t.a,a),D(t)}function D(t){for(;t.a.j;)try{var e=t.b(t.a);if(e)return t.a.g=!1,{value:e.value,done:!1}}catch(n){t.a.o=void 0,E(t.a,n)}if(t.a.g=!1,t.a.a){if(e=t.a.a,t.a.a=null,e.Jd)throw e.Cd;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function _(t){this.next=function(e){return T(t.a),t.a.c?e=R(t,t.a.c.next,e,t.a.h):(t.a.h(e),e=D(t)),e},this.throw=function(e){return T(t.a),t.a.c?e=R(t,t.a.c.throw,e,t.a.h):(E(t.a,e),e=D(t)),e},this.return=function(e){return function(t,e){T(t.a);var n=t.a.c;return n?R(t,"return"in n?n.return:function(t){return{value:t,done:!0}},e,t.a.return):(t.a.return(e),D(t))}(t,e)},c(),this[Symbol.iterator]=function(){return this}}function L(t,e){return _.prototype=t.prototype,new _(new C(e))}function U(t){if(!(t instanceof Array)){t=h(t);for(var e,n=[];!(e=t.next()).done;)n.push(e.value);t=n}return t}function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function j(t,e,n){t instanceof String&&(t=String(t));for(var r=t.length,i=0;i<r;i++){var a=t[i];if(e.call(n,a,i,t))return{Gd:i,ke:a}}return{Gd:-1,ke:void 0}}function B(t,e,n){if(null==t)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return t+""}w.prototype.h=function(t){this.o=t},w.prototype.return=function(t){this.a={return:t},this.j=this.b},w.prototype.A=function(t){this.j=t},d("WeakMap",function(t){function e(t){if(this.a=(s+=Math.random()+1).toString(),t){o(),c(),t=h(t);for(var e;!(e=t.next()).done;)e=e.value,this.set(e[0],e[1])}}function n(t){O(t,a)||r(t,a,{value:{}})}function i(t){var e=Object[t];e&&(Object[t]=function(t){return n(t),e(t)})}if(function(){if(!t||!Object.seal)return!1;try{var e=Object.seal({}),n=Object.seal({}),r=new t([[e,2],[n,3]]);return 2==r.get(e)&&3==r.get(n)&&(r.delete(e),r.set(n,4),!r.has(e)&&4==r.get(n))}catch(i){return!1}}())return t;var a="$jscomp_hidden_"+Math.random();i("freeze"),i("preventExtensions"),i("seal");var s=0;return e.prototype.set=function(t,e){if(n(t),!O(t,a))throw Error("WeakMap key fail: "+t);return t[a][this.a]=e,this},e.prototype.get=function(t){return O(t,a)?t[a][this.a]:void 0},e.prototype.has=function(t){return O(t,a)&&O(t[a],this.a)},e.prototype.delete=function(t){return!(!O(t,a)||!O(t[a],this.a))&&delete t[a][this.a]},e}),d("Map",function(t){function e(){var t={};return t.Ea=t.next=t.head=t}function n(t,e){var n=t.a;return f(function(){if(n){for(;n.head!=t.a;)n=n.Ea;for(;n.next!=n.head;)return n=n.next,{done:!1,value:e(n)};n=null}return{done:!0,value:void 0}})}function r(t,e){var n=e&&typeof e;"object"==n||"function"==n?a.has(e)?n=a.get(e):(n=""+ ++s,a.set(e,n)):n="p_"+e;var r=t.b[n];if(r&&O(t.b,n))for(var i=0;i<r.length;i++){var o=r[i];if(e!=e&&o.key!=o.key||e===o.key)return{id:n,list:r,index:i,X:o}}return{id:n,list:r,index:-1,X:void 0}}function i(t){if(this.b={},this.a=e(),this.size=0,t){t=h(t);for(var n;!(n=t.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!t||"function"!=typeof t||!t.prototype.entries||"function"!=typeof Object.seal)return!1;try{var e=Object.seal({x:4}),n=new t(h([[e,"s"]]));if("s"!=n.get(e)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==e&&"s"==i.value[1]&&!((i=r.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!r.next().done)}catch(a){return!1}}())return t;o(),c();var a=new WeakMap;i.prototype.set=function(t,e){var n=r(this,t);return n.list||(n.list=this.b[n.id]=[]),n.X?n.X.value=e:(n.X={next:this.a,Ea:this.a.Ea,head:this.a,key:t,value:e},n.list.push(n.X),this.a.Ea.next=n.X,this.a.Ea=n.X,this.size++),this},i.prototype.delete=function(t){return!(!(t=r(this,t)).X||!t.list)&&(t.list.splice(t.index,1),t.list.length||delete this.b[t.id],t.X.Ea.next=t.X.next,t.X.next.Ea=t.X.Ea,t.X.head=null,this.size--,!0)},i.prototype.clear=function(){this.b={},this.a=this.a.Ea=e(),this.size=0},i.prototype.has=function(t){return!!r(this,t).X},i.prototype.get=function(t){return(t=r(this,t).X)&&t.value},i.prototype.entries=function(){return n(this,function(t){return[t.key,t.value]})},i.prototype.keys=function(){return n(this,function(t){return t.key})},i.prototype.values=function(){return n(this,function(t){return t.value})},i.prototype.forEach=function(t,e){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,t.call(e,n[1],n[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var s=0;return i}),d("Set",function(t){function e(t){if(this.a=new Map,t){t=h(t);for(var e;!(e=t.next()).done;)this.add(e.value)}this.size=this.a.size}return function(){if(!t||"function"!=typeof t||!t.prototype.entries||"function"!=typeof Object.seal)return!1;try{var e=Object.seal({x:4}),n=new t(h([e]));if(!n.has(e)||1!=n.size||n.add(e)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==e&&i.value[1]==e&&(!(i=r.next()).done&&i.value[0]!=e&&4==i.value[0].x&&i.value[1]==i.value[0]&&r.next().done)}catch(a){return!1}}()?t:(o(),c(),e.prototype.add=function(t){return this.a.set(t,t),this.size=this.a.size,this},e.prototype.delete=function(t){return t=this.a.delete(t),this.size=this.a.size,t},e.prototype.clear=function(){this.a.clear(),this.size=0},e.prototype.has=function(t){return this.a.has(t)},e.prototype.entries=function(){return this.a.entries()},e.prototype.values=function(){return this.a.values()},e.prototype.keys=e.prototype.values,e.prototype[Symbol.iterator]=e.prototype.values,e.prototype.forEach=function(t,e){var n=this;this.a.forEach(function(r){return t.call(e,r,r,n)})},e)}),d("Array.prototype.findIndex",function(t){return t||function(t,e){return j(this,t,e).Gd}}),d("Array.prototype.keys",function(t){return t||function(){return function(t,e){c(),t instanceof String&&(t+="");var n=0,r={next:function(){if(n<t.length){var i=n++;return{value:e(i,t[i]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r}(this,function(t){return t})}}),d("Object.is",function(t){return t||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}}),d("Array.prototype.includes",function(t){return t||function(t,e){var n=this;n instanceof String&&(n=String(n));var r=n.length,i=e||0;for(0>i&&(i=Math.max(i+r,0));i<r;i++){var a=n[i];if(a===t||Object.is(a,t))return!0}return!1}}),d("String.prototype.includes",function(t){return t||function(t,e){return-1!==B(this,t,"includes").indexOf(t,e||0)}}),d("Array.from",function(t){return t||function(t,e,n){c(),e=null!=e?e:function(t){return t};var r=[],i=t[Symbol.iterator];if("function"==typeof i)for(t=i.call(t);!(i=t.next()).done;)r.push(e.call(n,i.value));else{i=t.length;for(var a=0;a<i;a++)r.push(e.call(n,t[a]))}return r}}),d("String.prototype.startsWith",function(t){return t||function(t,e){for(var n=B(this,t,"startsWith"),r=n.length,i=t.length,a=Math.max(0,Math.min(0|e,n.length)),o=0;o<i&&a<r;)if(n[a++]!=t[o++])return!1;return o>=i}}),d("Array.prototype.find",function(t){return t||function(t,e){return j(this,t,e).ke}});var F=this;function K(t,e){var n,r=t.split("."),i=F;r[0]in i||!i.execScript||i.execScript("var "+r[0]);for(;r.length&&(n=r.shift());)r.length||void 0===e?i=i[n]?i[n]:i[n]={}:i[n]=e}function V(t,e){function n(){}n.prototype=e.prototype,t.dg=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.qg=function(t,n,r){return e.prototype[n].apply(t,Array.prototype.slice.call(arguments,2))}}function H(t){this.c=Math.exp(Math.log(.5)/t),this.b=this.a=0}function z(t,e,n){var r=Math.pow(t.c,e);n=n*(1-r)+r*t.a,isNaN(n)||(t.a=n,t.b+=e)}function q(t){return t.a/(1-Math.pow(t.c,t.b))}function G(){this.b=new H(2),this.c=new H(5),this.a=0}function X(){}function Y(){}function W(){}F.a=!0,G.prototype.getBandwidthEstimate=function(t){return 128e3>this.a?t:Math.min(q(this.b),q(this.c))},t.console&&t.console.log.bind&&(Y=console.warn.bind(console),X=console.error.bind(console));var $=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function J(t){var e;t instanceof J?(Q(this,t.va),this.bb=t.bb,this.ra=t.ra,Z(this,t.zb),this.ja=t.ja,tt(this,t.a.clone()),this.Sa=t.Sa):t&&(e=String(t).match($))?(Q(this,e[1]||"",!0),this.bb=et(e[2]||""),this.ra=et(e[3]||"",!0),Z(this,e[4]),this.ja=et(e[5]||"",!0),tt(this,e[6]||"",!0),this.Sa=et(e[7]||"")):this.a=new ct(null)}function Q(t,e,n){t.va=n?et(e,!0):e,t.va&&(t.va=t.va.replace(/:$/,""))}function Z(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.zb=e}else t.zb=null}function tt(t,e,n){e instanceof ct?t.a=e:(n||(e=nt(e,st)),t.a=new ct(e))}function et(t,e){return t?e?decodeURI(t):decodeURIComponent(t):""}function nt(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rt),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rt(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}(n=J.prototype).va="",n.bb="",n.ra="",n.zb=null,n.ja="",n.Sa="",n.toString=function(){var t=[],e=this.va;if(e&&t.push(nt(e,it,!0),":"),e=this.ra){t.push("//");var n=this.bb;n&&t.push(nt(n,it,!0),"@"),t.push(encodeURIComponent(e).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.zb)&&t.push(":",String(e))}return(e=this.ja)&&(this.ra&&"/"!=e.charAt(0)&&t.push("/"),t.push(nt(e,"/"==e.charAt(0)?ot:at,!0))),(e=this.a.toString())&&t.push("?",e),(e=this.Sa)&&t.push("#",nt(e,ut)),t.join("")},n.resolve=function(t){var e=this.clone();"data"===e.va&&(e=new J);var n=!!t.va;n?Q(e,t.va):n=!!t.bb,n?e.bb=t.bb:n=!!t.ra,n?e.ra=t.ra:n=null!=t.zb;var r=t.ja;if(n)Z(e,t.zb);else if(n=!!t.ja){if("/"!=r.charAt(0))if(this.ra&&!this.ja)r="/"+r;else{var i=e.ja.lastIndexOf("/");-1!=i&&(r=e.ja.substr(0,i+1)+r)}if(".."==r||"."==r)r="";else if(-1!=r.indexOf("./")||-1!=r.indexOf("/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var a=[],o=0;o<r.length;){var s=r[o++];"."==s?i&&o==r.length&&a.push(""):".."==s?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),i&&o==r.length&&a.push("")):(a.push(s),i=!0)}r=a.join("/")}}return n?e.ja=r:n=""!==t.a.toString(),n?tt(e,t.a.clone()):n=!!t.Sa,n&&(e.Sa=t.Sa),e},n.clone=function(){return new J(this)};var it=/[#\/\?@]/g,at=/[#\?:]/g,ot=/[#\?]/g,st=/[#\?@]/g,ut=/#/g;function ct(t){this.a=t||null}function lt(t){this.b=t,this.a=null}function ft(t){this.b=t,this.a=null}function ht(t,e){var n={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0};this.i=null==t.maxAttempts?n.maxAttempts:t.maxAttempts,this.f=null==t.baseDelay?n.baseDelay:t.baseDelay,this.h=null==t.fuzzFactor?n.fuzzFactor:t.fuzzFactor,this.g=null==t.backoffFactor?n.backoffFactor:t.backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==e&&e)&&(this.a=1)}function dt(t){return p(function e(){var n,r;return L(e,function(e){switch(e.j){case 1:if(t.a>=t.i){if(!t.c)return e.return(Promise.reject());t.a=1,t.b=t.f}return n=t.a,t.a++,0==n?e.return():(r=t.b*(1+(2*Math.random()-1)*t.h),S(e,new Promise(function(t){new ft(t).P(r/1e3)}),2));case 2:t.b*=t.g,x(e)}})})}function pt(t,e,n,r){for(var i=[],a=3;a<arguments.length;++a)i[a-3]=arguments[a];this.severity=t,this.category=e,this.code=n,this.data=i,this.handled=!1}function mt(){var t,e,n=new Promise(function(n,r){t=n,e=r});return n.resolve=t,n.reject=e,n}function vt(t,e){this.promise=t,this.Md=e,this.a=!1}function yt(t){return new vt(Promise.reject(t),function(){return Promise.resolve()})}function gt(){var t=Promise.reject(new pt(2,7,7001));return t.catch(function(){}),new vt(t,function(){return Promise.resolve()})}function bt(t){return new vt(Promise.resolve(t),function(){return Promise.resolve()})}function wt(t){return new vt(t,function(){return t.catch(function(){})})}function Tt(t){return new vt(Promise.all(t.map(function(t){return t.promise})),function(){return Promise.all(t.map(function(t){return t.abort()}))})}function Et(t,e,n){try{var r=t(e);return r&&r.promise&&r.abort?(n.resolve(r.promise),function(){return r.abort()}):(n.resolve(r),function(){return Promise.resolve(r).then(function(){}).catch(function(){})})}catch(i){return n.reject(i),function(){return Promise.resolve()}}}function St(e,n){for(var r in n=void 0===n?{}:n)this[r]=n[r];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=t.performance&&t.performance.now?t.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function xt(){this.a={}}function kt(){this.Fc=new xt,this.Yb=this}function At(t){var e=new Set;return function t(n){switch(typeof n){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;default:if(!n||n.buffer&&n.buffer.constructor==ArrayBuffer)return n;if(e.has(n))return null;var r=n.constructor==Array;if(n.constructor!=Object&&!r)return null;e.add(n);var i,a=r?[]:{};for(i in n)a[i]=t(n[i]);return r&&(a.length=n.length),a}}(t)}function It(t,e){return!("number"!=typeof t||"number"!=typeof e||!isNaN(t)||!isNaN(e))||t===e}function Mt(t,e){var n=t.indexOf(e);-1<n&&t.splice(n,1)}function Nt(t,e,n){if(n||(n=It),t.length!=e.length)return!1;e=e.slice();for(var r={},i=(t=h(t)).next();!i.done;r={item:r.item},i=t.next()){if(r.item=i.value,-1==(i=e.findIndex(function(t){return function(e){return n(t.item,e)}}(r))))return!1;e[i]=e[e.length-1],e.pop()}return 0==e.length}function Pt(){this.a=[]}function Ct(t,e){t.a.push(e.finally(function(){Mt(t.a,e)}))}function Rt(t){kt.call(this),this.f=!1,this.g=new Pt,this.a=new Set,this.b=new Set,this.c=t||null}(n=ct.prototype).ha=null,n.cc=null,n.add=function(t,e){if(!this.ha&&(this.ha={},this.cc=0,this.a))for(var n=this.a.split("&"),r=0;r<n.length;r++){var i=n[r].indexOf("="),a=null;if(0<=i){var o=n[r].substring(0,i);a=n[r].substring(i+1)}else o=n[r];o=decodeURIComponent(o.replace(/\+/g," ")),a=a||"",this.add(o,decodeURIComponent(a.replace(/\+/g," ")))}return this.a=null,(n=this.ha.hasOwnProperty(t)&&this.ha[t])||(this.ha[t]=n=[]),n.push(e),this.cc++,this},n.toString=function(){if(this.a)return this.a;if(!this.ha)return"";var t,e=[];for(t in this.ha)for(var n=encodeURIComponent(t),r=this.ha[t],i=0;i<r.length;i++){var a=n;""!==r[i]&&(a+="="+encodeURIComponent(r[i])),e.push(a)}return this.a=e.join("&")},n.clone=function(){var t=new ct;if(t.a=this.a,this.ha){var e,n={};for(e in this.ha)n[e]=this.ha[e].concat();t.ha=n,t.cc=this.cc}return t},lt.prototype.P=function(e){var n=this;this.stop();var r=!0,i=null;return this.a=function(){t.clearTimeout(i),r=!1},i=t.setTimeout(function(){r&&n.b()},1e3*e),this},lt.prototype.stop=function(){this.a&&(this.a(),this.a=null)},K("shaka.util.Timer",ft),ft.prototype.uc=function(){return this.stop(),this.b(),this},ft.prototype.tickNow=ft.prototype.uc,ft.prototype.P=function(t){var e=this;return this.stop(),this.a=new lt(function(){e.b()}).P(t),this},ft.prototype.tickAfter=ft.prototype.P,ft.prototype.Na=function(t){var e=this;return this.stop(),this.a=new lt(function(){e.a.P(t),e.b()}).P(t),this},ft.prototype.tickEvery=ft.prototype.Na,ft.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},ft.prototype.stop=ft.prototype.stop,K("shaka.util.Error",pt),pt.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},pt.Severity={RECOVERABLE:1,CRITICAL:2},pt.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},pt.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,CAST_RECEIVER_APP_ID_MISSING:8007,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013},mt.prototype.resolve=function(){},mt.prototype.reject=function(){},K("shaka.util.AbortableOperation",vt),vt.failed=yt,vt.aborted=gt,vt.completed=bt,vt.notAbortable=wt,vt.prototype.abort=function(){return this.a=!0,this.Md()},vt.prototype.abort=vt.prototype.abort,vt.all=Tt,vt.prototype.finally=function(t){return this.promise.then(function(){return t(!0)},function(){return t(!1)}),this},vt.prototype.finally=vt.prototype.finally,vt.prototype.U=function(t,e){function n(){return i.reject(new pt(2,7,7001)),r.abort()}var r=this,i=new mt;return this.promise.then(function(e){r.a?i.reject(new pt(2,7,7001)):t?n=Et(t,e,i):i.resolve(e)},function(t){e?n=Et(e,t,i):i.reject(t)}),new vt(i,function(){return n()})},vt.prototype.chain=vt.prototype.U,St.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},St.prototype.stopImmediatePropagation=function(){this.a=!0},St.prototype.stopPropagation=function(){},(n=xt.prototype).push=function(t,e){this.a.hasOwnProperty(t)?this.a[t].push(e):this.a[t]=[e]},n.get=function(t){return(t=this.a[t])?t.slice():null},n.getAll=function(){var t,e=[];for(t in this.a)e.push.apply(e,this.a[t]);return e},n.remove=function(t,e){var n=this.a[t];if(n)for(var r=0;r<n.length;++r)n[r]==e&&(n.splice(r,1),--r)},n.forEach=function(t){for(var e in this.a)t(e,this.a[e])},kt.prototype.addEventListener=function(t,e){this.Fc.push(t,e)},kt.prototype.removeEventListener=function(t,e){this.Fc.remove(t,e)},kt.prototype.dispatchEvent=function(t){for(var e=this.Fc.get(t.type)||[],n=0;n<e.length;++n){t.target=this.Yb,t.currentTarget=this.Yb;var r=e[n];try{r.handleEvent?r.handleEvent(t):r.call(this,t)}catch(i){}if(t.a)break}return t.defaultPrevented},Pt.prototype.destroy=function(){var t=[];return this.a.forEach(function(e){e.promise.catch(function(){}),t.push(e.abort())}),this.a=[],Promise.all(t)},V(Rt,kt),K("shaka.net.NetworkingEngine",Rt),Rt.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},Rt.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Dt={};function _t(t,e,n){n=n||3;var r=Dt[t];(!r||n>=r.priority)&&(Dt[t]={priority:n,Cf:e})}function Lt(t,e){return{uris:t,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:e,licenseRequestType:null,sessionId:null}}function Ut(){this.a=0}function Ot(t,e,n){vt.call(this,t,e),this.b=n}Rt.registerScheme=_t,Rt.unregisterScheme=function(t){delete Dt[t]},Rt.prototype.Ef=function(t){this.a.add(t)},Rt.prototype.registerRequestFilter=Rt.prototype.Ef,Rt.prototype.fg=function(t){this.a.delete(t)},Rt.prototype.unregisterRequestFilter=Rt.prototype.fg,Rt.prototype.ye=function(){this.a.clear()},Rt.prototype.clearAllRequestFilters=Rt.prototype.ye,Rt.prototype.Ff=function(t){this.b.add(t)},Rt.prototype.registerResponseFilter=Rt.prototype.Ff,Rt.prototype.gg=function(t){this.b.delete(t)},Rt.prototype.unregisterResponseFilter=Rt.prototype.gg,Rt.prototype.ze=function(){this.b.clear()},Rt.prototype.clearAllResponseFilters=Rt.prototype.ze,Rt.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}},Rt.makeRequest=Lt,Rt.prototype.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.g.destroy()},Rt.prototype.destroy=Rt.prototype.destroy,Rt.prototype.request=function(t,e){var n=this,r=new Ut;if(this.f){var i=Promise.reject(new pt(2,7,7001));return i.catch(function(){}),new Ot(i,function(){return Promise.resolve()},r)}e.method=e.method||"GET",e.headers=e.headers||{},e.retryParameters=e.retryParameters?At(e.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},e.uris=At(e.uris);var a=(i=function(t,e,n){for(var r=bt(void 0),i={},a=(t=h(t.a)).next();!a.done;i={ld:i.ld},a=t.next())i.ld=a.value,r=r.U(function(t){return function(){return t.ld(e,n)}}(i));return r.U(void 0,function(t){if(t&&7001==t.code)throw t;throw new pt(2,1,1006,t)})}(this,t,e)).U(function(){return function t(e,n,r,i,a,o,s){var u=new J(r.uris[a]),c=u.va,l=!1;c||(c=location.protocol,c=c.slice(0,-1),Q(u,c),r.uris[a]=u.toString());c=c.toLowerCase();var f=(c=Dt[c])?c.Cf:null;if(!f)return yt(new pt(2,1,1e3,u));var h;return wt(dt(i)).U(function(){return e.f?gt():(h=Date.now(),f(r.uris[a],r,n,function(t,r,i){e.c&&1==n&&(e.c(t,r),l=!0,s.a=i)}))}).U(function(t){return null==t.timeMs&&(t.timeMs=Date.now()-h),{response:t,bf:l}},function(u){if(u&&7001==u.code)throw u;if(e.f)return gt();if(u&&1==u.severity)return e.dispatchEvent(new St("retry",{error:u instanceof pt?u:null})),a=(a+1)%r.uris.length,t(e,n,r,i,a,u,s);throw u||o})}(n,t,e,new ht(e.retryParameters,!1),0,null,r)}),o=a.U(function(e){return function(t,e,n){for(var r=bt(void 0),i=(t=h(t.b)).next();!i.done;i=t.next())r=r.U(i.value.bind(null,e,n.response));return r.U(function(){return n},function(t){if(t&&7001==t.code)throw t;var e=2;throw t instanceof pt&&(e=t.severity),new pt(e,1,1007,t)})}(n,t,e)}),s=Date.now(),u=0;i.promise.then(function(){u=Date.now()-s},function(){});var c=0;return a.promise.then(function(){c=Date.now()},function(){}),i=new Ot((i=o.U(function(e){var r=Date.now()-c,i=e.response;return i.timeMs+=u,i.timeMs+=r,e.bf||!n.c||i.fromCache||1!=t||n.c(i.timeMs,i.data.byteLength),i},function(t){throw t&&(t.severity=2),t})).promise,i.Md,r),Ct(this.g,i),i},Rt.prototype.request=Rt.prototype.request,Rt.NumBytesRemainingClass=Ut;var jt=Ot;if(jt.prototype=v(vt.prototype),jt.prototype.constructor=jt,b)b(jt,vt);else for(var Bt in vt)if("prototype"!=Bt)if(Object.defineProperties){var Ft=Object.getOwnPropertyDescriptor(vt,Bt);Ft&&Object.defineProperty(jt,Bt,Ft)}else jt[Bt]=vt[Bt];function Kt(){}function Vt(){this.a=new xt}function Ht(t,e,n,r){this.target=t,this.type=e,this.listener=n,this.a=function(t,e){if(null==e)return!1;if("boolean"==typeof e)return e;var n=new Set(["passive","capture"]);return Object.keys(e).filter(function(t){return!n.has(t)}),function(t){var e=zt;if(null==e){e=!1;try{var n={},r={get:function(){return e=!0,!1}};Object.defineProperty(n,"passive",r),Object.defineProperty(n,"capture",r),r=function(){},t.addEventListener("test",r,n),t.removeEventListener("test",r,n)}catch(i){e=!1}zt=e}return e||!1}(t)?e:e.capture||!1}(t,r),this.target.addEventListener(e,n,this.a)}jt.dg=vt.prototype,Rt.PendingRequest=Ot,Ot.all=Tt,Ot.notAbortable=wt,Ot.completed=bt,Ot.aborted=gt,Ot.failed=yt,K("shaka.util.IReleasable",Kt),Kt.prototype.release=function(){},K("shaka.util.EventManager",Vt),Vt.prototype.release=function(){this.$a(),this.a=null},Vt.prototype.release=Vt.prototype.release,Vt.prototype.w=function(t,e,n,r){this.a&&(t=new Ht(t,e,n,r),this.a.push(e,t))},Vt.prototype.listen=Vt.prototype.w,Vt.prototype.da=function(t,e,n,r){var i=this;this.w(t,e,function r(a){i.ea(t,e,r),n(a)},r)},Vt.prototype.listenOnce=Vt.prototype.da,Vt.prototype.ea=function(t,e,n){if(this.a)for(var r=this.a.get(e)||[],i=(r=h(r)).next();!i.done;i=r.next())(i=i.value).target!=t||n!=i.listener&&n||(i.ea(),this.a.remove(e,i))},Vt.prototype.unlisten=Vt.prototype.ea,Vt.prototype.$a=function(){if(this.a){for(var t=this.a.getAll(),e=(t=h(t)).next();!e.done;e=t.next())e.value.ea();this.a.a={}}},Vt.prototype.removeAll=Vt.prototype.$a,Ht.prototype.ea=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1},Ht.prototype.unlisten=Ht.prototype.ea;var zt=void 0;function qt(t){if(t=new Uint8Array(t),new DataView(t.buffer,t.byteOffset,t.byteLength).getUint32(0,!0)+4!=t.byteLength)throw new RangeError("Malformed FairPlay init data");return new J(t=ae(t.subarray(4),!0)).ra}function Gt(t,e,n){function r(t){new DataView(a.buffer).setUint32(o,t.byteLength,!0),o+=4,i(t)}function i(t){a.set(t,o),o+=t.byteLength}if(!n||!n.byteLength)throw new pt(2,6,6015);e="string"==typeof e?new Uint8Array(ue(e,!0)):new Uint8Array(e);var a=new Uint8Array(8+t.byteLength+e.byteLength+n.byteLength),o=0;return i(new Uint8Array(t)),r(e),r(new Uint8Array(n)),a}function Xt(t,e){for(var n=h(t),r=n.next();!r.done;r=n.next())if(!e(r.value))return!1;return!0}function Yt(t){var e=new Map;return Object.keys(t).forEach(function(n){e.set(n,t[n])}),e}function Wt(t){var e={};return t.forEach(function(t,n){e[n]=t}),e}function $t(t,e){var n=t;return e&&(n+='; codecs="'+e+'"'),n}function Jt(t){var e=(t=t.split("."))[0];return t.pop(),[e,t.join(".")]}K("shaka.util.FairPlayUtils.defaultGetContentId",qt),K("shaka.util.FairPlayUtils.initDataTransform",Gt);var Qt=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Zt(){return!(!t.MediaSource||!MediaSource.isTypeSupported)}function te(t){return""!=(re||(ne||(ne=new ft(function(){re=null})),(re=document.querySelector("video")||document.querySelector("audio"))||(re=document.createElement("video")),ne.P(1),re)).canPlayType(t)}function ee(t){return(navigator.userAgent||"").includes(t)}var ne=null,re=null;function ie(t){if(!t)return"";239==(t=new Uint8Array(t))[0]&&187==t[1]&&191==t[2]&&(t=t.subarray(3)),t=ce(t),t=escape(t);try{return decodeURIComponent(t)}catch(e){throw new pt(2,2,2004)}}function ae(t,e,n){if(!t)return"";if(!n&&0!=t.byteLength%2)throw new pt(2,2,2004);if(t instanceof ArrayBuffer)var r=t;else(n=new Uint8Array(t.byteLength)).set(new Uint8Array(t)),r=n.buffer;t=Math.floor(t.byteLength/2),n=new Uint16Array(t),r=new DataView(r);for(var i=0;i<t;i++)n[i]=r.getUint16(2*i,e);return ce(n)}function oe(t){var e=new Uint8Array(t);if(239==e[0]&&187==e[1]&&191==e[2])return ie(e);if(254==e[0]&&255==e[1])return ae(e.subarray(2),!1);if(255==e[0]&&254==e[1])return ae(e.subarray(2),!0);var n=function(t,e){return t.byteLength<=e||32<=t[e]&&126>=t[e]}.bind(null,e);if(0==e[0]&&0==e[2])return ae(t,!1);if(0==e[1]&&0==e[3])return ae(t,!0);if(n(0)&&n(1)&&n(2)&&n(3))return ie(t);throw new pt(2,2,2003)}function se(t){t=encodeURIComponent(t),t=unescape(t);for(var e=new Uint8Array(t.length),n=0;n<t.length;++n)e[n]=t.charCodeAt(n);return e.buffer}function ue(t,e){for(var n=new Uint8Array(2*t.length),r=new DataView(n.buffer),i=0;i<t.length;++i)r.setUint16(2*i,t.charCodeAt(i),e);return n.buffer}function ce(t){if(!le)for(var e=function(t){try{return U(new Uint8Array(t)),!0}catch(e){return!1}},n={size:65536};0<n.size;(n={size:n.size}).size/=2)if(e(n.size)){le=function(t){return function(e){for(var n="",r=0;r<e.length;r+=t.size)n+=String.fromCharCode.apply(String,U(e.subarray(r,r+t.size)));return n}}(n);break}return le(t)}K("shaka.util.StringUtils.fromUTF8",ie),K("shaka.util.StringUtils.fromUTF16",ae),K("shaka.util.StringUtils.fromBytesAutoDetect",oe),K("shaka.util.StringUtils.toUTF8",se),K("shaka.util.StringUtils.toUTF16",ue);var le=null,fe={vc:function(e,n){var r=ce(e);return n=null==n||n,r=t.btoa(r).replace(/\+/g,"-").replace(/\//g,"_"),n?r:r.replace(/=*$/,"")}};function he(t){var e=this;this.B=t,this.v=new Set,this.l=this.h=null,this.R=!1,this.a=null,this.i=new Vt,this.b=new Map,this.s=[],this.m=new mt,this.f=null,this.g=function(n){e.m.reject(n),t.onError(n)},this.oa=new Map,this.T=new Map,this.L=new ft(function(){return function(t){var e=t.oa,n=t.T;n.clear(),e.forEach(function(t,e){return n.set(e,t)}),(e=Array.from(n.values())).length&&e.every(function(t){return"expired"==t})&&t.g(new pt(2,6,6014)),t.B.mc(Wt(n))}(e)}),this.c=!1,this.$=new mt,this.D=!1,this.F=[],this.na=!1,this.W=new ft(function(){var t;(t=e).b.forEach(function(e,n){var r=e.cd,i=n.expiration;isNaN(i)&&(i=1/0),i!=r&&(t.B.onExpirationUpdated(n.sessionId,i),e.cd=i)})}).Na(1),this.m.catch(function(){})}function de(t,e,n){return t.s=n,t.D=0<n.length,pe(t,e)}function pe(e,n){var r=function(e){if(0==(e=Yt(e.f.clearKeys)).size)return null;var n=[],r=[];e.forEach(function(t,e){var i=fe.Mc(e),a=fe.Mc(t);i={kty:"oct",kid:fe.vc(i,!1),k:fe.vc(a,!1)},n.push(i),r.push(i.kid)}),e=JSON.stringify({keys:n});var i=JSON.stringify({kids:r});return i=[{initData:new Uint8Array(se(i)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+t.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:i,keyIds:[]}}(e);if(r)for(var i=h(n),a=i.next();!a.done;a=i.next())a.value.drmInfos=[r];for((r=n.some(function(t){return 0<t.drmInfos.length}))||function(t,e){var n=[];e.forEach(function(t,e){n.push({keySystem:e,licenseServerUri:t,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var r=h(t),i=r.next();!i.done;i=r.next())i.value.drmInfos=n}(n,a=Yt(e.f.servers)),a=(i=h(n)).next();!a.done;a=i.next())for(var o=(a=h(a.value.drmInfos)).next();!o.done;o=a.next())Pe(o.value,Yt(e.f.servers),Yt(e.f.advanced||{}));return(a=function(t,e){for(var n=new Set,r=h(e),i=r.next();!i.done;i=r.next()){var a=h(i.value.drmInfos);for(i=a.next();!i.done;i=a.next())n.add(i.value)}for(r=h(n),i=r.next();!i.done;i=r.next())Pe(i.value,Yt(t.f.servers),Yt(t.f.advanced||{}));a=t.D?"required":"optional";var o=t.D?["persistent-license"]:["temporary"];for(r=new Map,n=h(n),i=n.next();!i.done;i=n.next())i=i.value,r.set(i.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:a,sessionTypes:o,label:i.keySystem,drmInfos:[]});for(n=h(e),i=n.next();!i.done;i=n.next()){i=i.value,a=i.audio,o=i.video;var s=a?$t(a.mimeType,a.codecs):"",u=o?$t(o.mimeType,o.codecs):"",c=h(i.drmInfos);for(i=c.next();!i.done;i=c.next()){i=i.value;var l=r.get(i.keySystem);l.drmInfos.push(i),i.distinctiveIdentifierRequired&&(l.distinctiveIdentifier="required"),i.persistentStateRequired&&(l.persistentState="required"),a&&l.audioCapabilities.push({robustness:i.audioRobustness||"",contentType:s}),o&&l.videoCapabilities.push({robustness:i.videoRobustness||"",contentType:u})}}return r}(e,n)).size?(a=Te(e,a),r?a:a.catch(function(){})):(e.R=!0,Promise.resolve())}function me(t){return p(function e(){var n;return L(e,function(e){switch(e.j){case 1:if(!(t.h&&t.a&&t.a.serverCertificate&&t.a.serverCertificate.length)){e.A(0);break}return k(e,3),S(e,t.h.setServerCertificate(t.a.serverCertificate),5);case 5:I(e,0);break;case 3:return n=M(e),e.return(Promise.reject(new pt(2,6,6004,n.message)))}})})}function ve(t){var e=t.a?t.a.initData:[];return e.forEach(function(e){return Se(t,e.initDataType,e.initData)}),t.s.forEach(function(e){return Ee(t,e)}),e.length||t.s.length||t.m.resolve(),t.m}function ye(t,e,n){for(var r=t.b.values(),i=(r=h(r)).next();!i.done;i=r.next())if(fe.ya(n,i.value.initData))return;Se(t,e,n)}function ge(t){return t?t.keySystem:""}function be(t,e){return!!ee("Edge/")||t.v.has(e)}function we(t){return t=function(t,e){for(var n=[],r=h(t),i=r.next();!i.done;i=r.next())n.push(e(i.value));return n}(t=t.b.keys(),function(t){return t.sessionId}),Array.from(t)}function Te(t,e){if(1==e.size&&e.has(""))return Promise.reject(new pt(2,6,6e3));for(var n=h(e.values()),r=n.next();!r.done;r=n.next())0==(r=r.value).audioCapabilities.length&&delete r.audioCapabilities,0==r.videoCapabilities.length&&delete r.videoCapabilities;var i=n=new mt;return[!0,!1].forEach(function(t){var n=this;e.forEach(function(e,r){e.drmInfos.some(function(t){return!!t.licenseServerUri})==t&&(i=i.catch(function(){if(!this.c)return navigator.requestMediaKeySystemAccess(r,[e])}.bind(n)))})}.bind(t)),i=(i=i.catch(function(){return Promise.reject(new pt(2,6,6001))})).then(function(t){if(this.c)return Promise.reject();this.v.clear();var n=t.getConfiguration(),r=n.videoCapabilities||[],i=h(n.audioCapabilities||[]);for(n=i.next();!n.done;n=i.next())this.v.add(n.value.contentType);for(n=(r=h(r)).next();!n.done;n=r.next())this.v.add(n.value.contentType);r=t.keySystem,i=[];var a=[],o=[],s=[];return function(t,e,n,r,i){t.forEach(function(t){if(e.includes(t.licenseServerUri)||e.push(t.licenseServerUri),t.serverCertificate&&(n.some(function(e){return fe.ya(e,t.serverCertificate)})||n.push(t.serverCertificate)),t.initData&&t.initData.forEach(function(t){r.some(function(e){return!(!e.keyId||e.keyId!=t.keyId)||e.initDataType==t.initDataType&&fe.ya(e.initData,t.initData)})||r.push(t)}),t.keyIds)for(var a=0;a<t.keyIds.length;++a)i.includes(t.keyIds[a])||i.push(t.keyIds[a])})}((n=e.get(t.keySystem)).drmInfos,i,a,o,s),this.a={keySystem:r,licenseServerUri:i[0],distinctiveIdentifierRequired:"required"==n.distinctiveIdentifier,persistentStateRequired:"required"==n.persistentState,audioRobustness:n.audioCapabilities?n.audioCapabilities[0].robustness:"",videoRobustness:n.videoCapabilities?n.videoCapabilities[0].robustness:"",serverCertificate:a[0],initData:o,keyIds:s},this.a.licenseServerUri?t.createMediaKeys():Promise.reject(new pt(2,6,6012,this.a.keySystem))}.bind(t)).then(function(t){if(this.c)return Promise.reject();this.h=t,this.R=!0}.bind(t)).catch(function(t){if(!this.c)return this.a=null,this.v.clear(),t instanceof pt?Promise.reject(t):Promise.reject(new pt(2,6,6002,t.message))}.bind(t)),n.reject(),i}function Ee(t,e){try{var n=t.h.createSession("persistent-license")}catch(a){var r=new pt(2,6,6005,a.message);return t.g(r),Promise.reject(r)}t.i.w(n,"message",t.Ud.bind(t)),t.i.w(n,"keystatuseschange",t.Sd.bind(t));var i={initData:null,loaded:!1,cd:1/0,xa:null};return t.b.set(n,i),n.load(e).then(function(t){return this.c?Promise.reject():t?(i.loaded=!0,Ne(this)&&this.m.resolve(),n):(this.b.delete(n),void this.g(new pt(2,6,6013)))}.bind(t),function(t){this.c||(this.b.delete(n),this.g(new pt(2,6,6005,t.message)))}.bind(t))}function Se(t,e,n){try{var r=t.D?t.h.createSession("persistent-license"):t.h.createSession()}catch(i){return void t.g(new pt(2,6,6005,i.message))}t.i.w(r,"message",t.Ud.bind(t)),t.i.w(r,"keystatuseschange",t.Sd.bind(t)),t.b.set(r,{initData:n,loaded:!1,cd:1/0,xa:null});try{n=t.f.initDataTransform(n,t.a)}catch(i){return e=i,i instanceof pt||(e=new pt(2,6,6016,i)),void t.g(e)}r.generateRequest(e,n.buffer).catch(function(e){if(!t.c){if(t.b.delete(r),e.errorCode&&e.errorCode.systemCode){var n=e.errorCode.systemCode;0>n&&(n+=Math.pow(2,32)),n="0x"+n.toString(16)}t.g(new pt(2,6,6006,e.message,e,n))}})}function xe(t,e){if(ge(e).startsWith("com.apple.fps")){var n=e.serverCertificate;t=Gt(t,qt(t),n)}return t}function ke(t,e){var n=e.target,r=t.b.get(n),i=t.a.licenseServerUri,a=t.f.advanced[t.a.keySystem];"individualization-request"==e.messageType&&a&&a.individualizationServer&&(i=a.individualizationServer),(i=Lt([i],t.f.retryParameters)).body=e.message,i.method="POST",i.licenseRequestType=e.messageType,i.sessionId=n.sessionId,"com.microsoft.playready"!=t.a.keySystem&&"com.chromecast.playready"!=t.a.keySystem||function(t){var e=ae(t.body,!0,!0);if(e.includes("PlayReadyKeyMessage")){for(var n=(e=(new DOMParser).parseFromString(e,"application/xml")).getElementsByTagName("HttpHeader"),r=0;r<n.length;++r)t.headers[n[r].querySelector("name").textContent]=n[r].querySelector("value").textContent;t.body=fe.Aa(e.querySelector("Challenge").textContent).buffer}else t.headers["Content-Type"]="text/xml; charset=utf-8"}(i),t.a.keySystem.startsWith("com.apple.fps")&&t.f.fairPlayTransform&&function(t){var e=new Uint8Array(t.body);e="spc="+fe.vc(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=se(e)}(i),t.B.tb.request(2,i).promise.then(function(t){return this.c?Promise.reject():(this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&function(t){try{var e=ie(t.data)}catch(n){return}"<ckc>"===(e=e.trim()).substr(0,5)&&"</ckc>"===e.substr(-6)&&(e=e.slice(5,-6));try{e=JSON.parse(e).ckc}catch(n){}t.data=fe.Aa(e).buffer}(t),n.update(t.data).then(function(){var t=this;this.B.onEvent(new St("drmsessionupdate")),r&&(r.xa&&r.xa.resolve(),new ft(function(){r.loaded=!0,Ne(t)&&t.m.resolve()}).P(Ce))}.bind(this)))}.bind(t),function(t){this.c||(t=new pt(2,6,6007,t),this.g(t),r&&r.xa&&r.xa.reject(t))}.bind(t)).catch(function(t){this.c||(t=new pt(2,6,6008,t.message),this.g(t),r&&r.xa&&r.xa.reject(t))}.bind(t))}function Ae(){var t=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],e=[{videoCapabilities:t,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:t}],n=new Map;return t="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(t){return function(t){return p(function r(){var i,a,o;return L(r,function(r){switch(r.j){case 1:return k(r,2),S(r,navigator.requestMediaKeySystemAccess(t,e),4);case 4:return i=r.o,o=!!(a=i.getConfiguration().sessionTypes)&&a.includes("persistent-license"),ee("Tizen 3")&&(o=!1),n.set(t,{persistentState:o}),S(r,i.createMediaKeys(),5);case 5:I(r,0);break;case 2:M(r),n.set(t,null),x(r)}})})}(t)}),Promise.all(t).then(function(){return Wt(n)})}function Ie(t,e){var n=e.audio,r=e.video;if(n&&n.encrypted&&!be(t,$t(n.mimeType,n.codecs))||r&&r.encrypted&&!be(t,$t(r.mimeType,r.codecs)))return!1;var i=ge(t.a);return 0==e.drmInfos.length||e.drmInfos.some(function(t){return t.keySystem==i})}function Me(t,e){if(!t.length)return e;if(!e.length)return t;for(var n=[],r=0;r<t.length;r++)for(var i=0;i<e.length;i++)if(t[r].keySystem==e[i].keySystem){var a=t[r];i=e[i];var o=[];o=(o=o.concat(a.initData||[])).concat(i.initData||[]);var s=[];s=(s=s.concat(a.keyIds)).concat(i.keyIds),n.push({keySystem:a.keySystem,licenseServerUri:a.licenseServerUri||i.licenseServerUri,distinctiveIdentifierRequired:a.distinctiveIdentifierRequired||i.distinctiveIdentifierRequired,persistentStateRequired:a.persistentStateRequired||i.persistentStateRequired,videoRobustness:a.videoRobustness||i.videoRobustness,audioRobustness:a.audioRobustness||i.audioRobustness,serverCertificate:a.serverCertificate||i.serverCertificate,initData:o,keyIds:s});break}return n}function Ne(t){return Xt(t=t.b.values(),function(t){return t.loaded})}function Pe(e,n,r){!e.keySystem||"org.w3.clearkey"==e.keySystem&&e.licenseServerUri||(n.size&&(n=n.get(e.keySystem)||"",e.licenseServerUri=n),e.keyIds||(e.keyIds=[]),(r=r.get(e.keySystem))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=r.persistentStateRequired),e.videoRobustness||(e.videoRobustness=r.videoRobustness),e.audioRobustness||(e.audioRobustness=r.audioRobustness),e.serverCertificate||(e.serverCertificate=r.serverCertificate)),t.cast&&t.cast.__platform__&&"com.microsoft.playready"==e.keySystem&&(e.keySystem="com.chromecast.playready"))}K("shaka.util.Uint8ArrayUtils.toBase64",fe.vc),fe.Aa=function(e){e=t.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n},K("shaka.util.Uint8ArrayUtils.fromBase64",fe.Aa),fe.Mc=function(e){for(var n=new Uint8Array(e.length/2),r=0;r<e.length;r+=2)n[r/2]=t.parseInt(e.substr(r,2),16);return n},K("shaka.util.Uint8ArrayUtils.fromHex",fe.Mc),fe.wc=function(t){for(var e="",n=0;n<t.length;++n){var r=t[n].toString(16);1==r.length&&(r="0"+r),e+=r}return e},K("shaka.util.Uint8ArrayUtils.toHex",fe.wc),fe.ya=function(t,e){if(!t&&!e)return!0;if(!t||!e||t.length!=e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!=e[n])return!1;return!0},K("shaka.util.Uint8ArrayUtils.equal",fe.ya),fe.concat=function(t){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];for(var r=n=0;r<e.length;++r)n+=e[r].length;n=new Uint8Array(n);for(var i=r=0;i<e.length;++i)n.set(e[i],r),r+=e[i].length;return n},K("shaka.util.Uint8ArrayUtils.concat",fe.concat),(n=he.prototype).destroy=function(){var t=this;return p(function e(){return L(e,function(e){switch(e.j){case 1:return t.c?S(e,t.$,0):(t.c=!0,S(e,function(t){return p(function e(){var n;return L(e,function(e){switch(e.j){case 1:return t.i.release(),t.i=null,t.m.reject(),t.W.stop(),t.W=null,t.L.stop(),t.L=null,n=Array.from(t.b.keys()),t.b.clear(),S(e,Promise.all(n.map(function(t){return p(function e(){return L(e,function(e){switch(e.j){case 1:return k(e,2),S(e,Promise.all([t.close(),t.closed]),4);case 4:I(e,0);break;case 2:M(e),x(e)}})})})),2);case 2:if(!t.l){e.A(3);break}return k(e,4),S(e,t.l.setMediaKeys(null),6);case 6:I(e,5);break;case 4:M(e);case 5:t.l=null;case 3:t.a=null,t.v.clear(),t.h=null,t.s=[],t.f=null,t.g=null,t.B=null,x(e)}})})}(t),4));case 4:t.$.resolve(),e.A(0)}})})},n.configure=function(t){this.f=t},n.Fb=function(t){var e=this;if(!this.h)return this.i.da(t,"encrypted",function(){e.g(new pt(2,6,6010))}),Promise.resolve();this.l=t,this.i.da(this.l,"play",function(){for(var t=0;t<e.F.length;t++)ke(e,e.F[t]);e.na=!0,e.F=[]}),t=(t=this.l.setMediaKeys(this.h)).catch(function(t){return Promise.reject(new pt(2,6,6003,t.message))});var n=me(this);return Promise.all([t,n]).then(function(){if(e.c)return Promise.reject();ve(e),e.a.initData.length||e.s.length||e.i.w(e.l,"encrypted",function(t){return ye(e,t.initDataType,new Uint8Array(t.initData))})}).catch(function(t){if(!e.c)return Promise.reject(t)})},n.Ib=function(){for(var t=1/0,e=this.b.keys(),n=(e=h(e)).next();!n.done;n=e.next())n=n.value,isNaN(n.expiration)||(t=Math.min(t,n.expiration));return t},n.Ud=function(t){this.l&&this.f.delayLicenseRequestUntilPlayed&&this.l.paused&&!this.na?this.F.push(t):ke(this,t)},n.Sd=function(t){t=t.target;var e=this.b.get(t),n=!1;t.keyStatuses.forEach(function(t,r){if("string"==typeof r){var i=r;r=t,t=i}if("com.microsoft.playready"==this.a.keySystem&&16==r.byteLength&&!ee("Tizen")){var a=(i=new DataView(r)).getUint32(0,!0),o=i.getUint16(4,!0),s=i.getUint16(6,!0);i.setUint32(0,a,!1),i.setUint16(4,o,!1),i.setUint16(6,s,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==t&&(t="usable"),"status-pending"!=t&&(e.loaded=!0),"expired"==t&&(n=!0),i=fe.wc(new Uint8Array(r)),this.oa.set(i,t)}.bind(this));var r=t.expiration-Date.now();(0>r||n&&1e3>r)&&e&&!e.xa&&(this.b.delete(t),t.close().catch(function(){})),Ne(this)&&(this.m.resolve(),this.L.P(Re))};var Ce=5,Re=.5;function De(){this.a=new muxjs.mp4.CaptionParser,this.g=[],this.f={}}function _e(){}function Le(t){return!t||1==t.length&&1e-6>t.end(0)-t.start(0)?null:t.length?t.end(t.length-1):null}function Ue(t,e,n){return n=void 0===n?0:n,!(!t||!t.length||1==t.length&&1e-6>t.end(0)-t.start(0)||e>t.end(t.length-1))&&e+n>=t.start(0)}function Oe(t,e){if(!t||!t.length||1==t.length&&1e-6>t.end(0)-t.start(0))return 0;for(var n=0,r=t.length-1;0<=r&&t.end(r)>e;--r)n+=t.end(r)-Math.max(t.start(r),e);return n}function je(t){if(!t)return[];for(var e=[],n=0;n<t.length;n++)e.push({start:t.start(n),end:t.end(n)});return e}De.prototype.init=function(t){var e=muxjs.mp4.probe;t=new Uint8Array(t),this.g=e.videoTrackIds(t),this.f=e.timescale(t),this.a.init()},De.prototype.b=function(t,e){var n=new Uint8Array(t);(n=this.a.parse(n,this.g,this.f))&&n.captions&&e(n.captions),this.a.clearParsedCaptions()},De.prototype.c=function(){this.a.resetCaptionStream()},_e.prototype.init=function(){},_e.prototype.b=function(){},_e.prototype.c=function(){};var Be={Ae:function(t,e){return t.reduce(function(t,e,n){return e.catch(t.bind(null,n))}.bind(null,e),Promise.reject())},Cc:function(t,e){return t.concat(e)},kc:function(){},Ia:function(t){return null!=t}};function Fe(t,e){if(0==e.length)return t;var n=e.map(function(t){return new J(t)});return t.map(function(t){return new J(t)}).map(function(t){return n.map(t.resolve.bind(t))}).reduce(Be.Cc,[]).map(function(t){return t.toString()})}function Ke(t,e){return{keySystem:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:e||[],keyIds:[]}}var Ve={Pa:"video",Db:"audio",qa:"text",ng:"application"},He=1/15;function ze(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.i.bind(this)),this.a.on("done",this.h.bind(this))}function qe(e,n){return!(!t.muxjs||"mp2t"!=e.toLowerCase().split(";")[0].split("/")[1])&&(n?MediaSource.isTypeSupported(Ge(n,e)):MediaSource.isTypeSupported(Ge("audio",e))||MediaSource.isTypeSupported(Ge("video",e)))}function Ge(t,e){var n=e.replace(/mp2t/i,"mp4");"audio"==t&&(n=n.replace("video","audio"));var r=/avc1\.(66|77|100)\.(\d+)/.exec(n);if(r){var i="avc1.",a=r[1],o=Number(r[2]);i=("66"==a?i+"4200":"77"==a?i+"4d00":i+"6400")+(o>>4).toString(16),i+=(15&o).toString(16),n=n.replace(r[0],i)}return n}function Xe(t,e,n){this.startTime=t,this.direction=Ze,this.endTime=e,this.payload=n,this.region=new un,this.position=null,this.positionAlign=Ye,this.size=100,this.textAlign=We,this.writingMode=tn,this.lineInterpretation=en,this.line=null,this.lineHeight="",this.lineAlign=nn,this.displayAlign=Je,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=an,this.fontStyle=on,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1}ze.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},ze.prototype.i=function(t){this.c=t.captions;var e=new Uint8Array(t.data.byteLength+t.initSegment.byteLength);e.set(t.initSegment,0),e.set(t.data,t.initSegment.byteLength),this.g.push(e)},ze.prototype.h=function(){var t={data:fe.concat.apply(null,this.g),captions:this.c};this.b.resolve(t),this.f=!1},K("shaka.text.Cue",Xe);var Ye="auto";Xe.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Ye};var We="center",$e={LEFT:"left",RIGHT:"right",CENTER:We,START:"start",END:"end"};Xe.textAlign=$e;var Je="after",Qe={BEFORE:"before",CENTER:"center",AFTER:Je};Xe.displayAlign=Qe;var Ze="ltr";Xe.direction={HORIZONTAL_LEFT_TO_RIGHT:Ze,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var tn="horizontal-tb";Xe.writingMode={HORIZONTAL_TOP_TO_BOTTOM:tn,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var en=0;Xe.lineInterpretation={LINE_NUMBER:en,PERCENTAGE:1};var nn="start",rn={CENTER:"center",START:nn,END:"end"};Xe.lineAlign=rn;var an=400;Xe.fontWeight={NORMAL:an,BOLD:700};var on="normal",sn={NORMAL:on,ITALIC:"italic",OBLIQUE:"oblique"};function un(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=cn,this.scroll=ln}Xe.fontStyle=sn,Xe.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},K("shaka.text.CueRegion",un);var cn=1;un.units={PX:0,PERCENTAGE:cn,LINES:2};var ln="";function fn(t){this.g=null,this.c=t,this.f=this.m=0,this.h=1/0,this.b=this.a=null,this.l="",this.i=new Map}un.scrollMode={NONE:ln,UP:"up"};var hn={};function dn(e){return!!(hn[e]||t.muxjs&&"application/cea-608"==e)}function pn(t,e){"application/cea-608"!=e&&(t.g=new hn[e])}function mn(t,e,n,r,i){for(var a=n+" "+r,o=new Map,s=(e=h(e)).next();!s.done;s=e.next()){var u=s.value;s=u.stream,o.has(s)||o.set(s,new Map),o.get(s).has(a)||o.get(s).set(a,[]),u.startTime+=i,u.endTime+=i,u.startTime>=t.f&&u.startTime<t.h&&(u=new Xe(u.startTime,u.endTime,u.text),o.get(s).get(a).push(u),s==t.l&&t.c.append([u]))}for(a=(i=h(o.keys())).next();!a.done;a=i.next())for(a=a.value,t.i.has(a)||t.i.set(a,new Map),s=(e=h(o.get(a).keys())).next();!s.done;s=e.next())s=s.value,u=o.get(a).get(s),t.i.get(a).set(s,u);t.a=null==t.a?Math.max(n,t.f):Math.min(t.a,Math.max(n,t.f)),t.b=Math.max(t.b,Math.min(r,t.h))}function vn(t,e,n){this.f=t,this.g=n,this.b={},this.a=null,this.c={},this.i=new Vt,this.v=!1,this.l={},this.m=e,t=this.s=new mt,e=new MediaSource,this.i.da(e,"sourceopen",t.resolve),this.f.src=yn(e),this.h=e}K("shaka.text.TextEngine.registerParser",function(t,e){hn[t]=e}),K("shaka.text.TextEngine.unregisterParser",function(t){delete hn[t]}),fn.prototype.destroy=function(){return this.c=this.g=null,this.i.clear(),Promise.resolve()},fn.prototype.Rc=function(t){try{return this.g.parseMedia(new Uint8Array(t),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new pt(2,2,2009,e)}},fn.prototype.remove=function(t,e){return Promise.resolve().then(function(){!this.c||!this.c.remove(t,e)||null==this.a||e<=this.a||t>=this.b||(t<=this.a&&e>=this.b?this.a=this.b=null:t<=this.a&&e<this.b?this.a=e:t>this.a&&e>=this.b&&(this.b=t))}.bind(this))},fn.prototype.se=function(t){this.c.append(t)},fn.prototype.appendCues=fn.prototype.se,fn.prototype.tc=function(t,e){this.l=t;var n=this.i.get(t);if(n)for(var r=h(n.keys()),i=r.next();!i.done;i=r.next())(i=n.get(i.value).filter(function(t){return t.endTime<=e}))&&this.c.append(i)},fn.prototype.setSelectedClosedCaptionId=fn.prototype.tc;var yn=t.URL.createObjectURL;function gn(t){var e=$t(t.mimeType,t.codecs),n=function(t){var e=[t.mimeType];return Qt.forEach(function(n,r){var i=t[r];i&&e.push(n+'="'+i+'"')}),e.join(";")}(t);return dn(e)||MediaSource.isTypeSupported(n)||qe(e,t.type)}function bn(t,e){t.a||(t.a=new fn(t.g)),pn(t.a,e)}function wn(t){return!t.h||"ended"==t.h.readyState}function Tn(t,e){if("text"==e)var n=t.a.a;else n=!(n=Sn(t,e))||1==n.length&&1e-6>n.end(0)-n.start(0)?null:1==n.length&&0>n.start(0)?0:n.length?n.start(0):null;return n}function En(t,e){return"text"==e?t.a.b:Le(Sn(t,e))}function Sn(t,e){try{return t.b[e].buffered}catch(n){return null}}function xn(e,n,r,i,a,o){return"text"==n?function(t,e,n,r){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==n||null==r)this.g.parseInit(new Uint8Array(e));else{var t={periodStart:this.m,segmentStart:n,segmentEnd:r};t=this.g.parseMedia(new Uint8Array(e),t).filter(function(t){return t.startTime>=this.f&&t.startTime<this.h}.bind(this)),this.c.append(t),null==this.a&&(this.a=Math.max(n,this.f)),this.b=Math.min(r,this.h)}}.bind(t))}(e.a,r,i,a):e.l[n]?function(t,e){t.f=!0,t.b=new mt,t.g=[],t.c=[];var n=new Uint8Array(e);return t.a.push(n),t.a.flush(),t.f&&t.b.reject(new pt(2,3,3018)),t.b}(e.l[n],r).then(function(t){return this.a||bn(this,"text/vtt"),t.captions&&t.captions.length&&mn(this.a,t.captions,i,a,this.b.video.timestampOffset),An(this,n,this.ge.bind(this,n,t.data.buffer))}.bind(e)):(o&&t.muxjs&&(e.a||bn(e,"text/vtt"),null==i&&null==a?e.m.init(r):e.m.b(r,function(t){t.length&&mn(e.a,t,i,a,e.b.video.timestampOffset)})),An(e,n,e.ge.bind(e,n,r)))}function kn(t,e){return"text"==e?t.a?(t.m.c(),t.a.remove(0,1/0)):Promise.resolve():An(t,e,t.he.bind(t,e,0,t.h.duration))}function An(t,e,n){if(t.v)return Promise.reject();if(n={start:n,p:new mt},t.c[e].push(n),1==t.c[e].length)try{n.start()}catch(r){"QuotaExceededError"==r.name?n.p.reject(new pt(2,3,3017,e)):n.p.reject(new pt(2,3,3015,r)),Mn(t,e)}return n.p}function In(t,e){if(t.v)return Promise.reject();var n,r=[];for(n in t.b){var i=new mt,a={start:function(t){t.resolve()}.bind(null,i),p:i};t.c[n].push(a),r.push(i),1==t.c[n].length&&a.start()}return Promise.all(r).then(function(){try{e()}catch(r){var t=Promise.reject(new pt(2,3,3015,r))}for(var n in this.b)Mn(this,n);return t}.bind(t),function(t){throw t}.bind(t))}function Mn(t,e){t.c[e].shift();var n=t.c[e][0];if(n)try{n.start()}catch(r){n.p.reject(new pt(2,3,3015,r)),Mn(t,e)}}function Nn(t,e){return t=Cn(t),e=Cn(e),t.split("-")[0]==e.split("-")[0]}function Pn(t,e){t=Cn(t),e=Cn(e);var n=t.split("-"),r=e.split("-");return n[0]==r[0]&&1==n.length&&2==r.length}function Cn(t){var e=t.split("-");return t=e[0]||"",e=e[1]||"",t=t.toLowerCase(),t=_n.get(t)||t,(e=e.toUpperCase())?t+"-"+e:t}function Rn(t){return t.language?Cn(t.language):t.audio&&t.audio.language?Cn(t.audio.language):t.video&&t.video.language?Cn(t.video.language):"und"}function Dn(t,e){for(var n=Cn(t),r=new Set,i=h(e),a=i.next();!a.done;a=i.next())r.add(Cn(a.value));for(a=(i=h(r)).next();!a.done;a=i.next())if((a=a.value)==n)return a;for(a=(i=h(r)).next();!a.done;a=i.next())if(Pn(a=a.value,n))return a;for(a=(i=h(r)).next();!a.done;a=i.next()){var o=a=a.value,s=n;if(o=Cn(o),s=Cn(s),o=o.split("-"),s=s.split("-"),2==o.length&&2==s.length&&o[0]==s[0])return a}for(a=(r=h(r)).next();!a.done;a=r.next())if(Pn(n,i=a.value))return i;return null}(n=vn.prototype).destroy=function(){var t=this;this.v=!0;var e,n=[];for(e in this.c){var r=this.c[e],i=r[0];for(this.c[e]=r.slice(0,1),i&&n.push(i.p.catch(Be.kc)),i=1;i<r.length;++i)r[i].p.reject()}for(var a in this.a&&n.push(this.a.destroy()),this.g&&n.push(this.g.destroy()),this.l)n.push(this.l[a].destroy());return Promise.all(n).then(function(){t.i&&(t.i.release(),t.i=null),t.f&&(t.f.removeAttribute("src"),t.f.load(),t.f=null),t.h=null,t.a=null,t.g=null,t.b={},t.l={},t.m=null,t.c={}})},n.init=function(t,e){var n=this;return p(function r(){var i;return L(r,function(r){switch(r.j){case 1:return i=Ve,S(r,n.s,2);case 2:t.forEach(function(t,r){var a=$t(t.mimeType,t.codecs);r==i.qa?bn(n,a):(!e&&MediaSource.isTypeSupported(a)||!qe(a,r)||(n.l[r]=new ze,a=Ge(r,a)),a=n.h.addSourceBuffer(a),n.i.w(a,"error",n.Wf.bind(n,r)),n.i.w(a,"updateend",n.wb.bind(n,r)),n.b[r]=a,n.c[r]=[])}),x(r)}})})},n.Oc=function(t){if(t.total=je(this.f.buffered),t.audio=je(Sn(this,"audio")),t.video=je(Sn(this,"video")),t.text=[],this.a){var e=this.a.a,n=this.a.b;null!=e&&null!=n&&t.text.push({start:e,end:n})}},n.tc=function(t){var e=En(this,"video")||0;this.a.tc(t,e)},n.remove=function(t,e,n){return"text"==t?this.a.remove(e,n):An(this,t,this.he.bind(this,t,e,n))},n.flush=function(t){return"text"==t?Promise.resolve():An(this,t,this.Ee.bind(this,t))},n.endOfStream=function(t){return In(this,function(){wn(this)||(t?this.h.endOfStream(t):this.h.endOfStream())}.bind(this))},n.wa=function(t){return In(this,function(){this.h.duration=t}.bind(this))},n.Y=function(){return this.h.duration},n.ge=function(t,e){this.b[t].appendBuffer(e)},n.he=function(t,e,n){n<=e?this.wb(t):this.b[t].remove(e,n)},n.qe=function(t){var e=this.b[t].appendWindowStart,n=this.b[t].appendWindowEnd;this.b[t].abort(),this.b[t].appendWindowStart=e,this.b[t].appendWindowEnd=n,this.wb(t)},n.Ee=function(t){this.f.currentTime-=.001,this.wb(t)},n.Vf=function(t,e){0>e&&(e+=.001),this.b[t].timestampOffset=e,this.wb(t)},n.Sf=function(t,e,n){this.b[t].appendWindowStart=0,this.b[t].appendWindowEnd=n,this.b[t].appendWindowStart=e,this.wb(t)},n.Wf=function(t){this.c[t][0].p.reject(new pt(2,3,3014,this.f.error?this.f.error.code:0))},n.wb=function(t){var e=this.c[t][0];e&&(e.p.resolve(),Mn(this,t))};var _n=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function Ln(t,e,n){function r(t,e,n){return t>=e&&t<=n}var i=t.video;return!(i&&i.width&&i.height&&!(r(i.width,e.minWidth,Math.min(e.maxWidth,n.width))&&r(i.height,e.minHeight,Math.min(e.maxHeight,n.height))&&r(i.width*i.height,e.minPixels,e.maxPixels))||!r(t.bandwidth,e.minBandwidth,e.maxBandwidth))}function Un(t,e,n){var r=!1;return t.forEach(function(t){var i=t.allowedByApplication;t.allowedByApplication=Ln(t,e,n),i!=t.allowedByApplication&&(r=!0)}),r}function On(t,e,n,r){r.variants=r.variants.filter(function(r){if(t&&t.R&&!Ie(t,r))return!1;var i=r.audio;return r=r.video,!(i&&!gn(i)||r&&!gn(r)||i&&e&&!jn(i,e)||r&&n&&!jn(r,n))}),r.textStreams=r.textStreams.filter(function(t){return dn($t(t.mimeType,t.codecs))})}function jn(t,e){return t.mimeType==e.mimeType&&t.codecs.split(".")[0]==e.codecs.split(".")[0]}function Bn(t){var e=t.audio,n=t.video,r=e?e.codecs:null,i=n?n.codecs:null,a=[];i&&a.push(i),r&&a.push(r);var o=[];n&&o.push(n.mimeType),e&&o.push(e.mimeType),o=o[0]||null;var s=[];e&&s.push(e.kind),n&&s.push(n.kind),s=s[0]||null;var u=new Set;return e&&e.roles.forEach(function(t){return u.add(t)}),n&&n.roles.forEach(function(t){return u.add(t)}),t={id:t.id,active:!1,type:"variant",bandwidth:t.bandwidth,language:t.language,label:null,kind:s,width:null,height:null,frameRate:null,mimeType:o,codecs:a.join(", "),audioCodec:r,videoCodec:i,primary:t.primary,roles:Array.from(u),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},n&&(t.videoId=n.id,t.originalVideoId=n.originalId,t.width=n.width||null,t.height=n.height||null,t.frameRate=n.frameRate||null,t.videoBandwidth=n.bandwidth||null),e&&(t.audioId=e.id,t.originalAudioId=e.originalId,t.channelsCount=e.channelsCount,t.audioBandwidth=e.bandwidth||null,t.label=e.label,t.audioRoles=e.roles),t}function Fn(t){return{id:t.id,active:!1,type:"text",bandwidth:0,language:t.language,label:t.label,kind:t.kind||null,width:null,height:null,frameRate:null,mimeType:t.mimeType,codecs:t.codecs||null,audioCodec:null,videoCodec:null,primary:t.primary,roles:t.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:t.originalId}}function Kn(t){return t.__shaka_id||(t.__shaka_id=Vn++),t.__shaka_id}var Vn=0;function Hn(t){return{id:Kn(t),active:!1,type:"",bandwidth:0,language:Cn(t.language),label:t.label,kind:t.kind,width:null,height:null,frameRate:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}function zn(t){return t.allowedByApplication&&t.allowedByKeySystem}function qn(t,e){for(var n=t.filter(function(t){return t.audio&&t.audio.channelsCount}),r=new Map,i=(n=h(n)).next();!i.done;i=n.next()){var a=(i=i.value).audio.channelsCount;r.has(a)||r.set(a,[]),r.get(a).push(i)}return 0==(n=Array.from(r.keys())).length?t:(i=n.filter(function(t){return t<=e})).length?r.get(Math.max.apply(null,i)):r.get(Math.min.apply(null,n))}function Gn(t,e,n){var r=t,i=t.filter(function(t){return t.primary});i.length&&(r=i);var a=r.length?r[0].language:"";if(r=r.filter(function(t){return t.language==a}),e){var o=Dn(Cn(e),t.map(function(t){return t.language}));o&&(r=t.filter(function(t){return Cn(t.language)==o}))}if(n){if((t=Xn(r,n)).length)return t}else if((t=r.filter(function(t){return 0==t.roles.length})).length)return t;return(t=r.map(function(t){return t.roles}).reduce(Be.Cc,[])).length?Xn(r,t[0]):r}function Xn(t,e){return t.filter(function(t){return t.roles.includes(e)})}function Yn(t,e,n){for(var r=0;r<n.length;r++)if(n[r].audio==t&&n[r].video==e)return n[r];return null}function Wn(){this.h=null,this.f=!1,this.b=new G,this.c=[],this.i=!1,this.a=this.g=null}function $n(t,e){return t&&(e=e.filter(function(e){return Ln(e,t,{width:1/0,height:1/0})})),e.sort(function(t,e){return t.bandwidth-e.bandwidth})}function Jn(t,e){this.a=t,this.b=e}function Qn(t,e){var n=new Jn(2,6),r=er,i=r.a,a=n.b-i.b;(0<(n.a-i.a||a)?r.c:r.b)(r.a,n,t,e)}function Zn(t,e,n,r){Y([n,"has been deprecated and will be removed in",e,". We are currently at version",t,". Additional information:",r].join(" "))}function tr(t,e,n,r){X([n,"has been deprecated and has been removed in",e,". We are now at version",t,". Additional information:",r].join(""))}K("shaka.abr.SimpleAbrManager",Wn),Wn.prototype.stop=function(){this.h=null,this.f=!1,this.c=[],this.g=null},Wn.prototype.stop=Wn.prototype.stop,Wn.prototype.init=function(t){this.h=t},Wn.prototype.init=Wn.prototype.init,Wn.prototype.chooseVariant=function(){var t=$n(this.a.restrictions,this.c),e=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.c.length&&!t.length&&(t=[(t=$n(null,this.c))[0]]);for(var n=t[0]||null,r=0;r<t.length;++r){var i=t[r],a=(t[r+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;e>=i.bandwidth/this.a.bandwidthDowngradeTarget&&e<=a&&(n=i)}return this.g=Date.now(),n},Wn.prototype.chooseVariant=Wn.prototype.chooseVariant,Wn.prototype.enable=function(){this.f=!0},Wn.prototype.enable=Wn.prototype.enable,Wn.prototype.disable=function(){this.f=!1},Wn.prototype.disable=Wn.prototype.disable,Wn.prototype.segmentDownloaded=function(t,e){var n=this.b;if(!(16e3>e)){var r=8e3*e/t,i=t/1e3;n.a+=e,z(n.b,i,r),z(n.c,i,r)}if(null!=this.g&&this.f)t:{if(this.i){if(Date.now()-this.g<1e3*this.a.switchInterval)break t}else{if(!(128e3<=this.b.a))break t;this.i=!0}n=this.chooseVariant(),this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),this.h(n)}},Wn.prototype.segmentDownloaded=Wn.prototype.segmentDownloaded,Wn.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},Wn.prototype.getBandwidthEstimate=Wn.prototype.getBandwidthEstimate,Wn.prototype.setVariants=function(t){this.c=t},Wn.prototype.setVariants=Wn.prototype.setVariants,Wn.prototype.configure=function(t){this.a=t},Wn.prototype.configure=Wn.prototype.configure,Jn.prototype.toString=function(){return"v"+this.a+"."+this.b};var er=null,nr="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),rr="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),ir=["loop","playbackRate"],ar=["pause","play"],or="abrstatuschanged adaptation buffering emsg error loading streaming texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged textchanged".split(" "),sr={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},ur={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},cr=[["getConfiguration","configure"]],lr=[["isTextTrackVisible","setTextTrackVisibility"]],fr="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack setTextTrackVisibility trickPlay".split(" "),hr=["attach","detach","load","unload"];function dr(t){return JSON.stringify(t,function(t,e){if("function"!=typeof e){if(e instanceof Event||e instanceof St){var n,r={};for(n in e){var i=e[n];i&&"object"==typeof i?"detail"==n&&(r[n]=i):n in Event||(r[n]=i)}return r}if(e instanceof TimeRanges)for(r={__type__:"TimeRanges",length:e.length,start:[],end:[]},n=0;n<e.length;++n)r.start.push(e.start(n)),r.end.push(e.end(n));else r=e instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(e)}:"number"==typeof e?isNaN(e)?"NaN":isFinite(e)?e:0>e?"-Infinity":"Infinity":e;return r}})}function pr(t){return JSON.parse(t,function(t,e){return"NaN"==e?NaN:"-Infinity"==e?-1/0:"Infinity"==e?1/0:e&&"object"==typeof e&&"TimeRanges"==e.__type__?function(t){return{length:t.length,start:function(e){return t.start[e]},end:function(e){return t.end[e]}}}(e):e&&"object"==typeof e&&"Uint8Array"==e.__type__?new Uint8Array(e.entries):e})}function mr(t,e,n,r,i,a){this.T=t,this.f=new ft(e),this.R=n,this.l=!1,this.F=r,this.L=i,this.B=a,this.b=this.h=!1,this.D="",this.i=null,this.m=this.Qd.bind(this),this.s=this.nf.bind(this),this.a={video:{},player:{}},this.v=0,this.c={},this.g=null}var vr=!1,yr=null;function gr(t){var e=yr;e.removeUpdateListener(t.m),e.removeMessageListener("urn:x-cast:com.google.shaka.v2",t.s)}function br(t){for(var e in t.c){var n=t.c[e];delete t.c[e],n.reject(new pt(1,7,7e3))}}function wr(t){t=dr(t),yr.sendMessage("urn:x-cast:com.google.shaka.v2",t,function(){},W)}function Tr(t,e,n){var r=this;kt.call(this),this.c=t,this.b=e,this.i=this.g=this.f=this.l=this.h=null,(this.m=n)&&(this.a=new mr(n,function(){return Sr(r)},function(){return xr(r)},function(t,e){return Ar(r,t,e)},function(){return kr(r)},function(){return Er(r)})),function(t){for(var e in t.a&&t.a.init(),t.i=new Vt,nr.forEach(function(t){this.i.w(this.c,t,this.lg.bind(this))}.bind(t)),or.forEach(function(t){this.i.w(this.b,t,this.Bf.bind(this))}.bind(t)),t.h={},t.c)Object.defineProperty(t.h,e,{configurable:!1,enumerable:!0,get:t.kg.bind(t,e),set:t.mg.bind(t,e)});for(var n in t.l={},t.b)Object.defineProperty(t.l,n,{configurable:!1,enumerable:!0,get:t.Xd.bind(t,n)});t.f=new kt,t.f.Yb=t.h,t.g=new kt,t.g.Yb=t.l}(this)}function Er(t){var e={video:{},player:{},playerAfterLoad:{},manifest:t.b.ec(),startTime:null};return t.c.pause(),ir.forEach(function(t){e.video[t]=this.c[t]}.bind(t)),t.c.ended||(e.startTime=t.c.currentTime),cr.forEach(function(t){var n=t[1];t=this.b[t[0]](),e.player[n]=t}.bind(t)),lr.forEach(function(t){var n=t[1];t=this.b[t[0]](),e.playerAfterLoad[n]=t}.bind(t)),e}function Sr(t){t.dispatchEvent(new St("caststatuschanged"))}function xr(t){t.f.dispatchEvent(new St(t.h.paused?"pause":"play"))}function kr(t){cr.forEach(function(t){var e=t[1];t=this.a.get("player",t[0])(),this.b[e](t)}.bind(t));var e=t.a.get("player","getAssetUri")(),n=t.a.get("video","ended"),r=Promise.resolve(),i=t.c.autoplay,a=null;n||(a=t.a.get("video","currentTime")),e&&(t.c.autoplay=!1,r=t.b.load(e,a));var o={};ir.forEach(function(t){o[t]=this.a.get("video",t)}.bind(t)),r.then(function(){t.c&&(ir.forEach(function(t){this.c[t]=o[t]}.bind(t)),lr.forEach(function(t){var e=t[1];t=this.a.get("player",t[0])(),this.b[e](t)}.bind(t)),t.c.autoplay=i,e&&t.c.play())},function(e){t.b.dispatchEvent(new St("error",{detail:e}))})}function Ar(t,e,n){t.a.ga()&&("video"==e?t.f.dispatchEvent(n):"player"==e&&t.g.dispatchEvent(n))}function Ir(t,e,n,r){var i=this;kt.call(this),this.a=t,this.b=e,this.c=new Vt,this.D={video:t,player:e},this.s=n||function(){},this.F=r||function(t){return t},this.v=!1,this.h=!0,this.g=0,this.m=!1,this.l=!0,this.i=this.f=null,this.B=new ft(function(){Nr(i)}),function(t){var e=cast.receiver.CastReceiverManager.getInstance();e.onSenderConnected=t.Td.bind(t),e.onSenderDisconnected=t.Td.bind(t),e.onSystemVolumeChanged=t.De.bind(t),t.i=e.getCastMessageBus("urn:x-cast:com.google.cast.media"),t.i.onMessage=t.hf.bind(t),t.f=e.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),t.f.onMessage=t.uf.bind(t),e.start(),nr.forEach(function(t){this.c.w(this.a,t,this.Zd.bind(this,"video"))}.bind(t)),or.forEach(function(t){this.c.w(this.b,t,this.Zd.bind(this,"player"))}.bind(t)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?t.b.qd(3840,2160):t.b.qd(1920,1080),t.c.w(t.a,"loadeddata",function(){this.m=!0}.bind(t)),t.c.w(t.b,"loading",function(){this.h=!1,Mr(this)}.bind(t)),t.c.w(t.a,"playing",function(){this.h=!1,Mr(this)}.bind(t)),t.c.w(t.a,"pause",function(){Mr(this)}.bind(t)),t.c.w(t.b,"unloading",function(){this.h=!0,Mr(this)}.bind(t)),t.c.w(t.a,"ended",function(){var t=this;new ft(function(){t.a&&t.a.ended&&(t.h=!0,Mr(t))}).P(5)}.bind(t))}(this)}function Mr(t){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new St("caststatuschanged")),Pr(this)||Dr(this,0))}.bind(t))}function Nr(t){t.B.P(.5);var e={video:{},player:{}};if(rr.forEach(function(t){e.video[t]=this.a[t]}.bind(t)),t.b.V())for(var n in ur)0==t.g%ur[n]&&(e.player[n]=t.b[n]());for(var r in sr)0==t.g%sr[r]&&(e.player[r]=t.b[r]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(e.video.volume=n.level,e.video.muted=n.muted),t.m&&(t.g+=1),Rr(t,{type:"update",update:e},t.f),Pr(t)}function Pr(t){return!(!t.l||!t.a.duration&&!t.b.V())&&(Cr(t),t.l=!1,!0)}function Cr(t){var e={contentId:t.b.ec(),streamType:t.b.V()?"LIVE":"BUFFERED",duration:t.a.duration,contentType:""};Dr(t,0,e)}function Rr(t,e,n,r){t.v&&(t=dr(e),r?n.getCastChannel(r).send(t):n.broadcast(t))}function Dr(t,e,n){var r=t.a.playbackRate,i=_r;r={mediaSessionId:0,playbackRate:r,playerState:i=t.h?i.IDLE:t.b.Tc()?i.le:t.a.paused?i.ne:i.oe,currentTime:t.a.currentTime,supportedMediaCommands:15,volume:{level:t.a.volume,muted:t.a.muted}},n&&(r.media=n),Rr(t,{requestId:e,type:"MEDIA_STATUS",status:[r]},t.i)}(n=mr.prototype).destroy=function(){return br(this),yr&&gr(this),this.f&&(this.f.stop(),this.f=null),this.L=this.F=null,this.b=this.h=!1,this.s=this.m=this.g=this.c=this.a=this.i=null,Promise.resolve()},n.ga=function(){return this.b},n.hd=function(){return this.D},n.init=function(){if(t.chrome&&chrome.cast&&chrome.cast.isAvailable){delete t.__onGCastApiAvailable,this.h=!0,this.f.uc();var e=new chrome.cast.SessionRequest(this.T);e=new chrome.cast.ApiConfig(e,this.Rd.bind(this),this.sf.bind(this),"origin_scoped"),chrome.cast.initialize(e,function(){},function(){}),vr&&this.f.P(.02),(e=yr)&&e.status!=chrome.cast.SessionStatus.STOPPED?this.Rd(e):yr=null}else t.__onGCastApiAvailable=function(t){t&&this.init()}.bind(this)},n.pd=function(t){this.i=t,this.b&&wr({type:"appData",appData:this.i})},n.cast=function(t){return this.h?vr?this.b?Promise.reject(new pt(1,8,8002)):(this.g=new mt,chrome.cast.requestSession(this.ed.bind(this,t),this.Pd.bind(this)),this.g):Promise.reject(new pt(1,8,8001)):Promise.reject(new pt(1,8,8e3))},n.Hb=function(){this.b&&(br(this),yr&&(gr(this),yr.stop(function(){},function(){}),yr=null))},n.get=function(t,e){if("video"==t){if(ar.includes(e))return this.ae.bind(this,t,e)}else if("player"==t){if(ur[e]&&!this.get("player","isLive")())return function(){};if(fr.includes(e))return this.ae.bind(this,t,e);if(hr.includes(e))return this.Hf.bind(this,t,e);if(sr[e])return this.Yd.bind(this,t,e)}return this.Yd(t,e)},n.set=function(t,e,n){this.a[t][e]=n,wr({type:"set",targetName:t,property:e,value:n})},n.ed=function(t,e){yr=e,e.addUpdateListener(this.m),e.addMessageListener("urn:x-cast:com.google.shaka.v2",this.s),this.Qd(),wr({type:"init",initState:t,appData:this.i}),this.g.resolve()},n.Pd=function(t){var e=8003;switch(t.code){case"cancel":e=8004;break;case"timeout":e=8005;break;case"receiver_unavailable":e=8006}this.g.reject(new pt(2,8,e,t))},n.Yd=function(t,e){return this.a[t][e]},n.ae=function(t,e,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];wr({type:"call",targetName:t,methodName:e,args:r})},n.Hf=function(t,e,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];i=new mt;var a=this.v.toString();return this.v++,this.c[a]=i,wr({type:"asyncCall",targetName:t,methodName:e,args:r,id:a}),i},n.Rd=function(t){var e=this.B();this.g=new mt,this.l=!0,this.ed(e,t)},n.sf=function(t){vr="available"==t,this.f.uc()},n.Qd=function(){var t=!!yr&&"connected"==yr.status;if(this.b&&!t){for(var e in this.L(),this.a)this.a[e]={};br(this)}this.D=(this.b=t)?yr.receiver.friendlyName:"",this.f.uc()},n.nf=function(t,e){var n=pr(e);switch(n.type){case"event":var r=n.event;this.F(n.targetName,new St(r.type,r));break;case"update":for(var i in r=n.update)for(var a in n=this.a[i]||{},r[i])n[a]=r[i][a];this.l&&(this.R(),this.l=!1);break;case"asyncComplete":if(i=n.id,n=n.error,a=this.c[i],delete this.c[i],a)if(n){for(r in i=new pt(n.severity,n.category,n.code),n)i[r]=n[r];a.reject(i)}else a.resolve()}},V(Tr,kt),K("shaka.cast.CastProxy",Tr),Tr.prototype.destroy=function(t){return t&&this.a&&this.a.Hb(),this.i&&(this.i.release(),this.i=null),t=[],this.b&&(t.push(this.b.destroy()),this.b=null),this.a&&(t.push(this.a.destroy()),this.a=null),this.l=this.h=this.c=null,Promise.all(t)},Tr.prototype.destroy=Tr.prototype.destroy,Tr.prototype.af=function(){return this.h},Tr.prototype.getVideo=Tr.prototype.af,Tr.prototype.Ue=function(){return this.l},Tr.prototype.getPlayer=Tr.prototype.Ue,Tr.prototype.ue=function(){return!!this.a&&(this.a.h&&vr)},Tr.prototype.canCast=Tr.prototype.ue,Tr.prototype.ga=function(){return!!this.a&&this.a.ga()},Tr.prototype.isCasting=Tr.prototype.ga,Tr.prototype.hd=function(){return this.a?this.a.hd():""},Tr.prototype.receiverName=Tr.prototype.hd,Tr.prototype.cast=function(){if(!this.a)throw new pt(1,8,8007);var t=Er(this);return this.a.cast(t).then(function(){if(this.b)return this.b.xd()}.bind(this))},Tr.prototype.cast=Tr.prototype.cast,Tr.prototype.pd=function(t){this.a&&this.a.pd(t)},Tr.prototype.setAppData=Tr.prototype.pd,Tr.prototype.cg=function(){if(this.a){var t=this.a;if(t.b){var e=t.B();chrome.cast.requestSession(t.ed.bind(t,e),t.Pd.bind(t))}}},Tr.prototype.suggestDisconnect=Tr.prototype.cg,Tr.prototype.xe=function(t){var e=this;return p(function n(){return L(n,function(n){switch(n.j){case 1:if(t==e.m)return n.return();if(e.m=t,!e.a){n.A(2);break}return e.a.Hb(),S(n,e.a.destroy(),3);case 3:e.a=null;case 2:e.a=new mr(t,function(){return Sr(e)},function(){return xr(e)},function(t,n){return Ar(e,t,n)},function(){return kr(e)},function(){return Er(e)}),e.a.init(),x(n)}})})},Tr.prototype.changeReceiverId=Tr.prototype.xe,Tr.prototype.Hb=function(){this.a&&this.a.Hb()},Tr.prototype.forceDisconnect=Tr.prototype.Hb,(n=Tr.prototype).kg=function(t){if("addEventListener"==t)return this.f.addEventListener.bind(this.f);if("removeEventListener"==t)return this.f.removeEventListener.bind(this.f);if(this.a&&this.a.ga()&&0==Object.keys(this.a.a.video).length){var e=this.c[t];if("function"!=typeof e)return e}return this.a&&this.a.ga()?this.a.get("video",t):("function"==typeof(t=this.c[t])&&(t=t.bind(this.c)),t)},n.mg=function(t,e){this.a&&this.a.ga()?this.a.set("video",t,e):this.c[t]=e},n.lg=function(t){this.a&&this.a.ga()||this.f.dispatchEvent(new St(t.type,t))},n.Xd=function(t){if("addEventListener"==t)return this.g.addEventListener.bind(this.g);if("removeEventListener"==t)return this.g.removeEventListener.bind(this.g);if("getMediaElement"==t)return function(){return this.h}.bind(this);if("getSharedConfiguration"==t)return this.a?this.a.get("player","getConfiguration"):this.b.getConfiguration();if("getNetworkingEngine"==t)return this.b.Jb.bind(this.b);if(this.a&&this.a.ga()){if("getManifest"==t||"drmInfo"==t)return function(){return Y(t+"() does not work while casting!"),null};if("getManifestUri"==t)return Qn("getManifestUri",'Please use "getAssetUri" instead.'),this.Xd("getAssetUri");if("attach"==t||"detach"==t)return function(){return Y(t+"() does not work while casting!"),Promise.resolve()}}return this.a&&this.a.ga()&&0==Object.keys(this.a.a.video).length&&sr[t]||!this.a||!this.a.ga()?this.b[t].bind(this.b):this.a.get("player",t)},n.Bf=function(t){this.a&&this.a.ga()||this.g.dispatchEvent(t)},V(Ir,kt),K("shaka.cast.CastReceiver",Ir),Ir.prototype.isConnected=function(){return this.v},Ir.prototype.isConnected=Ir.prototype.isConnected,Ir.prototype.ef=function(){return this.h},Ir.prototype.isIdle=Ir.prototype.ef,Ir.prototype.destroy=function(){var t=this;return p(function e(){var n;return L(e,function(e){switch(e.j){case 1:return t.c&&(t.c.release(),t.c=null),n=[],t.b&&(n.push(t.b.destroy()),t.b=null),t.B&&(t.B.stop(),t.B=null),t.a=null,t.D=null,t.s=null,t.v=!1,t.h=!0,t.f=null,t.i=null,S(e,Promise.all(n),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),x(e)}})})},Ir.prototype.destroy=Ir.prototype.destroy,(n=Ir.prototype).Td=function(){this.g=0,this.l=!0,this.v=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Mr(this)},n.Zd=function(t,e){this.b&&(Nr(this),Rr(this,{type:"event",targetName:t,event:e},this.f))},n.De=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&Rr(this,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},this.f),Rr(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},n.uf=function(t){var e=pr(t.data);switch(e.type){case"init":this.g=0,this.m=!1,this.l=!0,function(t,e,n){for(var r in e.player)t.b[r](e.player[r]);t.s(n),n=Promise.resolve();var i=t.a.autoplay;e.manifest&&(t.a.autoplay=!1,n=t.b.load(e.manifest,e.startTime)),n.then(function(){if(t.b){for(var n in e.video)t.a[n]=e.video[n];for(var r in e.playerAfterLoad)t.b[r](e.playerAfterLoad[r]);t.a.autoplay=i,e.manifest&&(t.a.play(),Dr(t,0))}},function(e){t.b.dispatchEvent(new St("error",{detail:e}))})}(this,e.initState,e.appData),Nr(this);break;case"appData":this.s(e.appData);break;case"set":var n=e.targetName,r=e.property;if(e=e.value,"video"==n){var i=cast.receiver.CastReceiverManager.getInstance();if("volume"==r){i.setSystemVolumeLevel(e);break}if("muted"==r){i.setSystemVolumeMuted(e);break}}this.D[n][r]=e;break;case"call":(n=this.D[e.targetName])[e.methodName].apply(n,e.args);break;case"asyncCall":n=e.targetName,r=e.methodName,"player"==n&&"load"==r&&(this.g=0,this.m=!1),i=e.id,t=t.senderId;var a=this.D[n];e=a[r].apply(a,e.args),"player"==n&&"load"==r&&(e=e.then(function(){this.l=!0}.bind(this))),e.then(this.de.bind(this,t,i,null),this.de.bind(this,t,i))}},n.hf=function(t){var e=pr(t.data);switch(e.type){case"PLAY":this.a.play(),Dr(this,0);break;case"PAUSE":this.a.pause(),Dr(this,0);break;case"SEEK":t=e.currentTime;var n=e.resumeState;null!=t&&(this.a.currentTime=Number(t)),n&&"PLAYBACK_START"==n?(this.a.play(),Dr(this,0)):n&&"PLAYBACK_PAUSE"==n&&(this.a.pause(),Dr(this,0));break;case"STOP":this.b.xd().then(function(){this.b&&Dr(this,0)}.bind(this));break;case"GET_STATUS":Dr(this,Number(e.requestId));break;case"VOLUME":t=(n=e.volume).level,n=n.muted;var r=this.a.volume,i=this.a.muted;null!=t&&(this.a.volume=Number(t)),null!=n&&(this.a.muted=n),r==this.a.volume&&i==this.a.muted||Dr(this,0);break;case"LOAD":this.g=0,this.l=this.m=!1,t=e.media,n=e.currentTime,r=this.F(t.contentId),i=e.autoplay||!0,this.s(t.customData),i&&(this.a.autoplay=!0),this.b.load(r,n).then(function(){this.b&&Cr(this)}.bind(this)).catch(function(t){var n="LOAD_FAILED";7==t.category&&7e3==t.code&&(n="LOAD_CANCELLED"),Rr(this,{requestId:Number(e.requestId),type:n},this.i)}.bind(this));break;default:Rr(this,{requestId:Number(e.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}},n.de=function(t,e,n){this.b&&Rr(this,{type:"asyncComplete",id:e,error:n},this.f,t)};var _r={IDLE:"IDLE",oe:"PLAYING",le:"BUFFERING",ne:"PAUSED"};function Lr(t,e){this.I=t,this.b=e==Ur,this.a=0}K("shaka.util.DataViewReader",Lr);var Ur=1;function Or(){throw new pt(2,3,3e3)}function jr(){this.c=[],this.b=[],this.a=!1}function Br(t){for(var e=null!=t.flags?12:8;t.reader.sa()&&!t.parser.a;)t.parser.oc(t.start+e,t.reader,t.partialOkay)}function Fr(t){for(var e=null!=t.flags?12:8,n=t.reader.G();0<n&&!t.parser.a;--n)t.parser.oc(t.start+e,t.reader,t.partialOkay)}function Kr(t){return function(e){t(e.reader.Za(e.reader.I.byteLength-e.reader.ba()))}}function Vr(t){for(var e=0,n=0;n<t.length;n++)e=e<<8|t.charCodeAt(n);return e}function Hr(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)}function zr(t){var e=this;this.b=[],this.a=[],this.data=[],(new jr).H("moov",Br).fa("pssh",function(t){if(!(1<t.version)){var n=t.reader.I;if(n=new Uint8Array(n.buffer,n.byteOffset-12,t.size),e.data.push(n),e.b.push(fe.wc(t.reader.Za(16))),0<t.version){n=t.reader.G();for(var r=0;r<n;++r){var i=fe.wc(t.reader.Za(16));e.a.push(i)}}}}).parse(t)}Lr.Endianness={og:0,pg:Ur},Lr.prototype.sa=function(){return this.a<this.I.byteLength},Lr.prototype.hasMoreData=Lr.prototype.sa,Lr.prototype.ba=function(){return this.a},Lr.prototype.getPosition=Lr.prototype.ba,Lr.prototype.Ke=function(){return this.I.byteLength},Lr.prototype.getLength=Lr.prototype.Ke,Lr.prototype.la=function(){try{var t=this.I.getUint8(this.a);return this.a+=1,t}catch(e){Or()}},Lr.prototype.readUint8=Lr.prototype.la,Lr.prototype.Qb=function(){try{var t=this.I.getUint16(this.a,this.b);return this.a+=2,t}catch(e){Or()}},Lr.prototype.readUint16=Lr.prototype.Qb,Lr.prototype.G=function(){try{var t=this.I.getUint32(this.a,this.b);return this.a+=4,t}catch(e){Or()}},Lr.prototype.readUint32=Lr.prototype.G,Lr.prototype.$d=function(){try{var t=this.I.getInt32(this.a,this.b);return this.a+=4,t}catch(e){Or()}},Lr.prototype.readInt32=Lr.prototype.$d,Lr.prototype.Ab=function(){try{if(this.b)var t=this.I.getUint32(this.a,!0),e=this.I.getUint32(this.a+4,!0);else e=this.I.getUint32(this.a,!1),t=this.I.getUint32(this.a+4,!1)}catch(n){Or()}if(2097151<e)throw new pt(2,3,3001);return this.a+=8,e*Math.pow(2,32)+t},Lr.prototype.readUint64=Lr.prototype.Ab,Lr.prototype.Za=function(t){this.a+t>this.I.byteLength&&Or();var e=new Uint8Array(this.I.buffer,this.I.byteOffset+this.a,t);return this.a+=t,e},Lr.prototype.readBytes=Lr.prototype.Za,Lr.prototype.M=function(t){this.a+t>this.I.byteLength&&Or(),this.a+=t},Lr.prototype.skip=Lr.prototype.M,Lr.prototype.be=function(t){this.a<t&&Or(),this.a-=t},Lr.prototype.rewind=Lr.prototype.be,Lr.prototype.seek=function(t){(0>t||t>this.I.byteLength)&&Or(),this.a=t},Lr.prototype.seek=Lr.prototype.seek,Lr.prototype.gd=function(){for(var t=this.a;this.sa()&&0!=this.I.getUint8(this.a);)this.a+=1;return t=new Uint8Array(this.I.buffer,this.I.byteOffset+t,this.a-t),this.a+=1,ie(t)},Lr.prototype.readTerminatedString=Lr.prototype.gd,K("shaka.util.Mp4Parser",jr),jr.prototype.H=function(t,e){var n=Vr(t);return this.c[n]=0,this.b[n]=e,this},jr.prototype.box=jr.prototype.H,jr.prototype.fa=function(t,e){var n=Vr(t);return this.c[n]=1,this.b[n]=e,this},jr.prototype.fullBox=jr.prototype.fa,jr.prototype.stop=function(){this.a=!0},jr.prototype.stop=jr.prototype.stop,jr.prototype.parse=function(t,e){var n=new Uint8Array(t);for(n=new Lr(new DataView(n.buffer,n.byteOffset,n.byteLength),0),this.a=!1;n.sa()&&!this.a;)this.oc(0,n,e)},jr.prototype.parse=jr.prototype.parse,jr.prototype.oc=function(t,e,n){var r=e.ba(),i=e.G(),a=e.G();switch(i){case 0:i=e.I.byteLength-r;break;case 1:i=e.Ab()}var o=this.b[a];if(o){var s=null,u=null;1==this.c[a]&&(s=(u=e.G())>>>24,u&=16777215),a=r+i,n&&a>e.I.byteLength&&(a=e.I.byteLength),a-=e.ba(),e=0<a?e.Za(a):new Uint8Array(0),o({parser:this,partialOkay:n||!1,version:s,flags:u,reader:e=new Lr(new DataView(e.buffer,e.byteOffset,e.byteLength),0),size:i,start:r+t})}else e.M(Math.min(r+i-e.ba(),e.I.byteLength-e.ba()))},jr.prototype.parseNext=jr.prototype.oc,jr.children=Br,jr.sampleDescription=Fr,jr.allData=Kr,jr.typeToString=Hr,(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");var qr={dc:function(t,e){var n=qr.O(t,e);return 1!=n.length?null:n[0]},Kc:function(t,e,n){return 1!=(t=qr.Dd(t,e,n)).length?null:t[0]},O:function(t,e){return Array.prototype.filter.call(t.childNodes,function(t){return t instanceof Element&&t.tagName==e})},Dd:function(t,e,n){return Array.prototype.filter.call(t.childNodes,function(t){return t instanceof Element&&t.localName==n&&t.namespaceURI==e})},getAttributeNS:function(t,e,n){return t.hasAttributeNS(e,n)?t.getAttributeNS(e,n):null},fc:function(t){return Array.prototype.every.call(t.childNodes,function(t){return t.nodeType==Node.TEXT_NODE||t.nodeType==Node.CDATA_SECTION_NODE})?t.textContent.trim():null},K:function(t,e,n,r){r=void 0===r?null:r;var i=null;return null!=(t=t.getAttribute(e))&&(i=n(t)),null==i?r:i},yf:function(t){return t?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t)&&(t+="Z"),t=Date.parse(t),isNaN(t)?null:Math.floor(t/1e3)):null},Da:function(t){return t&&(t=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(t))?(t=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(t)?t:null):null},qc:function(t){var e=/([0-9]+)-([0-9]+)/.exec(t);return e?(t=Number(e[1]),isFinite(t)?(e=Number(e[2]),isFinite(e)?{start:t,end:e}:null):null):null},parseInt:function(t){return 0==(t=Number(t))%1?t:null},pc:function(t){return 0==(t=Number(t))%1&&0<t?t:null},xb:function(t){return 0==(t=Number(t))%1&&0<=t?t:null},parseFloat:function(t){return t=Number(t),isNaN(t)?null:t},Ce:function(t){var e;return t=(e=t.match(/^(\d+)\/(\d+)$/))?Number(e[1])/Number(e[2]):Number(t),isNaN(t)?null:t},Wd:function(t,e){var n=new DOMParser;try{var r=n.parseFromString(t,"text/xml")}catch(a){}if(r&&r.documentElement.tagName==e)var i=r.documentElement;return i&&0<i.getElementsByTagName("parsererror").length?null:i},Vd:function(t,e){try{var n=ie(t);return qr.Wd(n,e)}catch(r){}}},Gr=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Xr(t,e,n){var r=function(t){for(var e=[],n=(t=h(t)).next();!n.done;n=t.next())(n=$r(n.value))&&e.push(n);return e}(t),i=null;t=[];var a=[],o=new Set(r.map(function(t){return t.keyId}));if(o.delete(null),1<o.size)throw new pt(2,4,4010);if(n||(a=r.filter(function(t){return"urn:mpeg:dash:mp4protection:2011"!=t.ce||(i=t.init||i,!1)})).length&&(0==(t=function(t,e,n){for(var r=[],i=(n=h(n)).next();!i.done;i=n.next()){i=i.value;var a=Gr.get(i.ce);if(a){var o;if(o=qr.Kc(i.node,"urn:microsoft:playready","pro")){o=fe.Aa(o.textContent);var s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=o.length,c=s.length+16+u,l=new ArrayBuffer(c),f=new Uint8Array(l);l=new DataView(l);var d=0;l.setUint32(d,c),d+=4,l.setUint32(d,1886614376),d+=4,l.setUint32(d,0),d+=4,f.set(s,d),d+=s.length,l.setUint32(d,u),d+=4,f.set(o,d),o=[{initData:f,initDataType:"cenc",keyId:i.keyId}]}else o=null;o=Ke(a,i.init||t||o),(a=Wr.get(a))&&(o.licenseServerUri=a(i)),r.push(o)}else for(i=h(i=e(i.node)||[]),a=i.next();!a.done;a=i.next())r.push(a.value)}return r}(i,e,a)).length&&(t=[Ke("",i)])),r.length&&(n||!a.length))for(t=[],n=(e=h(Gr.values())).next();!n.done;n=e.next())"org.w3.clearkey"!=(n=n.value)&&t.push(Ke(n,i));if(o=Array.from(o)[0]||null)for(n=(e=h(t)).next();!n.done;n=e.next())for(r=(n=h(n.value.initData)).next();!r.done;r=n.next())r.value.keyId=o;return{Bd:o,rg:i,drmInfos:t,Ed:!0}}var Yr,Wr=(new Map).set("com.widevine.alpha",function(t){return(t=qr.Kc(t.node,"urn:microsoft","laurl"))&&t.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",function(t){return(t=qr.Kc(t.node,"urn:microsoft:playready","pro"))&&(t=function(t){var e=0,n=new DataView(t).getUint32(e,!0);if(n!==t.byteLength)return[];e+=6,n=[];for(var r=new DataView(t);e<t.byteLength-1;){var i=r.getUint16(e,!0);e+=2;var a=r.getUint16(e,!0);e+=2;var o=new Uint8Array(t,e,a);n.push({type:i,value:o}),e+=a}return n}((t=fe.Aa(t.textContent)).buffer).filter(function(t){return 1===t.type})[0])?(t=ae(t.value,!0),(t=qr.Wd(t,"WRMHEADER"))?function(t){return(t=t.querySelector("DATA > LA_URL"))?t.textContent:""}(t):""):""});function $r(t){var e=t.getAttribute("schemeIdUri"),n=qr.getAttributeNS(t,"urn:mpeg:cenc:2013","default_KID"),r=qr.Dd(t,"urn:mpeg:cenc:2013","pssh").map(qr.fc);if(!e)return null;if(e=e.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new pt(2,4,4009);var i=[];try{i=r.map(function(t){return{initDataType:"cenc",initData:fe.Aa(t),keyId:null}})}catch(a){throw new pt(2,4,4007)}return{node:t,ce:e,keyId:n,init:0<i.length?i:null}}function Jr(e,n,r,i,a){var o={RepresentationID:n,Number:r,Bandwidth:i,Time:a};return e.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(e,n,r,i){if("$$"==e)return"$";var a=o[n];if(null==a)return e;switch("RepresentationID"==n&&r&&(r=void 0),"Time"==n&&(a=Math.round(a)),i){case void 0:case"d":case"i":case"u":e=a.toString();break;case"o":e=a.toString(8);break;case"x":e=a.toString(16);break;case"X":e=a.toString(16).toUpperCase();break;default:e=a.toString()}return r=t.parseInt(r,10)||1,Array(Math.max(0,r-e.length)+1).join("0")+e})}function Qr(t,e){var n=Zr(t,e,"timescale"),r=1;n&&(r=qr.pc(n)||1),n=Zr(t,e,"duration"),(n=qr.pc(n||""))&&(n/=r);var i=Zr(t,e,"startNumber"),a=Number(Zr(t,e,"presentationTimeOffset"))||0,o=qr.xb(i||"");null!=i&&null!=o||(o=1);var s=ti(t,e,"SegmentTimeline");if(i=null,s){i=r;var u=t.S.duration||1/0;s=qr.O(s,"S");for(var c=[],l=0,f=0;f<s.length;++f){var h=s[f],d=qr.K(h,"t",qr.xb),p=qr.K(h,"d",qr.xb);if(h=qr.K(h,"r",qr.parseInt),null!=d&&(d-=a),!p)break;if(d=null!=d?d:l,0>(h=h||0))if(f+1<s.length){if(null==(h=qr.K(s[f+1],"t",qr.xb)))break;if(d>=h)break;h=Math.ceil((h-d)/p)-1}else{if(1/0==u)break;if(d/i>=u)break;h=Math.ceil((u*i-d)/p)-1}0<c.length&&d!=l&&(c[c.length-1].end=d/i);for(var m=0;m<=h;++m)l=d+p,c.push({start:d/i,end:l/i,hg:d}),d=l}i=c}return{timescale:r,Z:n,ab:o,ma:a/r||0,yd:a,N:i}}function Zr(t,e,n){return[e(t.C),e(t.ca),e(t.ka)].filter(Be.Ia).map(function(t){return t.getAttribute(n)}).reduce(function(t,e){return t||e})}function ti(t,e,n){return[e(t.C),e(t.ca),e(t.ka)].filter(Be.Ia).map(function(t){return qr.dc(t,n)}).reduce(function(t,e){return t||e})}function ei(t,e,n,r,i,a){if(a=void 0===a?0:a,qr.getAttributeNS(t,"http://www.w3.org/1999/xlink","href")){var o=function(t,e,n,r,i,a){for(var o=qr.getAttributeNS(t,"http://www.w3.org/1999/xlink","href"),s=qr.getAttributeNS(t,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=0;u<t.attributes.length;u++){var c=t.attributes[u];"http://www.w3.org/1999/xlink"==c.namespaceURI&&(t.removeAttributeNS(c.namespaceURI,c.localName),--u)}if(5<=a)return yt(new pt(2,4,4028));if("onLoad"!=s)return yt(new pt(2,4,4027));var l=Fe([r],[o]);return i.request(0,Lt(l,e)).U(function(r){if(!(r=qr.Vd(r.data,t.tagName)))return yt(new pt(2,4,4001,o));for(;t.childNodes.length;)t.removeChild(t.childNodes[0]);for(;r.childNodes.length;){var s=r.childNodes[0];r.removeChild(s),t.appendChild(s)}for(s=0;s<r.attributes.length;s++){var u=r.attributes[s].nodeName,c=r.getAttribute(u);t.setAttribute(u,c)}return ei(t,e,n,l[0],i,a+1)})}(t,e,n,r,i,a);return n&&(o=o.U(void 0,function(){return ei(t,e,n,r,i,a)})),o}o=[];for(var s=0;s<t.childNodes.length;s++){var u=t.childNodes[s];u instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==qr.getAttributeNS(u,"http://www.w3.org/1999/xlink","href")?(t.removeChild(u),--s):"SegmentTimeline"!=u.tagName&&o.push(ei(u,e,n,r,i,a)))}return Tt(o).U(function(){return t})}function ni(t,e,n){this.c=t,this.b=e,this.a=n}function ri(t,e,n,r,i,a){this.position=t,this.startTime=e,this.endTime=n,this.c=r,this.b=i,this.a=a}function ii(t,e,n,r){var i,a=(new jr).fa("sidx",function(t){i=function(t,e,n,r){var i=[];r.reader.M(4);var a=r.reader.G();if(0==a)throw new pt(2,3,3005);if(0==r.version)var o=r.reader.G(),s=r.reader.G();else o=r.reader.Ab(),s=r.reader.Ab();r.reader.M(2);var u=r.reader.Qb();for(t=t+r.size+s,s=0;s<u;s++){var c=r.reader.G(),l=(2147483648&c)>>>31;c&=2147483647;var f=r.reader.G();if(r.reader.M(4),1==l)throw new pt(2,3,3006);i.push(new ri(i.length,o/a-e,(o+f)/a-e,function(){return n},t,t+c-1)),o+=f,t+=c}return r.parser.stop(),i}(e,r,n,t)});if(t&&a.parse(t),i)return i;throw new pt(2,3,3004)}function ai(t){this.a=t}function oi(t,e){for(;t.a.length&&t.a[t.a.length-1].startTime>=e;)t.a.pop();for(;t.a.length&&0>=t.a[0].endTime;)t.a.shift();if(0!=t.a.length){var n=t.a[t.a.length-1];t.a[t.a.length-1]=new ri(n.position,n.startTime,e,n.c,n.b,n.a)}}function si(t){this.b=t,this.a=new Lr(t,0),Yr||(Yr=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function ui(t){var e=ci(t);if(7<e.length)throw new pt(2,3,3002);for(var n=0,r=0;r<e.length;r++)n=256*n+e[r];e=n,n=ci(t);t:{r=fe.ya;for(var i=0;i<Yr.length;i++)if(r(n,Yr[i])){r=!0;break t}r=!1}if(r)n=t.b.byteLength-t.a.ba();else{if(8==n.length&&224&n[1])throw new pt(2,3,3001);for(r=n[0]&(1<<8-n.length)-1,i=1;i<n.length;i++)r=256*r+n[i];n=r}return n=t.a.ba()+n<=t.b.byteLength?n:t.b.byteLength-t.a.ba(),r=new DataView(t.b.buffer,t.b.byteOffset+t.a.ba(),n),t.a.M(n),new li(e,r)}function ci(t){var e,n=t.a.la();for(e=1;8>=e&&!(n&1<<8-e);e++);if(8<e)throw new pt(2,3,3002);var r=new Uint8Array(e);for(r[0]=n,n=1;n<e;n++)r[n]=t.a.la();return r}function li(t,e){this.id=t,this.a=e}function fi(t){if(8<t.a.byteLength)throw new pt(2,3,3002);if(8==t.a.byteLength&&224&t.a.getUint8(0))throw new pt(2,3,3001);for(var e=0,n=0;n<t.a.byteLength;n++){e=256*e+t.a.getUint8(n)}return e}function hi(){}function di(t){var e=new si(t.a);if(179!=(t=ui(e)).id)throw new pt(2,3,3013);if(t=fi(t),183!=(e=ui(e)).id)throw new pt(2,3,3012);e=new si(e.a);for(var n=0;e.sa();){var r=ui(e);if(241==r.id){n=fi(r);break}}return{ig:t,Gf:n}}function pi(t,e){var n=ti(t,e,"Initialization");if(!n)return null;var r=t.C.pa,i=n.getAttribute("sourceURL");i&&(r=Fe(t.C.pa,[i])),i=0;var a=null;return(n=qr.K(n,"range",qr.qc))&&(i=n.start,a=n.end),new ni(function(){return r},i,a)}function mi(t,e,n,r,i,a,o,s){var u=t.presentationTimeline,c=!t.mb||!t.S.Vc,l=t.S.start,f=t.S.duration,h=e,d=null;return{createSegmentIndex:function(){var t=[h(r,i,a),"webm"==o?h(n.c(),n.b,n.a):null];return h=null,Promise.all(t).then(function(t){var e=t[0];t=t[1]||null,e="mp4"==o?ii(e,i,r,s):(new hi).parse(e,t,r,s),u.ub(e,l),d=new ai(e),c&&oi(d,f)})},findSegmentPosition:function(t){return d.find(t)},getSegmentReference:function(t){return d.get(t)}}}function vi(t){return t.Rb}function yi(t,e){var n=pi(t,gi),r=function(t){return[t.C.La,t.ca.La,t.ka.La].filter(Be.Ia).map(function(t){return qr.O(t,"SegmentURL")}).reduce(function(t,e){return 0<t.length?t:e}).map(function(e){e.getAttribute("indexRange")&&!t.Id&&(t.Id=!0);var n=e.getAttribute("media");return e=qr.K(e,"mediaRange",qr.qc,{start:0,end:null}),{ff:n,start:e.start,end:e.end}})}(t),i=Qr(t,gi),a=i.ab;0==a&&(a=1);var o=0;if(i.Z?o=i.Z*(a-1):i.N&&0<i.N.length&&(o=i.N[0].start),!(r={Z:i.Z,startTime:o,ab:a,ma:i.ma,N:i.N,sb:r}).Z&&!r.N&&1<r.sb.length)throw new pt(2,4,4002);if(!r.Z&&!t.S.duration&&!r.N&&1==r.sb.length)throw new pt(2,4,4002);if(r.N&&0==r.N.length)throw new pt(2,4,4002);return a=i=null,t.ka.id&&t.C.id&&(i=e[a=t.ka.id+","+t.C.id]),o=function(t,e,n,r){var i=r.sb.length;r.N&&r.N.length!=r.sb.length&&(i=Math.min(r.N.length,r.sb.length));for(var a=[],o=r.startTime,s=0;s<i;s++){var u=r.sb[s],c=Fe(n,[u.ff]),l=void 0;l=null!=r.Z?o+r.Z:r.N?r.N[s].end:o+t,a.push(new ri(s+e,o,l,function(t){return t}.bind(null,c),u.start,u.end)),o=l}return a}(t.S.duration,r.ab,t.C.pa,r),i?(i.Yc(o),a=t.presentationTimeline.Lb(),i.Hc(a-t.S.start)):(t.presentationTimeline.ub(o,t.S.start),i=new ai(o),a&&t.mb&&(e[a]=i)),t.mb&&t.S.Vc||oi(i,t.S.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:i.find.bind(i),getSegmentReference:i.get.bind(i),initSegmentReference:n,ma:r.ma}}function gi(t){return t.La}function bi(t,e,n,r){var i=function(t){var e=Zr(t,wi,"initialization");if(!e)return null;var n=t.C.id,r=t.bandwidth||null,i=t.C.pa;return new ni(function(){var t=Jr(e,n,null,r,null);return Fe(i,[t])},0,null)}(t),a=Qr(t,wi),o=Zr(t,wi,"media"),s=Zr(t,wi,"index");if(o=(a={Z:a.Z,timescale:a.timescale,ab:a.ab,ma:a.ma,yd:a.yd,N:a.N,Xc:o,Nb:s}).Nb?1:0,o+=a.N?1:0,0==(o+=a.Z?1:0))throw new pt(2,4,4002);if(1!=o&&(a.Nb&&(a.N=null),a.Z=null),!a.Nb&&!a.Xc)throw new pt(2,4,4002);if(a.Nb){if("mp4"!=(n=t.C.mimeType.split("/")[1])&&"webm"!=n)throw new pt(2,4,4006);if("webm"==n&&!i)throw new pt(2,4,4005);r=Jr(a.Nb,t.C.id,null,t.bandwidth||null,null),t=mi(t,e,i,r=Fe(t.C.pa,[r]),0,null,n,a.ma)}else a.Z?(r||(t.presentationTimeline.$c(a.Z),t.presentationTimeline.ad(t.S.start)),t=function(t,e){var n=t.S.duration,r=e.Z,i=e.ab,a=e.timescale,o=e.Xc,s=t.bandwidth||null,u=t.C.id,c=t.C.pa;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(t){return 0>t||n&&t>=n?null:Math.floor(t/r)},getSegmentReference:function(t){var e=t*r,l=e+r;return n&&(l=Math.min(l,n)),0>l||n&&e>=n?null:new ri(t,e,l,function(){var n=Jr(o,u,t+i,s,e*a);return Fe(c,[n])},0,null)}}}(t,a)):(o=e=null,t.ka.id&&t.C.id&&(e=n[o=t.ka.id+","+t.C.id]),s=function(t,e){for(var n=[],r=0;r<e.N.length;r++){var i=r+e.ab;n.push(new ri(i,e.N[r].start,e.N[r].end,function(t,e,n,r,i,a){return t=Jr(t,e,i,n,a),Fe(r,[t]).map(function(t){return t.toString()})}.bind(null,e.Xc,t.C.id,t.bandwidth||null,t.C.pa,i,e.N[r].hg+e.yd),0,null))}return n}(t,a),r=!t.mb||!t.S.Vc,e?(r&&oi(new ai(s),t.S.duration),e.Yc(s),n=t.presentationTimeline.Lb(),e.Hc(n-t.S.start)):(t.presentationTimeline.ub(s,t.S.start),e=new ai(s),o&&t.mb&&(n[o]=e)),r&&oi(e,t.S.duration),t={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:e.find.bind(e),getSegmentReference:e.get.bind(e)});return{createSegmentIndex:t.createSegmentIndex,findSegmentPosition:t.findSegmentPosition,getSegmentReference:t.getSegmentReference,initSegmentReference:i,ma:a.ma}}function wi(t){return t.Tb}K("shaka.media.InitSegmentReference",ni),ni.prototype.Ec=function(){return this.c()},ni.prototype.createUris=ni.prototype.Ec,ni.prototype.Qc=function(){return this.b},ni.prototype.getStartByte=ni.prototype.Qc,ni.prototype.Pc=function(){return this.a},ni.prototype.getEndByte=ni.prototype.Pc,K("shaka.media.SegmentReference",ri),ri.prototype.ba=function(){return this.position},ri.prototype.getPosition=ri.prototype.ba,ri.prototype.Rc=function(){return this.startTime},ri.prototype.getStartTime=ri.prototype.Rc,ri.prototype.Ie=function(){return this.endTime},ri.prototype.getEndTime=ri.prototype.Ie,ri.prototype.Ec=function(){return this.c()},ri.prototype.createUris=ri.prototype.Ec,ri.prototype.Qc=function(){return this.b},ri.prototype.getStartByte=ri.prototype.Qc,ri.prototype.Pc=function(){return this.a},ri.prototype.getEndByte=ri.prototype.Pc,K("shaka.media.SegmentIndex",ai),ai.prototype.destroy=function(){return this.a=null,Promise.resolve()},ai.prototype.destroy=ai.prototype.destroy,ai.prototype.find=function(t){for(var e=this.a.length-1;0<=e;--e){var n=this.a[e];if(t>=n.startTime&&t<n.endTime)return n.position}return this.a.length&&t<this.a[0].startTime?this.a[0].position:null},ai.prototype.find=ai.prototype.find,ai.prototype.get=function(t){return 0==this.a.length?null:0>(t-=this.a[0].position)||t>=this.a.length?null:this.a[t]},ai.prototype.get=ai.prototype.get,ai.prototype.offset=function(t){for(var e=0;e<this.a.length;++e)this.a[e].startTime+=t,this.a[e].endTime+=t},ai.prototype.offset=ai.prototype.offset,ai.prototype.Yc=function(t){for(var e=[],n=0,r=0;n<this.a.length&&r<t.length;){var i=this.a[n],a=t[r];i.startTime<a.startTime?(e.push(i),n++):(i.startTime>a.startTime?0==n&&e.push(a):(.1<Math.abs(i.endTime-a.endTime)?e.push(new ri(i.position,a.startTime,a.endTime,a.c,a.b,a.a)):e.push(i),n++),r++)}for(;n<this.a.length;)e.push(this.a[n++]);if(e.length)for(n=e[e.length-1].position+1;r<t.length;)i=new ri(n++,(i=t[r++]).startTime,i.endTime,i.c,i.b,i.a),e.push(i);else e=t;this.a=e},ai.prototype.merge=ai.prototype.Yc,ai.prototype.Hc=function(t){for(var e=0;e<this.a.length;++e)if(this.a[e].endTime>t)return void this.a.splice(0,e);this.a=[]},ai.prototype.evict=ai.prototype.Hc,si.prototype.sa=function(){return this.a.sa()},hi.prototype.parse=function(t,e,n,r){var i;if(440786851!=ui(e=new si(new DataView(e))).id)throw new pt(2,3,3008);var a=ui(e);if(408125543!=a.id)throw new pt(2,3,3009);for(e=a.a.byteOffset,a=new si(a.a),i=null;a.sa();){var o=ui(a);if(357149030==o.id){i=o;break}}if(!i)throw new pt(2,3,3010);for(a=new si(i.a),i=1e6,o=null;a.sa();){var s=ui(a);if(2807729==s.id)i=fi(s);else if(17545==s.id)if(4==(o=s).a.byteLength)o=o.a.getFloat32(0);else{if(8!=o.a.byteLength)throw new pt(2,3,3003);o=o.a.getFloat64(0)}}if(null==o)throw new pt(2,3,3011);if(i=o*(a=i/1e9),475249515!=(t=ui(new si(new DataView(t)))).id)throw new pt(2,3,3007);return function(t,e,n,r,i,a){function o(){return i}var s=[];t=new si(t.a);for(var u=null,c=null;t.sa();){var l=ui(t);if(187==l.id){var f=di(l);f&&(l=n*f.ig,f=e+f.Gf,null!=u&&s.push(new ri(s.length,u-a,l-a,o,c,f-1)),u=l,c=f)}}return null!=u&&s.push(new ri(s.length,u-a,r-a,o,c,null)),s}(t,e,a,i,n,r)};var Ti={yb:{},Pb:{},kd:function(t,e){Ti.Pb[t]=e}};function Ei(t,e,n){this.f=t,this.rc=e,this.h=this.g=1/0,this.a=1,this.b=this.c=null,this.l=0,this.m=!0,this.i=0,this.s=void 0===n||n}function Si(t,e,n,r){return t=Lt(t,r),0==e&&null==n||(t.headers.Range=n?"bytes="+e+"-"+n:"bytes="+e+"-"),t}function xi(){var t=this;this.b=this.a=null,this.f=[],this.c=null,this.l=[],this.h=1,this.m={},this.s=0,this.v=new H(5),this.i=new ft(function(){!function(t){p(function e(){var n,r;return L(e,function(e){switch(e.j){case 1:return n=0,k(e,2),S(e,ki(t),4);case 4:n=e.o,I(e,3);break;case 2:r=M(e),t.b&&(r.severity=1,t.b.onError(r));case 3:if(!t.b)return e.return();Ni(t,n),x(e)}})})}(t)}),this.g=new Pt}function ki(t){var e=Date.now(),n=t.b.networkingEngine.request(0,Lt(t.f,t.a.retryParameters));return Ct(t.g,n),n.promise.then(function(e){if(t.b)return e.uri&&!t.f.includes(e.uri)&&t.f.unshift(e.uri),function(t,e,n){if(!(e=qr.Vd(e,"MPD")))throw new pt(2,4,4001,n);return e=ei(e,t.a.retryParameters,t.a.dash.xlinkFailGracefully,n,t.b.networkingEngine),Ct(t.g,e),e.promise.then(function(e){return function(t,e,n){return p(function r(){var i,a,o,s,u,c,l,f,h,d,p,m,v,y,g,b,w,T,E,k,A,I,M;return L(r,function(r){switch(r.j){case 1:s=Be,c=[n],0<(l=(u=qr).O(e,"Location").map(u.fc).filter(s.Ia)).length&&(f=Fe(c,l),c=t.f=f),h=u.O(e,"BaseURL").map(u.fc),d=Fe(c,h),p=t.a.dash.ignoreMinBufferTime,m=0,p||(m=u.K(e,"minBufferTime",u.Da)),t.s=u.K(e,"minimumUpdatePeriod",u.Da,-1),v=u.K(e,"availabilityStartTime",u.yf),y=u.K(e,"timeShiftBufferDepth",u.Da),g=u.K(e,"suggestedPresentationDelay",u.Da),b=u.K(e,"maxSegmentDuration",u.Da),w=e.getAttribute("type")||"static",t.c?T=t.c.presentationTimeline:(E=Math.max(t.a.dash.defaultPresentationDelay,1.5*m),T=new Ei(v,null!=g?g:E,t.a.dash.autoCorrectDrift));for(var N={mb:"static"!=w,presentationTimeline:T,ka:null,S:null,ca:null,C:null,bandwidth:0,Id:!1},P=d,C=qr.K(e,"mediaPresentationDuration",qr.Da),R=[],D=0,_=qr.O(e,"Period"),L=0;L<_.length;L++){var U=_[L];D=qr.K(U,"start",qr.Da,D);var O=qr.K(U,"duration",qr.Da),j=null;if(L!=_.length-1){var B=qr.K(_[L+1],"start",qr.Da);null!=B&&(j=B-D)}else null!=C&&(j=C-D);if(null==j&&(j=O),U=Ai(t,N,P,{start:D,duration:j,node:U,Vc:null==j||L==_.length-1}),R.push(U),O=N.ka.id,t.l.includes(O)||(t.l.push(O),t.c&&(t.b.filterNewPeriod(U),t.c.periods.push(U))),null==j){D=null;break}D+=j}if(null==t.c&&t.b.filterAllPeriods(R),null!=C?(i=R,a=C,o=!1):(i=R,a=D,o=!0),k=a,A=i,T.Ub("static"==w),"static"!=w&&o||T.wa(k||1/0),T.V()&&!isNaN(t.a.availabilityWindowOverride)&&(y=t.a.availabilityWindowOverride),null==y&&(y=1/0),T.sd(y),T.$c(b||1),t.c){r.A(0);break}if(t.c={presentationTimeline:T,periods:A,offlineSessionIds:[],minBufferTime:m||0},!T.je()){r.A(0);break}return I=u.O(e,"UTCTiming"),S(r,function(t,e,n){n=n.map(function(t){return{scheme:t.getAttribute("schemeIdUri"),value:t.getAttribute("value")}});var r=t.a.dash.clockSyncUri;return!n.length&&r&&n.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:r}),Be.Ae(n,function(t){var n=t.scheme;switch(t=t.value,n){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Ci(this,e,t,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Ci(this,e,t,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return n=Date.parse(t),isNaN(n)?0:n-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return Y("NTP UTCTiming scheme is not supported"),Promise.reject();default:return Y("Unrecognized scheme in UTCTiming element",n),Promise.reject()}}.bind(t)).catch(function(){return Y("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0})}(t,d,I),4);case 4:if(M=r.o,!t.b)return r.return();T.ee(M),x(r)}})})}(t,e,n)})}(t,e.data,e.uri)}).then(function(){var n=(Date.now()-e)/1e3;return z(t.v,1,n),n})}function Ai(t,e,n,r){if(e.ka=Pi(r.node,null,n),e.S=r,e.ka.id||(e.ka.id="__shaka_period_"+r.start),qr.O(r.node,"EventStream").forEach(t.zf.bind(t,r.start,r.duration)),n=qr.O(r.node,"AdaptationSet").map(t.xf.bind(t,e)).filter(Be.Ia),e.mb){e=[];for(var i=h(n),a=i.next();!a.done;a=i.next())for(var o=(a=h(a.value.Jf)).next();!o.done;o=a.next())e.push(o.value);if(e.length!=new Set(e).size)throw new pt(2,4,4018)}var s=n.filter(function(t){return!t.wd});if(n.filter(function(t){return t.wd}).forEach(function(t){var e=t.streams[0],n=t.wd;s.forEach(function(t){t.id==n&&t.streams.forEach(function(t){t.trickModeVideo=e})})}),e=Ii(s,"video"),i=Ii(s,"audio"),!e.length&&!i.length)throw new pt(2,4,4004);for(n=t.a.disableAudio,i.length&&!n||(i=[null]),e.length||(e=[null]),n=[],a=0;a<i.length;a++)for(o=0;o<e.length;o++)Mi(t,i[a],e[o],n);for(t=Ii(s,"text"),e=[],i=0;i<t.length;i++)e.push.apply(e,t[i].streams);return{startTime:r.start,textStreams:e,variants:n}}function Ii(t,e){return t.filter(function(t){return t.contentType==e})}function Mi(t,e,n,r){if(e||n)if(e&&n){var i=e.drmInfos,a=n.drmInfos;if(!i.length||!a.length||0<Me(i,a).length){a=Me(e.drmInfos,n.drmInfos);for(var o=0;o<e.streams.length;o++)for(var s=0;s<n.streams.length;s++)i=(n.streams[s].bandwidth||0)+(e.streams[o].bandwidth||0),i={id:t.h++,language:e.language,primary:e.Wc||n.Wc,audio:e.streams[o],video:n.streams[s],bandwidth:i,drmInfos:a,allowedByApplication:!0,allowedByKeySystem:!0},r.push(i)}}else for(a=e||n,o=0;o<a.streams.length;o++)i=a.streams[o].bandwidth||0,i={id:t.h++,language:a.language||"und",primary:a.Wc,audio:e?a.streams[o]:null,video:n?a.streams[o]:null,bandwidth:i,drmInfos:a.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},r.push(i)}function Ni(t,e){0>t.s||t.i.P(Math.max(3,t.s-e,q(t.v)))}function Pi(t,e,n){e=e||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,bd:null},n=n||e.pa;var r=qr.xb,i=qr.Ce,a=qr.O(t,"BaseURL").map(qr.fc),o=t.getAttribute("contentType")||e.contentType,s=t.getAttribute("mimeType")||e.mimeType,u=t.getAttribute("codecs")||e.codecs;i=qr.K(t,"frameRate",i)||e.frameRate;for(var c=qr.O(t,"InbandEventStream"),l=e.emsgSchemeIdUris.slice(),f=(c=h(c)).next();!f.done;f=c.next())f=f.value.getAttribute("schemeIdUri"),l.includes(f)||l.push(f);return c=function(t){for(var e=0;e<t.length;++e){var n=t[e],r=n.getAttribute("schemeIdUri");if(r&&(n=n.getAttribute("value")))switch(r){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(r=parseInt(n,10)))continue;return r;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(r=parseInt(n,16)){for(t=0;r;)1&r&&++t,r>>=1;return t}}}return null}(c=qr.O(t,"AudioChannelConfiguration"))||e.bd,o||(o=Ri(s,u)),{pa:Fe(n,a),Rb:qr.dc(t,"SegmentBase")||e.Rb,La:qr.dc(t,"SegmentList")||e.La,Tb:qr.dc(t,"SegmentTemplate")||e.Tb,width:qr.K(t,"width",r)||e.width,height:qr.K(t,"height",r)||e.height,contentType:o,mimeType:s,codecs:u,frameRate:i,emsgSchemeIdUris:l,id:t.getAttribute("id"),bd:c}}function Ci(t,e,n,r){return(e=Lt(e=Fe(e,[n]),t.a.retryParameters)).method=r,e=t.b.networkingEngine.request(4,e),Ct(t.g,e),e.promise.then(function(t){if("HEAD"==r){if(!t.headers||!t.headers.date)return 0;t=t.headers.date}else t=ie(t.data);return t=Date.parse(t),isNaN(t)?0:t-Date.now()})}function Ri(t,e){return dn($t(t,e))?"text":t.split("/")[0]}function Di(t,e,n,r){this.b=t,this.type=e,this.a=n,this.segments=r||null}function _i(t,e,n,r){this.id=t,this.name=e,this.a=n,this.value=void 0===r?null:r}function Li(t,e){this.name=t,this.value=e}function Ui(t,e,n){return(t=t.getAttribute(e))?t.value:n||null}function Oi(t,e){this.b=e,this.a=t}K("shaka.media.ManifestParser.registerParserByExtension",Ti.kd),Ti.Bb=function(t,e){Ti.yb[t]=e},K("shaka.media.ManifestParser.registerParserByMime",Ti.Bb),Ti.Df=function(){var t={};if(Zt()){for(var e in Ti.yb)t[e]=!0;for(var n in Ti.Pb)t[n]=!0}e={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var r=(n=h(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!r.done;r=n.next())t[r=r.value]=Zt()?!!Ti.yb[r]:te(r);for(var i in e)t[i]=Zt()?!!Ti.Pb[i]:te(e[i]);return t},Ti.create=function(t,e,n,r){return p(function i(){var a,o;return L(i,function(i){switch(i.j){case 1:return k(i,2),S(i,Ti.Je(t,e,n,r),4);case 4:return a=i.o,i.return(new a);case 2:throw(o=M(i)).severity=2,o}})})},Ti.Je=function(t,e,n,r){return p(function i(){var a,o,s,u,c;return L(i,function(i){switch(i.j){case 1:if(a=Ti,r&&(o=a.yb[r.toLowerCase()]))return i.return(o);if((s=a.getExtension(t))&&(u=a.Pb[s]))return i.return(u);if(r){i.A(2);break}return S(i,a.Re(t,e,n),3);case 3:if((r=i.o)&&(c=Ti.yb[r]))return i.return(c);case 2:throw new pt(2,4,4e3,t)}})})},Ti.Re=function(t,e,n){return p(function r(){var i,a,o;return L(r,function(r){switch(r.j){case 1:return(i=Lt([t],n)).method="HEAD",S(r,e.request(0,i).promise,2);case 2:return a=r.o,o=a.headers["content-type"],r.return(o?o.toLowerCase().split(";").shift():"")}})})},Ti.getExtension=function(t){return 1==(t=new J(t).ja.split("/").pop().split(".")).length?"":t.pop().toLowerCase()},Ti.isSupported=function(t,e){return!!Zt()&&(e in Ti.yb||Ti.getExtension(t)in Ti.Pb)},K("shaka.media.PresentationTimeline",Ei),Ei.prototype.Y=function(){return this.g},Ei.prototype.getDuration=Ei.prototype.Y,Ei.prototype.Pe=function(){return this.a},Ei.prototype.getMaxSegmentDuration=Ei.prototype.Pe,Ei.prototype.wa=function(t){this.g=t},Ei.prototype.setDuration=Ei.prototype.wa,Ei.prototype.We=function(){return this.f},Ei.prototype.getPresentationStartTime=Ei.prototype.We,Ei.prototype.ee=function(t){this.l=t},Ei.prototype.setClockOffset=Ei.prototype.ee,Ei.prototype.Ub=function(t){this.m=t},Ei.prototype.setStatic=Ei.prototype.Ub,Ei.prototype.sd=function(t){this.h=t},Ei.prototype.setSegmentAvailabilityDuration=Ei.prototype.sd,Ei.prototype.Tf=function(t){this.rc=t},Ei.prototype.setDelay=Ei.prototype.Tf,Ei.prototype.He=function(){return this.rc},Ei.prototype.getDelay=Ei.prototype.He,Ei.prototype.ub=function(t,e){if(0!=t.length){var n=t[t.length-1].endTime+e;this.ad(t[0].startTime+e),this.a=t.reduce(function(t,e){return Math.max(t,e.endTime-e.startTime)},this.a),this.b=Math.max(this.b,n),null!=this.f&&this.s&&(this.f=(Date.now()+this.l)/1e3-this.b-this.a)}},Ei.prototype.notifySegments=Ei.prototype.ub,Ei.prototype.ad=function(t){this.c=null==this.c?t:Math.min(this.c,t)},Ei.prototype.notifyMinSegmentStartTime=Ei.prototype.ad,Ei.prototype.$c=function(t){this.a=Math.max(this.a,t)},Ei.prototype.notifyMaxSegmentDuration=Ei.prototype.$c,Ei.prototype.offset=function(t){null!=this.c&&(this.c+=t),null!=this.b&&(this.b+=t)},Ei.prototype.offset=Ei.prototype.offset,Ei.prototype.V=function(){return 1/0==this.g&&!this.m},Ei.prototype.isLive=Ei.prototype.V,Ei.prototype.Xa=function(){return 1/0!=this.g&&!this.m},Ei.prototype.isInProgress=Ei.prototype.Xa,Ei.prototype.Lb=function(){if(1/0==this.h)return this.i;var t=this.pb()-this.h;return Math.max(this.i,t)},Ei.prototype.getSegmentAvailabilityStart=Ei.prototype.Lb,Ei.prototype.fe=function(t){this.i=t},Ei.prototype.setUserSeekStart=Ei.prototype.fe,Ei.prototype.pb=function(){return this.V()||this.Xa()?Math.min(Math.max(0,(Date.now()+this.l)/1e3-this.a-this.f),this.g):this.g},Ei.prototype.getSegmentAvailabilityEnd=Ei.prototype.pb,Ei.prototype.Kb=function(t){var e=Math.max(this.c,this.i);if(1/0==this.h)return e;var n=this.pb()-this.h;return t=Math.min(n+t,this.Ba()),Math.max(e,t)},Ei.prototype.getSafeSeekRangeStart=Ei.prototype.Kb,Ei.prototype.ob=function(){return this.Kb(0)},Ei.prototype.getSeekRangeStart=Ei.prototype.ob,Ei.prototype.Ba=function(){var t=this.V()||this.Xa()?this.rc:0;return Math.max(0,this.pb()-t)},Ei.prototype.getSeekRangeEnd=Ei.prototype.Ba,Ei.prototype.je=function(){return null!=this.f&&null==this.b},Ei.prototype.usingPresentationStartTime=Ei.prototype.je,K("shaka.dash.DashParser",xi),(n=xi.prototype).configure=function(t){this.a=t},n.start=function(t,e){var n=this;return p(function r(){var i;return L(r,function(r){switch(r.j){case 1:return n.f=[t],n.b=e,S(r,ki(n),2);case 2:if(i=r.o,n.b&&Ni(n,i),!n.b)throw new pt(2,7,7001);return r.return(n.c)}})})},n.stop=function(){return this.a=this.b=null,this.f=[],this.c=null,this.l=[],this.m={},null!=this.i&&(this.i.stop(),this.i=null),this.g.destroy()},n.update=function(){ki(this).catch(function(t){this.b&&this.b.onError(t)}.bind(this))},n.onExpirationUpdated=function(){},n.xf=function(t,e){t.ca=Pi(e,t.ka,null);var n=!1,r=qr.O(e,"Role"),i=r.map(function(t){return t.getAttribute("value")}).filter(Be.Ia),a=void 0,o="text"==t.ca.contentType;o&&(a="subtitle");for(var s=0;s<r.length;s++){var u=r[s].getAttribute("schemeIdUri");if(null==u||"urn:mpeg:dash:role:2011"==u)switch(u=r[s].getAttribute("value"),u){case"main":n=!0;break;case"caption":case"subtitle":a=u}}var c=null,l=!1;qr.O(e,"EssentialProperty").forEach(function(t){"http://dashif.org/guidelines/trickmode"==t.getAttribute("schemeIdUri")?c=t.getAttribute("value"):l=!0}),s=qr.O(e,"Accessibility");var f=new Map;for(r={},u=(s=h(s)).next();!u.done;r={Gb:r.Gb},u=s.next()){var d=u.value;u=d.getAttribute("schemeIdUri"),d=d.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==u||"urn:scte:dash:cc:cea-708:2015"==u?(r.Gb=1,null!=d?d.split(";").forEach(function(t){return function(e){if(e.includes("=")){var n=(e=e.split("="))[0].startsWith("CC")?e[0]:"CC"+e[0];e=e[1].split(",")[0].split(":").pop()}else n="CC"+t.Gb,t.Gb+=2;f.set(n,Cn(e))}}(r)):f.set("CC1","und")):"urn:mpeg:dash:role:2011"==u&&null!=d&&(i.push(d),"captions"==d&&(a="caption"))}if(l)return null;var p=Xr(r=qr.O(e,"ContentProtection"),this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);if(r=Cn(e.getAttribute("lang")||"und"),s=e.getAttribute("label"),(u=qr.O(e,"Label"))&&u.length&&((u=u[0]).textContent&&(s=u.textContent)),0==(i=(u=qr.O(e,"Representation")).map(this.Af.bind(this,t,p,a,r,s,n,i,f)).filter(function(t){return!!t})).length){if(o)return null;throw new pt(2,4,4003)}return t.ca.contentType&&"application"!=t.ca.contentType||(t.ca.contentType=Ri(i[0].mimeType,i[0].codecs),i.forEach(function(e){e.type=t.ca.contentType})),i.forEach(function(t){p.drmInfos.forEach(function(e){t.keyId&&e.keyIds.push(t.keyId)})}),o=u.map(function(t){return t.getAttribute("id")}).filter(Be.Ia),{id:t.ca.id||"__fake__"+this.h++,contentType:t.ca.contentType,language:r,Wc:n,streams:i,drmInfos:p.drmInfos,wd:c,Jf:o}},n.Af=function(t,e,n,r,i,a,o,s,u){if(t.C=Pi(u,t.ca,null),!function(t){var e=t.Rb?1:0;return e+=t.La?1:0,0==(e+=t.Tb?1:0)?"text"==t.contentType||"application"==t.contentType:(1!=e&&(t.Rb&&(t.La=null),t.Tb=null),!0)}(t.C))return null;t.bandwidth=qr.K(u,"bandwidth",qr.pc)||0;var c=t.C.contentType;c="text"==c||"application"==c;try{var l=this.Kf.bind(this);if(t.C.Rb)var f=function(t,e){var n=Number(Zr(t,vi,"presentationTimeOffset"))||0,r=Zr(t,vi,"timescale"),i=1;r&&(i=qr.pc(r)||1),n=n/i||0,r=pi(t,vi);var a=t.C.contentType;if(i=t.C.mimeType.split("/")[1],"text"!=a&&"mp4"!=i&&"webm"!=i)throw new pt(2,4,4006);if("webm"==i&&!r)throw new pt(2,4,4005);a=ti(t,vi,"RepresentationIndex");var o=Zr(t,vi,"indexRange"),s=t.C.pa;if(o=qr.qc(o||""),a){var u=a.getAttribute("sourceURL");u&&(s=Fe(t.C.pa,[u])),o=qr.K(a,"range",qr.qc,o)}if(!o)throw new pt(2,4,4002);return{createSegmentIndex:(i=mi(t,e,r,s,o.start,o.end,i,n)).createSegmentIndex,findSegmentPosition:i.findSegmentPosition,getSegmentReference:i.getSegmentReference,initSegmentReference:r,ma:n}}(t,l);else if(t.C.La)f=yi(t,this.m);else if(t.C.Tb)f=bi(t,l,this.m,!!this.c);else{var h=t.C.pa,d=t.S.duration||0;f={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(t){return 0<=t&&t<d?1:null},getSegmentReference:function(t){return 1!=t?null:new ri(1,0,d,function(){return h},0,null)},initSegmentReference:null,ma:0}}}catch(p){if(c&&4002==p.code)return null;throw p}return u=function(t,e,n,r){var i=Xr(t,e,r);if(n.Ed)t=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,e=0==i.drmInfos.length,(0==n.drmInfos.length||t&&!e)&&(n.drmInfos=i.drmInfos),n.Ed=!1;else if(0<i.drmInfos.length&&(n.drmInfos=n.drmInfos.filter(function(t){return i.drmInfos.some(function(e){return e.keySystem==t.keySystem})}),0==n.drmInfos.length))throw new pt(2,4,4008);return i.Bd||n.Bd}(u=qr.O(u,"ContentProtection"),this.a.dash.customScheme,e,this.a.dash.ignoreDrmInfo),{id:this.h++,originalId:t.C.id,createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,initSegmentReference:f.initSegmentReference,presentationTimeOffset:f.ma,mimeType:t.C.mimeType,codecs:t.C.codecs,frameRate:t.C.frameRate,bandwidth:t.bandwidth,width:t.C.width,height:t.C.height,kind:n,encrypted:0<e.drmInfos.length,keyId:u,language:r,label:i,type:t.ca.contentType,primary:a,trickModeVideo:null,emsgSchemeIdUris:t.C.emsgSchemeIdUris,roles:o,channelsCount:t.C.bd,closedCaptions:s}},n.zf=function(t,e,n){var r=qr.xb,i=n.getAttribute("schemeIdUri")||"",a=n.getAttribute("value")||"",o=qr.K(n,"timescale",r)||1;qr.O(n,"Event").forEach(function(n){var s=qr.K(n,"presentationTime",r)||0,u=qr.K(n,"duration",r)||0;u=(s=s/o+t)+u/o,null!=e&&(s=Math.min(s,t+e),u=Math.min(u,t+e)),n={schemeIdUri:i,value:a,startTime:s,endTime:u,id:n.getAttribute("id")||"",eventElement:n},this.b.onTimelineRegionAdded(n)}.bind(this))},n.Kf=function(t,e,n){return t=Si(t,e,n,this.a.retryParameters),t=this.b.networkingEngine.request(1,t),Ct(this.g,t),t.promise.then(function(t){return t.data})},Ti.kd("mpd",xi),Ti.Bb("application/dash+xml",xi),Ti.Bb("video/vnd.mpeg.dash.mpd",xi),_i.prototype.toString=function(){var t="#"+this.name,e=this.a?this.a.map(function(t){return t.name+"="+(isNaN(Number(t.value))?'"'+t.value+'"':t.value)}):[];return this.value&&e.unshift(this.value),0<e.length&&(t+=":"+e.join(",")),t},_i.prototype.getAttribute=function(t){var e=this.a.filter(function(e){return e.name==t});return e.length?e[0]:null};var ji={nb:function(t,e){return t.filter(function(t){return t.name==e})},Ta:function(t,e){var n=ji.nb(t,e);return n.length?n[0]:null},Lc:function(t,e,n){return t.filter(function(t){var r=t.getAttribute("TYPE");return t=t.getAttribute("GROUP-ID"),r.value==e&&t.value==n})},Dc:function(t,e){return Fe([t],[e])[0]},Uc:function(t){return/^#(?!EXT)/m.test(t)}};function Bi(t){this.b=t,this.a=0}function Fi(t){Ki(t,/[ \t]+/gm)}function Ki(t,e){e.lastIndex=t.a;var n=e.exec(t.b);return n=null==n?null:{position:n.index,length:n[0].length,Mf:n},t.a==t.b.length||null==n||n.position!=t.a?null:(t.a+=n.length,n.Mf)}function Vi(t){return t.a==t.b.length?null:(t=Ki(t,/[^ \t\n]*/gm))?t[0]:null}function Hi(){this.a=0}function zi(t,e,n){var r=(e=(e=ie(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(r[0]))throw new pt(2,4,4015);e=0;for(var i=1;i<r.length;i++)if(!ji.Uc(r[i])){var a=Gi(t,r[i]);if(--t.a,Xi.includes(a.name)){e=1;break}"EXT-X-STREAM-INF"==a.name&&(i+=1)}for(i=[],a=1;a<r.length;)if(ji.Uc(r[a]))a+=1;else{var o=Gi(t,r[a]);if(Yi.includes(o.name)){if(1!=e)throw new pt(2,4,4017);return new Di(n,e,i,t=qi(t,n,r=r.splice(a,r.length-a),i))}i.push(o),a+=1,"EXT-X-STREAM-INF"==o.name&&(o.a.push(new Li("URI",r[a])),a+=1)}return new Di(n,e,i)}function qi(t,e,n,r){var i=[],a=[];return n.forEach(function(n){if(/^(#EXT)/.test(n))n=Gi(t,n),Xi.includes(n.name)?r.push(n):a.push(n);else{if(ji.Uc(n))return[];n=ji.Dc(e,n.trim()),i.push(new Oi(n,a)),a=[]}}),i}function Gi(t,e){var n=t.a++,r=e.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!r)throw new pt(2,4,4016,e);var i,a=r[1],o=r[2];if(r=[],o){var s;(s=Ki(o=new Bi(o),/^([^,=]+)(?:,|$)/g))&&(i=s[1]);for(var u=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;s=Ki(o,u);)r.push(new Li(s[1],s[2]||s[3]))}return new _i(n,a,r,i)}var Xi="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Yi="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Wi(t){try{var e=Wi.parse(t);return bt({uri:t,fd:t,data:e.data,headers:{"content-type":e.contentType}})}catch(n){return yt(n)}}function $i(){var t=this;this.c=this.g=null,this.$=1,this.D=new Map,this.T=new Set,this.a=new Map,this.b=null,this.v="",this.s=new Hi,this.R=0,this.h=new ft(function(){!function(t){p(function e(){var n,r;return L(e,function(e){switch(e.j){case 1:return t.g?(k(e,2),S(e,t.update(),4)):e.return();case 4:n=t.R,t.h.P(n),I(e,0);break;case 2:(r=M(e)).severity=1,t.g.onError(r),t.h.P(.1),x(e)}})})}(t)}),this.f=ma,this.m=null,this.B=0,this.F=1/0,this.i=new Pt,this.L=[],this.l=new Map,this.W=!1}function Ji(t,e){return p(function n(){var r,i,a,o,s,u,c,l,f,h;return L(n,function(n){switch(n.j){case 1:return r=ji,i=va,a=e.re,S(n,da(t,Lt([a],t.c.retryParameters),0),2);case 2:if(o=n.o,1!=(s=zi(t.s,o.data,o.uri)).type)throw new pt(2,4,4017);return c=(u=r.Ta(s.a,"EXT-X-MEDIA-SEQUENCE"))?Number(u.value):0,l=e.stream,S(n,aa(t,e.xc,s,c,l.mimeType,l.codecs),3);case 3:f=n.o,e.Sb.a=f,h=f[f.length-1],r.Ta(s.a,"EXT-X-ENDLIST")&&(ha(t,i.Qa),t.b.wa(h.endTime)),x(n)}})})}function Qi(t){t.forEach(function(t){var e=t.stream.codecs.split(",");e=e.filter(function(t){return"mp4a.40.34"!=t}),t.stream.codecs=e.join(",")})}function Zi(t,e,n,r,i){return{id:t.$++,language:e?e.language:"und",primary:!!e&&e.primary||!!n&&n.primary,audio:e,video:n,bandwidth:r,drmInfos:i,allowedByApplication:!0,allowedByKeySystem:!0}}function ta(t,e,n){return p(function r(){var i,a,o,s,u,c,l,f,h;return L(r,function(r){switch(r.j){case 1:if(i=ua(e,"URI"),t.a.has(i))return r.return(t.a.get(i));if(a=ua(e,"TYPE").toLowerCase(),o=Ve,"subtitles"==a&&(a=o.qa),s=Cn(Ui(e,"LANGUAGE","und")),u=Ui(e,"NAME"),c=e.getAttribute("DEFAULT"),l=e.getAttribute("AUTOSELECT"),f=Ui(e,"CHANNELS"),"audio"==a)if(f){var d=f.split("/")[0];d=parseInt(d,10)}else d=null;else d=null;return S(r,ea(t,i,n,a,s,!!c||!!l,u,d,null),2);case 2:return null==(h=r.o)?r.return(null):t.a.has(i)?r.return(t.a.get(i)):(t.D.set(e.id,h),t.a.set(i,h),r.return(h))}})})}function ea(t,e,n,r,i,a,o,s,u){return p(function c(){var l,f,d,m,v,y,g,b,w,T,E,x,k,A,I,M,N,P,C,R,D,_,U,O,j;return L(c,function(c){switch(c.j){case 1:return f=(l=ji).Dc(t.v,e),m="",S(c,da(t,Lt([f],t.c.retryParameters),0),2);case 2:if(y=c.o,f=y.uri,1!=(d=zi(t.s,y.data,f)).type)throw new pt(2,4,4017);g=[],d.segments.forEach(function(t){t=l.nb(t.b,"EXT-X-KEY"),g.push.apply(g,t)}),b=!1,w=[],T=null;for(var B=h(g),F=B.next();!F.done;F=B.next())if(E=F.value,"NONE"!=(x=ua(E,"METHOD"))){if(b=!0,"AES-128"==x)return t.W=!0,c.return(null);k=ua(E,"KEYFORMAT"),(I=(A=pa[k])?A(E):null)&&(I.keyIds.length&&(T=I.keyIds[0]),w.push(I))}if(b&&!w.length)throw new pt(2,4,4026);return function(t,e){var n=va,r=ji.Ta(e.a,"EXT-X-PLAYLIST-TYPE"),i=ji.Ta(e.a,"EXT-X-ENDLIST");i=r&&"VOD"==r.value||i,r=r&&"EVENT"==r.value&&!i,r=!i&&!r,i?ha(t,n.Qa):(ha(t,r?n.zd:n.me),n=ca(e.a,"EXT-X-TARGETDURATION"),n=Number(n.value),t.B=Math.max(n,t.B),t.F=Math.min(n,t.F))}(t,d),m=function(t,e){if(1==e.length)return e[0];var n=sa(t,e);if(null!=n)return n;throw new pt(2,4,4025,e)}(r,n),S(c,function(t,e,n,r){return p(function i(){var a,o,s,u,c,l,f,h,d;return L(i,function(i){switch(i.j){case 1:return a=Ve,o=r.segments[0].a,s=new J(o),u=s.ja.split(".").pop(),c=fa[e],(l=c[u])?i.return(l):e==a.qa?n&&"vtt"!=n?i.return("application/mp4"):i.return("text/vtt"):((f=Lt([o],t.c.retryParameters)).method="HEAD",S(i,da(t,f,1),2));case 2:if(h=i.o,!(d=h.headers["content-type"]))throw new pt(2,4,4021,u);return i.return(d.split(";")[0])}})})}(t,r,m,d),3);case 3:return v=c.o,N=(M=l.Ta(d.a,"EXT-X-MEDIA-SEQUENCE"))?Number(M.value):0,S(c,aa(t,e,d,N,v,m),4);case 4:return P=c.o,C=P[0].startTime,R=P[P.length-1].endTime,D=R-C,_=new ai(P),U=na(d),O=void 0,"text"==r&&(O="subtitle"),j={id:t.$++,originalId:o,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:_.find.bind(_),getSegmentReference:_.get.bind(_),initSegmentReference:U,presentationTimeOffset:0,mimeType:v,codecs:m,kind:O,encrypted:b,keyId:T,language:i,label:o,type:r,primary:a,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:[],channelsCount:s,closedCaptions:u},c.return({stream:j,Sb:_,drmInfos:w,xc:e,re:f,Zc:C,sg:R,duration:D})}})})}function na(t){var e=ji.nb(t.a,"EXT-X-MAP");if(!e.length)return null;if(1<e.length)throw new pt(2,4,4020);var n=ua(e=e[0],"URI"),r=ji.Dc(t.b,n);return t=0,n=null,(e=Ui(e,"BYTERANGE"))&&(t=e.split("@"),e=Number(t[0]),n=(t=Number(t[1]))+e-1),new ni(function(){return[r]},t,n)}function ra(t,e,n,r){var i=e.b,a=e.a;e=ca(i,"EXTINF").value.split(","),e=r+Number(e[0]);var o=0,s=null;return(i=ji.Ta(i,"EXT-X-BYTERANGE"))&&(o=i.value.split("@"),i=Number(o[0]),s=(o=o[1]?Number(o[1]):t.a+1)+i-1),new ri(n,r,e,function(){return[a]},o,s)}function ia(t){t.b&&(t.L.forEach(function(e){t.b.ub(e,0)}),t.L=[])}function aa(t,e,n,r,i,a){return p(function o(){var s,u,c,l,f,h,d,m,v,y;return L(o,function(o){switch(o.j){case 1:return s=n.segments,u=[],c=s[0].a,l=ra(null,s[0],r,0),f=na(n),S(o,function(t,e,n,r,i,a){return p(function o(){var s,u,c,l,f,h,d,p,m;return L(o,function(o){switch(o.j){case 1:if(t.m&&(s=t.a.get(e),u=s.Sb,c=u.get(r.position)))return o.return(c.startTime);if("audio/mpeg"==i)return o.return(0);if("video/mp4"!=i&&"audio/mp4"!=i){o.A(2);break}return l=[oa(t,r)],n&&l.push(oa(t,n)),S(o,Promise.all(l),3);case 3:return f=o.o,h=f[0],d=f[1]||f[0],o.return(function(t,e){var n=0;if((new jr).H("moov",Br).H("trak",Br).H("mdia",Br).fa("mdhd",function(t){t.reader.M(0==t.version?8:16),n=t.reader.G(),t.parser.stop()}).parse(e,!0),!n)throw new pt(2,4,4030);var r=0,i=!1;if((new jr).H("moof",Br).H("traf",Br).fa("tfdt",function(t){r=(0==t.version?t.reader.G():t.reader.Ab())/n,i=!0,t.parser.stop()}).parse(t,!0),!i)throw new pt(2,4,4030);return r}(h.data,d.data));case 2:if("video/mp2t"!=i){o.A(4);break}return S(o,oa(t,r),5);case 5:return p=o.o,o.return(function(t){function e(){throw new pt(2,4,4030)}t=new Lr(new DataView(t),0);for(var n=0,r=0;;){if(n=t.ba(),71!=(r=t.la())&&e(),16384&t.Qb()||e(),0!=(r=(48&t.la())>>4)&&2!=r||e(),3==r&&(r=t.la(),t.M(r)),1==t.G()>>8)return t.M(3),0!=(n=t.la()>>6)&&1!=n||e(),0==t.la()&&e(),n=t.la(),r=t.Qb(),t=t.Qb(),(1073741824*((14&n)>>1)+((65534&r)<<14|(65534&t)>>1))/9e4;t.seek(n+188),71!=(r=t.la())&&(t.seek(n+192),r=t.la()),71!=r&&(t.seek(n+204),r=t.la()),71!=r&&e(),t.be(1)}}(p.data));case 4:if("application/mp4"!=i&&!i.startsWith("text/")){o.A(6);break}return S(o,oa(t,r),7);case 7:return m=o.o,o.return(function(t,e,n){return dn(t=$t(t,e))?(pn(e=new fn(null),t),e.Rc(n)):0}(i,a,m.data));case 6:if("video/webm"==i)return o.return(null);throw new pt(2,4,4030)}})})}(t,e,f,l,i,a),2);case 2:h=o.o,c.split("/").pop();for(var g=0;g<s.length;++g)d=s[g],m=u[u.length-1],v=0==g?h:m.endTime,y=ra(m,d,r+g,v),u.push(y);return t.L.push(u),ia(t),o.return(u)}})})}function oa(t,e){return p(function n(){var r,i,a,o,s,u;return L(n,function(n){switch(n.j){case 1:return r=1,i=Si(e.c(),e.b,e.b+2048-1,t.c.retryParameters),a=Si(e.c(),e.b,e.a,t.c.retryParameters),k(n,2),S(n,da(t,i,r),4);case 4:return o=n.o,n.return(o);case 2:if(7001==(s=M(n)).code)throw s;return Y("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),S(n,da(t,a,r),5);case 5:return u=n.o,n.return(u)}})})}function sa(t,e){for(var n=la[t],r=0;r<n.length;r++)for(var i=0;i<e.length;i++)if(n[r].test(e[i].trim()))return e[i].trim();return"text"==t?"":null}function ua(t,e){var n=t.getAttribute(e);if(!n)throw new pt(2,4,4023,e);return n.value}function ca(t,e){var n=ji.Ta(t,e);if(!n)throw new pt(2,4,4024,e);return n}K("shaka.net.DataUriPlugin",Wi),Wi.parse=function(e){var n=e.split(":");if(2>n.length||"data"!=n[0])throw new pt(2,1,1004,e);if(2>(n=n.slice(1).join(":").split(",")).length)throw new pt(2,1,1004,e);var r=n[0];n=t.decodeURIComponent(n.slice(1).join(","));var i=null;if(1<(r=r.split(";")).length&&(i=r[1]),"base64"==i)e=fe.Aa(n).buffer;else{if(i)throw new pt(2,1,1005,e);e=se(n)}return{data:e,contentType:r[0]}},_t("data",Wi),K("shaka.hls.HlsParser",$i),(n=$i.prototype).configure=function(t){this.c=t},n.start=function(t,e){var n=this;return p(function r(){var i,a;return L(r,function(r){switch(r.j){case 1:return n.g=e,S(r,da(n,Lt([t],n.c.retryParameters),0),2);case 2:return i=r.o,n.v=i.uri,S(r,function(t,e){return p(function n(){var r,i,a,o,s,u,c,l,f,d,m;return L(n,function(n){switch(n.j){case 1:if(0!=(r=zi(t.s,e,t.v)).type)throw new pt(2,4,4022);return S(n,function(t,e){return p(function n(){var r,i,a,o,s,u,c,l,f,d,m,v;return L(n,function(n){switch(n.j){case 1:return r=ji,i=Be,a=e.a,o=r.nb(e.a,"EXT-X-MEDIA"),s=o.filter(function(t){return"SUBTITLES"==ua(t,"TYPE")}.bind(t)),u=s.map(function(t){var e=this;return p(function n(){var r;return L(n,function(n){switch(n.j){case 1:return k(n,2),S(n,function(t,e){return p(function n(){var r;return L(n,function(n){switch(n.j){case 1:return ua(e,"TYPE"),S(n,ta(t,e,[]),2);case 2:return r=n.o,n.return(r.stream)}})})}(e,t),4);case 4:return n.return(n.o);case 2:if(r=M(n),e.c.hls.ignoreTextStreamFailures)return n.return(null);throw r}})})}.bind(t)),c=o.filter(function(t){return"CLOSED-CAPTIONS"==ua(t,"TYPE")}),function(t,e){for(var n=h(e),r=n.next();!r.done;r=n.next()){ua(r=r.value,"TYPE");var i=Ui(r,"LANGUAGE")||"und";i=Cn(i);var a=ua(r,"GROUP-ID");r=ua(r,"INSTREAM-ID"),t.l.get(a)||t.l.set(a,new Map),t.l.get(a).set(r,i)}}(t,c),S(n,Promise.all(u),2);case 2:return l=n.o,f=r.nb(a,"EXT-X-STREAM-INF"),d=f.map(function(t){return function(t,e,n){return p(function r(){var i,a,o,s,u,c,l,f,d,m,v,y,g,b,w,T,E,x,k,A,I,M,N,P,C,R,D;return L(r,function(r){switch(r.j){case 1:return i=Ve,a=ji,o=Ui(e,"CODECS","avc1.42E01E,mp4a.40.2"),s=function(t){for(var e=new Set,n=[],r=(t=h(t)).next();!r.done;r=t.next()){var i=Jt(r=r.value)[0];e.has(i)||(n.push(r),e.add(i))}return n}(o.split(/\s*,\s*/)),u=e.getAttribute("RESOLUTION"),l=c=null,f=Ui(e,"FRAME-RATE"),d=Number(ua(e,"BANDWIDTH")),u&&(m=u.value.split("x"),c=m[0],l=m[1]),v=(v=(v=a.nb(n.a,"EXT-X-MEDIA")).filter(function(t){return"CLOSED-CAPTIONS"!=ua(t,"TYPE")})).filter(function(t){var e=Ui(t,"URI")||"";return"SUBTITLES"==(Ui(t,"TYPE")||"")||""!=e}),y=Ui(e,"AUDIO"),g=Ui(e,"VIDEO"),y?v=a.Lc(v,"AUDIO",y):g&&(v=a.Lc(v,"VIDEO",g)),(b=sa(i.qa,s))&&((w=Ui(e,"SUBTITLES"))&&((T=a.Lc(v,"SUBTITLES",w)).length&&(E=t.D.get(T[0].id))&&(E.stream.codecs=b)),Mt(s,b)),x=v.map(function(t){return ta(this,t,s)}.bind(t)),k=[],A=[],S(r,Promise.all(x),2);case 2:if(M=(M=r.o).filter(function(t){return null!=t}),y?k=M:g&&(A=M),P=!1,k.length||A.length?k.length?(R=ua(e,"URI"),D=k[0].xc,R==D?(N=i.Db,P=!0):N=i.Pa):N=i.Db:1==s.length?(C=sa(i.Pa,s),N=u||f||C?i.Pa:i.Db):(N=i.Pa,s=[s.join(",")]),P){r.A(3);break}return S(r,function(t,e,n,r){return p(function i(){var a,o,s,u,c;return L(i,function(i){switch(i.j){case 1:return a=Ve,o=ua(e,"URI"),t.a.has(o)?i.return(t.a.get(o)):(s=Ui(e,"CLOSED-CAPTIONS"),u=null,r==a.Pa&&s&&"NONE"!=s&&(u=t.l.get(s)),S(i,ea(t,o,n,r,"und",!1,null,null,u),2));case 2:return null==(c=i.o)?i.return(null):t.a.has(o)?i.return(t.a.get(o)):(t.a.set(o,c),i.return(c))}})})}(t,e,s,N),4);case 4:I=r.o;case 3:if(I)I.stream.type==i.Db?k=[I]:A=[I];else if(null===I)return r.return([]);return A&&Qi(A),k&&Qi(k),r.return(function(t,e,n,r,i,a,o){n.forEach(function(t){(t=t.stream)&&(t.width=Number(i)||void 0,t.height=Number(a)||void 0,t.frameRate=Number(o)||void 0)}.bind(t));var s=!!t.c&&t.c.disableAudio;e.length&&!s||(e=[null]);n.length||(n=[null]),s=[];for(var u=(e=h(e)).next();!u.done;u=e.next()){u=u.value;for(var c=h(n),l=c.next();!l.done;l=c.next()){var f=l.value;l=u?u.stream:null;var d=f?f.stream:null,p=u?u.drmInfos:null,m=f?f.drmInfos:null;f=(f?f.xc:"")+" - "+(u?u.xc:"");var v=void 0;if(l&&d){if(p.length&&m.length&&!(0<Me(p,m).length))continue;v=Me(p,m)}else l?v=p:d&&(v=m);t.T.has(f)||(l=Zi(t,l,d,r,v),s.push(l),t.T.add(f))}}return s}(t,k,A,d,c,l,f))}})})}(this,t,e)}.bind(t)),S(n,Promise.all(d),3);case 3:return m=n.o,v=(v=m.reduce(i.Cc,[])).filter(function(t){return null!=t}),n.return({startTime:0,variants:v,textStreams:l.filter(function(t){return null!=t})})}})})}(t,r),2);case 2:if(i=n.o,!t.g)throw new pt(2,7,7001);if(t.W&&0==i.variants.length)throw new pt(2,4,4034);t.g.filterAllPeriods([i]),a=1/0,o=0,s=1/0;for(var v=h(t.a.values()),y=v.next();!y.done;y=v.next())u=y.value,a=Math.min(a,u.Zc),o=Math.max(o,u.Zc),"text"!=u.stream.type&&(s=Math.min(s,u.duration));if(t.f!=va.Qa?(t.b=new Ei(0,3*t.B),t.b.Ub(!1)):(t.b=new Ei(null,0),t.b.Ub(!0)),ia(t),t.f!=va.Qa){for(t.R=t.F,c=va,t.f==c.zd&&(l=t.b.rc,isNaN(t.c.availabilityWindowOverride)||(l=t.c.availabilityWindowOverride),t.b.sd(l)),f=0;95443.7176888889<=o;)f+=95443.7176888889,o-=95443.7176888889;if(f)for(v=h(t.a.values()),y=v.next();!y.done;y=v.next())95443.7176888889>(d=y.value).Zc&&(d.stream.presentationTimeOffset=-f,d.Sb.offset(f))}else for(t.b.wa(s),t.b.offset(-a),v=h(t.a.values()),y=v.next();!y.done;y=v.next())(m=y.value).stream.presentationTimeOffset=a,m.Sb.offset(-a),oi(m.Sb,s);t.m={presentationTimeline:t.b,periods:[i],offlineSessionIds:[],minBufferTime:0},x(n)}})})}(n,i.data),3);case 3:return 0<(a=n.R)&&n.h.P(a),r.return(n.m)}})})},n.stop=function(){this.h&&(this.h.stop(),this.h=null);var t=[];return this.i&&(t.push(this.i.destroy()),this.i=null),this.c=this.g=null,this.D.clear(),this.T.clear(),this.a.clear(),this.m=null,Promise.all(t)},n.update=function(){if(this.f!=va.Qa){for(var t=[],e=h(this.a.values()),n=e.next();!n.done;n=e.next())t.push(Ji(this,n.value));return Promise.all(t)}},n.onExpirationUpdated=function(){};var la={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},fa={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",ts:"video/mp2t"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function ha(t,e){t.f=e,t.b&&t.b.Ub(t.f==va.Qa),t.f!=va.Qa||t.h.stop()}function da(t,e,n){if(!t.i)throw new pt(2,7,7001);return e=t.g.networkingEngine.request(n,e),Ct(t.i,e),e.promise}var pa={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(t){var e=ua(t,"METHOD");return Qn("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227"),["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].includes(e)?(e=ua(t,"URI"),e=Wi.parse(e),e=Ke("com.widevine.alpha",[{initDataType:"cenc",initData:e=new Uint8Array(e.data)}]),(t=Ui(t,"KEYID"))&&(e.keyIds=[t.substr(2).toLowerCase()]),e):null}},ma="VOD",va={Qa:ma,me:"EVENT",zd:"LIVE"};function ya(){this.a=new Map}function ga(t,e,n){ba(t,e).text=n}function ba(t,e){return t.a.has(e)||t.a.set(e,new wa),t.a.get(e)}function wa(){this.text=this.variant=null}function Ta(t,e){this.a=t,this.b=new Set([t]);for(var n=h(e=e||[]),r=n.next();!r.done;r=n.next())this.add(r.value)}function Ea(t,e){var n;if(!(n=!!t.audio!=!!e.audio||!!t.video!=!!e.video||t.language!=e.language)&&(n=t.audio&&e.audio)){n=t.audio;var r=e.audio;n=!(n.channelsCount==r.channelsCount&&Sa(n,r)&&xa(n.roles,r.roles))}return!n&&(n=t.video&&e.video)&&(n=!(Sa(n=t.video,r=e.video)&&xa(n.roles,r.roles))),!n}function Sa(t,e){if(t.mimeType!=e.mimeType)return!1;var n=t.codecs.split(",").map(function(t){return Jt(t)[0]}),r=e.codecs.split(",").map(function(t){return Jt(t)[0]});if(n.length!=r.length)return!1;n.sort(),r.sort();for(var i=0;i<n.length;i++)if(n[i]!=r[i])return!1;return!0}function xa(t,e){var n=new Set(t),r=new Set(e);if(n.delete("main"),r.delete("main"),n.size!=r.size)return!1;for(var i=(n=h(n)).next();!i.done;i=n.next())if(!r.has(i.value))return!1;return!0}function ka(t){this.a=t,this.b=new Aa(t.language,"",t.audio&&t.audio.channelsCount?t.audio.channelsCount:0)}function Aa(t,e,n){this.c=t,this.b=e,this.a=n}function Ia(){this.a=Pa,this.b=(new Map).set(Pa,2).set(Na,1)}function Ma(t,e,n){t.b.set(Pa,n).set(Na,e)}Ti.kd("m3u8",$i),Ti.Bb("application/x-mpegurl",$i),Ti.Bb("application/vnd.apple.mpegurl",$i),Ta.prototype.add=function(t){return!!Ea(this.a,t)&&(this.b.add(t),!0)},Ta.prototype.values=function(){return this.b.values()},ka.prototype.create=function(t){var e=this,n=t.filter(function(t){return Ea(e.a,t)});return n.length?new Ta(n[0],n):this.b.create(t)},Aa.prototype.create=function(t){var e=[];e=function(t,e){var n=Dn(Cn(e),t.map(function(t){return Rn(t)}));return n?t.filter(function(t){return n==Rn(t)}):[]}(t,this.c);var n=t.filter(function(t){return t.primary});for(e=e.length?e:n.length?n:t,this.b&&((t=function(t,e){return t.filter(function(t){var n=t.audio;return t=t.video,n&&0<=n.roles.indexOf(e)||t&&0<=t.roles.indexOf(e)})}(e,this.b)).length&&(e=t)),this.a&&((t=qn(e,this.a)).length&&(e=t)),t=new Ta(e[0]),n=(e=h(e)).next();!n.done;n=e.next())n=n.value,Ea(t.a,n)&&t.add(n);return t};var Na=0,Pa=1;function Ca(t,e){this.g=t,this.h=Da(t),this.a=t.a.currentTime,this.f=Date.now()/1e3,this.b=!1,this.i=e,this.c=function(){}}function Ra(t){this.a=t}function Da(t){if(t.a.paused||0==t.a.playbackRate||null==t.a.buffered)var e=!1;else t:{e=t.a.buffered,t=t.a.currentTime;for(var n=0;n<e.length;n++){var r=e.start(n),i=e.end(n);if(!(t<r||t>i-.5)){e=!0;break t}}e=!1}return e}function _a(t,e,n,r,i){var a=this;this.a=t,this.v=e,this.s=n,this.l=i,this.f=new Vt,this.i=!1,this.m=t.readyState,this.c=!1,this.b=r,this.h=!1,this.f.w(t,"waiting",function(){return La(a)}),this.g=new ft(function(){La(a)}).Na(.25)}function La(t){if(0!=t.a.readyState){if(t.a.seeking){if(!t.i)return}else t.i=!1;if(!t.a.paused){t.a.readyState!=t.m&&(t.c=!1,t.m=t.a.readyState);var e=t.s.smallGapLimit,n=t.a.currentTime,r=t.a.buffered;t:{if(r&&r.length&&!(1==r.length&&1e-6>r.end(0)-r.start(0)))for(var i=ee("Edge/")||ee("Trident/")||ee("Tizen")||ee("CrKey")?.5:.1,a=0;a<r.length;a++)if(r.start(a)>n&&(0==a||r.end(a-1)-n<=i)){i=a;break t}i=null}if(null==i)t.b&&(n=Da(r=(t=t.b).g),i=r.a.currentTime,a=Date.now()/1e3,t.a==i&&t.h==n||(t.f=a,t.a=i,t.h=n,t.b=!1),(i=a-t.f)>=t.i&&n&&!t.b&&(t.c(t.a,i),t.b=!0,t.a=r.a.currentTime));else if(0!=i||t.h){a=r.start(i);var o=t.v.Ba();if(!(a>=o)){e=(o=a-n)<=e;var s=!1;.001>o||(e||t.c||(t.c=!0,(n=new St("largegap",{currentTime:n,gapSize:o})).cancelable=!0,t.l(n),t.s.jumpLargeGaps&&!n.defaultPrevented&&(s=!0)),!e&&!s)||(0!=i&&r.end(i-1),t.a.currentTime=a)}}}}}function Ua(t){var e=this;this.c=t,this.a=new Set,this.b=new ft(function(){Oa(e,!1)}).Na(.25)}function Oa(t,e){for(var n=h(t.a),r=n.next();!r.done;r=n.next())r.value.g(t.c.currentTime,e)}function ja(t){for(var e=[],n=(t=h(t)).next();!n.done;n=t.next())for(var r=(n=h(n.value.variants)).next();!r.done;r=n.next())e.push(r.value);return e}function Ba(t,e){for(var n=null,r=h(t),i=r.next();!i.done;i=r.next())e>=(i=i.value).startTime&&(n=i);return n}function Fa(t){this.c=t,this.a=null,this.b=function(){}}function Ka(t){var e=this;this.a=t,this.f=!1,this.c=this.a.gc(),this.b=new ft(function(){e.a.Ld(.25*e.c)})}function Va(t){t.b.stop();var e=t.f?0:t.c;if(0<=e)try{return void(t.a.gc()!=e&&t.a.rd(e))}catch(n){}t.b.Na(.25),0!=t.a.gc()&&t.a.rd(0)}function Ha(t,e,n){this.a=t,this.f=e,this.g=n,this.h=!1,this.b=new Vt,this.c=new Ya(t),0<t.readyState?Ga(this,n):qa(this,n)}function za(t){return t.h?t.a.currentTime:t.g}function qa(t,e){t.g=e,t.b.ea(t.a,"loadedmetadata"),t.b.da(t.a,"loadedmetadata",function(){Ga(t,e)})}function Ga(t,e){.001>Math.abs(t.a.currentTime-e)?Xa(t):(t.b.da(t.a,"seeking",function(){Xa(t)}),Wa(t.c,0==t.a.currentTime?e:t.a.currentTime))}function Xa(t){t.h=!0,t.b.w(t.a,"seeking",function(){return t.f()})}function Ya(t){var e=this;this.b=t,this.h=10,this.g=this.f=this.c=0,this.a=new ft(function(){0>=e.c?e.a.stop():e.b.currentTime!=e.f?e.a.stop():(e.b.currentTime=e.g,e.c--)})}function Wa(t,e){t.f=t.b.currentTime,t.g=e,t.c=t.h,t.b.currentTime=e,t.a.Na(.1)}function $a(t){function e(){null==n.c?n.f=!0:(n.b.da(n.a,"seeking",function(){n.f=!0}),n.a.currentTime=n.c)}var n=this;this.a=t,this.f=!1,this.c=null,this.b=new Vt,0==this.a.readyState?this.b.da(this.a,"loadedmetadata",e):e()}function Ja(t,e,n,r,i,a){var o=this;this.b=t,this.a=e.presentationTimeline,this.B=e.minBufferTime||0,this.g=n,this.v=i,this.l=null,this.f=new _a(t,e.presentationTimeline,n,function(t,e){if(!e.stallEnabled)return null;var n=e.stallSkip,r=new Ca(new Ra(t),e.stallThreshold);return function(t,e){t.c=e}(r,function(){t.currentTime+=n}),r}(t,n),a),this.c=new Ha(t,function(){var t=o.f;t.i=!0,t.h=!1,t.c=!1;var e=za(o.c);return t=Za(o,e),.001<Math.abs(t-e)&&(e=(new Date).getTime()/1e3,!o.l||o.l<e-1)?(o.l=e,0<(e=o.c).a.readyState?Wa(e.c,t):qa(e,t),t=void 0):(o.v(),t=void 0),t},function(t,e){return null==e?e=1/0>t.a.Y()?t.a.ob():t.a.Ba():0>e&&(e=t.a.Ba()+e),Qa(t,to(t,e))}(this,r)),this.i=new ft(function(){if(0!=o.b.readyState&&!o.b.paused){var t=o.b.currentTime,e=o.a.ob(),n=o.a.Ba();3>n-e&&(e=n-3),t<e&&(t=Za(o,t),o.b.currentTime=t)}}).Na(.25)}function Qa(t,e){var n=t.a.Y();return e>=n?n-t.g.durationBackoff:e}function Za(t,e){var n=Ue.bind(null,t.b.buffered),r=Math.max(t.B,t.g.rebufferingGoal),i=t.g.safeSeekOffset,a=t.a.ob(),o=t.a.Ba(),s=t.a.Y();3>o-a&&(a=o-3);var u=t.a.Kb(r),c=t.a.Kb(i);return r=t.a.Kb(r+i),e>=s?Qa(t,e):e>o?o:e<a?n(c)?c:r:e>=u||n(e)?e:r}function to(t,e){var n=t.a.ob();return e<n?n:e>(n=t.a.Ba())?n:e}function eo(){this.b=function(){},this.a=new Set}function no(t){var e=this;this.h=t,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.i=[{eb:null,cb:io,Wa:function(t,n){return e.a(t,n)}},{eb:ro,cb:io,Wa:function(t,n){return e.a(t,n)}},{eb:ao,cb:io,Wa:function(t,n){return e.a(t,n)}},{eb:io,cb:ro,Wa:function(t,n){return e.b(t,n)}},{eb:io,cb:ao,Wa:function(t,n){return e.b(t,n)}},{eb:ro,cb:ao,Wa:function(t,n){return e.c(t,n)}},{eb:ao,cb:ro,Wa:function(t,n){return e.c(t,n)}}]}Ca.prototype.release=function(){this.g=null,this.c=function(){}},_a.prototype.release=function(){this.f&&(this.f.release(),this.f=null),null!=this.g&&(this.g.stop(),this.g=null),this.b&&(this.b.release(),this.b=null),this.a=this.v=this.l=null},_a.prototype.dd=function(){this.h=!0,La(this)},Ua.prototype.release=function(){this.b.stop();for(var t=h(this.a),e=t.next();!e.done;e=t.next())e.value.release();this.a.clear()},Fa.prototype.release=function(){this.a=this.c=null,this.b=function(){}},Fa.prototype.g=function(t){var e=this.a,n=this.c.periods;e!=(t=Ba(n,t)||n[0])&&this.b(t),this.a=t},Ka.prototype.release=function(){this.b&&(this.b.stop(),this.b=null),this.a=null},Ka.prototype.set=function(t){this.c=t,Va(this)},Ha.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.f=function(){},this.a=null},Ya.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},$a.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.a=null},$a.prototype.m=function(t){this.c=this.f?this.c:t},$a.prototype.h=function(){return(this.f?this.a.currentTime:this.c)||0},$a.prototype.s=function(){},Ja.prototype.release=function(){this.c&&(this.c.release(),this.c=null),this.f&&(this.f.release(),this.f=null),this.i&&(this.i.stop(),this.i=null),this.b=this.c=this.a=this.g=null,this.v=function(){}},Ja.prototype.m=function(t){var e=this.c;0<e.a.readyState?Wa(e.c,t):qa(e,t)},Ja.prototype.h=function(){var t=za(this.c);return 0<this.b.readyState&&!this.b.paused?to(this,t):t},Ja.prototype.s=function(){this.f.dd()},eo.prototype.release=function(){this.b=function(){},this.a.clear()},no.prototype.release=function(){this.h=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}},no.prototype.g=function(t,e){for(var n=h(this.h.a),r=n.next();!r.done;r=n.next()){r=r.value;var i=this.f.get(r),a=t<r.startTime?ro:t>r.endTime?ao:io;this.f.set(r,a);for(var o=h(this.i),s=o.next();!s.done;s=o.next())(s=s.value).eb==i&&s.cb==a&&s.Wa(r,e)}};var ro=1,io=2,ao=3;function oo(t,e){this.a=e,this.c=t,this.g=null,this.l=1,this.v=Promise.resolve(),this.h=[],this.i=new Map,this.b=new Map,this.s=!1,this.F=null,this.D=this.f=this.m=!1,this.B=0}function so(t){return co(t,"audio")}function uo(t){return co(t,"video")}function co(t,e){var n=t.b.get(e);return n?n.Ka||n.stream:null}function lo(t,e){return p(function n(){var r,i,a,o,s,u,c,l,f;return L(n,function(n){switch(n.j){case 1:return r=Ve,S(n,kn(t.a.J,r.qa),2);case 2:return t.B++,t.D=!1,i=t.B,a=t.a.J,o=new Map,s=new Set,o.set(r.qa,e),s.add(e),S(n,a.init(o,!1),3);case 3:return t.f?n.return():S(n,bo(t,s),4);case 4:if(t.f)return n.return();u=t.a.J.g.isTextVisible()||t.g.alwaysStreamText,t.B!=i||t.b.has(r.qa)||t.D||!u||(c=t.a.Ua(),l=Ao(t,c),f=yo(e,l,0),t.b.set(r.qa,f),Po(t,f,0)),x(n)}})})}function fo(t,e){var n=t.b.get("video");if(n){var r=n.stream;if(r)if(e){var i=r.trickModeVideo;i&&!n.Ka&&(po(t,i,!1,0,!1),n.Ka=r)}else(r=n.Ka)&&(n.Ka=null,po(t,r,!0,0,!1))}}function ho(t,e,n,r){e.video&&po(t,e.video,n,r,!1),e.audio&&po(t,e.audio,n,r,!1)}function po(t,e,n,r,i){var a=t.b.get(e.type);if(!a&&"text"==e.type&&t.g.ignoreTextStreamFailures)lo(t,e);else if(a){var o=Io(t,e),s=Array.from(t.b.values()).every(function(t){return t.ia==a.ia});n&&o!=a.ia&&s?t.b.forEach(function(e){mo(t,e)}):(a.Ka&&(e.trickModeVideo?(a.Ka=e,e=e.trickModeVideo):a.Ka=null),(s=t.h[o])&&s.Cb&&(s=t.i.get(e.id))&&s.Cb&&(a.stream!=e||i)&&("text"==e.type&&bn(t.a.J,$t(e.mimeType,e.codecs)),a.stream=e,a.jc=!0,function(t,e,n){if(!e.Ob)return!1;var r=t.a.Ua(),i=En(t.a.J,e.type);if(null==(n=(n=Eo(t,e,r,i,n))&&n.a?n.a-n.b:null))return!1;var a=e.stream.initSegmentReference;return a&&(n+=(a.a?a.a-a.b:null)||0),a=t.a.getBandwidthEstimate(),8*n/a<i-r-Math.max(t.c.minBufferTime||0,t.g.rebufferingGoal)||e.Ob.b.a>n}(t,a,o)&&a.Ob.abort(),n&&(a.Ra?a.yc=!0:a.Ja?(a.Oa=!0,a.bc=r,a.yc=!0):(Co(a),No(t,a,!0,r).catch(function(e){t.a&&t.a.onError(e)})))))}}function mo(t,e){e.Ra||e.Oa||(e.Ja?(e.Oa=!0,e.bc=0):null==Tn(t.a.J,e.type)?null==e.Fa&&Po(t,e,0):(Co(e),No(t,e,!1,0).catch(function(e){t.a&&t.a.onError(e)})))}function vo(t,e,n,r,i){return p(function a(){var o,s,u,c,l,f,h;return L(a,function(a){switch(a.j){case 1:return o=t.a.Ua(),s=Ao(t,o),u=Ve,c=new Map,l=new Set,e&&(c.set(u.Db,e),l.add(e)),n&&(c.set(u.Pa,n),l.add(n)),r&&(c.set(u.qa,r),l.add(r)),f=t.a.J,h=t.g.forceTransmuxTS,S(a,f.init(c,h),2);case 2:return t.f?a.return():(function(t){var e=t.c.presentationTimeline.Y();1/0>e?t.a.J.wa(e):t.a.J.wa(Math.pow(2,32))}(t),S(a,bo(t,l),3));case 3:if(t.f)return a.return();c.forEach(function(e,n){if(!t.b.has(n)){var r=yo(e,s,i);t.b.set(n,r),Po(t,r,0)}}),x(a)}})})}function yo(t,e,n){return{stream:t,type:t.type,rb:null,Ca:null,Ka:null,jc:!0,ia:e,endOfStream:!1,Ja:!1,Fa:null,Oa:!1,bc:0,yc:!1,Ra:!1,jd:!1,Mb:!1,md:n||0,Ob:null}}function go(t,e){var n=t.h[e];if(n)return n.promise;n={promise:new mt,Cb:!1},t.h[e]=n;for(var r=new Set,i=h(t.c.periods[e].variants),a=i.next();!a.done;a=i.next())(a=a.value).video&&r.add(a.video),a.video&&a.video.trickModeVideo&&r.add(a.video.trickModeVideo),a.audio&&r.add(a.audio);for(a=(i=h(t.c.periods[e].textStreams)).next();!a.done;a=i.next())r.add(a.value);return t.v=t.v.then(function(){if(!this.f)return bo(this,r)}.bind(t)).then(function(){this.f||(this.h[e].promise.resolve(),this.h[e].Cb=!0)}.bind(t)).catch(function(t){this.f||(this.h[e].promise.catch(function(){}),this.h[e].promise.reject(),delete this.h[e],this.a.onError(t))}.bind(t)),n.promise}function bo(t,e){return p(function n(){var r,i,a,o,s,u,c;return L(n,function(n){switch(n.j){case 1:r=[];for(var l=h(e),f=l.next();!f.done;f=l.next())i=f.value,(a=t.i.get(i.id))?r.push(a.promise):(t.i.set(i.id,{promise:new mt,Cb:!1}),r.push(i.createSegmentIndex()));return k(n,2),S(n,Promise.all(r),4);case 4:if(t.f)return n.return();I(n,3);break;case 2:if(o=M(n),t.f)return n.return();for(f=(n=h(e)).next();!f.done;f=n.next())s=f.value,t.i.get(s.id).promise.catch(function(){}),t.i.get(s.id).promise.reject(),t.i.delete(s.id);throw o;case 3:for(f=(l=h(e)).next();!f.done;f=l.next())u=f.value,(c=t.i.get(u.id)).Cb||(c.promise.resolve(),c.Cb=!0);x(n)}})})}function wo(t,e){if(!t.f&&!e.Ja&&null!=e.Fa&&!e.Ra)if(e.Fa=null,e.Oa)No(t,e,e.yc,e.bc);else{try{var n=function(t,e){if(xo(e))return t.a.J.tc(e.stream.originalId||""),null;var n=t.a.Ua(),r=To(t,e,n),i=Io(t,e.stream),a=Ao(t,r),o=function(t,e,n){return"text"==e?null==(t=t.a).b||t.b<n?0:t.b-Math.max(n,t.a):Oe(t=Sn(t,e),n)}(t.a.J,e.type,n),s=Math.max(t.c.minBufferTime||0,t.g.rebufferingGoal,t.g.bufferingGoal)*t.l;if(r>=t.c.presentationTimeline.Y())return e.endOfStream=!0,"video"==e.type&&(r=t.b.get("text"))&&"application/cea-608"==r.stream.mimeType&&(r.endOfStream=!0),null;if(e.endOfStream=!1,e.ia=a,a!=i)return null;if(o>=s)return.5;if(a=En(t.a.J,e.type),!(a=Eo(t,e,n,a,i)))return 1;var u=1/0;return Array.from(t.b.values()).forEach(function(e){xo(e)||(e=To(t,e,n),u=Math.min(u,e))}),r>=u+t.c.presentationTimeline.a?1:(e.md=0,function(t,e,n,r,i){var a=t.c.periods[r],o=e.stream,s=t.c.presentationTimeline.Y(),u=t.c.periods[r+1];r=function(t,e,n,r,i){return e.jc?(n=function(t,e,n,r,i){return"text"==e?(t.a.m=n,(t=t.a).f=r,t.h=i,Promise.resolve()):Promise.all([An(t,e,t.qe.bind(t,e)),An(t,e,t.Vf.bind(t,e,n)),An(t,e,t.Sf.bind(t,e,r,i))])}(t.a.J,e.type,t.c.periods[n].startTime-e.stream.presentationTimeOffset,r,i),e.stream.initSegmentReference?(t=Mo(t,e,e.stream.initSegmentReference).then(function(t){if(!this.f)return xn(this.a.J,e.type,t,null,null,e.stream.closedCaptions&&0<e.stream.closedCaptions.size)}.bind(t)).catch(function(t){return e.jc=!0,Promise.reject(t)}),Promise.all([n,t])):n):Promise.resolve()}(t,e,r,Math.max(0,a.startTime-.1),u?u.startTime+.01:s),e.Ja=!0,e.jc=!1,s=Mo(t,e,i),Promise.all([r,s]).then(function(t){if(!this.f&&!this.m)return function(t,e,n,r,i,a,o){var s=i.closedCaptions&&0<i.closedCaptions.size;return null!=i.emsgSchemeIdUris&&0<i.emsgSchemeIdUris.length&&(new jr).fa("emsg",t.L.bind(t,r,a,i.emsgSchemeIdUris)).parse(o),function(t,e,n){var r=Math.max(t.g.bufferBehind,t.c.presentationTimeline.a),i=Tn(t.a.J,e.type);return null==i?Promise.resolve():0>=(n=n-i-r)?Promise.resolve():t.a.J.remove(e.type,i,i+n).then(function(){}.bind(t))}(t,e,n).then(function(){if(!this.f)return xn(this.a.J,e.type,o,a.startTime+r.startTime,a.endTime+r.startTime,s)}.bind(t)).then(function(){if(!this.f)return e.rb=i,e.Ca=a,Promise.resolve()}.bind(t))}(this,e,n,a,o,i,t[1])}.bind(t)).then(function(){this.f||this.m||(e.Ja=!1,e.jd=!1,e.Oa||this.a.dd(),Po(this,e,0),function(t,e){if(!t.s){var n=Array.from(t.b.values());if(1==n.length&&"text"==n[0].type||(t.s=n.every(function(t){return"text"==t.type||!t.Oa&&!t.Ra&&t.Ca})),t.s){for(n=Io(t,e),t.h[n]||go(t,n).then(function(){this.f||this.a.Nd()}.bind(t)).catch(Be.kc),n=0;n<t.c.periods.length;++n)go(t,n).catch(Be.kc);t.a.vf&&t.a.vf()}}}(this,o))}.bind(t)).catch(function(t){this.f||this.m||(e.Ja=!1,"text"==e.type&&this.g.ignoreTextStreamFailures?this.b.delete("text"):7001==t.code?(e.Ja=!1,e.Fa=null,Po(this,e,0)):3017==t.code?function(t,e,n){if(!Array.from(t.b.values()).some(function(t){return t!=e&&t.jd})){var r=Math.round(100*t.l);if(20<r)t.l-=.2;else{if(!(4<r))return e.Mb=!0,t.m=!0,void t.a.onError(n);t.l-=.04}e.jd=!0}Po(t,e,4)}(this,e,t):(e.Mb=!0,t.severity=2,Ro(this,t)))}.bind(t))}(t,e,n,i,a),null)}(t,e);null!=n&&(Po(t,e,n),e.Mb=!1)}catch(r){return void Ro(t,r)}n=Array.from(t.b.values()),function(t,e){var n=Io(t,e.stream);if(e.ia!=n){var r=e.ia,i=Array.from(t.b.values());i.every(function(t){return t.ia==r||xo(t)})&&i.every(ko)&&go(t,r).then(function(){if(!this.f&&i.every(function(t){var e=ko(t),n=Io(this,t.stream);return!!xo(t)||e&&t.ia==r&&n!=r}.bind(this))){var t=this.c.periods[r],e=this.a.Od(t),n=new Map;e.variant&&e.variant.video&&n.set("video",e.variant.video),e.variant&&e.variant.audio&&n.set("audio",e.variant.audio),e.text&&n.set("text",e.text);for(var a=(e=h(this.b.keys())).next();!a.done;a=e.next())if(a=a.value,!n.has(a)&&"text"!=a)return void this.a.onError(new pt(2,5,5005));for(e=h(Array.from(n.keys())),a=e.next();!a.done;a=e.next())if(a=a.value,!this.b.has(a)){if("text"!=a)return void this.a.onError(new pt(2,5,5005));vo(this,null,null,n.get("text"),t.startTime),n.delete(a)}for(e=h(Array.from(this.b.keys())),a=e.next();!a.done;a=e.next()){a=a.value;var o=this.b.get(a),s=n.get(a);if(s){var u=xo(o);u&&(o.ia=r,o.md=t.startTime),po(this,s,!1,0,!1),u&&xo(o)||Po(this,this.b.get(a),0)}else this.b.delete(a)}this.a.Nd()}}.bind(t)).catch(Be.kc)}}(t,e),t.s&&n.every(function(t){return t.endOfStream})&&t.a.J.endOfStream().then(function(){if(!this.f){var t=this.a.J.Y();0!=t&&t<this.c.presentationTimeline.Y()&&this.c.presentationTimeline.wa(t)}}.bind(t))}}function To(t,e,n){return e.rb&&e.Ca?(n=Io(t,e.rb),t.c.periods[n].startTime+e.Ca.endTime):Math.max(n,e.md)}function Eo(t,e,n,r,i){if(e.Ca&&e.stream==e.rb)return So(t,e,i,e.Ca.position+1);if(e.Ca?(n=Io(t,e.rb),n=e.stream.findSegmentPosition(Math.max(0,t.c.periods[n].startTime+e.Ca.endTime-t.c.periods[i].startTime))):n=e.stream.findSegmentPosition(Math.max(0,(r||n)-t.c.periods[i].startTime)),null==n)return null;var a=null;return null==r&&(a=So(t,e,i,Math.max(0,n-1))),a||So(t,e,i,n)}function So(t,e,n,r){return n=t.c.periods[n],(e=e.stream.getSegmentReference(r))?(t=(r=t.c.presentationTimeline).Lb(),r=r.pb(),n.startTime+e.endTime<t||n.startTime+e.startTime>r?null:e):null}function xo(t){return t&&"text"==t.type&&"application/cea-608"==t.stream.mimeType}function ko(t){return!t.Ja&&null==t.Fa&&!t.Oa&&!t.Ra}function Ao(t,e){var n=Ba(t.c.periods,e+He);return n?t.c.periods.indexOf(n):0}function Io(t,e){for(var n=t.c.periods,r=0;r<n.length;r++){for(var i=n[r],a=new Set,o=h(i.variants),s=o.next();!s.done;s=o.next())(s=s.value).audio&&a.add(s.audio),s.video&&a.add(s.video),s.video&&s.video.trickModeVideo&&a.add(s.video.trickModeVideo);for(o=(i=h(i.textStreams)).next();!o.done;o=i.next())a.add(o.value);if(a.has(e))return r}return-1}function Mo(t,e,n){return n=Si(n.c(),n.b,n.a,t.g.retryParameters),t=t.a.tb.request(1,n),e.Ob=t,t.promise.then(function(t){return e.Ob=null,t.data})}function No(t,e,n,r){return p(function i(){var a,o,s;return L(i,function(i){switch(i.j){case 1:return e.Oa=!1,e.yc=!1,e.bc=0,e.Ra=!0,r?(o=t.a.Ua(),s=t.a.J.Y(),a=t.a.J.remove(e.type,o+r,s)):a=kn(t.a.J,e.type).then(function(){if(!this.f&&n)return this.a.J.flush(e.type)}.bind(t)),S(i,a,2);case 2:if(t.f)return i.return();e.rb=null,e.Ca=null,e.Ra=!1,e.endOfStream=!1,Po(t,e,0),x(i)}})})}function Po(t,e,n){e.Fa=new lt(function(){return p(function n(){var r;return L(n,function(n){switch(n.j){case 1:return k(n,2),S(n,wo(t,e),4);case 4:I(n,0);break;case 2:r=M(n),t.a&&t.a.onError(r),x(n)}})})}).P(n)}function Co(t){null!=t.Fa&&(t.Fa.stop(),t.Fa=null)}function Ro(t,e){dt(t.F).then(function(){this.f||(this.a.onError(e),e.handled||this.g.failureCallback(e))}.bind(t))}function Do(t,e,n,r,i,a){if(200<=n&&299>=n&&202!=n)return{uri:i||r,fd:r,data:e,headers:t,fromCache:!!t["x-shaka-from-cache"]};i=null;try{i=oe(e)}catch(o){}throw new pt(401==n||403==n?2:1,1,1001,r,n,i,t,a)}function _o(t,e,n,r){var i=new _o.b;Yt(e.headers).forEach(function(t,e){i.append(e,t)});var a=new _o.a,o={Ad:!1,ie:!1};if(t=new vt(t=_o.l(t,n,{body:e.body||void 0,headers:i,method:e.method,signal:a.signal,credentials:e.allowCrossSiteCredentials?"include":void 0},o,r),function(){return o.Ad=!0,a.abort(),Promise.resolve()}),e=e.retryParameters.timeout){var s=new ft(function(){o.ie=!0,a.abort()});s.P(e/1e3),t.finally(function(){s.stop()})}return t}function Lo(t,e,n,r){var i=new Lo.f,a=Date.now(),o=0;return new vt(new Promise(function(s,u){for(var c in i.open(e.method,t,!0),i.responseType="arraybuffer",i.timeout=e.retryParameters.timeout,i.withCredentials=e.allowCrossSiteCredentials,i.onabort=function(){u(new pt(1,1,7001,t,n))},i.onload=function(e){for(var r=(e=e.target).getAllResponseHeaders().trim().split("\r\n"),i={},a=(r=h(r)).next();!a.done;a=r.next())i[(a=a.value.split(": "))[0].toLowerCase()]=a.slice(1).join(": ");try{var o=Do(i,e.response,e.status,t,e.responseURL,n);s(o)}catch(c){u(c)}},i.onerror=function(e){u(new pt(1,1,1002,t,e,n))},i.ontimeout=function(){u(new pt(1,1,1003,t,n))},i.onprogress=function(t){var e=Date.now();(100<e-a||t.lengthComputable&&t.loaded==t.total)&&(r(e-a,t.loaded-o,t.total-t.loaded),o=t.loaded,a=e)},e.headers)i.setRequestHeader(c.toLowerCase(),e.headers[c]);i.send(e.body)}),function(){return i.abort(),Promise.resolve()})}function Uo(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function Oo(t,e,n){this.h=t,this.b=new Map,this.c=!1,this.g=e,this.f=n,this.a=new Uo}function jo(t,e,n,r,i,a){var o=function(t,e){t.b+=e;var n=t.g;return t.g++,t.c.set(n,e),n}(t.a,r);r=t.b.get(e)||Promise.resolve(),t.b.set(e,r.then(function(){return p(function e(){var r,s,u;return L(e,function(e){switch(e.j){case 1:return S(e,function(t,e){return p(function n(){var r,i;return L(n,function(n){switch(n.j){case 1:return r=t.h.request(1,e),S(n,r.promise,2);case 2:return i=n.o,n.return(i.data)}})})}(t,n),2);case 2:if(r=e.o,t.c)throw new pt(2,9,7001);if(i){s=new Uint8Array(r);for(var c=h(new zr(s).data),l=c.next();!l.done;l=c.next())u=l.value,t.f(u)}return t.a.close(o,r.byteLength),c=t.a,t.g(0==c.b?0:c.f/c.b,t.a.a),e.return(a(r))}})})}))}function Bo(t,e){var n=this;this.c=t,this.b=t.objectStore(e),this.a=new mt,t.onabort=function(t){t.preventDefault(),n.a.reject()},t.onerror=function(t){t.preventDefault(),n.a.reject()},t.oncomplete=function(){n.a.resolve()}}function Fo(t,e){return new Promise(function(n,r){var i=t.b.openCursor();i.onerror=r,i.onsuccess=function(t){if(!(t=t.target.result))return n();e(t.key,t.value,t),t.continue()}})}function Ko(t){this.b=t,this.a=[]}function Vo(t,e){return zo(t,e,"readonly")}function Ho(t,e){return zo(t,e,"readwrite")}function zo(t,e,n){var r=new Bo(n=t.b.transaction([e],n),e);return t.a.push(r),r.promise().then(function(){Mt(t.a,r)},function(){Mt(t.a,r)}),r}function qo(t){this.a=new Ko(t)}function Go(){this.a=new Map}function Xo(t,e,n){if(!(t=t.a.get(e)))throw new pt(2,9,9013,"Could not find mechanism with name "+e);if(!(e=t.getCells().get(n)))throw new pt(2,9,9013,"Could not find cell with name "+n);return e}function Yo(t,e){Wo.set(t,e)}oo.prototype.destroy=function(){for(var t=h(this.b.values()),e=t.next();!e.done;e=t.next())Co(e.value);return this.b.clear(),this.i.clear(),this.g=this.h=this.v=this.c=this.a=null,this.f=!0,Promise.resolve()},oo.prototype.configure=function(t){this.g=t,this.F=new ht({maxAttempts:Math.max(t.retryParameters.maxAttempts,2),baseDelay:t.retryParameters.baseDelay,backoffFactor:t.retryParameters.backoffFactor,fuzzFactor:t.retryParameters.fuzzFactor,timeout:0},!0)},oo.prototype.start=function(){var t=this;return p(function e(){var n,r,i;return L(e,function(e){switch(e.j){case 1:return n=t.a.Ua(),r=Ao(t,n),(i=t.a.Od(t.c.periods[r])).variant||i.text?S(e,vo(t,i.variant?i.variant.audio:null,i.variant?i.variant.video:null,i.text,n),2):e.return(new pt(2,5,5005));case 2:if(t.f)return e.return();t.a&&t.a.kf&&t.a.kf(),x(e)}})})},oo.prototype.L=function(t,e,n,r){var i=r.reader.gd(),a=r.reader.gd(),o=r.reader.G(),s=r.reader.G(),u=r.reader.G(),c=r.reader.G();r=r.reader.Za(r.reader.I.byteLength-r.reader.ba()),t=t.startTime+e.startTime+s/o,n.includes(i)&&("urn:mpeg:dash:event:2012"==i?this.a.lf():this.a.onEvent(new St("emsg",{detail:{startTime:t,endTime:t+u/o,schemeIdUri:i,value:a,timescale:o,presentationTimeDelta:s,eventDuration:u,id:c,messageData:r}})))},K("shaka.net.HttpFetchPlugin",_o),_o.l=function(t,e,n,r,i){return p(function a(){var o,s,u,c,l,f,h,d,m,v,y,g;return L(a,function(a){switch(a.j){case 1:return o=_o.g,s=_o.c,f=l=0,h=Date.now(),k(a,2),S(a,o(t,n),4);case 4:return u=a.o,d=u.clone().body.getReader(),v=(m=u.headers.get("Content-Length"))?parseInt(m,10):0,new s({start:function(t){!function e(){return p(function n(){var r,a;return L(n,function(n){switch(n.j){case 1:return k(n,2),S(n,d.read(),4);case 4:r=n.o,I(n,3);break;case 2:return M(n),n.return();case 3:r.done||(l+=r.value.byteLength),(100<(a=Date.now())-h||r.done)&&(i(a-h,l-f,v-l),f=l,h=a),r.done?t.close():(t.enqueue(r.value),e()),x(n)}})})}()}}),S(a,u.arrayBuffer(),5);case 5:c=a.o,I(a,3);break;case 2:if(y=M(a),r.Ad)throw new pt(1,1,7001,t,e);if(r.ie)throw new pt(1,1,1003,t,e);throw new pt(1,1,1002,t,y,e);case 3:return g={},u.headers.forEach(function(t,e){g[e.trim()]=t}),a.return(Do(g,c,u.status,t,u.url,e))}})})},_o.isSupported=function(){if(!t.ReadableStream)return!1;try{new ReadableStream({})}catch(s){return!1}return!(!t.fetch||!t.AbortController)},_o.isSupported=_o.isSupported,_o.g=t.fetch,_o.a=t.AbortController,_o.c=t.ReadableStream,_o.b=t.Headers,_o.isSupported()&&(_t("http",_o,2),_t("https",_o,2)),K("shaka.net.HttpXHRPlugin",Lo),Lo.f=t.XMLHttpRequest,_t("http",Lo,1),_t("https",Lo,1),Uo.prototype.close=function(t,e){if(this.c.has(t)){var n=this.c.get(t);this.c.delete(t),this.f+=n,this.a+=e}},Oo.prototype.destroy=function(){return this.c=!0,Promise.all(this.b.values()).then(function(){},function(){})},Bo.prototype.abort=function(){try{this.c.abort()}catch(s){}return this.a.catch(function(){})},Bo.prototype.store=function(){return this.b},Bo.prototype.promise=function(){return this.a},Ko.prototype.destroy=function(){return Promise.all(this.a.map(function(t){return t.abort()}))},qo.prototype.destroy=function(){return this.a.destroy()},qo.prototype.getAll=function(){var t=this;return p(function e(){var n,r;return L(e,function(e){switch(e.j){case 1:return n=Vo(t.a,"session-ids"),r=[],S(e,Fo(n,function(t,e){r.push(e)}),2);case 2:return S(e,n.promise(),3);case 3:return e.return(r)}})})},qo.prototype.add=function(t){for(var e=Ho(this.a,"session-ids"),n=e.store(),r=(t=h(t)).next();!r.done;r=t.next())n.add(r.value);return e.promise()},qo.prototype.remove=function(t){var e=this;return p(function n(){var r;return L(n,function(n){switch(n.j){case 1:return S(n,Fo(r=Ho(e.a,"session-ids"),function(e,n,r){0<=t.indexOf(n.sessionId)&&r.delete()}),2);case 2:return S(n,r.promise(),0)}})})},Go.prototype.destroy=function(){for(var t=[],e=h(this.a.values()),n=e.next();!n.done;n=e.next())t.push(n.value.destroy());return this.a.clear(),Promise.all(t)},Go.prototype.init=function(){var t=this;Wo.forEach(function(e,n){var r=e();r&&t.a.set(n,r)});for(var e=[],n=h(this.a.values()),r=n.next();!r.done;r=n.next())e.push(r.value.init());return Promise.all(e)},Go.prototype.erase=function(){var t=this;return p(function e(){var n,r;return L(e,function(e){switch(e.j){case 1:return n=Array.from(t.a.values()),(r=0<n.length)||Wo.forEach(function(t){(t=t())&&n.push(t)}),S(e,Promise.all(n.map(function(t){return t.erase()})),2);case 2:if(!r)return S(e,Promise.all(n.map(function(t){return t.destroy()})),0);e.A(0)}})})},K("shaka.offline.StorageMuxer.register",Yo),K("shaka.offline.StorageMuxer.unregister",function(t){Wo.delete(t)});var Wo=new Map;function $o(t){this.a=new Ko(t)}function Jo(t){return Promise.reject(new pt(2,9,9011,"Cannot add new value to "+t))}function Qo(t,e,n,r){var i=(t=Ho(t.a,e)).store();return n.forEach(function(t){i.delete(t).onsuccess=function(){return r(t)}}),t.promise()}function Zo(t,e,n){var r=(t=Vo(t.a,e)).store(),i={},a=[];return n.forEach(function(t){r.get(t).onsuccess=function(e){null==(e=e.target.result)&&a.push(t),i[t]=e}}),t.promise().then(function(){return a.length?Promise.reject(new pt(2,9,9012,"Could not find values for "+a)):n.map(function(t){return i[t]})})}function ts(t){return{originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:null==t.expiration?1/0:t.expiration,periods:t.periods.map(es),sessionIds:t.sessionIds,drmInfo:t.drmInfo,appMetadata:t.appMetadata}}function es(t){return function(t){var e=t.streams.filter(function(t){return"audio"==t.contentType}),n=t.streams.filter(function(t){return"video"==t.contentType});if(!e.every(function(t){return t.variantIds})||!n.every(function(t){return t.variantIds})){e.forEach(function(t){t.variantIds=[]}),n.forEach(function(t){t.variantIds=[]});var r=0;if(n.length&&!e.length){var i=r++;n.forEach(function(t){t.variantIds.push(i)})}if(!n.length&&e.length){var a=r++;e.forEach(function(t){t.variantIds.push(a)})}n.length&&e.length&&e.forEach(function(t){n.forEach(function(e){var n=r++;t.variantIds.push(n),e.variantIds.push(n)})})}}(t),t.streams.forEach(function(){}),{startTime:t.startTime,streams:t.streams.map(ns)}}function ns(t){var e=t.cf?as(t.cf):null;return{id:t.id,originalId:null,primary:t.primary,presentationTimeOffset:t.presentationTimeOffset,contentType:t.contentType,mimeType:t.mimeType,codecs:t.codecs,frameRate:t.frameRate,kind:t.kind,language:t.language,label:t.label,width:t.width,height:t.height,initSegmentKey:e,encrypted:t.encrypted,keyId:t.keyId,segments:t.segments.map(rs),variantIds:t.variantIds}}function rs(t){var e=as(t.uri);return{startTime:t.startTime,endTime:t.endTime,dataKey:e}}function is(t){return{data:t.data}}function as(t){var e;if((e=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(t))||(e=/^offline:segment\/([0-9]+)$/.exec(t)))return Number(e[1]);throw new pt(2,9,9004,"Could not parse uri "+t)}function os(t,e,n,r){this.a=new Ko(t),this.c=e,this.b=n,this.f=r}function ss(t,e,n){if(t.f)return Promise.reject(new pt(1,9,9011,"Cannot add new value to "+e));var r=(t=Ho(t.a,e)).store(),i=[];return n.forEach(function(t){r.add(t).onsuccess=function(t){i.push(t.target.result)}}),t.promise().then(function(){return i})}function us(t,e,n,r){var i=(t=Ho(t.a,e)).store();return n.forEach(function(t){i.delete(t).onsuccess=function(){return r(t)}}),t.promise()}function cs(t,e,n){var r=(t=Vo(t.a,e)).store(),i={},a=[];return n.forEach(function(t){var e=r.get(t);e.onsuccess=function(){null==e.result&&a.push(t),i[t]=e.result}}),t.promise().then(function(){return a.length?Promise.reject(new pt(1,9,9012,"Could not find values for "+a)):n.map(function(t){return i[t]})})}function ls(){this.g=this.c=this.b=this.a=this.f=null}function fs(t,e,n,r){this.a=t,this.g=e,this.f=n,this.c=r,this.b=["offline:",t,"/",e,"/",n,"/",r].join("")}function hs(t){if(null==(t=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(t)))return null;var e=t[1];if("manifest"!=e&&"segment"!=e)return null;var n=t[2];if(!n)return null;var r=t[3];return r&&null!=e?new fs(e,n,r,Number(t[4])):null}function ds(t,e){this.b=t,this.a=e}function ps(t,e,n){var r=e.streams.filter(function(t){return"audio"==t.contentType}),i=e.streams.filter(function(t){return"video"==t.contentType});return r=function(t,e,n){for(var r=new Set,i=h(e),a=i.next();!a.done;a=i.next()){var o=h(a.value.variantIds);for(a=o.next();!a.done;a=o.next())r.add(a.value)}for(i=h(n),a=i.next();!a.done;a=i.next())for(o=h(a.value.variantIds),a=o.next();!a.done;a=o.next())r.add(a.value);for(i=new Map,r=h(r),a=r.next();!a.done;a=r.next())a=a.value,i.set(a,{id:a,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(e=h(e),r=e.next();!r.done;r=e.next())for(r=r.value,a=ms(t,r),o=h(r.variantIds),r=o.next();!r.done;r=o.next())(r=i.get(r.value)).language=a.language,r.primary=r.primary||a.primary,r.audio=a;for(n=h(n),e=n.next();!e.done;e=n.next())for(r=e.value,e=ms(t,r),a=h(r.variantIds),r=a.next();!r.done;r=a.next())(r=i.get(r.value)).primary=r.primary||e.primary,r.video=e;return i}(t,r,i),i=e.streams.filter(function(t){return"text"==t.contentType}).map(function(e){return ms(t,e)}),e.streams.forEach(function(r){r=r.segments.map(function(e,n){return vs(t,n,e)}),n.ub(r,e.startTime)}),{startTime:e.startTime,variants:Array.from(r.values()),textStreams:i}}function ms(t,e){var n=e.segments.map(function(e,n){return vs(t,n,e)}),r=new ai(n);return n={id:e.id,originalId:e.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(t){return r.find(t)},getSegmentReference:function(t){return r.get(t)},initSegmentReference:null,presentationTimeOffset:e.presentationTimeOffset,mimeType:e.mimeType,codecs:e.codecs,width:e.width||void 0,height:e.height||void 0,frameRate:e.frameRate||void 0,kind:e.kind,encrypted:e.encrypted,keyId:e.keyId,language:e.language,label:e.label||null,type:e.contentType,primary:e.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},null!=e.initSegmentKey&&(n.initSegmentReference=function(t,e){var n=new fs("segment",t.b,t.a,e);return new ni(function(){return[n.toString()]},0,null)}(t,e.initSegmentKey)),n}function vs(t,e,n){var r=new fs("segment",t.b,t.a,n.dataKey);return new ri(e,n.startTime,n.endTime,function(){return[r.toString()]},0,null)}function ys(){this.a=null}function gs(t){var e=hs(t);return e&&"manifest"==e.a?gs.h(t):e&&"segment"==e.a?gs.i(e.key(),e):yt(new pt(2,1,9004,t))}function bs(t,e,n){return p(function r(){var i,a,o,s,u,c;return L(r,function(r){switch(r.j){case 1:i=[];for(var l=[],f=h(n),d=f.next();!d.done;d=f.next()){d=d.value;for(var m=!1,v=h(l),y=v.next();!y.done;y=v.next())if(ws((y=y.value).info,d)){y.sessionIds.push(d.sessionId),m=!0;break}m||l.push({info:d,sessionIds:[d.sessionId]})}a=h(l),o=a.next();case 2:if(o.done){r.A(4);break}return s=o.value,u=function(t,e,n){return p(function r(){var i,a;return L(r,function(r){switch(r.j){case 1:return i=new he({tb:e,onError:function(){},mc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),k(r,2),i.configure(t),S(r,function(t,e,n,r,i,a){var o=new Map;return o.set(e,{audioCapabilities:i,videoCapabilities:a,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:e,drmInfos:[{keySystem:e,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,initData:null,keyIds:null}]}),Te(t,o)}(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:I(r,3);break;case 2:return M(r),S(r,i.destroy(),5);case 5:return r.return([]);case 3:return k(r,6),S(r,me(i),8);case 8:I(r,7);break;case 6:return M(r),S(r,i.destroy(),9);case 9:return r.return([]);case 7:return a=[],S(r,Promise.all(n.sessionIds.map(function(t){return p(function e(){return L(e,function(e){switch(e.j){case 1:return k(e,2),S(e,function(t,e){return p(function n(){var r,i,a;return L(n,function(n){switch(n.j){case 1:return S(n,Ee(t,e),2);case 2:return(r=n.o)?(i=[],(a=t.b.get(r))&&(a.xa=new mt,i.push(a.xa)),i.push(r.remove()),S(n,Promise.all(i),0)):n.return()}})})}(i,t),4);case 4:a.push(t),I(e,0);break;case 2:M(e),x(e)}})})})),10);case 10:return S(r,i.destroy(),11);case 11:return r.return(a)}})})}(t,e,s),S(r,u,5);case 5:c=r.o,i=i.concat(c),o=a.next(),r.A(2);break;case 4:return r.return(i)}})})}function ws(t,e){function n(t,e){return t.robustness==e.robustness&&t.contentType==e.contentType}return t.keySystem==e.keySystem&&t.licenseUri==e.licenseUri&&Nt(t.audioCapabilities,e.audioCapabilities,n)&&Nt(t.videoCapabilities,e.videoCapabilities,n)}function Ts(t,e){var n={za:null,u:null,mimeType:null,startTime:null,ud:null,uri:null},r=this;this.g=e,this.c=t,this.i=n,this.h=null,this.f=[],this.b=this.a=null,this.l=!0,this.m=Promise.resolve().then(function(){return t=r,p(function e(){return L(e,function(e){switch(e.j){case 1:if(t.l){if(0==t.f.length||t.a&&!t.a.Va)var n=!1;else{t.a&&(t.a.ta.Ya(),t.a=null);var r=(n=t.f.shift()).create(t.i);r?(n.ta.vb(),t.a={node:r.node,payload:r.payload,Va:r.Va,ta:n.ta}):n.ta.nc(),n=!0}return n?n=Promise.resolve():t.a?n=function(t){return p(function e(){var n,r;return L(e,function(e){switch(e.j){case 1:return t.c=t.g.Se(t.c,t.i,t.a.node,t.a.payload),k(e,2),t.b=t.g.Be(t.c,t.i,t.a.payload),S(e,t.b.promise,4);case 4:t.b=null,t.c==t.a.node&&(t.a.ta.lc(),t.a=null),I(e,0);break;case 2:return 7001==(n=M(e)).code?t.a.ta.Ya():t.a.ta.onError(n),t.a=null,t.b=null,r=t,S(e,t.g.handleError(t.i,n),5);case 5:r.c=e.o,x(e)}})})}(t):(t.g.jf(t.c),t.h=new mt,n=t.h),S(e,n,1)}e.A(0)}})});var t})}function Es(t,e){var n={vb:function(){},lc:function(){},Ya:function(){},onError:function(){},nc:function(){},ug:function(){}};return t.f.push({create:e,ta:n}),t.b&&t.b.abort(),Ss(t),n}function Ss(t){t.h&&(t.h.resolve(),t.h=null)}function xs(t){this.a=null;for(var e=0;e<t.textTracks.length;++e){var n=t.textTracks[e];n.mode="disabled","Shaka Player TextTrack"==n.label&&(this.a=n)}this.a||(this.a=t.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function ks(t){if(t.startTime>=t.endTime)return null;var e=new VTTCue(t.startTime,t.endTime,t.payload);e.lineAlign=t.lineAlign,e.positionAlign=t.positionAlign,e.size=t.size;try{e.align=t.textAlign}catch(n){}return"center"==t.textAlign&&"center"!=e.align&&(e.align="middle"),"vertical-lr"==t.writingMode?e.vertical="lr":"vertical-rl"==t.writingMode&&(e.vertical="rl"),1==t.lineInterpretation&&(e.snapToLines=!1),null!=t.line&&(e.line=t.line),null!=t.position&&(e.position=t.position),e}function As(t,e){var n=t.mode;t.mode="showing"==n?"showing":"hidden";for(var r=t.cues,i=r.length-1;0<=i;i--){var a=r[i];a&&e(a)&&t.removeCue(a)}t.mode=n}function Is(t,e,n,r,i){var a,o=i in r,s=!0;for(a in e){var u=i+"."+a,c=o?r[i]:n[a];o||a in n?void 0===e[a]?void 0===c||o?delete t[a]:t[a]=At(c):c.constructor==Object&&e[a]&&e[a].constructor==Object?(t[a]||(t[a]=At(c)),u=Is(t[a],e[a],c,r,u),s=s&&u):typeof e[a]!=typeof c||null==e[a]||e[a].constructor!=c.constructor?s=!1:t[a]=e[a]:s=!1}return s}function Ms(t,e){for(var n={},r=n,i=0,a=0;!(0>(i=t.indexOf(".",i)));)0!=i&&"\\"==t[i-1]||(r[a=t.substring(a,i).replace(/\\\./g,".")]={},r=r[a],a=i+1),i+=1;return r[t.substring(a).replace(/\\\./g,".")]=e,n}function Ns(){}function Ps(){var t=5e5,e=1/0;navigator.connection&&(t=1e6*navigator.connection.downlink,navigator.connection.saveData&&(e=360));var n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:xe,fairPlayTransform:!0},r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},availabilityWindowOverride:NaN,disableAudio:!1,dash:{customScheme:function(t){if(t)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0},hls:{ignoreTextStreamFailures:!1}},i={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},failureCallback:function(){},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};ee("Web0S")&&(i.stallEnabled=!1);var a={trackSelectionCallback:function(t){return t},progressCallback:function(){},usePersistentLicense:!0},o={drm:n,manifest:r,streaming:i,offline:a,abrFactory:Wn,abr:{enabled:!0,defaultBandwidthEstimate:t,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return a.trackSelectionCallback=function(t){return function(t,e){var n=t.filter(function(t){return"variant"==t.type}),r=[],i=Dn(e,n.map(function(t){return t.language}));i&&(r=n.filter(function(t){return Cn(t.language)==i})),0==r.length&&(r=n.filter(function(t){return t.primary})),0==r.length&&(n.map(function(t){return t.language}),r=n);var a=r.filter(function(t){return t.height&&480>=t.height});if(a.length&&(a.sort(function(t,e){return e.height-t.height}),r=a.filter(function(t){return t.height==a[0].height})),n=[],r.length){var o=Math.floor(r.length/2);r.sort(function(t,e){return t.bandwidth-e.bandwidth}),n.push(r[o])}for(r=h(t),o=r.next();!o.done;o=r.next())"text"==(o=o.value).type&&n.push(o);return n}(t,o.preferredAudioLanguage)},o}function Cs(t,e,n){var r={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Is(t,e,n||Ps(),r,"")}function Rs(){this.a=null,this.b=[]}function Ds(t,e){if(null==t.a)t.a={timestamp:Date.now()/1e3,state:e,duration:0};else{var n=Date.now()/1e3;t.a.duration=n-t.a.timestamp,t.a.state!=e&&(t.b.push(t.a),t.a={timestamp:n,state:e,duration:0})}}function _s(t,e){var n=0;t.a&&t.a.state==e&&(n+=t.a.duration);for(var r=h(t.b),i=r.next();!i.done;i=r.next())n+=(i=i.value).state==e?i.duration:0;return n}function Ls(){this.b=this.c=null,this.a=[]}function Us(){this.f=this.l=this.b=this.h=this.i=this.g=this.m=NaN,this.a=new Rs,this.c=new Ls}function Os(e,n){var r=this;kt.call(this),this.h=Tu,this.a=null,this.gb=!1,this.g=new Vt,this.zc=this.l=this.Eb=this.b=this.m=this.f=this.Vb=this.B=this.Wb=this.W=this.ib=this.s=this.F=this.i=this.L=null,this.Kd=1e9,this.Zb=new Set,this.kb=!0,this.Ga=null,this.Hd=!1,this.Fd=0,this.oa=null,this.$=new ya,this.c=Xs(this),this.$b={width:1/0,height:1/0},this.v=null,this.Xb=new Aa(this.c.preferredAudioLanguage,this.c.preferredVariantRole,this.c.preferredAudioChannelCount),this.na=this.c.preferredTextLanguage,this.fb=this.c.preferredTextRole,n&&n(this),this.L=function(t){return new Rt(function(e,n){t.l&&t.l.segmentDownloaded(e,n)})}(this),this.g.w(t,"online",function(){r.nd()}),this.D={name:"detach"},this.R={name:"attach"},this.Ha={name:"unload"},this.Ic={name:"manifest-parser"},this.Gc={name:"manifest"},this.hb={name:"media-source"},this.Ac={name:"drm-engine"},this.T={name:"load"},this.Nc={name:"src-equals-drm-engine"},this.jb={name:"src-equals"};var i=new Map;i.set(this.R,function(t,e){return wt(function(t,e,n){return null==e.u&&(e.u=n.u,t.g.w(e.u,"error",function(){var e=uu(t);e&&t.Ma(e)})),t.a=e.u,Promise.resolve()}(r,t,e))}),i.set(this.D,function(t){return t.u&&(r.g.ea(t.u,"error"),t.u=null),r.a=null,wt(t=Promise.resolve())}),i.set(this.Ha,function(t){return wt(Ks(r,t))}),i.set(this.hb,function(e){return wt(e=function(e,n){return p(function r(){var i,a,o,s;return L(r,function(r){switch(r.j){case 1:return i=t.muxjs?new De:new _e,a=e.c.textDisplayFactory,o=new a,e.Bc=a,s=new vn(n.u,i,o),S(r,s.s,2);case 2:e.F=s,x(r)}})})}(r,e))}),i.set(this.Ic,function(t,e){return wt(function(t,e,n){return p(function r(){var i,a,o;return L(r,function(r){switch(r.j){case 1:if(e.za=n.za,e.mimeType=n.mimeType,e.uri=n.uri,i=e.uri,a=t.L,t.Eb=i,e.za){t.m=e.za(),r.A(2);break}return o=t,S(r,Ti.create(i,a,t.c.manifest.retryParameters,e.mimeType),3);case 3:o.m=r.o;case 2:t.m.configure(t.c.manifest),x(r)}})})}(r,t,e))}),i.set(this.Gc,function(t){return function(t,e){var n=e.uri,r=t.L;t.Vb=new eo,function(t,e){t.b=e}(t.Vb,function(e){su(t,"timelineregionadded",e)});var i={networkingEngine:r,filterNewPeriod:function(e){return t.Jc(e)},filterAllPeriods:function(e){return Ys(t,e)},onTimelineRegionAdded:function(e){var n=t.Vb;t:{for(var r=h(n.a),i=r.next();!i.done;i=r.next())if((i=i.value).schemeIdUri==e.schemeIdUri&&i.id==e.id&&i.startTime==e.startTime&&i.endTime==e.endTime){r=i;break t}r=null}null==r&&(n.a.add(e),n.b(e))},onEvent:function(e){return t.dispatchEvent(e)},onError:function(e){return t.Ma(e)}};return new vt(Promise.resolve().then(function(){return p(function e(){var r;return L(e,function(e){switch(e.j){case 1:return r=t,S(e,t.m.start(n,i),2);case 2:if(r.b=e.o,t.dispatchEvent(new St("manifestparsed")),0==t.b.periods.length)throw new pt(2,4,4014);!function(t){function e(t){return t.video&&t.audio||t.video&&t.video.codecs.includes(",")}t.some(function(t){return t.variants.some(e)})&&t.forEach(function(t){t.variants=t.variants.filter(e)})}(t.b.periods),x(e)}})})}),function(){return t.m.stop()})}(r,t)}),i.set(this.Ac,function(){return wt(function(t){return p(function e(){return L(e,function(e){switch(e.j){case 1:return t.i=new he({tb:t.L,onError:function(e){t.Ma(e)},mc:function(e){cu(t,e)},onExpirationUpdated:function(e,n){lu(t,e,n)},onEvent:function(e){t.dispatchEvent(e)}}),t.i.configure(t.c.drm),S(e,de(t.i,ja(t.b.periods),t.b.offlineSessionIds),2);case 2:Ys(t,t.b.periods),x(e)}})})}(r))}),i.set(this.T,function(t,e){return wt(function(t,e,n){return p(function r(){var i,a,o,s,u,c,l,f,d;return L(r,function(r){switch(r.j){case 1:return e.startTime=n.startTime,i=e.u,a=e.uri,t.Eb=a,t.v=new Us,o=function(){return Qs(t)},s=function(){var e=t.a.playbackRate;0!=e&&t.W.set(e)},t.g.w(i,"playing",o),t.g.w(i,"pause",o),t.g.w(i,"ended",o),t.g.w(i,"ratechange",s),u=t.c.abrFactory,t.l&&t.zc==u||(t.zc=u,t.l=new u,t.l.configure(t.c.abr)),function(t,e){for(var n=0;n<e.length;n++){for(var r=e[n],i=new Map,a=h(r.variants),o=a.next();!o.done;o=a.next())if((o=o.value).video&&o.video.closedCaptions)for(var s=h((o=o.video).closedCaptions.keys()),u=s.next();!u.done;u=s.next())if(u=u.value,!i.has(u)){var c={id:t.Kd++,originalId:u,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:o.closedCaptions.get(u),label:null,type:"text",primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:o.roles,channelsCount:null,closedCaptions:null};i.set(u,c)}for(i=h(i.values()),a=i.next();!a.done;a=i.next())r.textStreams.push(a.value)}}(t,t.b.periods),t.Xb=new Aa(t.c.preferredAudioLanguage,t.c.preferredVariantRole,t.c.preferredAudioChannelCount),t.na=t.c.preferredTextLanguage,function(t,e,n){0<e&&(t.V()||t.fe(e)),n<t.Y()&&(t.V()||t.wa(n))}(t.b.presentationTimeline,t.c.playRangeStart,t.c.playRangeEnd),S(r,t.i.Fb(i),2);case 2:return t.l.init(function(e,n,r){n=void 0!==n&&n,r=void 0===r?0:r;t:{for(var i=h(t.b.periods),a=i.next();!a.done;a=i.next())if((a=a.value).variants.includes(e)){i=a;break t}i=null}qs(t,i,e,!0),t.f&&(ho(t.f,e,n,r),eu(t))}),t.s=function(t,e){return new Ja(t.a,t.b,t.c.streaming,e,function(){t.ib&&Oa(t.ib,!0),t.f&&function(t){function e(e){var i=t.a.J;return e="text"==e?null!=(e=i.a).a&&null!=e.b&&n>=e.a&&n<e.b:Ue(e=Sn(i,e),n,r)}var n=t.a.Ua(),r=t.g.smallGapLimit,i=Ao(t,n);if(Xt(t.b.values(),function(t){return t.ia==i}))for(var a=h(t.b.keys()),o=a.next();!o.done;o=a.next())e(o=o.value)||mo(t,t.b.get(o));else Xt(t.b.keys(),e)||t.b.forEach(function(e){mo(t,e)})}(t.f),t.B&&Hs(t)},function(e){return t.dispatchEvent(e)})}(t,e.startTime),t.ib=function(t){var e=new Fa(t.b);!function(t,e){t.b=e}(e,function(){nu(t)});var n=new no(t.Vb);!function(t,e,n,r){t.a=e,t.b=n,t.c=r}(n,function(e){su(t,"timelineregionenter",e)},function(e){su(t,"timelineregionexit",e)},function(e,n){n||(su(t,"timelineregionenter",e),su(t,"timelineregionexit",e))});var r=new Ua(t.a);return r.a.add(e),r.a.add(n),r}(t),t.W=new Ka({gc:function(){return e.u.playbackRate},rd:function(t){e.u.playbackRate=t},Ld:function(t){e.u.currentTime+=t}}),c=Math.max(t.b.minBufferTime,t.c.streaming.rebufferingGoal),Vs(t,c),t.f=function(t){return new oo(t.b,{Ua:function(){return t.s.h()},getBandwidthEstimate:function(){return t.l.getBandwidthEstimate()},J:t.F,tb:t.L,Od:t.gf.bind(t),Nd:t.ve.bind(t),onError:t.Ma.bind(t),onEvent:function(e){return t.dispatchEvent(e)},lf:t.mf.bind(t),dd:t.tf.bind(t)})}(t),t.f.configure(t.c.streaming),function(t){function e(t){var e="";t.video&&(e=Jt(t.video.codecs)[0]);var n="";return t.audio&&(n=Jt(t.audio.codecs)[0]),e+"-"+n}var n=t.b.periods.reduce(function(t,e){return t.concat(e.variants)},[]);n=qn(n,t.c.preferredAudioChannelCount);var r=new xt;n.forEach(function(t){var n=e(t);r.push(n,t)});var i=null,a=1/0;r.forEach(function(t,e){var n=0,r=0;e.forEach(function(t){n+=t.bandwidth||0,++r});var o=n/r;o<a&&(i=t,a=o)}),t.b.periods.forEach(function(t){t.variants=t.variants.filter(function(t){return e(t)==i})})}(t),t.h=Eu,t.dispatchEvent(new St("streaming")),S(r,t.f.start(),3);case 3:t.c.streaming.startAtSegmentBoundary&&(l=t.s.h(),f=function(t,e){function n(t,e){if(!t)return null;var n=t.findSegmentPosition(e-a.startTime);return null==n?null:(n=t.getSegmentReference(n))?n.startTime+a.startTime:null}var r=so(t.f),i=uo(t.f),a=mu(t);return r=n(r,e),null!=(i=n(i,e))&&null!=r?Math.max(i,r):null!=i?i:null!=r?r:e}(t,l),t.s.m(f)),t.b.periods.forEach(t.Jc.bind(t)),nu(t),eu(t),(d=mu(t)||t.b.periods[0]).variants.some(function(t){return t.primary}),Zs(t,d.variants),t.g.da(i,"loadeddata",function(){t.v.b=Date.now()/1e3-n.ud}),x(r)}})})}(r,t,e))}),i.set(this.Nc,function(t){return wt(t=function(t,e){return p(function n(){var r,i;return L(n,function(n){switch(n.j){case 1:return r=Ve,t.i=new he({tb:t.L,onError:function(e){t.Ma(e)},mc:function(e){cu(t,e)},onExpirationUpdated:function(e,n){lu(t,e,n)},onEvent:function(e){t.dispatchEvent(e)}}),t.i.configure(t.c.drm),i={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:r.Pa,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},S(n,de(t.i,[i],[]),2);case 2:return S(n,t.i.Fb(e.u),0)}})})}(r,t))}),i.set(this.jb,function(t,e){return function(t,e,n){function r(){return Qs(t)}if(e.uri=n.uri,e.startTime=n.startTime,t.Eb=e.uri,t.v=new Us,t.s=new $a(e.u),null!=e.startTime&&t.s.m(e.startTime),t.W=new Ka({gc:function(){return e.u.playbackRate},rd:function(t){e.u.playbackRate=t},Ld:function(t){e.u.currentTime+=t}}),Vs(t,t.c.streaming.rebufferingGoal),t.g.w(e.u,"playing",r),t.g.w(e.u,"pause",r),t.g.w(e.u,"ended",r),t.g.da(e.u,"loadeddata",function(){t.v.b=Date.now()/1e3-n.ud}),t.a.audioTracks&&(t.g.w(t.a.audioTracks,"addtrack",function(){return nu(t)}),t.g.w(t.a.audioTracks,"removetrack",function(){return nu(t)}),t.g.w(t.a.audioTracks,"change",function(){return nu(t)})),t.a.textTracks){var i=t.a.textTracks;t.g.w(i,"addtrack",function(){return nu(t)}),t.g.w(i,"removetrack",function(){return nu(t)}),t.g.w(i,"change",function(){return nu(t)})}e.u.src=e.uri,t.h=Su,t.dispatchEvent(new St("streaming"));var a=new mt;return t.a.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?a.resolve():t.a.error?a.reject(uu(t)):(t.g.da(t.a,"loadeddata",function(){a.resolve()}),t.g.da(t.a,"error",function(){a.reject(uu(t))})),new vt(a,function(){return a.reject(new pt(2,7,7001)),Promise.resolve()})}(r,t,e)}),this.lb=new Ts(this.D,{Se:function(t,e,n,i){var a=null;return t==r.D&&(a=n==r.D?r.D:r.R),t==r.R&&(a=n==r.D||e.u!=i.u?r.D:n==r.R?r.R:n==r.hb||n==r.T?r.hb:n==r.jb?r.Nc:null),t==r.hb&&(a=n==r.T&&e.u==i.u?r.Ic:r.Ha),t==r.Ic&&(a=gu(r.T,r.Gc,r.Ha,n,e,i)),t==r.Gc&&(a=gu(r.T,r.Ac,r.Ha,n,e,i)),t==r.Ac&&(a=gu(r.T,r.T,r.Ha,n,e,i)),t==r.Nc&&(a=n==r.jb&&e.u==i.u?r.jb:r.Ha),t!=r.T&&t!=r.jb||(a=r.Ha),t==r.Ha&&(a=i.u&&e.u==i.u?r.R:r.D),a},Be:function(t,e,n){return r.dispatchEvent(new St("onstatechange",{state:t.name})),i.get(t)(e,n)},handleError:function(t){return p(function e(){return L(e,function(e){switch(e.j){case 1:return S(e,Ks(r,t),2);case 2:return e.return(t.u?r.R:r.D)}})})},jf:function(t){r.dispatchEvent(new St("onstateidle",{state:t.name}))}}),e&&this.Fb(e,!0)}(n=$o.prototype).destroy=function(){return this.a.destroy()},n.hasFixedKeySpace=function(){return!0},n.addSegments=function(){return Jo("segment")},n.removeSegments=function(t,e){return Qo(this,"segment",t,e)},n.getSegments=function(t){return Zo(this,"segment",t).then(function(t){return t.map(is)})},n.addManifests=function(){return Jo("manifest")},n.updateManifestExpiration=function(t,e){var n=Ho(this.a,"manifest"),r=n.store(),i=new mt;return r.get(t).onsuccess=function(n){(n=n.target.result)?(n.expiration=e,r.put(n),i.resolve()):i.reject(new pt(2,9,9012,"Could not find values for "+t))},n.promise().then(function(){return i})},n.removeManifests=function(t,e){return Qo(this,"manifest",t,e)},n.getManifests=function(t){return Zo(this,"manifest",t).then(function(t){return t.map(ts)})},n.getAllManifests=function(){var t=this;return p(function e(){var n,r;return L(e,function(e){switch(e.j){case 1:return n=Vo(t.a,"manifest"),r=new Map,S(e,Fo(n,function(t,e){r.set(t,ts(e))}),2);case 2:return S(e,n.promise(),3);case 3:return e.return(r)}})})},(n=os.prototype).destroy=function(){return this.a.destroy()},n.hasFixedKeySpace=function(){return this.f},n.addSegments=function(t){return ss(this,this.c,t)},n.removeSegments=function(t,e){return us(this,this.c,t,e)},n.getSegments=function(t){return cs(this,this.c,t)},n.addManifests=function(t){return ss(this,this.b,t)},n.updateManifestExpiration=function(t,e){var n=Ho(this.a,this.b),r=n.store();return r.get(t).onsuccess=function(n){(n=n.target.result)&&(n.expiration=e,r.put(n,t))},n.promise()},n.removeManifests=function(t,e){return us(this,this.b,t,e)},n.getManifests=function(t){return cs(this,this.b,t)},n.getAllManifests=function(){var t=this;return p(function e(){var n,r;return L(e,function(e){switch(e.j){case 1:return n=Vo(t.a,t.b),r=new Map,S(e,Fo(n,function(t,e){r.set(t,e)}),2);case 2:return S(e,n.promise(),3);case 3:return e.return(r)}})})},(n=ls.prototype).init=function(){var e=this,n=new mt,r=t.indexedDB.open("shaka_offline_db",4);return r.onsuccess=function(t){t=t.target.result,e.f=t;var r=t.objectStoreNames;r=r.contains("manifest")&&r.contains("segment")?new $o(t):null,e.a=r,r=(r=t.objectStoreNames).contains("manifest-v2")&&r.contains("segment-v2")?new os(t,"segment-v2","manifest-v2",!0):null,e.b=r,r=(r=t.objectStoreNames).contains("manifest-v3")&&r.contains("segment-v3")?new os(t,"segment-v3","manifest-v3",!1):null,e.c=r,t=t.objectStoreNames.contains("session-ids")?new qo(t):null,e.g=t,n.resolve()},r.onupgradeneeded=function(t){t=t.target.result;for(var e=h(["segment-v3","manifest-v3","session-ids"]),n=e.next();!n.done;n=e.next())n=n.value,t.objectStoreNames.contains(n)||t.createObjectStore(n,{autoIncrement:!0})},r.onerror=function(t){n.reject(new pt(2,9,9001,r.error)),t.preventDefault()},n},n.destroy=function(){var t=this;return p(function e(){return L(e,function(e){switch(e.j){case 1:if(!t.a){e.A(2);break}return S(e,t.a.destroy(),2);case 2:if(!t.b){e.A(4);break}return S(e,t.b.destroy(),4);case 4:if(!t.c){e.A(6);break}return S(e,t.c.destroy(),6);case 6:if(!t.g){e.A(8);break}return S(e,t.g.destroy(),8);case 8:t.f&&t.f.close(),x(e)}})})},n.getCells=function(){var t=new Map;return this.a&&t.set("v1",this.a),this.b&&t.set("v2",this.b),this.c&&t.set("v3",this.c),t},n.getEmeSessionCell=function(){return this.g},n.erase=function(){var e=this;return p(function n(){return L(n,function(n){switch(n.j){case 1:if(!e.a){n.A(2);break}return S(n,e.a.destroy(),2);case 2:if(!e.b){n.A(4);break}return S(n,e.b.destroy(),4);case 4:if(!e.c){n.A(6);break}return S(n,e.c.destroy(),6);case 6:return e.f&&e.f.close(),S(n,function(){var e=new mt,n=t.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){e.resolve()},n.onerror=function(t){e.reject(new pt(2,9,9001,n.error)),t.preventDefault()},e}(),8);case 8:return e.f=null,e.a=null,e.b=null,e.c=null,S(n,e.init(),0)}})})},Yo("idb",function(){return t.indexedDB?new ls:null}),fs.prototype.ua=function(){return this.g},fs.prototype.aa=function(){return this.f},fs.prototype.key=function(){return this.c},fs.prototype.toString=function(){return this.b},(n=ys.prototype).configure=function(){},n.start=function(t){var e=this;return p(function n(){var r,i,a,o,s;return L(n,function(n){switch(n.j){case 1:return r=hs(t),e.a=r,null==r||"manifest"!=r.a?n.return(Promise.reject(new pt(2,1,9004,r))):(i=new Go,A(n,2),S(n,i.init(),4));case 4:return S(n,Xo(i,r.ua(),r.aa()),5);case 5:return S(n,n.o.getManifests([r.key()]),6);case 6:return a=n.o,o=a[0],s=new ds(r.ua(),r.aa()),n.return(function(t,e){var n=new Ei(null,0);n.wa(e.duration);var r=e.periods.map(function(e){return ps(t,e,n)}),i=e.drmInfo?[e.drmInfo]:[];return e.drmInfo&&r.forEach(function(t){t.variants.forEach(function(t){t.drmInfos=i})}),{presentationTimeline:n,minBufferTime:2,offlineSessionIds:e.sessionIds,periods:r}}(s,o));case 2:return N(n),S(n,i.destroy(),7);case 7:P(n,0)}})})},n.stop=function(){return Promise.resolve()},n.update=function(){},n.onExpirationUpdated=function(t,e){var n=this;return p(function r(){var i,a,o,s,u,c,l;return L(r,function(r){switch(r.j){case 1:return i=n.a,a=new Go,k(r,2,3),S(r,a.init(),5);case 5:return S(r,Xo(a,i.ua(),i.aa()),6);case 6:return S(r,(o=r.o).getManifests([i.key()]),7);case 7:if(s=r.o,u=s[0],c=u.sessionIds.includes(t),l=null==u.expiration||u.expiration>e,!c||!l){r.A(3);break}return S(r,o.updateManifestExpiration(i.key(),e),3);case 3:return N(r),S(r,a.destroy(),10);case 10:P(r,0);break;case 2:M(r),r.A(3)}})})},Ti.Bb("application/x-offline-manifest",ys),K("shaka.offline.OfflineScheme",gs),gs.h=function(t){return bt(t={uri:t,fd:t,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},gs.i=function(t,e){var n=new Go;return bt(void 0).U(function(){return n.init()}).U(function(){return Xo(n,e.ua(),e.aa())}).U(function(t){return t.getSegments([e.key()])}).U(function(t){return{uri:e,fd:e,data:t[0].data,headers:{}}}).finally(function(){return n.destroy()})},_t("offline",gs),Ts.prototype.destroy=function(){var t=this;return p(function e(){return L(e,function(e){switch(e.j){case 1:return t.l=!1,t.b&&t.b.abort(),Ss(t),S(e,t.m,2);case 2:t.a&&t.a.ta.Ya();for(var n=h(t.f),r=n.next();!r.done;r=n.next())r.value.ta.Ya();t.a=null,t.f=[],t.g=null,x(e)}})})},K("shaka.text.SimpleTextDisplayer",xs),xs.prototype.remove=function(t,e){return!!this.a&&(As(this.a,function(n){return n.startTime<e&&n.endTime>t}),!0)},xs.prototype.remove=xs.prototype.remove,xs.prototype.append=function(t){for(var e=ks,n=[],r=0;r<t.length;r++){var i=e(t[r]);i&&n.push(i)}n.slice().sort(function(t,e){return t.startTime!=e.startTime?t.startTime-e.startTime:t.endTime!=e.endTime?t.endTime-e.startTime:n.indexOf(e)-n.indexOf(t)}).forEach(function(t){this.a.addCue(t)}.bind(this))},xs.prototype.append=xs.prototype.append,xs.prototype.destroy=function(){return this.a&&As(this.a,function(){return!0}),this.a=null,Promise.resolve()},xs.prototype.destroy=xs.prototype.destroy,xs.prototype.isTextVisible=function(){return"showing"==this.a.mode},xs.prototype.isTextVisible=xs.prototype.isTextVisible,xs.prototype.setTextVisibility=function(t){this.a.mode=t?"showing":"hidden"},xs.prototype.setTextVisibility=xs.prototype.setTextVisibility,K("shaka.util.ConfigUtils.mergeConfigObjects",Is),K("shaka.util.ConfigUtils.convertToConfigObject",Ms),K("shaka.util.PlayerConfiguration",Ns),Ns.mergeConfigObjects=Cs,V(Os,kt),K("shaka.Player",Os),Os.prototype.destroy=function(){var t=this;return p(function e(){var n;return L(e,function(e){switch(e.j){case 1:return t.h==wu?e.return():(t.h=wu,n=Es(t.lb,function(){return{node:t.D,payload:{za:null,u:null,mimeType:null,startTime:null,ud:null,uri:null},Va:!1}}),S(e,new Promise(function(t){n.vb=function(){},n.lc=function(){t()},n.Ya=function(){t()},n.onError=function(){t()},n.nc=function(){t()}}),2));case 2:return S(e,t.lb.destroy(),3);case 3:if(t.g&&(t.g.release(),t.g=null),t.zc=null,t.l=null,t.c=null,!t.L){e.A(0);break}return S(e,t.L.destroy(),5);case 5:t.L=null,x(e)}})})},Os.prototype.destroy=Os.prototype.destroy,Os.version="v2.5.6";var js=["2","5"];er=new function(t){this.a=t,this.c=Zn,this.b=tr}(new Jn(Number(js[0]),Number(js[1])));var Bs=["output-restricted","internal-error"],Fs={};function Ks(t,e){return p(function n(){return L(n,function(n){switch(n.j){case 1:if(t.h!=wu&&(t.h=Tu),t.dispatchEvent(new St("unloading")),e.za=null,e.mimeType=null,e.startTime=null,e.uri=null,e.u&&(t.g.ea(e.u,"loadeddata"),t.g.ea(e.u,"playing"),t.g.ea(e.u,"pause"),t.g.ea(e.u,"ended"),t.g.ea(e.u,"ratechange")),t.ib&&(t.ib.release(),t.ib=null),t.Wb&&(t.Wb.stop(),t.Wb=null),!t.m){n.A(2);break}return S(n,t.m.stop(),3);case 3:t.m=null;case 2:if(!t.l){n.A(4);break}return S(n,t.l.stop(),4);case 4:if(!t.f){n.A(6);break}return S(n,t.f.destroy(),7);case 7:t.f=null;case 6:if(t.s&&(t.s.release(),t.s=null),!t.F){n.A(8);break}return S(n,t.F.destroy(),9);case 9:t.F=null;case 8:if(!e.u||!e.u.src){n.A(10);break}return S(n,new Promise(function(t){return new ft(t).P(.1)}),11);case 11:e.u.removeAttribute("src"),e.u.load();case 10:if(!t.i){n.A(12);break}return S(n,t.i.destroy(),13);case 13:t.i=null;case 12:t.$.a.clear(),t.Eb=null,t.B=null,t.Zb.clear(),t.b=null,t.v=null,t.Bc=null,t.kb=!0,Js(t),x(n)}})})}function Vs(t,e){t.B=new Ia,t.B.a=Na,Ma(t.B,e,Math.min(.5,e/2)),Js(t),t.Wb=new ft(function(){Hs(t)}).Na(.25)}function Hs(t){switch(t.h){case Su:var e=!!t.a.ended||Le(t.a.buffered)>=t.a.duration-1;break;case Eu:t:if(t.a.ended||wn(t.F))e=!0;else{if(t.b.presentationTimeline.V()){var n=t.b.presentationTimeline.pb();if(Le(t.a.buffered)>=n){e=!0;break t}}e=!1}break;default:e=!1}var r=Oe(t.a.buffered,t.a.currentTime),i=e,a=(n=t.B).b.get(n.a);e=n.a,r=i||r>=a?Pa:Na,n.a=r,e!=r&&Js(t)}function zs(t){if(t.m&&t.m.configure(t.c.manifest),t.i&&t.i.configure(t.c.drm),t.f){t.f.configure(t.c.streaming);try{t.b.periods.forEach(t.Jc.bind(t))}catch(a){t.Ma(a)}var e=so(t.f),n=uo(t.f),r=mu(t);e=Yn(e,n,r.variants),t.l&&e&&e.allowedByApplication&&e.allowedByKeySystem?Zs(t,r.variants):tu(t,r)}if(t.F&&(r=t.c.textDisplayFactory,t.Bc!=r)){e=new r;var i=(n=t.F).g;n.g=e,i&&(e.setTextVisibility(i.isTextVisible()),i.destroy()),n.a&&(n.a.c=e),t.Bc=r,t.f&&((e=(r=t.f).b.get("text"))&&po(r,e.stream,!0,0,!0))}t.l&&(t.l.configure(t.c.abr),t.c.abr.enabled&&!t.kb?t.l.enable():t.l.disable(),ou(t)),t.B&&(r=t.c.streaming.rebufferingGoal,t.b&&(r=Math.max(r,t.b.minBufferTime)),Ma(t.B,r,Math.min(.5,r/2)))}function qs(t,e,n,r){ba(t.$,e).variant=n,(t=t.v.c).c!=n&&(t.c=n,t.a.push({timestamp:Date.now()/1e3,id:n.id,type:"variant",fromAdaptation:r,bandwidth:n.bandwidth}))}function Gs(t,e,n,r){ga(t.$,e,n),(t=t.v.c).b!=n&&(t.b=n,t.a.push({timestamp:Date.now()/1e3,id:n.id,type:"text",fromAdaptation:r,bandwidth:null}))}function Xs(t){var e=Ps();return e.streaming.failureCallback=function(e){t.V()&&[1001,1002,1003].includes(e.code)&&(e.severity=1,t.nd())},e.textDisplayFactory=function(){return new xs(t.a)},e}function Ys(t,e){var n=t.f?so(t.f):null,r=t.f?uo(t.f):null;if(e.forEach(On.bind(null,t.i,n,r)),0==(n=function(t,e){var n=0;return t.forEach(function(t){n+=e(t)?1:0}),n}(e,function(t){return t.variants.some(zn)})))throw new pt(2,4,4032);if(n<e.length)throw new pt(2,4,4011);e.forEach(function(t){Un(t.variants,this.c.restrictions,this.$b)&&this.f&&mu(this)==t&&nu(this),fu(this,t.variants)}.bind(t))}function Ws(t,e,n,r){n=void 0!==n&&n,r=void 0===r?0:r,t.kb?(t.Ga=e,t.Hd=n,t.Fd=r):(ho(t.f,e,n,r),ru(t))}function $s(t,e){t.kb?t.oa=e:(po(t.f,e,!0,0,!1),iu(t))}function Js(t){var e=t.Tc();if(t.v&&t.B&&t.s){var n=t.W;n.f=e,Va(n),Qs(t)}t.dispatchEvent(new St("buffering",{buffering:e}))}function Qs(t){if(t.v&&t.B){var e=t.v.a;t.B.a==Na?Ds(e,"buffering"):t.a.paused?Ds(e,"paused"):t.a.ended?Ds(e,"ended"):Ds(e,"playing")}}function Zs(t,e){try{fu(t,e)}catch(r){return t.Ma(r),null}var n=e.filter(function(t){return zn(t)});return n=t.Xb.create(n),t.l.setVariants(Array.from(n.values())),t.l.chooseVariant()}function tu(t,e){var n=Zs(t,e.variants);n&&(qs(t,e,n,!0),Ws(t,n,!0)),(n=Gn(e.textStreams,t.na,t.fb)[0]||null)&&(t.c.streaming.alwaysStreamText||t.ic())&&(Gs(t,e,n,!0),$s(t,n)),eu(t)}function eu(t){hu(t,new St("adaptation"))}function nu(t){hu(t,new St("trackschanged"))}function ru(t){hu(t,new St("variantchanged"))}function iu(t){hu(t,new St("textchanged"))}function au(t){hu(t,new St("texttrackvisibility"))}function ou(t){hu(t,new St("abrstatuschanged",{tg:t.c.abr.enabled}))}function su(t,e,n){t.dispatchEvent(new St(e,{detail:{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}}))}function uu(t){if(!t.a.error)return null;var e=t.a.error.code;if(1==e)return null;var n=t.a.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new pt(2,3,3016,e,n,t.a.error.message)}function cu(t,e){if(t.f){var n=mu(t),r=!1,i=Object.keys(e),a=1==i.length&&"00"==i[0];i.length&&t.b.periods.forEach(function(t){t.variants.forEach(function(t){(function(t){var e=[];return t.audio&&e.push(t.audio),t.video&&e.push(t.video),e})(t).forEach(function(n){var i=t.allowedByKeySystem;n.keyId&&(n=e[a?"00":n.keyId],t.allowedByKeySystem=!!n&&!Bs.includes(n)),i!=t.allowedByKeySystem&&(r=!0)})})}),(i=Yn(i=so(t.f),uo(t.f),n.variants))&&!i.allowedByKeySystem&&tu(t,n),r&&(nu(t),Zs(t,n.variants))}}function lu(t,e,n){t.m&&t.m.onExpirationUpdated&&t.m.onExpirationUpdated(e,n),t.dispatchEvent(new St("expirationupdated"))}function fu(t,e){var n=t.i?Wt(t.i.T):{},r=Object.keys(n);r=r.length&&"00"==r[0];for(var i=!1,a=!1,o=[],s=[],u=h(e),c=u.next();!c.done;c=u.next()){var l=[];(c=c.value).audio&&l.push(c.audio),c.video&&l.push(c.video);for(var f=(l=h(l)).next();!f.done;f=l.next())if((f=f.value).keyId){var d=n[r?"00":f.keyId];d?Bs.includes(d)&&(s.includes(d)||s.push(d)):o.includes(f.keyId)||o.push(f.keyId)}c.allowedByApplication?c.allowedByKeySystem&&(i=!0):a=!0}if(!i)throw new pt(2,4,4012,{hasAppRestrictions:a,missingKeys:o,restrictedKeyStatuses:s})}function hu(t,e){p(function n(){return L(n,function(n){switch(n.j){case 1:return S(n,Promise.resolve(),2);case 2:t.h!=wu&&t.dispatchEvent(e),x(n)}})})}function du(t){for(var e=new Set,n=(t=h(t)).next();!n.done;n=t.next())(n=n.value).language?e.add(Cn(n.language)):e.add("und");return e}function pu(t){for(var e=new Map,n=(t=h(t)).next();!n.done;n=t.next()){var r=n.value;n="und";var i=[];for(r.language&&(n=Cn(r.language)),(i="variant"==r.type?r.audioRoles:r.roles)&&i.length||(i=[""]),e.has(n)||e.set(n,new Set),i=(r=h(i)).next();!i.done;i=r.next())i=i.value,e.get(n).add(i)}var a=[];return e.forEach(function(t,e){for(var n=h(t),r=n.next();!r.done;r=n.next())a.push({language:e,role:r.value})}),a}function mu(t){for(var e=t.s.h(),n=null,r=(t=h(t.b.periods)).next();!r.done;r=t.next())(r=r.value).startTime<=e&&(n=r);return n}function vu(t){var e=mu(t);return ba(t.$,e).variant}function yu(){return new pt(2,7,7e3)}function gu(t,e,n,r,i,a){return r==t&&i.u==a.u&&i.uri==a.uri&&i.mimeType==a.mimeType&&i.za==a.za?e:n}function bu(t){return new Promise(function(e,n){t.Ya=function(){return n(yu())},t.lc=function(){return e()},t.onError=function(t){return n(t)},t.nc=function(){return n(yu())}})}Os.registerSupportPlugin=function(t,e){Fs[t]=e},Os.isBrowserSupported=function(){return!!(t.Promise&&t.Uint8Array&&Array.prototype.forEach&&t.MediaKeys&&t.navigator&&t.navigator.requestMediaKeySystemAccess&&t.MediaKeySystemAccess&&t.MediaKeySystemAccess.prototype.getConfiguration)&&(!!Zt()||te("application/x-mpegurl"))},Os.probeSupport=function(){return Ae().then(function(t){for(var e=Ti.Df(),n={},r=h('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),i=r.next();!i.done;i=r.next()){n[i=i.value]=Zt()?!!dn(i)||(MediaSource.isTypeSupported(i)||qe(i)):te(i);var a=i.split(";")[0];n[a]=n[a]||n[i]}for(var o in t={manifest:e,media:n,drm:t},Fs)t[o]=Fs[o]();return t})},Os.prototype.Fb=function(t,e){if(e=void 0===e||e,this.h==wu)return Promise.reject(yu());var n={za:null,u:null,mimeType:null,startTime:null,ud:null,uri:null};n.u=t,Zt()||(e=!1);var r=e?this.hb:this.R,i=Es(this.lb,function(){return{node:r,payload:n,Va:!1}});return i.vb=function(){},bu(i)},Os.prototype.attach=Os.prototype.Fb,Os.prototype.detach=function(){var t=this;if(this.h==wu)return Promise.reject(yu());var e=Es(this.lb,function(){return{node:t.D,payload:{za:null,u:null,mimeType:null,startTime:null,ud:null,uri:null},Va:!1}});return e.vb=function(){},bu(e)},Os.prototype.detach=Os.prototype.detach,Os.prototype.xd=function(t){var e=this;if(t=void 0===t||t,this.h==wu)return Promise.reject(yu());Zt()||(t=!1);var n={za:null,u:null,mimeType:null,startTime:null,ud:null,uri:null},r=Es(this.lb,function(r){var i=r.u&&t?e.hb:r.u?e.R:e.D;return n.u=r.u,{node:i,payload:n,Va:!1}});return r.vb=function(){},bu(r)},Os.prototype.unload=Os.prototype.xd,Os.prototype.load=function(t,e,n){if(this.h==wu)return Promise.reject(yu());this.dispatchEvent(new St("loading"));var r={za:null,u:null,mimeType:null,startTime:null,ud:null,uri:null};r.uri=t,r.ud=Date.now()/1e3,n&&"string"!=typeof n&&(Qn("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),r.za=function(){return new n}),n&&"string"==typeof n&&(r.mimeType=n),void 0!==e&&(r.startTime=e);var i=function(t,e){if(e.za)return!1;if(!Zt())return!0;var n=e.mimeType,r=e.uri||"";return n||(n={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",ts:"video/mp2t",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac"}[Ti.getExtension(r)]),!!n&&!!te(n)&&(!Ti.isSupported(r,n)||!!navigator.vendor&&navigator.vendor.includes("Apple")&&t.c.streaming.useNativeHlsOnSafari)}(this,r)?this.jb:this.T,a=Es(this.lb,function(t){return null==t.u?null:(r.u=t.u,{node:i,payload:r,Va:!0})});return a.vb=function(){},new Promise(function(t,e){a.nc=function(){return e(new pt(2,7,7002))},a.lc=function(){return t()},a.Ya=function(){return e(yu())},a.onError=function(t){return e(t)}})},Os.prototype.load=Os.prototype.load,Os.prototype.configure=function(t,e){2==arguments.length&&"string"==typeof t&&(t=Ms(t,e));var n=Cs(this.c,t,Xs(this));return zs(this),n},Os.prototype.configure=Os.prototype.configure,Os.prototype.getConfiguration=function(){var t=Xs(this);return Cs(t,this.c,Xs(this)),t},Os.prototype.getConfiguration=Os.prototype.getConfiguration,Os.prototype.Lf=function(){for(var t in this.c)delete this.c[t];Cs(this.c,Xs(this),Xs(this)),zs(this)},Os.prototype.resetConfiguration=Os.prototype.Lf,Os.prototype.Le=function(){return this.h},Os.prototype.getLoadMode=Os.prototype.Le,Os.prototype.Qe=function(){return this.a},Os.prototype.getMediaElement=Os.prototype.Qe,Os.prototype.Jb=function(){return this.L},Os.prototype.getNetworkingEngine=Os.prototype.Jb,Os.prototype.ec=function(){return this.Eb},Os.prototype.getAssetUri=Os.prototype.ec,Os.prototype.Oe=function(){return Qn("getManifestUri",'Please use "getAssetUri" instead.'),this.ec()},Os.prototype.getManifestUri=Os.prototype.Oe,Os.prototype.V=function(){return this.b?this.b.presentationTimeline.V():!(!this.a||!this.a.src)&&1/0==this.a.duration},Os.prototype.isLive=Os.prototype.V,Os.prototype.Xa=function(){return!!this.b&&this.b.presentationTimeline.Xa()},Os.prototype.isInProgress=Os.prototype.Xa,Os.prototype.df=function(){if(this.b){if(!this.b.periods.length)return!1;var t=this.b.periods[0].variants;return!!t.length&&!t[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},Os.prototype.isAudioOnly=Os.prototype.df,Os.prototype.Nf=function(){if(this.b){var t=this.b.presentationTimeline;return{start:t.ob(),end:t.Ba()}}return this.a&&this.a.src&&(t=this.a.seekable).length?{start:t.start(0),end:t.end(t.length-1)}:{start:0,end:0}},Os.prototype.seekRange=Os.prototype.Nf,Os.prototype.keySystem=function(){return ge(this.drmInfo())},Os.prototype.keySystem=Os.prototype.keySystem,Os.prototype.drmInfo=function(){return this.i?this.i.a:null},Os.prototype.drmInfo=Os.prototype.drmInfo,Os.prototype.Ib=function(){return this.i?this.i.Ib():1/0},Os.prototype.getExpiration=Os.prototype.Ib,Os.prototype.Tc=function(){return!!this.B&&this.B.a==Na},Os.prototype.isBuffering=Os.prototype.Tc,Os.prototype.Te=function(){if(this.W){var t=this.W;t=t.f?0:t.c}else t=0;return t},Os.prototype.getPlaybackRate=Os.prototype.Te,Os.prototype.eg=function(t){0==t?Y("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.W.set(t),this.h==Eu&&fo(this.f,1<Math.abs(t)))},Os.prototype.trickPlay=Os.prototype.eg,Os.prototype.we=function(){this.h==Su&&this.W.set(1),this.h==Eu&&(this.W.set(1),fo(this.f,!1))},Os.prototype.cancelTrickPlay=Os.prototype.we,Os.prototype.Sc=function(){if(this.b&&this.s){for(var t=vu(this),e=[],n=h(function(t){return null==(t=mu(t))?[]:t.variants.filter(function(t){return zn(t)})}(this)),r=n.next();!r.done;r=n.next()){var i=Bn(r=r.value);i.active=r==t,e.push(i)}return e}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(t){var e=Hn(t);return e.active=t.enabled,e.type="variant",e.originalAudioId=t.id,"main"==t.kind?(e.primary=!0,e.roles=["main"],e.audioRoles=["main"]):e.audioRoles=[],e}):[]},Os.prototype.getVariantTracks=Os.prototype.Sc,Os.prototype.qb=function(){if(this.b&&this.s){for(var t=function(t){var e=mu(t);if(null==e)return null;if(!ba(t.$,e).text){var n=Gn(e.textStreams,t.na,t.fb);n.length&&ga(t.$,e,n[0])}return ba(t.$,e).text}(this),e=[],n=h(function(t){var e=mu(t);return null==e?[]:e.textStreams.filter(function(e){return!t.Zb.has(e)})}(this)),r=n.next();!r.done;r=n.next()){var i=Fn(r=r.value);i.active=r==t,e.push(i)}return e}return this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).map(function(t){var e=Hn(t);return e.active="disabled"!=t.mode,e.type="text",e.originalTextId=t.id,"captions"==t.kind&&(e.mimeType="application/cea-608"),e}):[]},Os.prototype.getTextTracks=Os.prototype.qb,Os.prototype.od=function(t){if(this.b&&this.f){var e=mu(this),n=e.textStreams.find(function(e){return e.id==t.id});n&&(Gs(this,e,n,!1),$s(this,n),this.na=n.language)}else if(this.a&&this.a.src&&this.a.textTracks){for(n=(e=h(e=Array.from(this.a.textTracks))).next();!n.done;n=e.next())Kn(n=n.value)==t.id?n.mode=this.gb?"showing":"hidden":n.mode="disabled";iu(this)}},Os.prototype.selectTextTrack=Os.prototype.od,Os.prototype.Pf=function(){Qn("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var t=this.qb().filter(function(t){return"application/cea-608"==t.mimeType});0<t.length&&this.od(t[0])},Os.prototype.selectEmbeddedTextTrack=Os.prototype.Pf,Os.prototype.jg=function(){Qn("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var t=this.qb().filter(function(t){return t.active})[0];return!!t&&"application/cea-608"==t.mimeType},Os.prototype.usingEmbeddedTextTrack=Os.prototype.jg,Os.prototype.Rf=function(t,e,n){if(n=void 0===n?0:n,this.b&&this.f){var r=mu(this);this.c.abr.enabled&&Y("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var i=r.variants.find(function(e){return e.id==t.id});i&&zn(i)&&(qs(this,r,i,!1),Ws(this,i,e,n),this.Xb=new ka(i),Zs(this,r.variants))}else if(this.a&&this.a.audioTracks){for(n=(e=h(e=Array.from(this.a.audioTracks))).next();!n.done;n=e.next())Kn(n=n.value)==t.id&&(n.enabled=!0);ru(this)}},Os.prototype.selectVariantTrack=Os.prototype.Rf,Os.prototype.Ge=function(){return pu(this.Sc())},Os.prototype.getAudioLanguagesAndRoles=Os.prototype.Ge,Os.prototype.$e=function(){return pu(this.qb())},Os.prototype.getTextLanguagesAndRoles=Os.prototype.$e,Os.prototype.Fe=function(){return Array.from(du(this.Sc()))},Os.prototype.getAudioLanguages=Os.prototype.Fe,Os.prototype.Ze=function(){return Array.from(du(this.qb()))},Os.prototype.getTextLanguages=Os.prototype.Ze,Os.prototype.Of=function(t,e){if(this.b&&this.s){var n=mu(this);this.Xb=new Aa(t,e||"",0),tu(this,n)}else if(this.a&&this.a.audioTracks){for(var r=(n=h(n=Array.from(this.a.audioTracks))).next();!r.done;r=n.next())(r=r.value).language==t&&(r.enabled=!0);ru(this)}},Os.prototype.selectAudioLanguage=Os.prototype.Of,Os.prototype.Qf=function(t,e){if(this.b&&this.s){var n=mu(this);this.na=t,this.fb=e||"";var r=Gn(n.textStreams,this.na,this.fb)[0]||null;r&&(Gs(this,n,r,!1),(this.c.streaming.alwaysStreamText||this.ic())&&$s(this,r))}else(n=this.qb().filter(function(e){return e.language==t})[0])&&this.od(n)},Os.prototype.selectTextLanguage=Os.prototype.Qf,Os.prototype.ic=function(){var t=this.gb;return this.b?this.F.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).some(function(t){return"showing"==t.mode}):t},Os.prototype.isTextTrackVisible=Os.prototype.ic,Os.prototype.Uf=function(t){var e=this;return p(function n(){var r,i,a,o;return L(n,function(n){switch(n.j){case 1:if(e.gb==(r=t))return n.return();if(e.gb=r,e.h!=Eu){if(e.a&&e.a.src&&e.a.textTracks)for(var s=h(Array.from(e.a.textTracks)),u=s.next();!u.done;u=s.next())"disabled"!=(i=u.value).mode&&(i.mode=t?"showing":"hidden");n.A(2);break}if(e.F.g.setTextVisibility(t),e.c.streaming.alwaysStreamText){n.A(2);break}if(!t){(s=e.f).D=!0,(u=s.b.get("text"))&&(Co(u),s.b.delete("text")),n.A(2);break}if(a=mu(e),!(0<(o=Gn(a.textStreams,e.na,e.fb)).length)){n.A(2);break}return S(n,lo(e.f,o[0]),2);case 2:au(e),x(n)}})})},Os.prototype.setTextTrackVisibility=Os.prototype.Uf,Os.prototype.Ve=function(){if(!this.V())return null;if(this.b)return new Date(1e3*(this.b.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate){var t=this.a.getStartDate();return isNaN(t.getTime())?null:new Date(t.getTime()+1e3*this.a.currentTime)}return null},Os.prototype.getPlayheadTimeAsDate=Os.prototype.Ve,Os.prototype.Xe=function(){if(!this.V())return null;if(this.b)return new Date(1e3*this.b.presentationTimeline.f);if(this.a&&this.a.getStartDate){var t=this.a.getStartDate();return isNaN(t.getTime())?null:t}return null},Os.prototype.getPresentationStartTimeAsDate=Os.prototype.Xe,Os.prototype.Oc=function(){var t={total:[],audio:[],video:[],text:[]};return this.h==Su&&(t.total=je(this.a.buffered)),this.h==Eu&&this.F.Oc(t),t},Os.prototype.getBufferedInfo=Os.prototype.Oc,Os.prototype.getStats=function(){if(this.h!=Eu&&this.h!=Su)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,switchHistory:[],stateHistory:[]};Qs(this);var t=this.a;if(t.getVideoPlaybackQuality){t=t.getVideoPlaybackQuality();var e=this.v,n=Number(t.totalVideoFrames);e.i=Number(t.droppedVideoFrames),e.h=n}this.h==Eu&&((t=vu(this))&&(this.v.l=t.bandwidth),t&&t.video&&(e=this.v,n=t.video.height||NaN,e.m=t.video.width||NaN,e.g=n),t=this.l.getBandwidthEstimate(),this.v.f=t);var r=this.v;t=r.m,e=r.g,n=r.l;for(var i=r.h,a=r.i,o=r.f,s=r.b,u=_s(r.a,"playing"),c=_s(r.a,"paused"),l=_s(r.a,"buffering"),f=function(t){function e(t){return{timestamp:t.timestamp,state:t.state,duration:t.duration}}for(var n=[],r=h(t.b),i=r.next();!i.done;i=r.next())n.push(e(i.value));return t.a&&n.push(e(t.a)),n}(r.a),d=[],p=(r=h(r.c.a)).next();!p.done;p=r.next())p=p.value,d.push({timestamp:p.timestamp,id:p.id,type:p.type,fromAdaptation:p.fromAdaptation,bandwidth:p.bandwidth});return{width:t,height:e,streamBandwidth:n,decodedFrames:i,droppedFrames:a,estimatedBandwidth:o,loadLatency:s,playTime:u,pauseTime:c,bufferingTime:l,stateHistory:f,switchHistory:d}},Os.prototype.getStats=Os.prototype.getStats,Os.prototype.addTextTrack=function(t,e,n,r,i,a){var o=this;return p(function s(){var u,c,l,f,h,d,p,m,v;return L(s,function(s){switch(s.j){case 1:if(o.h==Su)throw Error("State error!");if(o.h!=Eu)throw Error("State error!");if(u=mu(o),c=Ve,l=o.b.periods.indexOf(u),h=(f=l+1)>=o.b.periods.length?o.b.presentationTimeline.Y():o.b.periods[f].startTime,1/0==(d=h-u.startTime))throw new pt(1,4,4033);return p=new ri(1,0,d,function(){return[t]},0,null),m={id:o.Kd++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(t){return 1==t?p:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:r,codecs:i||"",kind:n,encrypted:!1,keyId:null,language:e,label:a||null,type:c.qa,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},o.Zb.add(m),u.textStreams.push(m),S(s,lo(o.f,m),2);case 2:return(v=co(o.f,"text"))&&ga(o.$,u,v),o.Zb.delete(m),tu(o,u),nu(o),s.return(Fn(m))}})})},Os.prototype.addTextTrack=Os.prototype.addTextTrack,Os.prototype.qd=function(t,e){this.$b.width=t,this.$b.height=e},Os.prototype.setMaxHardwareResolution=Os.prototype.qd,Os.prototype.nd=function(){if(this.h==Eu){var t=this.f;if(t.f)t=!1;else if(t.m)t=!1;else{for(var e=h(t.b.values()),n=e.next();!n.done;n=e.next())(n=n.value).Mb&&(n.Mb=!1,Po(t,n,.1));t=!0}}else t=!1;return t},Os.prototype.retryStreaming=Os.prototype.nd,Os.prototype.Me=function(){return this.b},Os.prototype.getManifest=Os.prototype.Me,Os.prototype.Ne=function(){return this.m?this.m.constructor:null},Os.prototype.getManifestParserFactory=Os.prototype.Ne,(n=Os.prototype).Jc=function(t){var e=this.f?so(this.f):null,n=this.f?uo(this.f):null;if(On(this.i,e,n,t),!(e=t.variants).some(zn))throw new pt(2,4,4011);if(fu(this,t.variants),Un(e,this.c.restrictions,this.$b)&&this.f&&mu(this)==t&&nu(this),t=this.i?this.i.a:null)for(n=(e=h(e)).next();!n.done;n=e.next())for(var r=(n=h(n.value.drmInfos)).next();!r.done;r=n.next())if((r=r.value).keySystem==t.keySystem)for(var i=(r=h(r.initData||[])).next();!i.done;i=r.next())i=i.value,ye(this.i,i.initDataType,i.initData)},n.gf=function(t){try{this.kb=!0,this.l.disable(),ou(this);var e=Zs(this,t.variants),n=Gn(t.textStreams,this.na,this.fb)[0]||null;this.Ga&&(t.variants.includes(this.Ga)&&(e=this.Ga),this.Ga=null),this.oa&&(t.textStreams.includes(this.oa)&&(n=this.oa),this.oa=null),e&&qs(this,t,e,!0),n&&Gs(this,t,n,!0);var r=this.f,i=r.b.get("video");if(i)var a=r.c.periods[i.ia];else{var o=r.b.get("audio");a=o?r.c.periods[o.ia]:null}var s=e?e.audio:null;if(!a&&n){var u;if(u=s){t=n;var c=Cn(this.c.preferredTextLanguage),l=Cn(s.language),f=Cn(t.language);u=Nn(f,c)&&!Nn(l,f)}u&&(this.gb=!0),this.gb&&this.F.g.setTextVisibility(!0),au(this)}return this.c.streaming.alwaysStreamText||this.ic()?{variant:e,text:n}:{variant:e,text:null}}catch(h){return this.Ma(h),{variant:null,text:null}}},n.ve=function(){this.kb=!1,this.c.abr.enabled&&(this.l.enable(),ou(this)),this.Ga&&(ho(this.f,this.Ga,this.Hd,this.Fd),ru(this),this.Ga=null),this.oa&&(po(this.f,this.oa,!0,0,!1),iu(this),this.oa=null)},n.mf=function(){this.m&&this.m.update&&this.m.update()},n.tf=function(){this.s&&this.s.s()},n.Ma=function(t){if(this.h!=wu){var e=new St("error",{detail:t});this.dispatchEvent(e),e.defaultPrevented&&(t.handled=!0)}};var wu=0,Tu=1,Eu=2,Su=3;function xu(t,e){var n=ps(new ds(t.ua(),t.aa()),e.periods[0],new Ei(null,0)),r=e.appMetadata||{};return n=ku(n),{offlineUri:t.toString(),originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:e.expiration,tracks:n,appMetadata:r}}function ku(t){for(var e=[],n=function(t){return t.filter(function(t){return zn(t)})}(t.variants),r=(n=h(n)).next();!r.done;r=n.next())e.push(Bn(r.value));for(n=(t=h(t.textStreams)).next();!n.done;n=t.next())e.push(Fn(n.value));return e}function Au(){this.a={}}function Iu(t,e){var n=t.a[e];return null==n&&(n=0),n}function Mu(t){this.a=!1,this.b=new mt,this.c=t}function Nu(t){var e=new Cu;t.periods.forEach(function(t,n){var r=Du(t.variants);if(0==n)for(var i=(r=h(r.a)).next();!i.done;i=r.next())e.add(i.value);else!function(t,e){t.a=t.a.filter(function(t){return Ru(e,t)})}(e,r)});for(var n=(t=h(t.periods)).next();!n.done;n=t.next())(n=n.value).variants=n.variants.filter(function(t){return Ru(e,new Pu(t))})}function Pu(t){var e=t.audio;t=t.video,this.b=e?e.mimeType:null,this.a=e?e.codecs.split(".")[0]:null,this.f=t?t.mimeType:null,this.c=t?t.codecs.split(".")[0]:null}function Cu(){this.a=[]}function Ru(t,e){return t.a.some(function(t){return e.b==t.b&&e.a==t.a&&e.f==t.f&&e.c==t.c})}function Du(t){for(var e=new Cu,n=(t=h(t)).next();!n.done;n=t.next())e.add(new Pu(n.value));return e}function _u(t){var e=this;if(t&&t.constructor!=Os)throw new pt(2,9,9008);this.b=this.a=null,t?(this.a=t.c,this.b=t.Jb()):(this.a=Ps(),this.b=new Rt),this.f=!1,this.c=[],this.g=[];var n=!t;this.h=new Mu(function(){return p(function t(){var r;return L(t,function(t){switch(t.j){case 1:return r=function(){},S(t,Promise.all(e.g.map(function(t){return t.then(r,r)})),2);case 2:if(!n){t.A(3);break}return S(t,e.b.destroy(),3);case 3:e.a=null,e.b=null,x(t)}})})})}function Lu(){if(Zt())t:{for(var t=h(Wo.values()),e=t.next();!e.done;e=t.next())if(e=(e=e.value)()){e.destroy(),t=!0;break t}t=!1}else t=!1;return t}function Uu(t,e){for(var n=[],r=h(t.periods),i=r.next();!i.done;i=r.next())for(var a=(i=h(i.value.streams)).next();!a.done;a=i.next())a=a.value,e&&"video"==a.contentType?n.push({contentType:$t(a.mimeType,a.codecs),robustness:t.drmInfo.videoRobustness}):e||"audio"!=a.contentType||n.push({contentType:$t(a.mimeType,a.codecs),robustness:t.drmInfo.audioRobustness});return n}function Ou(t,e,n){return p(function r(){return L(r,function(r){switch(r.j){case 1:return S(r,function(t,e,n,r){return p(function i(){var a,o,s;return L(i,function(i){switch(i.j){case 1:return r.drmInfo?(a=function(t){var e=Array.from(t.a.keys());if(!e.length)throw new pt(2,9,9e3,"No supported storage mechanisms found");return t.a.get(e[0]).getEmeSessionCell()}(n),o=r.sessionIds.map(function(t){return{sessionId:t,keySystem:r.drmInfo.keySystem,licenseUri:r.drmInfo.licenseServerUri,serverCertificate:r.drmInfo.serverCertificate,audioCapabilities:Uu(r,!1),videoCapabilities:Uu(r,!0)}}),S(i,bs(e,t,o),2)):i.return();case 2:return s=i.o,S(i,a.remove(s),3);case 3:return S(i,a.add(o.filter(function(t){return-1==s.indexOf(t.sessionId)})),0)}})})}(t.b,t.a.drm,n,e),0)}})})}function ju(t,e,n,r){function i(){s+=1,t.a.offline.progressCallback(u,s/o)}var a=function(t){var e=[];return t.periods.forEach(function(t){t.streams.forEach(function(t){null!=t.initSegmentKey&&e.push(t.initSegmentKey),t.segments.forEach(function(t){e.push(t.dataKey)})})}),e}(r),o=a.length+1,s=0,u=xu(n,r);return Promise.all([e.removeSegments(a,i),e.removeManifests([n.key()],i)])}function Bu(t,e,n,r,i,a){var o={id:a.id,originalId:a.originalId,primary:a.primary,presentationTimeOffset:a.presentationTimeOffset||0,contentType:a.type,mimeType:a.mimeType,codecs:a.codecs,frameRate:a.frameRate,kind:a.kind,language:a.language,label:a.label,width:a.width||null,height:a.height||null,initSegmentKey:null,encrypted:a.encrypted,keyId:a.keyId,segments:[],variantIds:[]};i=i.presentationTimeline.Lb();var s=a.id,u=a.initSegmentReference;return u&&(u=Si(u.c(),u.b,u.a,t.a.streaming.retryParameters),jo(e,s,u,.5*Iu(r,a.id),!0,function(e){return p(function r(){var i;return L(r,function(r){switch(r.j){case 1:return S(r,n.addSegments([{data:e}]),2);case 2:i=r.o,t.c.push(i[0]),o.initSegmentKey=i[0],x(r)}})})})),function(t,e,n){for(var r=null==(e=t.findSegmentPosition(e))?null:t.getSegmentReference(e);r;)n(r),r=t.getSegmentReference(++e)}(a,i,function(i){var u=Si(i.c(),i.b,i.a,t.a.streaming.retryParameters);jo(e,s,u,function(t,e,n){return n=n.endTime-n.startTime,Iu(t,e)*n}(r,a.id,i),!1,function(e){return p(function r(){var a;return L(r,function(r){switch(r.j){case 1:return S(r,n.addSegments([{data:e}]),2);case 2:a=r.o,t.c.push(a[0]),o.segments.push({startTime:i.startTime,endTime:i.endTime,dataKey:a[0]}),x(r)}})})})}),o}function Fu(t){if(t.h.a)throw new pt(2,9,7001)}function Ku(){if(!Lu())throw new pt(2,9,9e3)}function Vu(t,e){return p(function n(){return L(n,function(n){switch(n.j){case 1:return t.g.push(e),A(n,2),S(n,e,4);case 4:return n.return(n.o);case 2:N(n),Mt(t.g,e),P(n,0)}})})}function Hu(t){for(var e=new Set,n=(t=h(t.periods)).next();!n.done;n=t.next()){for(var r=h((n=n.value).textStreams),i=r.next();!i.done;i=r.next())e.add(i.value);for(r=(n=h(n.variants)).next();!r.done;r=n.next())(r=r.value).audio&&e.add(r.audio),r.video&&e.add(r.video)}return e}function zu(t){t.variants.map(function(t){return t.video});var e=new Set(t.variants.map(function(t){return t.audio}));t=t.textStreams;for(var n=h(e),r=n.next();!r.done;r=n.next())for(var i=(r=h(e)).next();!i.done;i=r.next());for(n=(e=h(t)).next();!n.done;n=e.next())for(r=(n=h(t)).next();!r.done;r=n.next());}Os.LoadMode={DESTROYED:wu,NOT_LOADED:Tu,MEDIA_SOURCE:Eu,SRC_EQUALS:Su},Mu.prototype.destroy=function(){var t=this;return this.a?this.b:(this.a=!0,this.c().then(function(){t.b.resolve()},function(){t.b.resolve()}))},Cu.prototype.add=function(t){Ru(this,t)||this.a.push(t)},K("shaka.offline.Storage",_u),_u.support=Lu,_u.prototype.destroy=function(){return this.h.destroy()},_u.prototype.destroy=_u.prototype.destroy,_u.prototype.configure=function(t,e){2==arguments.length&&"string"==typeof t&&(t=Ms(t,e));var n=t,r=!1;return null!=n.trackSelectionCallback&&(r=!0,n.offline=n.offline||{},n.offline.trackSelectionCallback=n.trackSelectionCallback,delete n.trackSelectionCallback),null!=n.progressCallback&&(r=!0,n.offline=n.offline||{},n.offline.progressCallback=n.progressCallback,delete n.progressCallback),null!=n.usePersistentLicense&&(r=!0,n.offline=n.offline||{},n.offline.usePersistentLicense=n.usePersistentLicense,delete n.usePersistentLicense),r&&Qn("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),Cs(this.a,t)},_u.prototype.configure=_u.prototype.configure,_u.prototype.getConfiguration=function(){var t=Ps();return Cs(t,this.a,Ps()),t},_u.prototype.getConfiguration=_u.prototype.getConfiguration,_u.prototype.Jb=function(){return this.b},_u.prototype.getNetworkingEngine=_u.prototype.Jb,_u.prototype.store=function(t,e,n){var r=this;return Vu(this,function(t,e,n,r){return p(function i(){var a,o,s,u,c,l,f,d,m;return L(i,function(i){switch(i.j){case 1:return Ku(),t.f?i.return(Promise.reject(new pt(2,9,9006))):(t.f=!0,S(i,function(t,e,n){return p(function r(){var i,a,o,s,u,c;return L(r,function(r){switch(r.j){case 1:return i=null,a=t.b,o={networkingEngine:a,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(t){i=t}},S(r,n(),2);case 2:return(s=r.o).configure(t.a.manifest),Fu(t),A(r,3),S(r,s.start(e,o),5);case 5:return u=r.o,Fu(t),c=Hu(u),S(r,Promise.all(Array.from(c).map(function(t){return t.createSegmentIndex()})),6);case 6:if(Fu(t),i)throw i;return r.return(u);case 3:return N(r),S(r,s.stop(),7);case 7:P(r,0)}})})}(t,e,r),2));case 2:if(a=i.o,Fu(t),!(!a.presentationTimeline.V()&&!a.presentationTimeline.Xa()))throw new pt(2,9,9005,e);return o=null,s=new Go,c=u=null,k(i,3,4),S(i,function(t,e,n){return p(function r(){var i,a,o;return L(r,function(r){switch(r.j){case 1:return i=new he({tb:t.b,onError:n,mc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),a=ja(e.periods),o=t.a,i.configure(o.drm),S(r,function(t,e,n){return t.s=[],t.D=n,pe(t,e)}(i,a,o.offline.usePersistentLicense),2);case 2:return S(r,me(i),3);case 3:return S(r,ve(i),4);case 4:return r.return(i)}})})}(t,a,function(t){c=c||t}),6);case 6:if(o=i.o,Fu(t),c)throw c;return function(t,e,n){(function(t,e){for(var n={width:1/0,height:1/0},r=h(t.periods),i=r.next();!i.done;i=r.next())(i=i.value).variants=i.variants.filter(function(t){return Ln(t,e,n)})})(e,t.a.restrictions),function(t){for(var e=(t=h(t.periods)).next();!e.done;e=t.next())(e=e.value).variants=e.variants.filter(function(t){var e=!0;return t.audio&&(e=e&&gn(t.audio)),t.video&&(e=e&&gn(t.video)),e})}(e),function(t,e){for(var n=h(t.periods),r=n.next();!r.done;r=n.next())(r=r.value).variants=r.variants.filter(function(t){return Ie(e,t)})}(e,n),Nu(e),function(t,e){var n=new Cu;t.periods.forEach(function(t,r){0<r&&(t.variants=t.variants.filter(function(t){return Ru(n,new Pu(t))})),e(t),n=Du(t.variants)})}(e,function(e){for(var n=[],r=h(e.variants),i=r.next();!i.done;i=r.next())n.push(Bn(i.value));for(r=h(e.textStreams),i=r.next();!i.done;i=r.next())n.push(Fn(i.value));n=t.a.offline.trackSelectionCallback(n);var a=new Set,o=new Set;for(n=h(n),r=n.next();!r.done;r=n.next())"variant"==(r=r.value).type&&a.add(r.id),"text"==r.type&&o.add(r.id);e.variants=e.variants.filter(function(t){return a.has(t.id)}),e.textStreams=e.textStreams.filter(function(t){return o.has(t.id)})}),function(t){if(0==t.periods.length)throw new pt(2,4,4014);for(var e=(t=h(t.periods)).next();!e.done;e=t.next())zu(e.value)}(e)}(t,a,o),S(i,s.init(),7);case 7:return Fu(t),S(i,function(t){var e=null;if(t.a.forEach(function(t,n){t.getCells().forEach(function(t,r){t.hasFixedKeySpace()||e||(e={path:{ua:n,aa:r},aa:t})})}),e)return e;throw new pt(2,9,9013,"Could not find a cell that supports add-operations")}(s),8);case 8:return u=i.o,Fu(t),S(i,function(t,e,n,r,i,a){return p(function o(){var s,u,c,l,f,d,m,v;return L(o,function(o){switch(o.j){case 1:return s=function(t,e,n){var r=null==e.expiration?1/0:e.expiration;return{offlineUri:null,originalManifestUri:t,duration:e.presentationTimeline.Y(),size:0,expiration:r,tracks:e=ku(e.periods[0]),appMetadata:n}}(i,r,a),u=r.periods.some(function(t){return t.variants.some(function(t){return t.drmInfos&&t.drmInfos.length})}),c=r.periods.some(function(t){return t.variants.some(function(t){return t.drmInfos.some(function(t){return t.initData&&t.initData.length})})}),l=u&&!c,f=new Oo(t.b,function(e,n){s.size=n,t.a.offline.progressCallback(s,e)},function(e){l&&t.a.offline.usePersistentLicense&&ye(n,"cenc",e)}),A(o,2),m=d=function(t,e,n,r,i,a,o){var s=new Au,u=i.periods.map(function(r){return function(t,e,n,r,i,a){i.periods.forEach(function(t){t.variants.forEach(function(t){var e=t.audio,n=t.video;if(e&&!n&&(r.a[e.id]=e.bandwidth||t.bandwidth),!e&&n&&(r.a[n.id]=n.bandwidth||t.bandwidth),e&&n){var i=e.bandwidth||393216,a=n.bandwidth||t.bandwidth-i;0>=a&&(a=t.bandwidth),r.a[e.id]=i,r.a[n.id]=a}}),t.textStreams.forEach(function(t){r.a[t.id]=52})});for(var o=Hu(i),s=new Map,u=(o=h(o)).next();!u.done;u=o.next()){u=u.value;var c=Bu(t,e,n,r,i,u);s.set(u.id,c)}return a.variants.forEach(function(t){t.audio&&s.get(t.audio.id).variantIds.push(t.id),t.video&&s.get(t.video.id).variantIds.push(t.id)}),{startTime:a.startTime,streams:Array.from(s.values())}}(t,e,n,s,i,r)}),c=r.a,l=t.a.offline.usePersistentLicense;return c&&l&&(c.initData=[]),{originalManifestUri:a,duration:i.presentationTimeline.Y(),size:0,expiration:r.Ib(),periods:u,sessionIds:l?we(r):[],drmInfo:c,appMetadata:o}}(t,f,e,n,r,i,a),S(o,function(t){return p(function e(){return L(e,function(e){switch(e.j){case 1:return S(e,Promise.all(t.b.values()),2);case 2:return e.return(t.a.a)}})})}(f),4);case 4:if(m.size=o.o,d.expiration=n.Ib(),v=we(n),d.sessionIds=t.a.offline.usePersistentLicense?v:[],u&&t.a.offline.usePersistentLicense&&!v.length)throw new pt(2,9,9007);return o.return(d);case 2:return N(o),S(o,f.destroy(),5);case 5:P(o,0)}})})}(t,u.aa,o,a,e,n),9);case 9:if(l=i.o,Fu(t),c)throw c;return S(i,u.aa.addManifests([l]),10);case 10:return f=i.o,Fu(t),d=new fs("manifest",u.path.ua,u.path.aa,f[0]),i.return(xu(d,l));case 4:return N(i),t.f=!1,t.c=[],S(i,s.destroy(),11);case 11:if(!o){i.A(12);break}return S(i,o.destroy(),12);case 12:P(i,0);break;case 3:if(m=M(i),!u){i.A(14);break}return S(i,u.aa.removeSegments(t.c,function(){}),14);case 14:throw c||m}})})}(this,t,e||{},function(){return p(function e(){var i,a;return L(e,function(e){switch(e.j){case 1:return n&&"string"!=typeof n?(Qn("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),i=n,e.return(new i)):S(e,Ti.create(t,r.b,r.a.manifest.retryParameters,n),2);case 2:return a=e.o,e.return(a)}})})}))},_u.prototype.store=_u.prototype.store,_u.prototype.Ye=function(){return this.f},_u.prototype.getStoreInProgress=_u.prototype.Ye,_u.prototype.remove=function(t){return Vu(this,function(t,e){return p(function n(){var r,i,a,o,s,u;return L(n,function(n){switch(n.j){case 1:return Ku(),null==(r=hs(e))||"manifest"!=r.a?n.return(Promise.reject(new pt(2,9,9004,e))):(i=r,a=new Go,A(n,2),S(n,a.init(),4));case 4:return S(n,Xo(a,i.ua(),i.aa()),5);case 5:return o=n.o,S(n,o.getManifests([i.key()]),6);case 6:return s=n.o,u=s[0],S(n,Promise.all([Ou(t,u,a),ju(t,o,i,u)]),2);case 2:return N(n),S(n,a.destroy(),8);case 8:P(n,0)}})})}(this,t))},_u.prototype.remove=_u.prototype.remove,_u.prototype.If=function(){return Vu(this,(t=this,p(function e(){var n,r,i,a,o,s,u,c,l;return L(e,function(e){switch(e.j){case 1:return Ku(),n=t.b,r=t.a.drm,i=new Go,a=!1,A(e,2),S(e,i.init(),4);case 4:for(o=[],function(t,e){t.a.forEach(function(t){e(t.getEmeSessionCell())})}(i,function(t){return o.push(t)}),s=Promise.resolve(),u={},c=h(o),l=c.next();!l.done;u={sc:u.sc},l=c.next())u.sc=l.value,s=s.then(function(t){return function(){return p(function e(){var i,o;return L(e,function(e){switch(e.j){case 1:return S(e,t.sc.getAll(),2);case 2:return i=e.o,S(e,bs(r,n,i),3);case 3:return o=e.o,S(e,t.sc.remove(o),4);case 4:o.length!=i.length&&(a=!0),x(e)}})})}}(u));return S(e,s,2);case 2:return N(e),S(e,i.destroy(),6);case 6:P(e,3);break;case 3:return e.return(!a)}})})));var t},_u.prototype.removeEmeSessions=_u.prototype.If,_u.prototype.list=function(){return Vu(this,p(function t(){var e,n,r;return L(t,function(t){switch(t.j){case 1:return Ku(),e=[],n=new Go,A(t,2),S(t,n.init(),4);case 4:return r=Promise.resolve(),function(t,e){t.a.forEach(function(t,n){t.getCells().forEach(function(t,r){e({ua:n,aa:r},t)})})}(n,function(t,n){r=r.then(function(){return p(function r(){return L(r,function(r){switch(r.j){case 1:return S(r,n.getAllManifests(),2);case 2:r.o.forEach(function(n,r){var i=xu(new fs("manifest",t.ua,t.aa,r),n);e.push(i)}),x(r)}})})})}),S(t,r,2);case 2:return N(t),S(t,n.destroy(),6);case 6:P(t,3);break;case 3:return t.return(e)}})}))},_u.prototype.list=_u.prototype.list,_u.deleteAll=function(){return p(function t(){var e;return L(t,function(t){switch(t.j){case 1:return e=new Go,A(t,2),S(t,e.erase(),2);case 2:return N(t),S(t,e.destroy(),5);case 5:P(t,0)}})})},Fs.offline=Lu,K("shaka.polyfill.installAll",function(){for(var t=0;t<Xu.length;++t)Xu[t].te()});var qu,Gu,Xu=[];function Yu(t,e){for(var n={priority:e=e||0,te:t},r=0;r<Xu.length;r++)if(Xu[r].priority<e)return void Xu.splice(r,0,n);Xu.push(n)}function Wu(t){var e=t.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"==typeof Event)var n=new Event(e,t);else(n=document.createEvent("Event")).initEvent(e,t.bubbles,t.cancelable);t.target.dispatchEvent(n)}function $u(t,e,n){if("input"==t)switch(this.type){case"range":t="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,t,e,n)}function Ju(){var t=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(e){for(var n=[],r=0;r<arguments.length;++r)n[r]=arguments[r];return(n=t.apply(this,n)).abort=function(){},n}}function Qu(t,e){try{var n=new Zu(t,e);return Promise.resolve(n)}catch(r){return Promise.reject(r)}}function Zu(t,e){if(this.keySystem=t,t.startsWith("com.apple.fps"))for(var n=h(e),r=n.next();!r.done;r=n.next()){var i=r.value;if("required"==i.persistentState)r=null;else{r={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label};var a=!1,o=!1;if(i.audioCapabilities)for(var s=h(i.audioCapabilities),u=s.next();!u.done;u=s.next())if((u=u.value).contentType){a=!0;var c=u.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,c)&&(r.audioCapabilities.push(u),o=!0)}if(i.videoCapabilities)for(u=(i=h(i.videoCapabilities)).next();!u.done;u=i.next())(s=u.value).contentType&&(a=!0,u=s.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,u)&&(r.videoCapabilities.push(s),o=!0));a||(o=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),r=o?r:null}if(r)return void(this.a=r)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function tc(t){var e=this.mediaKeys;return e&&e!=t&&nc(e,null),delete this.mediaKeys,(this.mediaKeys=t)?nc(t,this):Promise.resolve()}function ec(t){this.b=new WebKitMediaKeys(t),this.a=new Vt}function nc(t,e){if(t.a.$a(),!e)return Promise.resolve();t.a.w(e,"webkitneedkey",ic);try{return 1<=e.readyState?e.webkitSetMediaKeys(t.b):t.a.da(e,"loadedmetadata",function(){e.webkitSetMediaKeys(t.b)}),Promise.resolve()}catch(n){return Promise.reject(n)}}function rc(t){kt.call(this),this.b=null,this.g=t,this.c=this.a=null,this.f=new Vt,this.sessionId="",this.expiration=NaN,this.closed=new mt,this.keyStatuses=new oc}function ic(t){var e=new Event("encrypted");e.initDataType="cenc",e.initData=t.initData,this.dispatchEvent(e)}function ac(t,e){var n=t.keyStatuses;n.size=null==e?0:1,n.a=e,t.dispatchEvent(new St("keystatuseschange"))}function oc(){this.size=0,this.a=void 0}function sc(t,e){try{var n=new uc(t,e);return Promise.resolve(n)}catch(r){return Promise.reject(r)}}function uc(t,e){this.keySystem=t;for(var n=!1,r=0;r<e.length;++r){var i=e[r],a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label},o=!1;if(i.audioCapabilities)for(var s=0;s<i.audioCapabilities.length;++s){var u=i.audioCapabilities[s];if(u.contentType){o=!0;var c=u.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,c)&&(a.audioCapabilities.push(u),n=!0)}}if(i.videoCapabilities)for(s=0;s<i.videoCapabilities.length;++s)(u=i.videoCapabilities[s]).contentType&&(o=!0,c=u.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,c)&&(a.videoCapabilities.push(u),n=!0));if(o||(n=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==i.persistentState&&(n=!1),n)return void(this.a=a)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function cc(t){var e=this.mediaKeys;return e&&e!=t&&fc(e,null),delete this.mediaKeys,(this.mediaKeys=t)?fc(t,this):Promise.resolve()}function lc(t){this.a=new MSMediaKeys(t),this.b=new Vt}function fc(t,e){if(t.b.$a(),!e)return Promise.resolve();t.b.w(e,"msneedkey",dc);var n=t;try{return 1<=e.readyState?e.msSetMediaKeys(t.a):e.addEventListener("loadedmetadata",function t(){e.msSetMediaKeys(n.a),e.removeEventListener("loadedmetadata",t)}),Promise.resolve()}catch(r){return Promise.reject(r)}}function hc(t){kt.call(this),this.c=null,this.g=t,this.b=this.a=null,this.f=new Vt,this.sessionId="",this.expiration=NaN,this.closed=new mt,this.keyStatuses=new mc}function dc(t){if(t.initData){var e=document.createEvent("CustomEvent");e.initCustomEvent("encrypted",!1,!1,null),e.initDataType="cenc",e.initData=function(t){if(!t)return t;var e=new zr(t);if(1>=e.data.length)return t;t=[];for(var n={},r=(e=h(e.data)).next();!r.done;n={hc:n.hc},r=e.next())n.hc=r.value,t.some(function(t){return function(e){return fe.ya(e,t.hc)}}(n))||t.push(n.hc);return fe.concat.apply(fe,U(t))}(t.initData),this.dispatchEvent(e)}}function pc(t,e){var n=t.keyStatuses;n.size=null==e?0:1,n.a=e,t.dispatchEvent(new St("keystatuseschange"))}function mc(){this.size=0,this.a=void 0}function vc(){return Promise.reject(Error("The key system specified is not supported."))}function yc(t){return null==t?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function gc(){throw new TypeError("Illegal constructor.")}function bc(){throw new TypeError("Illegal constructor.")}K("shaka.polyfill.register",Yu),Yu(function(){if(t.Document){var e=Element.prototype;e.requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,(e=Document.prototype).exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitExitFullscreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Wu),document.addEventListener("webkitfullscreenerror",Wu),document.addEventListener("mozfullscreenchange",Wu),document.addEventListener("mozfullscreenerror",Wu),document.addEventListener("MSFullscreenChange",Wu),document.addEventListener("MSFullscreenError",Wu)}}),Yu(function(){ee("CrKey")&&delete t.indexedDB}),Yu(function(){ee("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=$u)}),Yu(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})}),Yu(function(){}),Yu(function(){if(t.MediaSource)if(t.cast&&cast.__platform__&&cast.__platform__.canDisplayType)!function(){var t=MediaSource.isTypeSupported,e=/^dv(?:h[e1]|a[v1])\./;MediaSource.isTypeSupported=function(n){for(var r=n.split(/ *; */),i=r[0],a={},o=1;o<r.length;++o){var s=r[o].split("="),u=s[0];s=s[1].replace(/"(.*)"/,"$1"),a[u]=s}if(!(r=a.codecs))return t(n);var c=!1,l=!1;for(var f in n=r.split(",").filter(function(t){return e.test(t)&&(l=!0),/^(hev|hvc)1\.2/.test(t)&&(c=!0),!0}),l&&(c=!1),a.codecs=n.join(","),c&&(a.eotf="smpte2084"),a)i+="; "+f+'="'+a[f]+'"';return cast.__platform__.canDisplayType(i)}}();else if(navigator.vendor&&navigator.vendor.includes("Apple")){var e=navigator.appVersion.match(/Version\/(\d+)/);e=parseInt(e[1],10),function(){var t=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(e){return"mp2t"!=e.split(/ *; */)[0].split("/")[1].toLowerCase()&&t(e)}}(),10>=e?t.MediaSource=null:12>=e?(Ju(),function(){var t=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(e,n){return t.call(this,e,n-.001)}}()):Ju()}else ee("Tizen")&&function(){var t=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(e){return"opus"!=Jt(e)[0]&&t(e)}}()}),Zu.prototype.createMediaKeys=function(){var t=new ec(this.keySystem);return Promise.resolve(t)},Zu.prototype.getConfiguration=function(){return this.a},ec.prototype.createSession=function(t){if("temporary"!=(t=t||"temporary"))throw new TypeError("Session type "+t+" is unsupported on this platform.");return new rc(this.b,t)},ec.prototype.setServerCertificate=function(t){return t&&new Uint8Array(t),Promise.resolve(!0)},V(rc,kt),(n=rc.prototype).generateRequest=function(t,e){this.a=new mt;try{this.b=this.g.createSession("video/mp4",new Uint8Array(e)),this.sessionId=this.b.sessionId||"",this.f.w(this.b,"webkitkeymessage",this.Zf.bind(this)),this.f.w(this.b,"webkitkeyadded",this.Xf.bind(this)),this.f.w(this.b,"webkitkeyerror",this.Yf.bind(this)),ac(this,"status-pending")}catch(n){this.a.reject(n)}return this.a},n.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},n.update=function(t){this.c=new mt;try{this.b.update(new Uint8Array(t))}catch(e){this.c.reject(e)}return this.c},n.close=function(){try{this.b.close(),this.closed.resolve(),this.f.$a()}catch(s){this.closed.reject(s)}return this.closed},n.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},n.Zf=function(t){this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new St("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:t.message.buffer}))},n.Xf=function(){this.c&&(ac(this,"usable"),this.c.resolve(),this.c=null)},n.Yf=function(){var t=Error("EME PatchedMediaKeysApple key error");if(t.errorCode=this.b.error,null!=this.a)this.a.reject(t),this.a=null;else if(null!=this.c)this.c.reject(t),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:ac(this,"output-not-allowed");break;default:ac(this,"internal-error")}},(n=oc.prototype).forEach=function(t){this.a&&t(this.a,qu)},n.get=function(t){if(this.has(t))return this.a},n.has=function(t){var e=qu;return!(!this.a||!fe.ya(new Uint8Array(t),new Uint8Array(e)))},n.entries=function(){},n.keys=function(){},n.values=function(){},Yu(function(){t.HTMLVideoElement&&t.WebKitMediaKeys&&(qu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=tc,t.MediaKeys=ec,t.MediaKeySystemAccess=Zu,navigator.requestMediaKeySystemAccess=Qu)}),uc.prototype.createMediaKeys=function(){var t=new lc(this.keySystem);return Promise.resolve(t)},uc.prototype.getConfiguration=function(){return this.a},lc.prototype.createSession=function(t){if("temporary"!=(t=t||"temporary"))throw new TypeError("Session type "+t+" is unsupported on this platform.");return new hc(this.a,t)},lc.prototype.setServerCertificate=function(){return Promise.resolve(!1)},V(hc,kt),(n=hc.prototype).generateRequest=function(t,e){this.a=new mt;try{this.c=this.g.createSession("video/mp4",new Uint8Array(e),null),this.f.w(this.c,"mskeymessage",this.rf.bind(this)),this.f.w(this.c,"mskeyadded",this.pf.bind(this)),this.f.w(this.c,"mskeyerror",this.qf.bind(this)),pc(this,"status-pending")}catch(n){this.a.reject(n)}return this.a},n.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},n.update=function(t){this.b=new mt;try{this.c.update(new Uint8Array(t))}catch(e){this.b.reject(e)}return this.b},n.close=function(){try{this.c.close(),this.closed.resolve(),this.f.$a()}catch(s){this.closed.reject(s)}return this.closed},n.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},n.rf=function(t){this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new St("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:t.message.buffer}))},n.pf=function(){this.a?(pc(this,"usable"),this.a.resolve(),this.a=null):this.b&&(pc(this,"usable"),this.b.resolve(),this.b=null)},n.qf=function(){var t=Error("EME PatchedMediaKeysMs key error");if(t.errorCode=this.c.error,null!=this.a)this.a.reject(t),this.a=null;else if(null!=this.b)this.b.reject(t),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:pc(this,"output-not-allowed");break;default:pc(this,"internal-error")}},(n=mc.prototype).forEach=function(t){this.a&&t(this.a,Gu)},n.get=function(t){if(this.has(t))return this.a},n.has=function(t){var e=Gu;return!(!this.a||!fe.ya(new Uint8Array(t),new Uint8Array(e)))},n.entries=function(){},n.keys=function(){},n.values=function(){},Yu(function(){!t.HTMLVideoElement||!t.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(Gu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=cc,t.MediaKeys=lc,t.MediaKeySystemAccess=uc,navigator.requestMediaKeySystemAccess=sc)}),gc.prototype.createSession=function(){},gc.prototype.setServerCertificate=function(){},bc.prototype.getConfiguration=function(){},bc.prototype.createMediaKeys=function(){},Yu(function(){!t.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=vc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=yc,t.MediaKeys=gc,t.MediaKeySystemAccess=bc)},-10);var wc,Tc="";function Ec(t){return Tc?Tc+t.charAt(0).toUpperCase()+t.slice(1):t}function Sc(t,e){try{var n=new kc(t,e);return Promise.resolve(n)}catch(r){return Promise.reject(r)}}function xc(t){var e=this.mediaKeys;return e&&e!=t&&Ic(e,null),delete this.mediaKeys,(this.mediaKeys=t)&&Ic(t,this),Promise.resolve()}function kc(t,e){this.a=this.keySystem=t;var n=!1;"org.w3.clearkey"==t&&(this.a="webkit-org.w3.clearkey",n=!1);var r=!1,i=document.getElementsByTagName("video");i=i.length?i[0]:document.createElement("video");for(var a=0;a<e.length;++a){var o=e[a],s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:o.initDataTypes,sessionTypes:["temporary"],label:o.label},u=!1;if(o.audioCapabilities)for(var c=0;c<o.audioCapabilities.length;++c){var l=o.audioCapabilities[c];if(l.contentType){u=!0;var f=l.contentType.split(";")[0];i.canPlayType(f,this.a)&&(s.audioCapabilities.push(l),r=!0)}}if(o.videoCapabilities)for(c=0;c<o.videoCapabilities.length;++c)(l=o.videoCapabilities[c]).contentType&&(u=!0,i.canPlayType(l.contentType,this.a)&&(s.videoCapabilities.push(l),r=!0));if(u||(r=i.canPlayType("video/mp4",this.a)||i.canPlayType("video/webm",this.a)),"required"==o.persistentState&&(n?(s.persistentState="required",s.sessionTypes=["persistent-license"]):r=!1),r)return void(this.b=s)}throw n="Unsupported keySystem","org.w3.clearkey"!=t&&"com.widevine.alpha"!=t||(n="None of the requested configurations were supported."),(n=Error(n)).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function Ac(t){this.g=t,this.b=null,this.a=new Vt,this.c=[],this.f={}}function Ic(t,e){t.b=e,t.a.$a();var n=Tc;e&&(t.a.w(e,n+"needkey",t.wf.bind(t)),t.a.w(e,n+"keymessage",t.bg.bind(t)),t.a.w(e,n+"keyadded",t.$f.bind(t)),t.a.w(e,n+"keyerror",t.ag.bind(t)))}function Mc(t,e){var n=t.f[e];return n||((n=t.c.shift())?(n.sessionId=e,t.f[e]=n):null)}function Nc(t,e,n){kt.call(this),this.f=t,this.h=!1,this.a=this.b=null,this.c=e,this.g=n,this.sessionId="",this.expiration=NaN,this.closed=new mt,this.keyStatuses=new Rc}function Pc(t,e,n){if(t.h)return Promise.reject(Error("The session is already initialized."));t.h=!0;try{if("persistent-license"==t.g)if(n)var r=new Uint8Array(se("LOAD_SESSION|"+n));else{var a=se("PERSISTENT|"),o=new Uint8Array(a.byteLength+e.byteLength);o.set(new Uint8Array(a),0),o.set(new Uint8Array(e),a.byteLength),r=o}else r=new Uint8Array(e)}catch(i){return Promise.reject(i)}t.b=new mt;var s=Ec("generateKeyRequest");try{t.f[s](t.c,r)}catch(i){if("InvalidStateError"!=i.name)return t.b=null,Promise.reject(i);new ft(function(){try{t.f[s](t.c,r)}catch(e){t.b.reject(e),t.b=null}}).P(.01)}return t.b}function Cc(t,e){var n=t.keyStatuses;n.size=null==e?0:1,n.a=e,t.dispatchEvent(new St("keystatuseschange"))}function Rc(){this.size=0,this.a=void 0}function Dc(t){if("picture-in-picture"==(t=t.target).webkitPresentationMode){document.pictureInPictureElement=t;var e=new Event("enterpictureinpicture");t.dispatchEvent(e)}else document.pictureInPictureElement==t&&(document.pictureInPictureElement=null),e=new Event("leavepictureinpicture"),t.dispatchEvent(e)}function _c(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Lc(){var t=document.pictureInPictureElement;return t?(t.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Uc(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Oc(e,n,r){return new t.TextTrackCue(e,n,r)}function jc(e,n,r){return new t.TextTrackCue(e+"-"+n+"-"+r,e,n,r)}function Bc(){}kc.prototype.createMediaKeys=function(){var t=new Ac(this.a);return Promise.resolve(t)},kc.prototype.getConfiguration=function(){return this.b},(n=Ac.prototype).createSession=function(t){if("temporary"!=(t=t||"temporary")&&"persistent-license"!=t)throw new TypeError("Session type "+t+" is unsupported on this platform.");var e=this.b||document.createElement("video");return e.src||(e.src="about:blank"),t=new Nc(e,this.g,t),this.c.push(t),t},n.setServerCertificate=function(){return Promise.resolve(!1)},n.wf=function(t){var e=document.createEvent("CustomEvent");e.initCustomEvent("encrypted",!1,!1,null),e.initDataType="webm",e.initData=t.initData,this.b.dispatchEvent(e)},n.bg=function(t){var e=Mc(this,t.sessionId);e&&(t=new St("message",{messageType:null==e.keyStatuses.a?"licenserequest":"licenserenewal",message:t.message}),e.b&&(e.b.resolve(),e.b=null),e.dispatchEvent(t))},n.$f=function(t){(t=Mc(this,t.sessionId))&&(Cc(t,"usable"),t.a&&t.a.resolve(),t.a=null)},n.ag=function(t){var e=Mc(this,t.sessionId);e&&e.handleError(t)},V(Nc,kt),(n=Nc.prototype).handleError=function(t){var e=Error("EME v0.1b key error");e.errorCode=t.errorCode,e.errorCode.systemCode=t.systemCode,!t.sessionId&&this.b?(e.method="generateRequest",45==t.systemCode&&(e.message="Unsupported session type."),this.b.reject(e),this.b=null):t.sessionId&&this.a?(e.method="update",this.a.reject(e),this.a=null):(e=t.systemCode,t.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Cc(this,"output-restricted"):Cc(this,1==e?"expired":"internal-error"))},n.td=function(t,e){if(this.a)this.a.then(this.td.bind(this,t,e)).catch(this.td.bind(this,t,e));else{if(this.a=t,"webkit-org.w3.clearkey"==this.c){var n=ie(e),r=JSON.parse(n);"oct"!=r.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),n=fe.Aa(r.keys[0].k),r=fe.Aa(r.keys[0].kid)}else n=new Uint8Array(e),r=null;var i=Ec("addKey");try{this.f[i](this.c,n,r,this.sessionId)}catch(a){this.a.reject(a),this.a=null}}},n.generateRequest=function(t,e){return Pc(this,e,null)},n.load=function(t){return"persistent-license"==this.g?Pc(this,null,t):Promise.reject(Error("Not a persistent session."))},n.update=function(t){var e=new mt;return this.td(e,t),e},n.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var t=Ec("cancelKeyRequest");try{this.f[t](this.c,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},n.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(n=Rc.prototype).forEach=function(t){this.a&&t(this.a,wc)},n.get=function(t){if(this.has(t))return this.a},n.has=function(t){var e=wc;return!(!this.a||!fe.ya(new Uint8Array(t),new Uint8Array(e)))},n.entries=function(){},n.keys=function(){},n.values=function(){},Yu(function(){if(!(!t.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Tc="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;wc=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Sc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=xc,t.MediaKeys=Ac,t.MediaKeySystemAccess=kc}}),Yu(function(){if(t.HTMLVideoElement){var e=HTMLVideoElement.prototype;e.requestPictureInPicture&&document.exitPictureInPicture||!e.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=_c,document.exitPictureInPicture=Lc,document.addEventListener("webkitpresentationmodechanged",Dc,!0))}}),Yu(function(){if(t.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch(function(){}),t}}}),Yu(function(){if(t.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in e&&(e.getVideoPlaybackQuality=Uc)}}),Yu(function(){if(!t.VTTCue&&t.TextTrackCue){var e=TextTrackCue.length;if(3==e)t.VTTCue=Oc;else if(6==e)t.VTTCue=jc;else{try{var n=!!Oc(1,2,"")}catch(r){n=!1}n&&(t.VTTCue=Oc)}}}),Bc.prototype.parseInit=function(){},Bc.prototype.parseMedia=function(t,e){var n=ie(t),r=[],i=new DOMParser,a=null;if(""==n)return r;try{a=i.parseFromString(n,"text/xml")}catch(w){throw new pt(2,2,2005,"Failed to parse TTML.")}if(a){if(n=a.getElementsByTagName("parsererror")[0])throw new pt(2,2,2005,n.textContent);if(!(i=a.getElementsByTagName("tt")[0]))throw new pt(2,2,2005,"TTML does not contain <tt> tag.");var o=qr.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","frameRate"),s=qr.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),u=qr.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),c=qr.getAttributeNS(i,"http://www.w3.org/ns/ttml#parameter","tickRate");if(a=i.getAttribute("xml:space")||"default",n=i.getAttribute("tts:extent"),"default"!=a&&"preserve"!=a)throw new pt(2,2,2005,"Invalid xml:space value: "+a);a="default"==a,o=new ol(o,s,u,c),s=Jc(i.getElementsByTagName("metadata")[0]),u=Jc(i.getElementsByTagName("styling")[0]),c=Jc(i.getElementsByTagName("layout")[0]);for(var l=[],f=0;f<c.length;f++){var d,p,m=c[f],v=u,y=n,g=new un,b=m.getAttribute("xml:id");if(b)g.id=b,b=null,y&&(b=Fc.exec(y)||Vc.exec(y)),y=b?Number(b[1]):null,b=b?Number(b[2]):null,(d=el(m,v,"extent"))&&(null!=(d=(p=Fc.exec(d))||Vc.exec(d))&&(g.width=null!=y?100*Number(d[1])/y:Number(d[1]),g.height=null!=b?100*Number(d[2])/b:Number(d[2]),g.widthUnits=p||null!=y?cn:0,g.heightUnits=p||null!=b?cn:0)),(m=el(m,v,"origin"))&&(null!=(d=(p=Fc.exec(m))||Vc.exec(m))&&(g.viewportAnchorX=null!=b?100*Number(d[1])/b:Number(d[1]),g.viewportAnchorY=null!=y?100*Number(d[2])/y:Number(d[2]),g.viewportAnchorUnits=p||null!=y?cn:0));else g=null;g&&l.push(g)}for(n=(n=i.getElementsByTagName("body")[0])?Array.from(n.querySelectorAll("[begin]")):[],i=(n=h(n)).next();!i.done;i=n.next())(i=Qc(i.value,e.periodStart,o,s,u,c,l,a,!1))&&r.push(i)}return r};var Fc=/^(\d{1,2}(?:\.\d+)?|100)% (\d{1,2}(?:\.\d+)?|100)%$/,Kc=/^(\d+px|\d+em)$/,Vc=/^(\d+)px (\d+)px$/,Hc=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,zc=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,qc=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Gc=/^(\d*(?:\.\d*)?)f$/,Xc=/^(\d*(?:\.\d*)?)t$/,Yc=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Wc={left:nn,center:"center",right:"end",start:nn,end:"end"},$c={left:"line-left",center:"center",right:"line-right"};function Jc(t){var e=[];if(!t)return e;for(var n=h(t.childNodes),r=n.next();!r.done;r=n.next())(r=r.value).nodeType==Node.ELEMENT_NODE&&"br"!==r.nodeName&&(r=Jc(r),e=e.concat(r));return e.length||e.push(t),e}function Qc(t,e,n,r,i,a,o,s,u){if(u&&"br"==t.nodeName)return(t=new Xe(0,0,"")).spacer=!0,t;var c=/^[\s\n]*$/.test(t.textContent),l=t.nodeType==Node.ELEMENT_NODE&&!t.hasAttribute("begin")&&!t.hasAttribute("end");if(t.nodeType!=Node.ELEMENT_NODE||l&&c||l&&!u)return null;c=il(t.getAttribute("begin"),n),l=il(t.getAttribute("end"),n);var f=il(t.getAttribute("dur"),n);if(null==l&&null!=f&&(l=c+f),!u&&(null==c||null==l))throw new pt(2,2,2001);if(c+=e,l+=e,f="",u=[],Array.from(t.childNodes).find(function(t){return t.nodeType===Node.TEXT_NODE&&/\w+/.test(t.textContent)}))f=function t(e,n){for(var r="",i=h(e.childNodes),a=i.next();!a.done;a=i.next())"br"==(a=a.value).nodeName&&e.childNodes[0]!==a?r+="\n":a.childNodes&&0<a.childNodes.length?r+=t(a,n):r+=n?a=(a=a.textContent.trim()).replace(/\s+/g," "):a.textContent;return r}(t,s);else for(var d=h(t.childNodes),p=d.next();!p.done;p=d.next())(p=Qc(p.value,e,n,r,i,a,o,s,!0))&&u.push(p);if((e=new Xe(c,l,f)).nestedCues=u,(a=rl(t,"region",a,"")[0])&&a.getAttribute("xml:id")){var m=a.getAttribute("xml:id");e.region=o.filter(function(t){return t.id==m})[0]}return function(t,e,n,r,i){"rtl"==tl(e,n,i,"direction")&&(t.direction="rtl");var a=tl(e,n,i,"writingMode");"tb"==a||"tblr"==a?t.writingMode="vertical-lr":"tbrl"==a?t.writingMode="vertical-rl":"rltb"==a||"rl"==a?t.direction="rtl":a&&(t.direction=Ze),(a=tl(e,n,i,"textAlign"))&&(t.positionAlign=$c[a],t.lineAlign=Wc[a],t.textAlign=$e[a.toUpperCase()]);(a=tl(e,n,i,"displayAlign"))&&(t.displayAlign=Qe[a.toUpperCase()]);(a=tl(e,n,i,"color"))&&(t.color=a);(a=tl(e,n,i,"backgroundColor"))&&(t.backgroundColor=a);(a=tl(e,n,i,"fontFamily"))&&(t.fontFamily=a);(a=tl(e,n,i,"fontWeight"))&&"bold"==a&&(t.fontWeight=700),(a=tl(e,n,i,"wrapOption"))&&"noWrap"==a&&(t.wrapLine=!1),(a=tl(e,n,i,"lineHeight"))&&a.match(Kc)&&(t.lineHeight=a),(a=tl(e,n,i,"fontSize"))&&a.match(Kc)&&(t.fontSize=a),(a=tl(e,n,i,"fontStyle"))&&(t.fontStyle=sn[a.toUpperCase()]);if(r){a=r.getAttribute("imagetype");var o=r.getAttribute("encoding");r=r.textContent.trim(),"PNG"==a&&"Base64"==o&&r&&(t.backgroundImage="data:image/png;base64,"+r)}(n=el(n,i,"textDecoration"))&&Zc(t,n),(e=nl(e,i,"textDecoration"))&&Zc(t,e)}(e,t,a,r=rl(t,"smpte:backgroundImage",r,"#")[0],i),e}function Zc(t,e){for(var n=e.split(" "),r=0;r<n.length;r++)switch(n[r]){case"underline":t.textDecoration.includes("underline")||t.textDecoration.push("underline");break;case"noUnderline":t.textDecoration.includes("underline")&&Mt(t.textDecoration,"underline");break;case"lineThrough":t.textDecoration.includes("lineThrough")||t.textDecoration.push("lineThrough");break;case"noLineThrough":t.textDecoration.includes("lineThrough")&&Mt(t.textDecoration,"lineThrough");break;case"overline":t.textDecoration.includes("overline")||t.textDecoration.push("overline");break;case"noOverline":t.textDecoration.includes("overline")&&Mt(t.textDecoration,"overline")}}function tl(t,e,n,r){return(t=nl(t,n,r))?t:el(e,n,r)}function el(t,e,n){for(var r=Jc(t),i=0;i<r.length;i++){var a=qr.getAttributeNS(r[i],"http://www.w3.org/ns/ttml#styling",n);if(a)return a}return(t=rl(t,"style",e,"")[0])?qr.getAttributeNS(t,"http://www.w3.org/ns/ttml#styling",n):null}function nl(t,e,n){var r=qr.getAttributeNS(t,"http://www.w3.org/ns/ttml#styling",n);if(r)return r;for(t=rl(t,"style",e,""),e=null,r=0;r<t.length;r++){var i=qr.getAttributeNS(t[r],"http://www.w3.org/ns/ttml#styling",n);i&&(e=i)}return e}function rl(t,e,n,r){var i=[];if(!t||1>n.length)return i;var a=t;for(t=null;a&&!(t=a.getAttribute(e))&&(a=a.parentNode)instanceof Element;);if(e=t)for(t=(e=h(e=e.split(" "))).next();!t.done;t=e.next()){t=t.value;for(var o=(a=h(n)).next();!o.done;o=a.next())if(r+(o=o.value).getAttribute("xml:id")==t){i.push(o);break}}return i}function il(t,e){var n=null;if(Hc.test(t)){n=Hc.exec(t);var r=Number(n[1]),i=Number(n[2]),a=Number(n[3]),o=Number(n[4]);n=(a+=(o+=(Number(n[5])||0)/e.b)/e.frameRate)+60*i+3600*r}else zc.test(t)?n=al(zc,t):qc.test(t)?n=al(qc,t):Gc.test(t)?(n=Gc.exec(t),n=Number(n[1])/e.frameRate):Xc.test(t)?(n=Xc.exec(t),n=Number(n[1])/e.a):Yc.test(t)&&(n=al(Yc,t));return n}function al(t,e){var n=t.exec(e);return null==n||""==n[0]?null:(Number(n[4])||0)/1e3+(Number(n[3])||0)+60*(Number(n[2])||0)+3600*(Number(n[1])||0)}function ol(t,e,n,r){this.frameRate=Number(t)||30,this.b=Number(e)||1,this.a=Number(r),0==this.a&&(this.a=t?this.frameRate*this.b:1),n&&(t=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(t[1])/Number(t[2]))}function sl(){this.a=new Bc}function ul(){}function cl(t,e,n){var r;(r=/^align:(start|middle|center|end|left|right)$/.exec(e))?(e=r[1],t.textAlign="middle"==e?We:$e[e.toUpperCase()]):(r=/^vertical:(lr|rl)$/.exec(e))?t.writingMode="lr"==r[1]?"vertical-lr":"vertical-rl":(r=/^size:([\d.]+)%$/.exec(e))?t.size=Number(r[1]):(r=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(e))?(t.position=Number(r[1]),r[2]&&(e=r[2],t.positionAlign="line-left"==e||"start"==e?"line-left":"line-right"==e||"end"==e?"line-right":"center")):(r=/^region:(.*)$/.exec(e))?(e=function(t,e){var n=t.filter(function(t){return t.id==e});return n.length?n[0]:null}(n,r[1]))&&(t.region=e):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(e))?(t.lineInterpretation=1,t.line=Number(n[1]),n[2]&&(t.lineAlign=rn[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(e))&&(t.lineInterpretation=en,t.line=Number(n[1]),n[2]&&(t.lineAlign=rn[n[2].toUpperCase()]))}function ll(t){if(null==(t=Ki(t,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var e=Number(t[2]),n=Number(t[3]);return 59<e||59<n?null:Number(t[4])/1e3+n+60*e+3600*(Number(t[1])||0)}function fl(){this.a=null}function hl(t,e,n){var r,i,a;return(new jr).H("payl",Kr(function(t){r=ie(t)})).H("iden",Kr(function(t){i=ie(t)})).H("sttg",Kr(function(t){a=ie(t)})).parse(t),r?function(t,e,n,r,i){if(t=new Xe(r,i,t),e&&(t.id=e),n)for(e=new Bi(n),n=Vi(e);n;)cl(t,n,[]),Fi(e),n=Vi(e);return t}(r,i,a,e,n):null}hn["application/ttml+xml"]=Bc,sl.prototype.parseInit=function(t){var e=!1;if((new jr).H("moov",Br).H("trak",Br).H("mdia",Br).H("minf",Br).H("stbl",Br).fa("stsd",Fr).H("stpp",function(t){e=!0,t.parser.stop()}).parse(t),!e)throw new pt(2,2,2007)},sl.prototype.parseMedia=function(t,e){var n=!1,r=[];if((new jr).H("mdat",Kr(function(t){n=!0,r=r.concat(this.a.parseMedia(t,e))}.bind(this))).parse(t),!n)throw new pt(2,2,2007);return r},hn['application/mp4; codecs="stpp"']=sl,hn['application/mp4; codecs="stpp.TTML.im1t"']=sl,ul.prototype.parseInit=function(){},ul.prototype.parseMedia=function(t,e){var n=ie(t);if(n=(n=n.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new pt(2,2,2e3);var r=e.segmentStart;if(null==r&&(r=0,n[0].includes("X-TIMESTAMP-MAP"))){var i=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=n[0].match(/MPEGTS:(\d+)/m);if(i&&a){if(null==(r=ll(new Bi(i[1]))))throw new pt(2,2,2e3);r=e.periodStart+(Number(a[1])/9e4-r)}}a=[];var o=n[0].split("\n");for(i=1;i<o.length;i++)if(/^Region:/.test(o[i])){var s=new Bi(o[i]),u=new un;Vi(s),Fi(s);for(var c=Vi(s);c;){var l=u,f=c;(c=/^id=(.*)$/.exec(f))?l.id=c[1]:(c=/^width=(\d{1,2}|100)%$/.exec(f))?l.width=Number(c[1]):(c=/^lines=(\d+)$/.exec(f))?(l.height=Number(c[1]),l.heightUnits=2):(c=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(f))?(l.regionAnchorX=Number(c[1]),l.regionAnchorY=Number(c[2])):(c=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(f))?(l.viewportAnchorX=Number(c[1]),l.viewportAnchorY=Number(c[2])):/^scroll=up$/.exec(f)&&(l.scroll="up"),Fi(s),c=Vi(s)}a.push(u)}for(i=[],s=1;s<n.length;s++){if(c=o=n[s].split("\n"),f=r,o=a,1==c.length&&!c[0]||/^NOTE($|[ \t])/.test(c[0])||"STYLE"==c[0])o=null;else{u=null,c[0].includes("--\x3e")||(u=c[0],c.splice(0,1));var h=ll(l=new Bi(c[0])),d=Ki(l,/[ \t]+--\x3e[ \t]+/g),p=ll(l);if(null==h||null==d||null==p)throw new pt(2,2,2001);for(c=new Xe(h+f,p+f,c.slice(1).join("\n").trim()),Fi(l),f=Vi(l);f;)cl(c,f,o),Fi(l),f=Vi(l);null!=u&&(c.id=u),o=c}o&&i.push(o)}return i},hn["text/vtt"]=ul,hn['text/vtt; codecs="vtt"']=ul,fl.prototype.parseInit=function(t){var e=!1;if((new jr).H("moov",Br).H("trak",Br).H("mdia",Br).fa("mdhd",function(t){0==t.version?(t.reader.M(4),t.reader.M(4),this.a=t.reader.G(),t.reader.M(4)):(t.reader.M(8),t.reader.M(8),this.a=t.reader.G(),t.reader.M(8)),t.reader.M(4)}.bind(this)).H("minf",Br).H("stbl",Br).fa("stsd",Fr).H("wvtt",function(){e=!0}).parse(t),!this.a)throw new pt(2,2,2008);if(!e)throw new pt(2,2,2008)},fl.prototype.parseMedia=function(t,e){var n=this;if(!this.a)throw new pt(2,2,2008);var r,i=0,a=[],o=[],s=!1,u=!1,c=!1,l=null;if((new jr).H("moof",Br).H("traf",Br).fa("tfdt",function(t){s=!0,i=0==t.version?t.reader.G():t.reader.Ab()}).fa("tfhd",function(t){var e=t.flags;(t=t.reader).M(4),1&e&&t.M(8),2&e&&t.M(4),l=8&e?t.G():null}).fa("trun",function(t){u=!0;var e=t.version,n=t.flags,r=(t=t.reader).G();1&n&&t.M(4),4&n&&t.M(4);for(var i=[],o=0;o<r;o++){var s={duration:null,sampleSize:null,vd:null};256&n&&(s.duration=t.G()),512&n&&(s.sampleSize=t.G()),1024&n&&t.M(4),2048&n&&(s.vd=0==e?t.G():t.$d()),i.push(s)}a=i}).H("mdat",Kr(function(t){c=!0,r=t})).parse(t),!c&&!s&&!u)throw new pt(2,2,2008);var f=i,h=new Lr(new DataView(r.buffer,r.byteOffset,r.byteLength),0);return a.forEach(function(t){var r=t.duration||l,a=t.vd?i+t.vd:f;f=a+(r||0);var s=0;do{var u=h.G();s+=u;var c=null;"vttc"==Hr(h.G())?8<u&&(c=h.Za(u-8)):h.M(u-8),r&&c&&o.push(hl(c,e.periodStart+a/n.a,e.periodStart+f/n.a))}while(t.sampleSize&&s<t.sampleSize)}),o.filter(Be.Ia)},hn['application/mp4; codecs="wvtt"']=fl,K("shaka.util.Dom.createHTMLElement",function(t){return document.createElement(t)}),K("shaka.util.Dom.createVideoElement",function(){var t=document.createElement("video");return t.muted=!0,t.width=600,t.height=400,t}),K("shaka.util.Dom.asHTMLElement",function(t){return t}),K("shaka.util.Dom.asHTMLMediaElement",function(t){return t}),K("shaka.util.Dom.removeAllChildren",function(t){for(;t.firstChild;)t.removeChild(t.firstChild)})}.call(r,n,n),"undefined"!=typeof exports)for(var i in r.shaka)exports[i]=r.shaka[i];else void 0!==t&&t.amd?t(function(){return r.shaka}):n.shaka=r.shaka}();
},{}],"TN90":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DashPlayer=void 0;var e=c(require("@babel/runtime/helpers/classCallCheck")),t=c(require("@babel/runtime/helpers/createClass")),r=c(require("@babel/runtime/helpers/inherits")),n=c(require("@babel/runtime/helpers/possibleConstructorReturn")),u=c(require("@babel/runtime/helpers/getPrototypeOf")),i=require("./interface"),a=l(require("shaka-player"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var i=n?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,t&&t.set(e,r),r}function c(e){return e&&e.__esModule?e:{default:e}}function f(e){return function(){var t,r=(0,u.default)(e);if(s()){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,n.default)(this,t)}}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var p=function(n){(0,r.default)(i,n);var u=f(i);function i(t,r){return(0,e.default)(this,i),u.call(this,t,r)}return(0,t.default)(i,[{key:"load",value:function(){var e=this;return new Promise(function(t){var r=new a.Player(e.videoElement_);r.load(e.manifestUrl_).then(function(){t()}),e.shakap_=r})}},{key:"isLive",get:function(){return this.shakap_.isLive()}}]),i}(i.PlayerTechInterface);exports.DashPlayer=p;
},{"@babel/runtime/helpers/classCallCheck":"ZBnv","@babel/runtime/helpers/createClass":"NoOd","@babel/runtime/helpers/inherits":"qngw","@babel/runtime/helpers/possibleConstructorReturn":"GFCP","@babel/runtime/helpers/getPrototypeOf":"WQgz","./interface":"Sxab","shaka-player":"wZ93"}],"xj1q":[function(require,module,exports) {
"use strict";!function(t){var e={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},i=function(t){var i=t;return e.hasOwnProperty(t)&&(i=e[t]),String.fromCharCode(i)},s={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},r={17:2,18:4,21:6,22:8,23:10,19:13,20:15},n={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},o={25:2,26:4,29:6,30:8,31:10,27:13,28:15},a=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],h={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(t){this.time=t},log:function(t,e){var i=this.verboseFilter[t];this.verboseLevel>=i&&console.log(this.time+" ["+t+"] "+e)}},l=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].toString(16));return e},c=function(t,e,i,s,r){this.foreground=t||"white",this.underline=e||!1,this.italics=i||!1,this.background=s||"black",this.flash=r||!1};c.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(t){for(var e=["foreground","underline","italics","background","flash"],i=0;i<e.length;i++){var s=e[i];t.hasOwnProperty(s)&&(this[s]=t[s])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},copy:function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var u=function(t,e,i,s,r,n){this.uchar=t||" ",this.penState=new c(e,i,s,r,n)};u.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(t,e){this.uchar=t,this.penState.copy(e)},setPenState:function(t){this.penState.copy(t)},equals:function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},copy:function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var d=function(){this.chars=[];for(var t=0;t<32;t++)this.chars.push(new u);this.pos=0,this.currPenState=new c};d.prototype={equals:function(t){for(var e=!0,i=0;i<32;i++)if(!this.chars[i].equals(t.chars[i])){e=!1;break}return e},copy:function(t){for(var e=0;e<32;e++)this.chars[e].copy(t.chars[e])},isEmpty:function(){for(var t=!0,e=0;e<32;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},setCursor:function(t){this.pos!==t&&(this.pos=t),this.pos<0?(h.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>32&&(h.log("ERROR","Too large cursor position "+this.pos),this.pos=32)},moveCursor:function(t){var e=this.pos+t;if(t>1)for(var i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(t){t>=144&&this.backSpace();var e=i(t);this.pos>=32?h.log("ERROR","Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))},clearFromPos:function(t){var e;for(e=t;e<32;e++)this.chars[e].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var t=[],e=!0,i=0;i<32;i++){var s=this.chars[i].uchar;" "!==s&&(e=!1),t.push(s)}return e?"":t.join("")},setPenStyles:function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}};var p=function(){this.rows=[];for(var t=0;t<15;t++)this.rows.push(new d);this.currRow=14,this.nrRollUpRows=null,this.reset()};p.prototype={reset:function(){for(var t=0;t<15;t++)this.rows[t].clear();this.currRow=14},equals:function(t){for(var e=!0,i=0;i<15;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e},copy:function(t){for(var e=0;e<15;e++)this.rows[e].copy(t.rows[e])},isEmpty:function(){for(var t=!0,e=0;e<15;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(t){this.rows[this.currRow].insertChar(t)},setPen:function(t){this.rows[this.currRow].setPenStyles(t)},moveCursor:function(t){this.rows[this.currRow].moveCursor(t)},setCursor:function(t){h.log("INFO","setCursor: "+t),this.rows[this.currRow].setCursor(t)},setPAC:function(t){h.log("INFO","pacData = "+JSON.stringify(t));var e=t.row-1;this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.currRow=e;var i=this.rows[this.currRow];if(null!==t.indent){var s=t.indent,r=Math.max(s-1,0);i.setCursor(t.indent),t.color=i.chars[r].penState.foreground}var n={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(n)},setBkgData:function(t){h.log("INFO","bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},setRollUpRows:function(t){this.nrRollUpRows=t},rollUp:function(){if(null!==this.nrRollUpRows){h.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),h.log("INFO","Rolling up")}else h.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(t){t=t||!1;for(var e=[],i="",s=-1,r=0;r<15;r++){var n=this.rows[r].getTextString();n&&(s=r+1,t?e.push("Row "+s+': "'+n+'"'):e.push(n.trim()))}return e.length>0&&(i=t?"["+e.join(" | ")+"]":e.join("\n")),i},getTextAndFormat:function(){return this.rows}};var f=function(t,e){this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new p,this.nonDisplayedMemory=new p,this.lastOutputScreen=new p,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};f.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(t){this.outputFilter=t},setPAC:function(t){this.writeScreen.setPAC(t)},setBkgData:function(t){this.writeScreen.setBkgData(t)},setMode:function(t){t!==this.mode&&(this.mode=t,h.log("INFO","MODE="+t),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},insertChars:function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";h.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(h.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){h.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){h.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){h.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(t){h.log("INFO","RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},cc_FON:function(){h.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){h.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){h.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){h.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){h.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){h.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){h.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(h.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,h.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(t){h.log("INFO","TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},cc_MIDROW:function(t){var e={flash:!1};if(e.underline=t%2==1,e.italics=t>=46,e.italics)e.foreground="white";else{var i=Math.floor(t/2)-16;e.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}h.log("INFO","MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},outputDataUpdate:function(){var t=h.time;null!==t&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(t,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}};var g=function(t,e,i){this.field=t||1,this.outputs=[e,i],this.channels=[new f(1,e),new f(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};g.prototype={getHandler:function(t){return this.channels[t].getHandler()},setHandler:function(t,e){this.channels[t].setHandler(e)},addData:function(t,e){var i,s,r,n=!1;this.lastTime=t,h.setTime(t);for(var o=0;o<e.length;o+=2)if(s=127&e[o],r=127&e[o+1],s>=16&&s<=31&&s===this.lastCmdA&&r===this.lastCmdB)this.lastCmdA=null,this.lastCmdB=null,h.log("DEBUG","Repeated command ("+l([s,r])+") is dropped");else if(0!==s||0!==r){if(h.log("DATA","["+l([e[o],e[o+1]])+"] -> ("+l([s,r])+")"),(i=this.parseCmd(s,r))||(i=this.parseMidrow(s,r)),i||(i=this.parsePAC(s,r)),i||(i=this.parseBackgroundAttributes(s,r)),!i)if(n=this.parseChars(s,r))if(this.currChNr&&this.currChNr>=0)this.channels[this.currChNr-1].insertChars(n);else h.log("WARNING","No channel found yet. TEXT-MODE?");i?this.dataCounters.cmd+=2:n?this.dataCounters.char+=2:(this.dataCounters.other+=2,h.log("WARNING","Couldn't parse cleaned data "+l([s,r])+" orig: "+l([e[o],e[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(t,e){var i=null;if(!((20===t||21===t||28===t||29===t)&&32<=e&&e<=47)&&!((23===t||31===t)&&33<=e&&e<=35))return!1;i=20===t||21===t||23===t?1:2;var s=this.channels[i-1];return 20===t||21===t||28===t||29===t?32===e?s.cc_RCL():33===e?s.cc_BS():34===e?s.cc_AOF():35===e?s.cc_AON():36===e?s.cc_DER():37===e?s.cc_RU(2):38===e?s.cc_RU(3):39===e?s.cc_RU(4):40===e?s.cc_FON():41===e?s.cc_RDC():42===e?s.cc_TR():43===e?s.cc_RTD():44===e?s.cc_EDM():45===e?s.cc_CR():46===e?s.cc_ENM():47===e&&s.cc_EOC():s.cc_TO(e-32),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=i,!0},parseMidrow:function(t,e){var i=null;if((17===t||25===t)&&32<=e&&e<=47){if((i=17===t?1:2)!==this.currChNr)return h.log("ERROR","Mismatch channel in midrow parsing"),!1;var s=this.channels[i-1];return s.insertChars([32]),s.cc_MIDROW(e),h.log("DEBUG","MIDROW ("+l([t,e])+")"),this.lastCmdA=t,this.lastCmdB=e,!0}return!1},parsePAC:function(t,e){var i,a=null;if(!((17<=t&&t<=23||25<=t&&t<=31)&&64<=e&&e<=127)&&!((16===t||24===t)&&64<=e&&e<=95))return!1;i=t<=23?1:2,a=64<=e&&e<=95?1===i?s[t]:n[t]:1===i?r[t]:o[t];var h=this.interpretPAC(a,e);return this.channels[i-1].setPAC(h),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=i,!0},interpretPAC:function(t,e){var i=e,s={color:null,italics:!1,indent:null,underline:!1,row:t};return i=e>95?e-96:e-64,s.underline=1==(1&i),i<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(s.italics=!0,s.color="white"):s.indent=4*Math.floor((i-16)/2),s},parseChars:function(t,e){var s=null,r=null,n=null;if(t>=25?(s=2,n=t-8):(s=1,n=t),17<=n&&n<=19){var o=e;o=17===n?e+80:18===n?e+112:e+144,h.log("INFO","Special char '"+i(o)+"' in channel "+s),r=[o],this.lastCmdA=t,this.lastCmdB=e}else 32<=t&&t<=127&&(r=0===e?[t]:[t,e],this.lastCmdA=null,this.lastCmdB=null);if(r){var a=l(r);h.log("DEBUG","Char codes =  "+a.join(","))}return r},parseBackgroundAttributes:function(t,e){var i,s,r;return((16===t||24===t)&&32<=e&&e<=47||(23===t||31===t)&&45<=e&&e<=47)&&(i={},16===t||24===t?(s=Math.floor((e-32)/2),i.background=a[s],e%2==1&&(i.background=i.background+"_semi")):45===e?i.background="transparent":(i.foreground="black",47===e&&(i.underline=!0)),r=t<24?1:2,this.channels[r-1].setBkgData(i),this.lastCmdA=t,this.lastCmdB=e,!0)},reset:function(){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(t){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].cueSplitAtTime(t)}};t.logger=h,t.PenState=c,t.CaptionScreen=p,t.Cea608Parser=g,t.findCea608Nalus=function(t,e,i){for(var s=0,r=e,n=[],o=function(t,e,i,s){if(4!==t||e<8)return null;var r=i.getUint8(s),n=i.getUint16(s+1),o=i.getUint32(s+3),a=i.getUint8(s+7);return 181==r&&49==n&&1195456820==o&&3==a};r<e+i;){if(s=t.getUint32(r),6==(31&t.getUint8(r+4)))for(var a=r+5,h=-1;a<r+4+s-1;){h=0;for(var l=255;255===l;)h+=l=t.getUint8(a),a++;var c=0;for(l=255;255===l;)c+=l=t.getUint8(a),a++;o(h,c,t,a)&&n.push([a,c]),a+=c}r+=s+4}return n},t.extractCea608DataFromRange=function(t,e){var i=e[0],s=[[],[]];i+=8;var r=31&t.getUint8(i);i+=2;for(var n=0;n<r;n++){var o=t.getUint8(i),a=4&o,h=3&o;i++;var l=t.getUint8(i);i++;var c=t.getUint8(i);i++,a&&(127&l)+(127&c)!=0&&(0===h?(s[0].push(l),s[0].push(c)):1===h&&(s[1].push(l),s[1].push(c)))}return s}}("undefined"==typeof exports?(void 0).cea608parser={}:exports);
},{}],"jJgo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}();function i(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var e=function(){function e(){i(this,e),this.init()}return t(e,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime"}}]),e}(),s=new e;exports.default=s;
},{}],"RxE2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function i(){e(this,i),this.init()}return t(i,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),i}(),n=new i;exports.default=n;
},{}],"FHM8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){var n=void 0,t=[],e={},r={};function a(n,e){for(var r in t){var a=t[r];if(a.context===n&&a.name===e)return a.instance}return null}function o(n,t){return t[n]}function c(n,t,e){n in e&&(e[n]=t)}function i(t,e,r){var a=void 0,o=t.__dashjs_factory_name,c=e[o];if(c){var i=c.instance;if(!c.override)return i.apply({context:e,factory:n},r);for(var u in a=t.apply({context:e},r),i=i.apply({context:e,factory:n,parent:a},r))a.hasOwnProperty(u)&&(a[u]=i[u])}else a=t.apply({context:e},r);return a.getClassName=function(){return o},a}return n={extend:function(n,t,e,r){!r[n]&&t&&(r[n]={instance:t,override:e})},getSingletonInstance:a,setSingletonInstance:function(n,e,r){for(var a in t){var o=t[a];if(o.context===n&&o.name===e)return void(t[a].instance=r)}t.push({name:e,context:n,instance:r})},getSingletonFactory:function(n){var r=o(n.__dashjs_factory_name,e);return r||(r=function(e){var r=void 0;return void 0===e&&(e={}),{getInstance:function(){return r||(r=a(e,n.__dashjs_factory_name)),r||(r=i(n,e,arguments),t.push({name:n.__dashjs_factory_name,context:e,instance:r})),r}}},e[n.__dashjs_factory_name]=r),r},getSingletonFactoryByName:function(n){return o(n,e)},updateSingletonFactory:function(n,t){c(n,t,e)},getClassFactory:function(n){var t=o(n.__dashjs_factory_name,r);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return i(n,t,arguments)}}},r[n.__dashjs_factory_name]=t),t},getClassFactoryByName:function(n){return o(n,r)},updateClassFactory:function(n,t){c(n,t,r)}}}();exports.default=n;
},{}],"Opee":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./FactoryMaker"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}var n=0,o=5e3;function i(){var e={};function r(r,t,n){var o=-1;return e[r]?(e[r].some(function(e,r){if(e&&e.callback===t&&(!n||n===e.scope))return o=r,!0}),o):o}return{on:function(t,o,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(!t)throw new Error("event type cannot be null or undefined");if(!o||"function"!=typeof o)throw new Error("listener must be a function: "+o);if(!(r(t,o,i)>=0)){e[t]=e[t]||[];var u={callback:o,scope:i,priority:a};e[t].some(function(r,n){if(r&&a>r.priority)return e[t].splice(n,0,u),!0})||e[t].push(u)}},off:function(t,n,o){if(t&&n&&e[t]){var i=r(t,n,o);i<0||(e[t][i]=null)}},trigger:function(r,t){if(r&&e[r]){if((t=t||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");t.type=r,e[r]=e[r].filter(function(e){return e}),e[r].forEach(function(e){return e&&e.callback.call(e.scope,t)})}},reset:function(){e={}}}}i.__dashjs_factory_name="EventBus";var a=r.default.getSingletonFactory(i);a.EVENT_PRIORITY_LOW=n,a.EVENT_PRIORITY_HIGH=o,r.default.updateSingletonFactory(i.__dashjs_factory_name,a),exports.default=a;
},{"./FactoryMaker":"FHM8"}],"zN1Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function(){function r(){n(this,r)}return e(r,[{key:"extend",value:function(e,n){if(e){var r=!!n&&n.override,t=!!n&&n.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!r||t&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),r}();exports.default=r;
},{}],"kdX5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./EventsBase"),t=E(e);function E(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(e){function E(){o(this,E);var e=n(this,(E.__proto__||Object.getPrototypeOf(E)).call(this));return e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.BYTES_APPENDED="bytesAppended",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.DATA_UPDATE_STARTED="dataUpdateStarted",e.INITIALIZATION_LOADED="initializationLoaded",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_REQUESTED="initRequested",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.QUOTA_EXCEEDED="quotaExceeded",e.REPRESENTATION_UPDATED="representationUpdated",e.SEGMENTS_LOADED="segmentsLoaded",e.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_COMPLETED="streamCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIMED_TEXT_REQUESTED="timedTextRequested",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e}return r(E,t.default),E}();exports.default=a;
},{"./EventsBase":"zN1Q"}],"W3G1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./CoreEvents"),t=o(e);function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(e){function o(){return r(this,o),n(this,(o.__proto__||Object.getPrototypeOf(o)).apply(this,arguments))}return u(o,t.default),o}(),f=new i;exports.default=f;
},{"./CoreEvents":"kdX5"}],"Vb3t":[function(require,module,exports) {
"use strict";function t(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function i(){t(this,i),this.action=i.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null};i.ACTION_DOWNLOAD="download",i.ACTION_COMPLETE="complete",exports.default=i;
},{}],"Hx0a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e=function(){function n(n,e){for(var o=0;o<e.length;o++){var t=e[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}return function(e,o,t){return o&&n(e.prototype,o),t&&n(e,t),e}}();function o(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var t=function(){function t(){o(this,t)}return e(t,null,[{key:"mixin",value:function(e,o,r){var i=void 0,u={};if(e)for(var f in o)o.hasOwnProperty(f)&&(i=o[f],f in e&&(e[f]===i||f in u&&u[f]===i)||("object"===n(e[f])&&null!==e[f]?e[f]=t.mixin(e[f],i,r):e[f]=r(i)));return e}},{key:"clone",value:function(e){if(!e||"object"!==(void 0===e?"undefined":n(e)))return e;var o=void 0;if(e instanceof Array){o=[];for(var r=0,i=e.length;r<i;++r)r in e&&o.push(t.clone(e[r]))}else o={};return t.mixin(o,e,t.clone)}}]),t}();exports.default=t;
},{}],"yMBz":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._responseHeaders=null,this._serviceLocation=null},n=function e(){t(this,e),this.s=null,this.d=null,this.b=[]};e.GET="GET",e.HEAD="HEAD",e.MPD_TYPE="MPD",e.XLINK_EXPANSION_TYPE="XLinkExpansion",e.INIT_SEGMENT_TYPE="InitializationSegment",e.INDEX_SEGMENT_TYPE="IndexSegment",e.MEDIA_SEGMENT_TYPE="MediaSegment",e.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",e.OTHER_TYPE="other",exports.HTTPRequest=e,exports.HTTPRequestTrace=n;
},{}],"yjrH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=require("./FactoryMaker"),a=s(t),i=require("./Utils.js"),o=s(i),r=require("../core/Debug"),n=s(r),u=require("../streaming/constants/Constants"),T=s(u),l=require("../streaming/vo/metrics/HTTPRequest");function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function f(){var t,a,i={debug:{logLevel:n.default.LOG_LEVEL_WARNING},streaming:{metricsMaxListDepth:1e3,abandonLoadTimeout:1e4,liveDelayFragmentCount:4,liveDelay:null,scheduleWhilePaused:!0,fastSwitchEnabled:!1,bufferPruningInterval:10,bufferToKeep:20,bufferAheadToKeep:80,jumpGaps:!0,smallGapLimit:1.5,stableBufferTime:12,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,longFormContentDurationThreshold:600,wallclockTimeUpdateInterval:50,lowLatencyEnabled:!1,keepProtectionMediaKeys:!1,useManifestDateHeaderTimeSource:!0,useSuggestedPresentationDelay:!1,manifestUpdateRetryInterval:100,liveCatchUpMinDrift:.02,liveCatchUpMaxDrift:0,liveCatchUpPlaybackRate:.5,lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},retryIntervals:(t={},d(t,l.HTTPRequest.MPD_TYPE,500),d(t,l.HTTPRequest.XLINK_EXPANSION_TYPE,500),d(t,l.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),d(t,l.HTTPRequest.INIT_SEGMENT_TYPE,1e3),d(t,l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),d(t,l.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),d(t,l.HTTPRequest.OTHER_TYPE,1e3),t),retryAttempts:(a={},d(a,l.HTTPRequest.MPD_TYPE,3),d(a,l.HTTPRequest.XLINK_EXPANSION_TYPE,1),d(a,l.HTTPRequest.MEDIA_SEGMENT_TYPE,3),d(a,l.HTTPRequest.INIT_SEGMENT_TYPE,3),d(a,l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),d(a,l.HTTPRequest.INDEX_SEGMENT_TYPE,3),d(a,l.HTTPRequest.OTHER_TYPE,3),a),abr:{movingAverageMethod:T.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:T.default.ABR_STRATEGY_DYNAMIC,bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useBufferOccupancyABR:!1,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0}}}},r=o.default.clone(i);return{get:function(){return r},update:function(t){"object"===(void 0===t?"undefined":e(t))&&function t(a,i,r){for(var n in a)a.hasOwnProperty(n)&&i.hasOwnProperty(n)&&("object"===e(a[n])?t(a[n],i[n],r.slice()+n+"."):i[n]=o.default.clone(a[n]))}(t,r,"")},reset:function(){r=o.default.clone(i)}}}f.__dashjs_factory_name="Settings";var c=a.default.getSingletonFactory(f);exports.default=c;
},{"./FactoryMaker":"FHM8","./Utils.js":"Hx0a","../core/Debug":"iL1O","../streaming/constants/Constants":"jJgo","../streaming/vo/metrics/HTTPRequest":"yMBz"}],"iL1O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./EventBus"),n=d(e),t=require("./events/Events"),o=d(t),r=require("./FactoryMaker"),a=d(r),i=require("./Settings"),l=d(i);function d(e){return e&&e.__esModule?e:{default:e}}var u=0,c=1,s=2,g=3,f=4,v=5;function L(){var e,t=this.context,r=(0,n.default)(t).getInstance(),a=(0,l.default)(t).getInstance(),i=[],d=void 0,u=void 0,L=void 0;function w(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function _(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];h.apply(void 0,[c,this].concat(n))}function y(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];h.apply(void 0,[s,this].concat(n))}function p(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];h.apply(void 0,[g,this].concat(n))}function E(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];h.apply(void 0,[f,this].concat(n))}function b(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];h.apply(void 0,[v,this].concat(n))}function h(e,n){var t="",l=null;d&&(l=(new Date).getTime(),t+="["+(l-L)+"]"),u&&n&&n.getClassName&&(t+="["+n.getClassName()+"]",n.getType&&(t+="["+n.getType()+"]")),t.length>0&&(t+=" ");for(var c=arguments.length,s=Array(c>2?c-2:0),g=2;g<c;g++)s[g-2]=arguments[g];Array.apply(null,s).forEach(function(e){t+=e+" "}),i[e]&&a.get().debug.logLevel>=e&&i[e](t),r.trigger(o.default.LOG,{message:t,level:e})}return e={getLogger:function(e){return{fatal:_.bind(e),error:y.bind(e),warn:p.bind(e),info:E.bind(e),debug:b.bind(e)}},setLogTimestampVisible:function(e){d=e},setCalleeNameVisible:function(e){u=e},setLogLevel:function(e){var n={debug:{logLevel:e}};a.update(n)},getLogLevel:function(){return a.get().debug.logLevel}},d=!0,u=!0,L=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(i[c]=w(window.console.error),i[s]=w(window.console.error),i[g]=w(window.console.warn),i[f]=w(window.console.info),i[v]=w(window.console.debug)),e}L.__dashjs_factory_name="Debug";var w=a.default.getSingletonFactory(L);w.LOG_LEVEL_NONE=u,w.LOG_LEVEL_FATAL=c,w.LOG_LEVEL_ERROR=s,w.LOG_LEVEL_WARNING=g,w.LOG_LEVEL_INFO=f,w.LOG_LEVEL_DEBUG=v,a.default.updateSingletonFactory(L.__dashjs_factory_name,w),exports.default=w;
},{"./EventBus":"Opee","./events/Events":"W3G1","./FactoryMaker":"FHM8","./Settings":"yjrH"}],"OnkV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/EventBus"),t=f(e),r=require("../../core/events/Events"),n=f(r),a=require("../../core/FactoryMaker"),i=f(a),s=require("../vo/FragmentRequest"),u=f(s),o=require("../../core/Debug"),d=f(o);function f(e){return e&&e.__esModule?e:{default:e}}var c="loading",N="executed",l="canceled",E="failed";function T(e){e=e||{};var r=this.context,a=(0,t.default)(r).getInstance(),i=e.dashMetrics,s=e.fragmentLoader,o=void 0,f=void 0,l=void 0,T=void 0,_=void 0;function A(e){var t;return!!e&&(t=!1,T.some(function(r){if(n=e,a=r,!isNaN(n.index)&&n.startTime===a.startTime&&n.adaptationIndex===a.adaptationIndex&&n.type===a.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,r)||function(e,t){return e.action===u.default.ACTION_COMPLETE&&e.action===t.action}(e,r))return t=!0;var n,a}),t)}function O(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function g(e){T=T.filter(function(t){var r=O(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-r})}function m(e,t){t<=e+.5||(T=T.filter(function(r){var n=O(r);return isNaN(r.startTime)||r.startTime>=t-n||isNaN(r.duration)||r.startTime+r.duration<=e+n}))}function D(e,t,r){for(var n=e.length-1;n>=0;n--){var a=e[n],i=a.startTime,s=i+a.duration;if(r=isNaN(r)?O(a):r,!isNaN(i)&&!isNaN(s)&&t+r>=i&&t-r<s||isNaN(i)&&isNaN(t))return a}return null}function v(e,t){i.addSchedulingInfo(e,t),i.addRequestsQueue(e.mediaType,_,T)}function h(e){e.sender===s&&(_.splice(_.indexOf(e.request),1),e.response&&!e.error&&T.push(e.request),v(e.request,e.error?E:N),a.trigger(n.default.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}))}function q(e){e.sender===s&&a.trigger(n.default.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this})}function L(e){e.sender===s&&a.trigger(n.default.FRAGMENT_LOADING_ABANDONED,{streamProcessor:this.getStreamProcessor(),request:e.request,mediaType:e.mediaType})}function M(){T=[],_=[]}return o={setStreamProcessor:function(e){l=e},getStreamProcessor:function(){return l},getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],r=[];return t.forEach(function(t){var n=function(e){var t=void 0;switch(e){case c:t=_;break;case N:t=T;break;default:t=[]}return t}(t);r=r.concat(function(e,t){return t.hasOwnProperty("time")?[D(e,t.time,t.threshold)]:e.filter(function(e){for(var r in t)if("state"!==r&&t.hasOwnProperty(r)&&e[r]!=t[r])return!1;return!0})}(n,e))}),r},isFragmentLoaded:A,isFragmentLoadedOrPending:function(e){var t=!1,r=0,n=void 0;if(!(t=A(e)))for(r=0;r<_.length;r++)n=_[r],e.url===n.url&&e.startTime===n.startTime&&(t=!0);return t},removeExecutedRequestsBeforeTime:g,removeExecutedRequestsAfterTime:function(e){T=T.filter(function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<e})},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var r=0,n=0,a=e.length;n<a;n++)m(r,e.start(n)),r=e.end(n);t>0&&m(r,t)}else g()},abortRequests:function(){s.abort(),_=[]},executeRequest:function(e){switch(e.action){case u.default.ACTION_COMPLETE:T.push(e),v(e,N),f.debug("executeRequest trigger STREAM_COMPLETED"),a.trigger(n.default.STREAM_COMPLETED,{request:e,fragmentModel:this});break;case u.default.ACTION_DOWNLOAD:v(e,c),_.push(e),function(e){a.trigger(n.default.FRAGMENT_LOADING_STARTED,{sender:o,request:e}),s.load(e)}(e);break;default:f.warn("Unknown request action.")}},reset:function(){a.off(n.default.LOADING_COMPLETED,h,this),a.off(n.default.LOADING_DATA_PROGRESS,q,this),a.off(n.default.LOADING_ABANDONED,L,this),s&&s.reset(),M()},addExecutedRequest:function(e){T.push(e)}},f=(0,d.default)(r).getInstance().getLogger(o),M(),a.on(n.default.LOADING_COMPLETED,h,o),a.on(n.default.LOADING_DATA_PROGRESS,q,o),a.on(n.default.LOADING_ABANDONED,L,o),o}T.__dashjs_factory_name="FragmentModel";var _=i.default.getClassFactory(T);_.FRAGMENT_MODEL_LOADING=c,_.FRAGMENT_MODEL_EXECUTED=N,_.FRAGMENT_MODEL_CANCELED=l,_.FRAGMENT_MODEL_FAILED=E,i.default.updateClassFactory(T.__dashjs_factory_name,_),exports.default=_;
},{"../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../vo/FragmentRequest":"Vb3t","../../core/Debug":"iL1O"}],"gyaG":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(n,s,a){t(this,e),this.code=n||null,this.message=s||null,this.data=a||null};exports.default=e;
},{}],"r8R8":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1};exports.default=e;
},{}],"gcNw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,s){for(var t=0;t<s.length;t++){var i=s[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(s,t,i){return t&&e(s.prototype,t),i&&e(s,i),s}}();function s(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}var t=function(){function t(e){if(s(this,t),this.offset=e._offset,this.type=e.type,this.size=e.size,this.boxes=[],e.boxes)for(var i=0;i<e.boxes.length;i++)this.boxes.push(new t(e.boxes[i]));switch(this.isComplete=!0,e.type){case"sidx":if(this.timescale=e.timescale,this.earliest_presentation_time=e.earliest_presentation_time,this.first_offset=e.first_offset,this.references=e.references,e.references){this.references=[];for(var a=0;a<e.references.length;a++){var r={reference_type:e.references[a].reference_type,referenced_size:e.references[a].referenced_size,subsegment_duration:e.references[a].subsegment_duration};this.references.push(r)}}break;case"emsg":this.id=e.id,this.value=e.value,this.timescale=e.timescale,this.scheme_id_uri=e.scheme_id_uri,this.presentation_time_delta=1===e.version?e.presentation_time:e.presentation_time_delta,this.event_duration=e.event_duration,this.message_data=e.message_data;break;case"mdhd":this.timescale=e.timescale;break;case"mfhd":this.sequence_number=e.sequence_number;break;case"subs":this.entry_count=e.entry_count,this.entries=e.entries;break;case"tfhd":this.base_data_offset=e.base_data_offset,this.sample_description_index=e.sample_description_index,this.default_sample_duration=e.default_sample_duration,this.default_sample_size=e.default_sample_size,this.default_sample_flags=e.default_sample_flags,this.flags=e.flags;break;case"tfdt":this.version=e.version,this.baseMediaDecodeTime=e.baseMediaDecodeTime,this.flags=e.flags;break;case"trun":if(this.sample_count=e.sample_count,this.first_sample_flags=e.first_sample_flags,this.data_offset=e.data_offset,this.flags=e.flags,this.samples=e.samples,e.samples){this.samples=[];for(var n=0,f=e.samples.length;n<f;n++){var o={sample_size:e.samples[n].sample_size,sample_duration:e.samples[n].sample_duration,sample_composition_time_offset:e.samples[n].sample_composition_time_offset};this.samples.push(o)}}}}return e(t,[{key:"getChildBox",value:function(e){for(var s=0;s<this.boxes.length;s++)if(this.boxes[s].type===e)return this.boxes[s]}},{key:"getChildBoxes",value:function(e){for(var s=[],t=0;t<this.boxes.length;t++)this.boxes[t].type===e&&s.push(this.boxes[t]);return s}}]),t}();exports.default=t;
},{}],"Zh34":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../vo/IsoBox"),t=o(e),n=require("../../core/FactoryMaker"),r=o(n);function o(e){return e&&e.__esModule?e:{default:e}}function u(){var e=void 0;function n(t){var n=[];if(!t||!e||"function"!=typeof e.fetchAll)return n;for(var o=e.fetchAll(t),u=void 0,l=0,f=o.length;l<f;l++)(u=r(o[l]))&&n.push(u);return n}function r(e){if(!e)return null;var n=new t.default(e);return e.hasOwnProperty("_incomplete")&&(n.isComplete=!e._incomplete),n}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"==typeof e.fetch?r(e.fetch(t)):null},getBoxes:n,setData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var t=n(e.boxes[e.boxes.length-1].type);return t.length>0?t[t.length-1]:null}}}u.__dashjs_factory_name="IsoFile",exports.default=r.default.getClassFactory(u);
},{"../vo/IsoBox":"gcNw","../../core/FactoryMaker":"FHM8"}],"tss1":[function(require,module,exports) {
var t={parseBuffer:function(t){return new e(t).parse()},addBoxProcessor:function(t,e){"string"==typeof t&&"function"==typeof e&&(i.prototype._boxProcessors[t]=e)},createFile:function(){return new e},createBox:function(t,e,s){var r=i.create(t);return e&&e.append(r,s),r},createFullBox:function(e,i,s){var r=t.createBox(e,i,s);return r.version=0,r.flags=0,r},Utils:{}};t.Utils.dataViewToString=function(t,e){var i=e||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(i).decode(t);var s=[],r=0;if("utf-8"===i)for(;r<t.byteLength;){var o=t.getUint8(r++);o<128||(o<224?(o=(31&o)<<6,o|=63&t.getUint8(r++)):o<240?(o=(15&o)<<12,o|=(63&t.getUint8(r++))<<6,o|=63&t.getUint8(r++)):(o=(7&o)<<18,o|=(63&t.getUint8(r++))<<12,o|=(63&t.getUint8(r++))<<6,o|=63&t.getUint8(r++))),s.push(String.fromCharCode(o))}else for(;r<t.byteLength;)s.push(String.fromCharCode(t.getUint8(r++)));return s.join("")},t.Utils.utf8ToByteArray=function(t){var e,i;if("undefined"!=typeof TextEncoder)e=(new TextEncoder).encode(t);else for(e=[],i=0;i<t.length;++i){var s=t.charCodeAt(i);s<128?e.push(s):s<2048?(e.push(192|s>>6),e.push(128|63&s)):s<65536?(e.push(224|s>>12),e.push(128|63&s>>6),e.push(128|63&s)):(e.push(240|s>>18),e.push(128|63&s>>12),e.push(128|63&s>>6),e.push(128|63&s))}return e},t.Utils.appendBox=function(t,e,i){if(e._offset=t._cursor.offset,e._root=t._root?t._root:t,e._raw=t._raw,e._parent=t,-1!==i)if(null!=i){var s,r=-1;if("number"==typeof i)r=i;else{if("string"==typeof i)s=i;else{if("object"!=typeof i||!i.type)return void t.boxes.push(e);s=i.type}for(var o=0;o<t.boxes.length;o++)if(s===t.boxes[o].type){r=o+1;break}}t.boxes.splice(r,0,e)}else t.boxes.push(e)},"undefined"!=typeof exports&&(exports.parseBuffer=t.parseBuffer,exports.addBoxProcessor=t.addBoxProcessor,exports.createFile=t.createFile,exports.createBox=t.createBox,exports.createFullBox=t.createFullBox,exports.Utils=t.Utils),t.Cursor=function(t){this.offset=void 0===t?0:t};var e=function(e){this._cursor=new t.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};e.prototype.fetch=function(t){var e=this.fetchAll(t,!0);return e.length?e[0]:null},e.prototype.fetchAll=function(t,i){var s=[];return e._sweep.call(this,t,s,i),s},e.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var t=i.parse(this);if(void 0===t.type)break;this.boxes.push(t)}return this},e._sweep=function(t,i,s){for(var r in this.type&&this.type==t&&i.push(this),this.boxes){if(i.length&&s)return;e._sweep.call(this.boxes[r],t,i,s)}},e.prototype.write=function(){var t,e=0;for(t=0;t<this.boxes.length;t++)e+=this.boxes[t].getLength(!1);var i=new Uint8Array(e);for(this._rawo=new DataView(i.buffer),this.bytes=i,this._cursor.offset=0,t=0;t<this.boxes.length;t++)this.boxes[t].write();return i.buffer},e.prototype.append=function(e,i){t.Utils.appendBox(this,e,i)};var i=function(){this._cursor=new t.Cursor};i.parse=function(t){var e=new i;return e._offset=t._cursor.offset,e._root=t._root?t._root:t,e._raw=t._raw,e._parent=t,e._parseBox(),t._cursor.offset=e._raw.byteOffset+e._raw.byteLength,e},i.create=function(t){var e=new i;return e.type=t,e.boxes=[],e},i.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],i.prototype._boxProcessors={},i.prototype._procField=function(t,e,i){this._parsing?this[t]=this._readField(e,i):this._writeField(e,i,this[t])},i.prototype._procFieldArray=function(t,e,i,s){var r;if(this._parsing)for(this[t]=[],r=0;r<e;r++)this[t][r]=this._readField(i,s);else for(r=0;r<this[t].length;r++)this._writeField(i,s,this[t][r])},i.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},i.prototype._procEntries=function(t,e,i){var s;if(this._parsing)for(this[t]=[],s=0;s<e;s++)this[t].push({}),i.call(this,this[t][s]);else for(s=0;s<e;s++)i.call(this,this[t][s])},i.prototype._procSubEntries=function(t,e,i,s){var r;if(this._parsing)for(t[e]=[],r=0;r<i;r++)t[e].push({}),s.call(this,t[e][r]);else for(r=0;r<i;r++)s.call(this,t[e][r])},i.prototype._procEntryField=function(t,e,i,s){this._parsing?t[e]=this._readField(i,s):this._writeField(i,s,t[e])},i.prototype._procSubBoxes=function(t,e){var s;if(this._parsing)for(this[t]=[],s=0;s<e;s++)this[t].push(i.parse(this));else for(s=0;s<e;s++)this._rawo?this[t][s].write():this.size+=this[t][s].getLength()},i.prototype._readField=function(t,e){switch(t){case"uint":return this._readUint(e);case"int":return this._readInt(e);case"template":return this._readTemplate(e);case"string":return-1===e?this._readTerminatedString():this._readString(e);case"data":return this._readData(e);case"utf8":return this._readUTF8String();default:return-1}},i.prototype._readInt=function(t){var e=null,i=this._cursor.offset-this._raw.byteOffset;switch(t){case 8:e=this._raw.getInt8(i);break;case 16:e=this._raw.getInt16(i);break;case 32:e=this._raw.getInt32(i);break;case 64:var s=this._raw.getInt32(i),r=this._raw.getInt32(i+4);e=s*Math.pow(2,32)+r}return this._cursor.offset+=t>>3,e},i.prototype._readUint=function(t){var e,i,s=null,r=this._cursor.offset-this._raw.byteOffset;switch(t){case 8:s=this._raw.getUint8(r);break;case 16:s=this._raw.getUint16(r);break;case 24:s=((e=this._raw.getUint16(r))<<8)+(i=this._raw.getUint8(r+2));break;case 32:s=this._raw.getUint32(r);break;case 64:e=this._raw.getUint32(r),i=this._raw.getUint32(r+4),s=e*Math.pow(2,32)+i}return this._cursor.offset+=t>>3,s},i.prototype._readString=function(t){for(var e="",i=0;i<t;i++){var s=this._readUint(8);e+=String.fromCharCode(s)}return e},i.prototype._readTemplate=function(t){return this._readUint(t/2)+this._readUint(t/2)/Math.pow(2,t/2)},i.prototype._readTerminatedString=function(){for(var t="";this._cursor.offset-this._offset<this._raw.byteLength;){var e=this._readUint(8);if(0===e)break;t+=String.fromCharCode(e)}return t},i.prototype._readData=function(t){var e=t>0?t:this._raw.byteLength-(this._cursor.offset-this._offset);if(e>0){var i=new Uint8Array(this._raw.buffer,this._cursor.offset,e);return this._cursor.offset+=e,i}return null},i.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),i=null;return e>0&&(i=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),i?t.Utils.dataViewToString(i):i},i.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},i.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},i.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(i.parse(this))},i.prototype.append=function(e,i){t.Utils.appendBox(this,e,i)},i.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var t=0;t<this.boxes.length;t++)this.size+=this.boxes[t].getLength();return this._data&&this._writeData(this._data),this.size},i.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var t=0;t<this.boxes.length;t++)this.boxes[t].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},i.prototype._writeInt=function(t,e){if(this._rawo){var i=this._cursor.offset-this._rawo.byteOffset;switch(t){case 8:this._rawo.setInt8(i,e);break;case 16:this._rawo.setInt16(i,e);break;case 32:this._rawo.setInt32(i,e);break;case 64:var s=Math.floor(e/Math.pow(2,32)),r=e-s*Math.pow(2,32);this._rawo.setUint32(i,s),this._rawo.setUint32(i+4,r)}this._cursor.offset+=t>>3}else this.size+=t>>3},i.prototype._writeUint=function(t,e){if(this._rawo){var i,s,r=this._cursor.offset-this._rawo.byteOffset;switch(t){case 8:this._rawo.setUint8(r,e);break;case 16:this._rawo.setUint16(r,e);break;case 24:i=(16776960&e)>>8,s=255&e,this._rawo.setUint16(r,i),this._rawo.setUint8(r+2,s);break;case 32:this._rawo.setUint32(r,e);break;case 64:s=e-(i=Math.floor(e/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(r,i),this._rawo.setUint32(r+4,s)}this._cursor.offset+=t>>3}else this.size+=t>>3},i.prototype._writeString=function(t,e){for(var i=0;i<t;i++)this._writeUint(8,e.charCodeAt(i))},i.prototype._writeTerminatedString=function(t){if(0!==t.length){for(var e=0;e<t.length;e++)this._writeUint(8,t.charCodeAt(e));this._writeUint(8,0)}},i.prototype._writeTemplate=function(t,e){var i=Math.floor(e),s=(e-i)*Math.pow(2,t/2);this._writeUint(t/2,i),this._writeUint(t/2,s)},i.prototype._writeData=function(t){if(t)if(this._rawo){if(t instanceof Array){for(var e=this._cursor.offset-this._rawo.byteOffset,i=0;i<t.length;i++)this._rawo.setInt8(e+i,t[i]);this._cursor.offset+=t.length}t instanceof Uint8Array&&(this._root.bytes.set(t,this._cursor.offset),this._cursor.offset+=t.length)}else this.size+=t.length},i.prototype._writeUTF8String=function(e){var i=t.Utils.utf8ToByteArray(e);if(this._rawo)for(var s=new DataView(this._rawo.buffer,this._cursor.offset,i.length),r=0;r<i.length;r++)s.setUint8(r,i[r]);else this.size+=i.length},i.prototype._writeField=function(t,e,i){switch(t){case"uint":this._writeUint(e,i);break;case"int":this._writeInt(e,i);break;case"template":this._writeTemplate(e,i);break;case"string":-1==e?this._writeTerminatedString(i):this._writeString(e,i);break;case"data":this._writeData(i);break;case"utf8":this._writeUTF8String(i)}},i.prototype._boxProcessors.avc1=i.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},i.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(t){this._procEntryField(t,"segment_duration","uint",1===this.version?64:32),this._procEntryField(t,"media_time","int",1===this.version?64:32),this._procEntryField(t,"media_rate_integer","int",16),this._procEntryField(t,"media_rate_fraction","int",16)})},i.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},i.prototype._boxProcessors.free=i.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},i.prototype._boxProcessors.ftyp=i.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var t=-1;this._parsing&&(t=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",t,"string",4)},i.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},i.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},i.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},i.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},i.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},i.prototype._boxProcessors.mp4a=i.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},i.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},i.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},i.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},i.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},i.prototype._boxProcessors.sdtp=function(){this._procFullBox();var t=-1;this._parsing&&(t=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",t,"uint",8)},i.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(t){this._parsing||(t.reference=(1&t.reference_type)<<31,t.reference|=2147483647&t.referenced_size,t.sap=(1&t.starts_with_SAP)<<31,t.sap|=(3&t.SAP_type)<<28,t.sap|=268435455&t.SAP_delta_time),this._procEntryField(t,"reference","uint",32),this._procEntryField(t,"subsegment_duration","uint",32),this._procEntryField(t,"sap","uint",32),this._parsing&&(t.reference_type=t.reference>>31&1,t.referenced_size=2147483647&t.reference,t.starts_with_SAP=t.sap>>31&1,t.SAP_type=t.sap>>28&7,t.SAP_delta_time=268435455&t.sap)})},i.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},i.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(t){this._procEntryField(t,"ranges_count","uint",32),this._procSubEntries(t,"ranges",t.ranges_count,function(t){this._procEntryField(t,"level","uint",8),this._procEntryField(t,"range_size","uint",24)})})},i.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(t){this._procEntryField(t,"sample_delta","uint",32),this._procEntryField(t,"subsample_count","uint",16),this._procSubEntries(t,"subsamples",t.subsample_count,function(t){this._procEntryField(t,"subsample_size","uint",1===this.version?32:16),this._procEntryField(t,"subsample_priority","uint",8),this._procEntryField(t,"discardable","uint",8),this._procEntryField(t,"codec_specific_parameters","uint",32)})})},i.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},i.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},i.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(t){this._procEntryField(t,"time","uint",1===this.version?64:32),this._procEntryField(t,"moof_offset","uint",1===this.version?64:32),this._procEntryField(t,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(t,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(t,"sample_number","uint",8*(this.length_size_of_sample_num+1))})},i.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},i.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(t){256&this.flags&&this._procEntryField(t,"sample_duration","uint",32),512&this.flags&&this._procEntryField(t,"sample_size","uint",32),1024&this.flags&&this._procEntryField(t,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(t,"sample_composition_time_offset",1===this.version?"int":"uint",32)})},i.prototype._boxProcessors["url "]=i.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},i.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},i.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},i.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},i.prototype._boxProcessors.vtte=function(){};
},{}],"DbLy":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(s,n,o){t(this,e),this.lastCompletedOffset=s,this.found=n,this.size=o};exports.default=e;
},{}],"Yc5r":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/Debug"),t=d(e),o=require("./IsoFile"),r=d(o),i=require("../../core/FactoryMaker"),a=d(i),n=require("codem-isoboxer"),s=d(n),u=require("../vo/IsoBoxSearchInfo"),f=d(u);function d(e){return e&&e.__esModule?e:{default:e}}function l(){var e=void 0,o=void 0,i=this.context;function a(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=s.default.parseBuffer(e),o=(0,r.default)(i).create();return o.setData(t),o}function n(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function u(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return o={parse:a,findLastTopIsoBoxCompleted:function(e,t,o){if(void 0===o&&(o=0),!t||o+8>=t.byteLength)return new f.default(0,!1);for(var r=t instanceof ArrayBuffer?new Uint8Array(t):t,i=void 0,a=0;o<r.byteLength;){var s=n(r,o),d=u(r,o+4);if(0===s)break;o+s<=r.byteLength&&(e.indexOf(d)>=0?i=new f.default(o,!0,s):a=o+s),o+=s}return i||new f.default(a,!1)},getMediaTimescaleFromMoov:function(e){var t=a(e),o=t?t.getBox("mdhd"):void 0;return o?o.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,o,r=a(e),i=r.getBoxes("moof"),n=r.getBoxes("mfhd"),s=void 0,u=void 0,f=void 0,d=void 0,l=void 0,m=void 0,v=void 0,g=void 0,c=void 0,_=void 0,p=void 0,h=void 0,b=void 0,x=void 0;o=r.getBoxes("moof").length,t=n[n.length-1].sequence_number,u=0,l=[];var S=-1,B=-1;for(_=0;_<i.length;_++){var C=i[_],y=C.getChildBoxes("traf");for(g=0;g<y.length;g++){var z=y[g],q=z.getChildBox("tfhd"),N=z.getChildBox("tfdt");d=N.baseMediaDecodeTime;var L=z.getChildBoxes("trun"),I=z.getChildBoxes("subs");for(c=0;c<L.length;c++){var M=L[c];for(u=M.sample_count,b=(q.base_data_offset||0)+(M.data_offset||0),v=0;v<u;v++){s=void 0!==(m=M.samples[v]).sample_duration?m.sample_duration:q.default_sample_duration,f=void 0!==m.sample_size?m.sample_size:q.default_sample_size;var D={dts:d,cts:d+(void 0!==m.sample_composition_time_offset?m.sample_composition_time_offset:0),duration:s,offset:C.offset+b,size:f,subSizes:[f]};if(I)for(p=0;p<I.length;p++){var F=I[p];if(S<F.entry_count-1&&v>B&&(S++,B+=F.entries[S].sample_delta),v==B){D.subSizes=[];var w=F.entries[S];for(h=0;h<w.subsample_count;h++)D.subSizes.push(w.subsamples[h].subsample_size)}}l.push(D),b+=f,d+=s}}x=d-N.baseMediaDecodeTime}}return{sampleList:l,lastSequenceNumber:t,totalDuration:x,numSequences:o}},findInitRange:function(t){var o=null,r=a(t);if(!r)return o;var i=r.getBox("ftyp"),n=r.getBox("moov");return e.debug("Searching for initialization."),n&&n.isComplete&&(o=(i?i.offset:n.offset)+"-"+(n.offset+n.size-1),e.debug("Found the initialization.  Range: "+o)),o}},e=(0,t.default)(i).getInstance().getLogger(o),o}l.__dashjs_factory_name="BoxParser",exports.default=a.default.getSingletonFactory(l);
},{"../../core/Debug":"iL1O","./IsoFile":"Zh34","../../core/FactoryMaker":"FHM8","codem-isoboxer":"tss1","../vo/IsoBoxSearchInfo":"DbLy"}],"A0aa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};exports.checkParameterType=r,exports.checkInteger=u,exports.checkRange=f,exports.checkIsVideoOrAudioType=i;var e=require("../constants/Constants"),o=n(e);function n(t){return t&&t.__esModule?t:{default:t}}function r(e,n){if((void 0===e?"undefined":t(e))!==n)throw o.default.BAD_ARGUMENT_ERROR}function u(t){if(!(null!==t&&!isNaN(t)&&t%1==0))throw o.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"}function f(t,e,n){if(t<e||t>n)throw o.default.BAD_ARGUMENT_ERROR+" : argument out of range"}function i(t){if("string"!=typeof t||t!==o.default.AUDIO&&t!==o.default.VIDEO)throw o.default.BAD_ARGUMENT_ERROR}
},{"../constants/Constants":"jJgo"}],"j59Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=s(e),r=require("../utils/SupervisorTools");function s(e){return e&&e.__esModule?e:{default:e}}function a(){return{customTimeRangeArray:[],length:0,add:function(e,t){var r=0;for(r=0;r<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[r].start;r++);for(this.customTimeRangeArray.splice(r,0,{start:e,end:t}),r=0;r<this.customTimeRangeArray.length-1;r++)this.mergeRanges(r,r+1)&&r--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var r=0;r<this.customTimeRangeArray.length;r++)if(e<=this.customTimeRangeArray[r].start&&t>=this.customTimeRangeArray[r].end)this.customTimeRangeArray.splice(r,1),r--;else{if(e>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end){this.customTimeRangeArray.splice(r+1,0,{start:t,end:this.customTimeRangeArray[r].end}),this.customTimeRangeArray[r].end=e;break}e>this.customTimeRangeArray[r].start&&e<this.customTimeRangeArray[r].end?this.customTimeRangeArray[r].end=e:t>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end&&(this.customTimeRangeArray[r].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var r=this.customTimeRangeArray[e],s=this.customTimeRangeArray[t];return r.start<=s.start&&s.start<=r.end&&r.end<=s.end?(r.end=s.end,this.customTimeRangeArray.splice(t,1),!0):s.start<=r.start&&r.start<=s.end&&s.end<=r.end?(r.start=s.start,this.customTimeRangeArray.splice(t,1),!0):s.start<=r.start&&r.start<=s.end&&r.end<=s.end?(this.customTimeRangeArray.splice(e,1),!0):r.start<=s.start&&s.start<=r.end&&s.end<=r.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,r.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,r.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}a.__dashjs_factory_name="CustomTimeRanges",exports.default=t.default.getClassFactory(a);
},{"../../core/FactoryMaker":"FHM8","../utils/SupervisorTools":"A0aa"}],"H9JC":[function(require,module,exports) {
!function(t){t.ns_tt="http://www.w3.org/ns/ttml",t.ns_tts="http://www.w3.org/ns/ttml#styling",t.ns_ttp="http://www.w3.org/ns/ttml#parameter",t.ns_xml="http://www.w3.org/XML/1998/namespace",t.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",t.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",t.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",t.ns_ebutts="urn:ebu:tt:style"}("undefined"==typeof exports?this.imscNames={}:exports);
},{}],"XcJY":[function(require,module,exports) {
!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,n=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,l={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var u,s=null,o=l[e.toLowerCase()];return void 0!==o?s=o:null!==(u=t.exec(e))?s=[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16),void 0!==u[4]?parseInt(u[4],16):255]:null!==(u=n.exec(e))?s=[parseInt(u[1]),parseInt(u[2]),parseInt(u[3]),255]:null!==(u=r.exec(e))&&(s=[parseInt(u[1]),parseInt(u[2]),parseInt(u[3]),parseInt(u[4])]),s};var u=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(e){var t,n=null;return null!==(t=u.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n},e.parseTextShadow=function(t){var n=t.split(","),r=[];for(var l in n){var u=n[l].split(" ");if(1===u.length&&"none"===u[0])return"none";if(u.length>1&&u.length<5){var s=[null,null,null,null],o=e.parseLength(u.shift());if(null===o)return null;if(s[0]=o,null===(o=e.parseLength(u.shift())))return null;if(s[1]=o,0===u.length){r.push(s);continue}if(null!==(o=e.parseLength(u[0]))&&(s[2]=o,u.shift()),0===u.length){r.push(s);continue}var a=e.parseColor(u[0]);if(null===a)return null;s[3]=a,r.push(s)}}return r},e.parsePosition=function(t){var n=t.split(" "),r=function(e){return"center"===e||"left"===e||"top"===e||"bottom"===e||"right"===e};if(n.length>4)return null;for(var l in n)if(!r(n[l])){var u=e.parseLength(n[l]);if(null===u)return null;n[l]=u}for(var s={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},o=0;o<n.length;){var a=n[o++];if(r(a)){var h={value:0,unit:"%"};2!==n.length&&o<n.length&&!r(n[o])&&(h=n[o++]),"right"===a?(s.h.edge=a,s.h.offset=h):"bottom"===a?(s.v.edge=a,s.v.offset=h):"left"===a?s.h.offset=h:"top"===a&&(s.v.offset=h)}else{if(1!==n.length&&2!==n.length)return null;1===o?s.h.offset=a:s.v.offset=a}}return s},e.ComputedLength=function(e,t){this.rw=e,this.rh=t},e.ComputedLength.prototype.toUsedLength=function(e,t){return e*this.rw+t*this.rh},e.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh},e.toComputedLength=function(t,n,r,l,u,s){return"%"===n&&l?new e.ComputedLength(l.rw*t/100,l.rh*t/100):"em"===n&&r?new e.ComputedLength(r.rw*t,r.rh*t):"c"===n&&u?new e.ComputedLength(t*u.rw,t*u.rh):"px"===n&&s?new e.ComputedLength(t*s.rw,t*s.rh):"rh"===n?new e.ComputedLength(0,t/100):"rw"===n?new e.ComputedLength(t/100,0):null}}("undefined"==typeof exports?this.imscUtils={}:exports);
},{}],"o3uR":[function(require,module,exports) {
!function(n,t,e){function l(n,t,e,l,r,u,s,i){this.name=t,this.ns=n,this.qname=n+" "+t,this.inherit=r,this.animatable=u,this.initial=e,this.applies=l,this.parse=s,this.compute=i}for(var r in n.all=[new l(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,e.parseColor,null),new l(t.ns_tts,"color","white",["span"],!0,!0,e.parseColor,null),new l(t.ns_tts,"direction","ltr",["p","span"],!0,!0,function(n){return n},null),new l(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(n){return n},null),new l(t.ns_tts,"displayAlign","before",["region"],!1,!0,function(n){return n},null),new l(t.ns_tts,"extent","auto",["tt","region"],!1,!0,function(n){if("auto"===n)return n;var t=n.split(" ");if(2!==t.length)return null;var l=e.parseLength(t[0]),r=e.parseLength(t[1]);return r&&l?{h:r,w:l}:null},function(n,t,l,r,u){var s,i;if("auto"===r)s=new e.ComputedLength(0,1);else if(null===(s=e.toComputedLength(r.h.value,r.h.unit,null,n.dimensions.h,null,n.pxLength.h)))return null;if("auto"===r)i=new e.ComputedLength(1,0);else if(null===(i=e.toComputedLength(r.w.value,r.w.unit,null,n.dimensions.w,null,n.pxLength.w)))return null;return{h:s,w:i}}),new l(t.ns_tts,"fontFamily","default",["span"],!0,!0,function(n){var t=n.split(","),e=[];for(var l in t)"'"!==t[l].charAt(0)&&'"'!==t[l].charAt(0)&&"default"===t[l]?e.push("monospaceSerif"):e.push(t[l]);return e},null),new l(t.ns_tts,"shear","0%",["p"],!0,!0,e.parseLength,function(n,t,e,l){return"%"!==l.unit?null:Math.abs(l.value)>100?100*Math.sign(l.value):l.value}),new l(t.ns_tts,"fontSize","1c",["span"],!0,!0,e.parseLength,function(t,l,r,u,s){return e.toComputedLength(u.value,u.unit,null!==l?l.styleAttrs[n.byName.fontSize.qname]:t.cellLength.h,null!==l?l.styleAttrs[n.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h)}),new l(t.ns_tts,"fontStyle","normal",["span"],!0,!0,function(n){return n},null),new l(t.ns_tts,"fontWeight","normal",["span"],!0,!0,function(n){return n},null),new l(t.ns_tts,"lineHeight","normal",["p"],!0,!0,function(n){return"normal"===n?n:e.parseLength(n)},function(t,l,r,u,s){var i;if("normal"===u)i=u;else if(null===(i=e.toComputedLength(u.value,u.unit,r.styleAttrs[n.byName.fontSize.qname],r.styleAttrs[n.byName.fontSize.qname],t.cellLength.h,t.pxLength.h)))return null;return i}),new l(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new l(t.ns_tts,"origin","auto",["region"],!1,!0,function(n){if("auto"===n)return n;var t=n.split(" ");if(2!==t.length)return null;var l=e.parseLength(t[0]),r=e.parseLength(t[1]);return r&&l?{h:r,w:l}:null},function(n,t,l,r,u){var s,i;if("auto"===r)s=new e.ComputedLength(0,0);else if(null===(s=e.toComputedLength(r.h.value,r.h.unit,null,n.dimensions.h,null,n.pxLength.h)))return null;if("auto"===r)i=new e.ComputedLength(0,0);else if(null===(i=e.toComputedLength(r.w.value,r.w.unit,null,n.dimensions.w,null,n.pxLength.w)))return null;return{h:s,w:i}}),new l(t.ns_tts,"overflow","hidden",["region"],!1,!0,function(n){return n},null),new l(t.ns_tts,"padding","0px",["region"],!1,!0,function(n){var t=n.split(" ");if(t.length>4)return null;var l=[];for(var r in t){var u=e.parseLength(t[r]);if(!u)return null;l.push(u)}return l},function(t,l,r,u,s){var i;if(1===u.length)i=[u[0],u[0],u[0],u[0]];else if(2===u.length)i=[u[0],u[1],u[0],u[1]];else if(3===u.length)i=[u[0],u[1],u[2],u[1]];else{if(4!==u.length)return null;i=[u[0],u[1],u[2],u[3]]}var o=r.styleAttrs[n.byName.writingMode.qname];if("lrtb"===o||"lr"===o)i=[i[0],i[3],i[2],i[1]];else if("rltb"===o||"rl"===o)i=[i[0],i[1],i[2],i[3]];else if("tblr"===o)i=[i[3],i[0],i[1],i[2]];else{if("tbrl"!==o&&"tb"!==o)return null;i=[i[3],i[2],i[1],i[0]]}var a=[];for(var h in i)if(0===i[h].value)a[h]=new e.ComputedLength(0,0);else if(a[h]=e.toComputedLength(i[h].value,i[h].unit,r.styleAttrs[n.byName.fontSize.qname],"0"===h||"2"===h?r.styleAttrs[n.byName.extent.qname].h:r.styleAttrs[n.byName.extent.qname].w,"0"===h||"2"===h?t.cellLength.h:t.cellLength.w,"0"===h||"2"===h?t.pxLength.h:t.pxLength.w),null===a[h])return null;return a}),new l(t.ns_tts,"position","top left",["region"],!1,!0,function(n){return e.parsePosition(n)},function(t,l,r,u){var s,i;return null===(s=e.toComputedLength(u.v.offset.value,u.v.offset.unit,null,new e.ComputedLength(-r.styleAttrs[n.byName.extent.qname].h.rw,t.dimensions.h.rh-r.styleAttrs[n.byName.extent.qname].h.rh),null,t.pxLength.h))?null:("bottom"===u.v.edge&&(s=new e.ComputedLength(-s.rw-r.styleAttrs[n.byName.extent.qname].h.rw,t.dimensions.h.rh-s.rh-r.styleAttrs[n.byName.extent.qname].h.rh)),i=e.toComputedLength(u.h.offset.value,u.h.offset.unit,null,new e.ComputedLength(t.dimensions.w.rw-r.styleAttrs[n.byName.extent.qname].w.rw,-r.styleAttrs[n.byName.extent.qname].w.rh),null,t.pxLength.w),null===s?null:("right"===u.h.edge&&(i=new e.ComputedLength(t.dimensions.w.rw-i.rw-r.styleAttrs[n.byName.extent.qname].w.rw,-i.rh-r.styleAttrs[n.byName.extent.qname].w.rh)),{h:s,w:i}))}),new l(t.ns_tts,"ruby","none",["span"],!1,!0,function(n){return n},null),new l(t.ns_tts,"rubyAlign","center",["span"],!0,!0,function(n){return"center"!==n&&"spaceAround"!==n?null:n},null),new l(t.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(n){return n},null),new l(t.ns_tts,"rubyReserve","none",["p"],!0,!0,function(n){var t=n.split(" "),l=[null,null];if(0===t.length||t.length>2)return null;if("none"!==t[0]&&"both"!==t[0]&&"after"!==t[0]&&"before"!==t[0]&&"outside"!==t[0])return null;if(l[0]=t[0],2===t.length&&"none"!==t[0]){var r=e.parseLength(t[1]);if(!r)return null;l[1]=r}return l},function(t,l,r,u,s){if("none"===u[0])return u;var i=null;return null===(i=null===u[1]?new e.ComputedLength(.5*r.styleAttrs[n.byName.fontSize.qname].rw,.5*r.styleAttrs[n.byName.fontSize.qname].rh):e.toComputedLength(u[1].value,u[1].unit,r.styleAttrs[n.byName.fontSize.qname],r.styleAttrs[n.byName.fontSize.qname],t.cellLength.h,t.pxLength.h))?null:[u[0],i]}),new l(t.ns_tts,"showBackground","always",["region"],!1,!0,function(n){return n},null),new l(t.ns_tts,"textAlign","start",["p"],!0,!0,function(n){return n},function(n,t,e,l,r){return"left"===l?"start":"right"===l?"end":l}),new l(t.ns_tts,"textCombine","none",["span"],!0,!0,function(n){var t=n.split(" ");return 1!==t.length||"none"!==t[0]&&"all"!==t[0]?null:[t[0]]},null),new l(t.ns_tts,"textDecoration","none",["span"],!0,!0,function(n){return n.split(" ")},null),new l(t.ns_tts,"textEmphasis","none",["span"],!0,!0,function(n){var t=n.split(" "),l={style:null,symbol:null,color:null,position:null};for(var r in t)if("none"===t[r]||"auto"===t[r])l.style=t[r];else if("filled"===t[r]||"open"===t[r])l.style=t[r];else if("circle"===t[r]||"dot"===t[r]||"sesame"===t[r])l.symbol=t[r];else if("current"===t[r])l.color=t[r];else if("outside"===t[r]||"before"===t[r]||"after"===t[r])l.position=t[r];else if(l.color=e.parseColor(t[r]),null===l.color)return null;return null==l.style&&null==l.symbol?l.style="auto":(l.symbol=l.symbol||"circle",l.style=l.style||"filled"),l.position=l.position||"outside",l.color=l.color||"current",l},null),new l(t.ns_tts,"textOutline","none",["span"],!0,!0,function(n){if("none"===n)return n;var t={},l=n.split(" ");if(0===l.length||l.length>2)return null;var r=e.parseColor(l[0]);if(t.color=r,null!==r&&l.shift(),1!==l.length)return null;var u=e.parseLength(l[0]);return u?(t.thickness=u,t):null},function(t,l,r,u,s){if("none"===u)return u;var i={};return null===u.color?i.color=r.styleAttrs[n.byName.color.qname]:i.color=u.color,i.thickness=e.toComputedLength(u.thickness.value,u.thickness.unit,r.styleAttrs[n.byName.fontSize.qname],r.styleAttrs[n.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),null===i.thickness?null:i}),new l(t.ns_tts,"textShadow","none",["span"],!0,!0,e.parseTextShadow,function(t,l,r,u){if("none"===u)return u;var s=[];for(var i in u){var o={};if(o.x_off=e.toComputedLength(u[i][0].value,u[i][0].unit,null,r.styleAttrs[n.byName.fontSize.qname],null,t.pxLength.w),null===o.x_off)return null;if(o.y_off=e.toComputedLength(u[i][1].value,u[i][1].unit,null,r.styleAttrs[n.byName.fontSize.qname],null,t.pxLength.h),null===o.y_off)return null;if(null===u[i][2])o.b_radius=0;else if(o.b_radius=e.toComputedLength(u[i][2].value,u[i][2].unit,null,r.styleAttrs[n.byName.fontSize.qname],null,t.pxLength.h),null===o.b_radius)return null;null===u[i][3]?o.color=r.styleAttrs[n.byName.color.qname]:o.color=u[i][3],s.push(o)}return s}),new l(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(n){return n},null),new l(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(n){return n},null),new l(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(n){return n},null),new l(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(n){return n},null),new l(t.ns_tts,"zIndex","auto",["region"],!1,!0,function(n){var t;return"auto"===n?t=n:(t=parseInt(n),isNaN(t)&&(t=null)),t},null),new l(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,e.parseLength,function(n,t,l,r,u){return e.toComputedLength(r.value,r.unit,null,null,n.cellLength.w,null)}),new l(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(n){return n},null),new l(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(n){return n},null),new l(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(n){return"true"===n},null),new l(t.ns_itts,"fillLineGap","false",["p"],!0,!0,function(n){return"true"===n},null)],n.byQName={},n.all)n.byQName[n.all[r].qname]=n.all[r];for(var u in n.byName={},n.all)n.byName[n.all[u].name]=n.all[u]}("undefined"==typeof exports?this.imscStyles={}:exports,"undefined"==typeof imscNames?require("./names"):imscNames,"undefined"==typeof imscUtils?require("./utils"):imscUtils);
},{"./names":"H9JC","./utils":"XcJY"}],"f3iw":[function(require,module,exports) {
!function(e,t,n,i){e.generateISD=function(e,t,n){var i=new a(e),r={};for(var l in e.head.layout.regions){var o=s(e,t,e.head.layout.regions[l],e.body,null,"",e.head.layout.regions[l],n,r);null!==o&&i.contents.push(o.element)}return i};var r=[n.byName.color.qname,n.byName.textCombine.qname,n.byName.textDecoration.qname,n.byName.textEmphasis.qname,n.byName.textOutline.qname,n.byName.textShadow.qname];function s(e,t,a,m,y,f,d,u,c){if(t<d.begin||t>=d.end)return null;var b="regionID"in d&&""!==d.regionID?d.regionID:f;if(null!==y&&b!==a.id&&(!("contents"in d)||"contents"in d&&0===d.contents.length||""!==b))return null;var q=new l(d);for(var h in d.sets)t<d.sets[h].begin||t>=d.sets[h].end||(q.styleAttrs[d.sets[h].qname]=d.sets[h].value);var p,g={};for(var v in q.styleAttrs)if(g[v]=!0,v===n.byName.writingMode.qname&&!(n.byName.direction.qname in q.styleAttrs)){var x=q.styleAttrs[v];"lrtb"===x||"lr"===x?q.styleAttrs[n.byName.direction.qname]="ltr":"rltb"!==x&&"rl"!==x||(q.styleAttrs[n.byName.direction.qname]="rtl")}if(null!==y)for(var A in n.all){var N=n.all[A];if(N.qname===n.byName.textDecoration.qname){var k=y.styleAttrs[N.qname],O=q.styleAttrs[N.qname],w=[];void 0===O?w=k:-1===O.indexOf("none")?((-1===O.indexOf("noUnderline")&&-1!==k.indexOf("underline")||-1!==O.indexOf("underline"))&&w.push("underline"),(-1===O.indexOf("noLineThrough")&&-1!==k.indexOf("lineThrough")||-1!==O.indexOf("lineThrough"))&&w.push("lineThrough"),(-1===O.indexOf("noOverline")&&-1!==k.indexOf("overline")||-1!==O.indexOf("overline"))&&w.push("overline")):w.push("none"),q.styleAttrs[N.qname]=w}else if(N.qname!==n.byName.fontSize.qname||N.qname in q.styleAttrs||"span"!==q.kind||"textContainer"!==q.styleAttrs[n.byName.ruby.qname])if(N.qname!==n.byName.fontSize.qname||N.qname in q.styleAttrs||"span"!==q.kind||"text"!==q.styleAttrs[n.byName.ruby.qname])N.inherit&&N.qname in y.styleAttrs&&!(N.qname in q.styleAttrs)&&(q.styleAttrs[N.qname]=y.styleAttrs[N.qname]);else{var S=y.styleAttrs[n.byName.fontSize.qname];"textContainer"===y.styleAttrs[n.byName.ruby.qname]?q.styleAttrs[N.qname]=S:q.styleAttrs[N.qname]=new i.ComputedLength(.5*S.rw,.5*S.rh)}else{var _=y.styleAttrs[n.byName.fontSize.qname];q.styleAttrs[N.qname]=new i.ComputedLength(.5*_.rw,.5*_.rh)}}for(var C in n.all){var D=n.all[C];if(!(D.qname in q.styleAttrs)&&!(D.qname===n.byName.position.qname&&n.byName.origin.qname in q.styleAttrs||D.qname===n.byName.origin.qname&&n.byName.position.qname in q.styleAttrs)){var I=e.head.styling.initials[D.qname]||D.initial;("region"===q.kind||!1===D.inherit&&null!==I)&&(q.styleAttrs[D.qname]=D.parse(I),g[D.qname]=!0)}}for(var z in n.all){var T=n.all[z];if(T.qname in g&&null!==T.compute){var L=T.compute(e,y,q,q.styleAttrs[T.qname],c);null!==L?q.styleAttrs[T.qname]=L:(q.styleAttrs[T.qname]=T.compute(e,y,q,T.parse(T.initial),c),o(u,"Style '"+T.qname+"' on element '"+q.kind+"' cannot be computed"))}}if("none"===q.styleAttrs[n.byName.display.qname])return null;for(var U in null===y?p=null===m?[]:[m]:"contents"in d&&(p=d.contents),p){var R=s(e,t,a,m,q,b,p[U],u,c);null!==R&&q.contents.push(R.element)}for(var B in q.styleAttrs){var E=!1;if("span"===q.kind){var M=q.styleAttrs[n.byName.ruby.qname];(E=("container"===M||"textContainer"===M||"baseContainer"===M)&&-1!==r.indexOf(B))||(E="container"!==M&&B===n.byName.rubyAlign.qname),E||(E=!("textContainer"===M||"text"===M)&&B===n.byName.rubyPosition.qname)}if(!E)E=-1===n.byQName[B].applies.indexOf(q.kind);E&&delete q.styleAttrs[B]}if("span"===q.kind&&q.text&&"default"===q.space){var P=q.text.replace(/[\t\r\n ]+/g," ");q.text=P}if("p"===q.kind){var Q=[];!function e(t,n){if("contents"in t)for(var i in t.contents)e(t.contents[i],n);else"span"!==t.kind&&"br"!==t.kind||n.push(t)}(q,Q);for(var $=0,j="after_br",F=0;;)if("after_br"===j)$>=Q.length||"br"===Q[$].kind?(j="before_br",F=$,$--):("preserve"!==Q[$].space&&(Q[$].text=Q[$].text.replace(/^[\t\r\n ]+/g,"")),Q[$].text.length>0?(j="looking_br",$++):Q.splice($,1));else if("before_br"===j)if($<0||"br"===Q[$].kind){if(j="after_br",($=F+1)>=Q.length)break}else if("preserve"!==Q[$].space&&(Q[$].text=Q[$].text.replace(/[\t\r\n ]+$/g,"")),Q[$].text.length>0){if(j="after_br",($=F+1)>=Q.length)break}else Q.splice($,1),$--;else $>=Q.length||"br"===Q[$].kind?(j="before_br",F=$,$--):$++;!function e(t){if("br"===t.kind)return!1;if("text"in t)return 0===t.text.length;if("contents"in t){for(var n=t.contents.length;n--;)e(t.contents[n])&&t.contents.splice(n,1);return 0===t.contents.length}}(q)}return"div"===q.kind&&n.byName.backgroundImage.qname in q.styleAttrs||"br"===q.kind||"image"===q.kind||"contents"in q&&q.contents.length>0||"span"===q.kind&&null!==q.text||"region"===q.kind&&"always"===q.styleAttrs[n.byName.showBackground.qname]?{region_id:b,element:q}:null}function a(e){this.contents=[],this.aspectRatio=e.aspectRatio}function l(e){for(var t in this.kind=e.kind||"region",e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)this.styleAttrs[t]=e.styleAttrs[t];"src"in e&&(this.src=e.src),"type"in e&&(this.type=e.type),"text"in e?this.text=e.text:("region"===this.kind||"contents"in e)&&(this.contents=[]),"space"in e&&(this.space=e.space)}function o(e,t){if(e&&e.error&&e.error(t))throw t}}("undefined"==typeof exports?this.imscISD={}:exports,"undefined"==typeof imscNames?require("./names"):imscNames,"undefined"==typeof imscStyles?require("./styles"):imscStyles,"undefined"==typeof imscUtils?require("./utils"):imscUtils);
},{"./names":"H9JC","./styles":"o3uR","./utils":"XcJY"}],"wIHY":[function(require,module,exports) {
"use strict";var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function r(e){console&&console.warn&&console.warn(e)}e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}module.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function f(e,t,n,i){var o,s,f;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),f=s[t]),void 0===f)f=s[t]=n,++e._eventsCount;else if("function"==typeof f?f=s[t]=i?[n,f]:[f,n]:i?f.unshift(n):f.push(n),(o=u(e))>0&&f.length>o&&!f.warned){f.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=e,p.type=t,p.count=f.length,r(p)}return e}function p(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,n(this.listener,this.target,e))}function v(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=p.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?y(i):c(i,i.length)}function a(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function c(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function l(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function y(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var f=o[e];if(void 0===f)return!1;if("function"==typeof f)n(f,this,t);else{var p=f.length,v=c(f,p);for(r=0;r<p;++r)n(v[r],this,t)}return!0},o.prototype.addListener=function(e,t){return f(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return f(this,e,t,!0)},o.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,v(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,v(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():l(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):a.call(e,t)},o.prototype.listenerCount=a,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};
},{}],"oxwV":[function(require,module,exports) {
"function"==typeof Object.create?module.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:module.exports=function(t,e){if(e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}};
},{}],"g5IB":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"iFTO":[function(require,module,exports) {
var process = require("process");
var n=require("process");function e(e,r,t,c){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,l,u=arguments.length;switch(u){case 0:case 1:return n.nextTick(e);case 2:return n.nextTick(function(){e.call(null,r)});case 3:return n.nextTick(function(){e.call(null,r,t)});case 4:return n.nextTick(function(){e.call(null,r,t,c)});default:for(i=new Array(u-1),l=0;l<i.length;)i[l++]=arguments[l];return n.nextTick(function(){e.apply(null,i)})}}void 0===n||!n.version||0===n.version.indexOf("v0.")||0===n.version.indexOf("v1.")&&0!==n.version.indexOf("v1.8.")?module.exports={nextTick:e}:module.exports=n;
},{"process":"g5IB"}],"aqZJ":[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],"o232":[function(require,module,exports) {
module.exports=require("events").EventEmitter;
},{"events":"wIHY"}],"FRly":[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){var n,o,a=h(r),u=a[0],i=a[1],f=new e(c(r,u,i)),A=0,d=i>0?u-4:u;for(o=0;o<d;o+=4)n=t[r.charCodeAt(o)]<<18|t[r.charCodeAt(o+1)]<<12|t[r.charCodeAt(o+2)]<<6|t[r.charCodeAt(o+3)],f[A++]=n>>16&255,f[A++]=n>>8&255,f[A++]=255&n;return 2===i&&(n=t[r.charCodeAt(o)]<<2|t[r.charCodeAt(o+1)]>>4,f[A++]=255&n),1===i&&(n=t[r.charCodeAt(o)]<<10|t[r.charCodeAt(o+1)]<<4|t[r.charCodeAt(o+2)]>>2,f[A++]=n>>8&255,f[A++]=255&n),f}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],"Quj6":[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],"aMB2":[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":"FRly","ieee754":"Quj6","isarray":"aqZJ","buffer":"aMB2"}],"gIYa":[function(require,module,exports) {

var r=require("buffer"),e=r.Buffer;function n(r,e){for(var n in r)e[n]=r[n]}function o(r,n,o){return e(r,n,o)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?module.exports=r:(n(r,exports),exports.Buffer=o),n(e,o),o.from=function(r,n,o){if("number"==typeof r)throw new TypeError("Argument must not be a number");return e(r,n,o)},o.alloc=function(r,n,o){if("number"!=typeof r)throw new TypeError("Argument must be a number");var f=e(r);return void 0!==n?"string"==typeof o?f.fill(n,o):f.fill(n):f.fill(0),f},o.allocUnsafe=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return e(r)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)};
},{"buffer":"aMB2"}],"kj8s":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var r=require("buffer").Buffer;function t(r){return Array.isArray?Array.isArray(r):"[object Array]"===a(r)}function e(r){return"boolean"==typeof r}function n(r){return null===r}function o(r){return null==r}function i(r){return"number"==typeof r}function u(r){return"string"==typeof r}function s(r){return"symbol"==typeof r}function f(r){return void 0===r}function p(r){return"[object RegExp]"===a(r)}function c(r){return"object"==typeof r&&null!==r}function l(r){return"[object Date]"===a(r)}function y(r){return"[object Error]"===a(r)||r instanceof Error}function x(r){return"function"==typeof r}function b(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r}function a(r){return Object.prototype.toString.call(r)}exports.isArray=t,exports.isBoolean=e,exports.isNull=n,exports.isNullOrUndefined=o,exports.isNumber=i,exports.isString=u,exports.isSymbol=s,exports.isUndefined=f,exports.isRegExp=p,exports.isObject=c,exports.isDate=l,exports.isError=y,exports.isFunction=x,exports.isPrimitive=b,exports.isBuffer=r.isBuffer;
},{"buffer":"aMB2"}],"sC8V":[function(require,module,exports) {

},{}],"m362":[function(require,module,exports) {

"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var n=require("safe-buffer").Buffer,e=require("util");function i(t,n,e){t.copy(n,e)}module.exports=function(){function e(){t(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(t){var n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length},e.prototype.unshift=function(t){var n={data:t,next:this.head};0===this.length&&(this.tail=n),this.head=n,++this.length},e.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(t){if(0===this.length)return"";for(var n=this.head,e=""+n.data;n=n.next;)e+=t+n.data;return e},e.prototype.concat=function(t){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var e=n.allocUnsafe(t>>>0),h=this.head,a=0;h;)i(h.data,e,a),a+=h.data.length,h=h.next;return e},e}(),e&&e.inspect&&e.inspect.custom&&(module.exports.prototype[e.inspect.custom]=function(){var t=e.inspect({length:this.length});return this.constructor.name+" "+t});
},{"safe-buffer":"gIYa","util":"sC8V"}],"Umu5":[function(require,module,exports) {
"use strict";var t=require("process-nextick-args");function e(e,a){var r=this,s=this._readableState&&this._readableState.destroyed,d=this._writableState&&this._writableState.destroyed;return s||d?(a?a(e):!e||this._writableState&&this._writableState.errorEmitted||t.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!a&&e?(t.nextTick(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):a&&a(e)}),this)}function a(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function i(t,e){t.emit("error",e)}module.exports={destroy:e,undestroy:a};
},{"process-nextick-args":"iFTO"}],"hQaz":[function(require,module,exports) {
var global = arguments[3];
var r=arguments[3];function t(r,t){if(e("noDeprecation"))return r;var n=!1;return function(){if(!n){if(e("throwDeprecation"))throw new Error(t);e("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return r.apply(this,arguments)}}function e(t){try{if(!r.localStorage)return!1}catch(n){return!1}var e=r.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}module.exports=t;
},{}],"pX9p":[function(require,module,exports) {
var process = require("process");

var global = arguments[3];
var e=require("process"),t=arguments[3],n=require("process-nextick-args");function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){W(t,e)}}module.exports=g;var o,s=n.nextTick;g.WritableState=y;var f=require("core-util-is");f.inherits=require("inherits");var u={deprecate:require("util-deprecate")},a=require("./internal/streams/stream"),c=require("safe-buffer").Buffer,l=t.Uint8Array||function(){};function d(e){return c.from(e)}function h(e){return c.isBuffer(e)||e instanceof l}var b,p=require("./internal/streams/destroy");function w(){}function y(e,t){o=o||require("./_stream_duplex"),e=e||{};var n=t instanceof o;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,s=e.writableHighWaterMark,f=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(s||0===s)?s:f,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===e.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){S(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function g(e){if(o=o||require("./_stream_duplex"),!(b.call(g,this)||this instanceof o))return new g(e);this._writableState=new y(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function k(e,t){var r=new Error("write after end");e.emit("error",r),n.nextTick(t,r)}function v(e,t,r,i){var o=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),n.nextTick(i,s),o=!1),o}function q(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n)),t}function _(e,t,n,r,i,o){if(!n){var s=q(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var f=t.objectMode?1:r.length;t.length+=f;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var a=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},a?a.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else m(e,t,!1,f,r,i,o);return u}function m(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function R(e,t,r,i,o){--t.pendingcb,r?(n.nextTick(o,i),n.nextTick(T,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(o(i),e._writableState.errorEmitted=!0,e.emit("error",i),T(e,t))}function x(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function S(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(x(n),t)R(e,n,r,t,i);else{var o=E(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||j(e,n),r?s(M,e,n,o,i):M(e,n,o,i)}}function M(e,t,n,r){n||B(e,t),t.pendingcb--,r(),T(e,t)}function B(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function j(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,o=new Array(r),s=t.corkedRequestsFree;s.entry=n;for(var f=0,u=!0;n;)o[f]=n,n.isBuf||(u=!1),n=n.next,f+=1;o.allBuffers=u,m(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;n;){var a=n.chunk,c=n.encoding,l=n.callback;if(m(e,t,!1,t.objectMode?1:a.length,a,c,l),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function E(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),T(e,t)})}function P(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,n.nextTick(C,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function T(e,t){var n=E(t);return n&&(P(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}function F(e,t,r){t.ending=!0,T(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function W(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}f.inherits(g,a),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:u.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(b=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(e){return!!b.call(this,e)||this===g&&(e&&e._writableState instanceof y)}})):b=function(e){return e instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(e,t,n){var r=this._writableState,i=!1,o=!r.objectMode&&h(e);return o&&!c.isBuffer(e)&&(e=d(e)),"function"==typeof t&&(n=t,t=null),o?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=w),r.ended?k(this,n):(o||v(this,r,e,n))&&(r.pendingcb++,i=_(this,r,o,e,t,n)),i},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||j(this,e))},g.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||F(this,r,n)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),g.prototype.destroy=p.destroy,g.prototype._undestroy=p.undestroy,g.prototype._destroy=function(e,t){this.end(),t(e)};
},{"process-nextick-args":"iFTO","core-util-is":"kj8s","inherits":"oxwV","util-deprecate":"hQaz","./internal/streams/stream":"o232","safe-buffer":"gIYa","./internal/streams/destroy":"Umu5","./_stream_duplex":"gYn1","process":"g5IB"}],"gYn1":[function(require,module,exports) {
"use strict";var e=require("process-nextick-args"),t=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=l;var r=require("core-util-is");r.inherits=require("inherits");var i=require("./_stream_readable"),a=require("./_stream_writable");r.inherits(l,i);for(var o=t(a.prototype),s=0;s<o.length;s++){var n=o[s];l.prototype[n]||(l.prototype[n]=a.prototype[n])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||e.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),l.prototype._destroy=function(t,r){this.push(null),this.end(),e.nextTick(r,t)};
},{"process-nextick-args":"iFTO","core-util-is":"kj8s","inherits":"oxwV","./_stream_readable":"KTao","./_stream_writable":"pX9p"}],"ikue":[function(require,module,exports) {

"use strict";var t=require("safe-buffer").Buffer,e=t.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function i(i){var a=s(i);if("string"!=typeof a&&(t.isEncoding===e||!e(i)))throw new Error("Unknown encoding: "+i);return a||i}function a(e){var s;switch(this.encoding=i(e),this.encoding){case"utf16le":this.text=c,this.end=f,s=4;break;case"utf8":this.fillLast=l,s=4;break;case"base64":this.text=d,this.end=g,s=3;break;default:return this.write=N,void(this.end=v)}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(s)}function r(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function n(t,e,s){var i=e.length-1;if(i<s)return 0;var a=r(e[i]);return a>=0?(a>0&&(t.lastNeed=a-1),a):--i<s||-2===a?0:(a=r(e[i]))>=0?(a>0&&(t.lastNeed=a-2),a):--i<s||-2===a?0:(a=r(e[i]))>=0?(a>0&&(2===a?a=0:t.lastNeed=a-3),a):0}function h(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"ï¿½";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"ï¿½";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"ï¿½"}}function l(t){var e=this.lastTotal-this.lastNeed,s=h(this,t,e);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){var s=n(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=s;var i=t.length-(s-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function o(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"ï¿½":e}function c(t,e){if((t.length-e)%2==0){var s=t.toString("utf16le",e);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function f(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,s)}return e}function d(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function g(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function N(t){return t.toString(this.encoding)}function v(t){return t&&t.length?this.write(t):""}exports.StringDecoder=a,a.prototype.write=function(t){if(0===t.length)return"";var e,s;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},a.prototype.end=o,a.prototype.text=u,a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};
},{"safe-buffer":"gIYa"}],"KTao":[function(require,module,exports) {

var global = arguments[3];
var process = require("process");
var e=arguments[3],t=require("process"),n=require("process-nextick-args");module.exports=_;var r,i=require("isarray");_.ReadableState=w;var a=require("events").EventEmitter,d=function(e,t){return e.listeners(t).length},o=require("./internal/streams/stream"),s=require("safe-buffer").Buffer,u=e.Uint8Array||function(){};function l(e){return s.from(e)}function h(e){return s.isBuffer(e)||e instanceof u}var p=require("core-util-is");p.inherits=require("inherits");var f=require("util"),c=void 0;c=f&&f.debuglog?f.debuglog("stream"):function(){};var g,b=require("./internal/streams/BufferList"),m=require("./internal/streams/destroy");p.inherits(_,o);var v=["error","close","destroy","pause","resume"];function y(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?i(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function w(e,t){e=e||{};var n=t instanceof(r=r||require("./_stream_duplex"));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,a=e.readableHighWaterMark,d=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(a||0===a)?a:d,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new b,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(g||(g=require("string_decoder/").StringDecoder),this.decoder=new g(e.encoding),this.encoding=e.encoding)}function _(e){if(r=r||require("./_stream_duplex"),!(this instanceof _))return new _(e);this._readableState=new w(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function M(e,t,n,r,i){var a,d=e._readableState;null===t?(d.reading=!1,x(e,d)):(i||(a=k(d,t)),a?e.emit("error",a):d.objectMode||t&&t.length>0?("string"==typeof t||d.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=l(t)),r?d.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):S(e,d,t,!0):d.ended?e.emit("error",new Error("stream.push() after EOF")):(d.reading=!1,d.decoder&&!n?(t=d.decoder.write(t),d.objectMode||0!==t.length?S(e,d,t,!1):C(e,d)):S(e,d,t,!1))):r||(d.reading=!1));return j(d)}function S(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&q(e)),C(e,t)}function k(e,t){var n;return h(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function j(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=m.destroy,_.prototype._undestroy=m.undestroy,_.prototype._destroy=function(e,t){this.push(null),t(e)},_.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=s.from(e,t),t=""),n=!0),M(this,e,t,!1,n)},_.prototype.unshift=function(e){return M(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){return g||(g=require("string_decoder/").StringDecoder),this._readableState.decoder=new g(e),this._readableState.encoding=e,this};var R=8388608;function E(e){return e>=R?e=R:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function L(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=E(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,q(e)}}function q(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(W,e):W(e))}function W(e){c("emit readable"),e.emit("readable"),B(e)}function C(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(D,e,t))}function D(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(c("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function O(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&d(e,"data")&&(t.flowing=!0,B(e))}}function T(e){c("readable nexttick read 0"),e.read(0)}function U(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(P,e,t))}function P(e,t){t.reading||(c("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),B(e),t.flowing&&!t.reading&&e.read(0)}function B(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function H(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=I(e,t.buffer,t.decoder),n);var n}function I(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?A(e,t):F(e,t),r}function A(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var a=n.data,d=e>a.length?a.length:e;if(d===a.length?i+=a:i+=a.slice(0,e),0===(e-=d)){d===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(d));break}++r}return t.length-=r,i}function F(e,t){var n=s.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var a=r.data,d=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,d),0===(e-=d)){d===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(d));break}++i}return t.length-=i,n}function z(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(G,t,e))}function G(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function J(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}_.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?z(this):q(this),null;if(0===(e=L(e,t))&&t.ended)return 0===t.length&&z(this),null;var r,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=L(n,t))),null===(r=e>0?H(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&z(this)),null!==r&&this.emit("data",r),r},_.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(e,r){var i=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,c("pipe count=%d opts=%j",a.pipesCount,r);var o=(!r||!1!==r.end)&&e!==t.stdout&&e!==t.stderr?u:v;function s(t,n){c("onunpipe"),t===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,c("cleanup"),e.removeListener("close",b),e.removeListener("finish",m),e.removeListener("drain",l),e.removeListener("error",g),e.removeListener("unpipe",s),i.removeListener("end",u),i.removeListener("end",v),i.removeListener("data",f),h=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){c("onend"),e.end()}a.endEmitted?n.nextTick(o):i.once("end",o),e.on("unpipe",s);var l=O(i);e.on("drain",l);var h=!1;var p=!1;function f(t){c("ondata"),p=!1,!1!==e.write(t)||p||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==J(a.pipes,e))&&!h&&(c("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,p=!0),i.pause())}function g(t){c("onerror",t),v(),e.removeListener("error",g),0===d(e,"error")&&e.emit("error",t)}function b(){e.removeListener("finish",m),v()}function m(){c("onfinish"),e.removeListener("close",b),v()}function v(){c("unpipe"),i.unpipe(e)}return i.on("data",f),y(e,"error",g),e.once("close",b),e.once("finish",m),e.emit("pipe",i),a.flowing||(c("pipe resume"),i.resume()),e},_.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,n);return this}var d=J(t.pipes,e);return-1===d?this:(t.pipes.splice(d,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},_.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&q(this):n.nextTick(T,this))}return r},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!0,U(this,e)),this},_.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",function(){if(c("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){(c("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<v.length;a++)e.on(v[a],this.emit.bind(this,v[a]));return this._read=function(t){c("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=H;
},{"process-nextick-args":"iFTO","isarray":"aqZJ","events":"wIHY","./internal/streams/stream":"o232","safe-buffer":"gIYa","core-util-is":"kj8s","inherits":"oxwV","util":"sC8V","./internal/streams/BufferList":"m362","./internal/streams/destroy":"Umu5","./_stream_duplex":"gYn1","string_decoder/":"ikue","process":"g5IB"}],"PxOV":[function(require,module,exports) {
"use strict";module.exports=n;var t=require("./_stream_duplex"),r=require("core-util-is");function e(t,r){var e=this._transformState;e.transforming=!1;var n=e.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));e.writechunk=null,e.writecb=null,null!=r&&this.push(r),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function n(r){if(!(this instanceof n))return new n(r);t.call(this,r),this._transformState={afterTransform:e.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",i)}function i(){var t=this;"function"==typeof this._flush?this._flush(function(r,e){a(t,r,e)}):a(this,null,null)}function a(t,r,e){if(r)return t.emit("error",r);if(null!=e&&t.push(e),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}r.inherits=require("inherits"),r.inherits(n,t),n.prototype.push=function(r,e){return this._transformState.needTransform=!1,t.prototype.push.call(this,r,e)},n.prototype._transform=function(t,r,e){throw new Error("_transform() is not implemented")},n.prototype._write=function(t,r,e){var n=this._transformState;if(n.writecb=e,n.writechunk=t,n.writeencoding=r,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},n.prototype._read=function(t){var r=this._transformState;null!==r.writechunk&&r.writecb&&!r.transforming?(r.transforming=!0,this._transform(r.writechunk,r.writeencoding,r.afterTransform)):r.needTransform=!0},n.prototype._destroy=function(r,e){var n=this;t.prototype._destroy.call(this,r,function(t){e(t),n.emit("close")})};
},{"./_stream_duplex":"gYn1","core-util-is":"kj8s","inherits":"oxwV"}],"pumY":[function(require,module,exports) {
"use strict";module.exports=i;var r=require("./_stream_transform"),e=require("core-util-is");function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e.inherits=require("inherits"),e.inherits(i,r),i.prototype._transform=function(r,e,i){i(null,r)};
},{"./_stream_transform":"PxOV","core-util-is":"kj8s","inherits":"oxwV"}],"YvpY":[function(require,module,exports) {
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js");
},{"./lib/_stream_readable.js":"KTao","./lib/_stream_writable.js":"pX9p","./lib/_stream_duplex.js":"gYn1","./lib/_stream_transform.js":"PxOV","./lib/_stream_passthrough.js":"pumY"}],"PbAG":[function(require,module,exports) {
module.exports=require("./lib/_stream_writable.js");
},{"./lib/_stream_writable.js":"pX9p"}],"AyLR":[function(require,module,exports) {
module.exports=require("./lib/_stream_duplex.js");
},{"./lib/_stream_duplex.js":"gYn1"}],"K38q":[function(require,module,exports) {
module.exports=require("./readable").Transform;
},{"./readable":"YvpY"}],"D33E":[function(require,module,exports) {
module.exports=require("./readable").PassThrough;
},{"./readable":"YvpY"}],"JMHy":[function(require,module,exports) {
module.exports=n;var e=require("events").EventEmitter,r=require("inherits");function n(){e.call(this)}r(n,e),n.Readable=require("readable-stream/readable.js"),n.Writable=require("readable-stream/writable.js"),n.Duplex=require("readable-stream/duplex.js"),n.Transform=require("readable-stream/transform.js"),n.PassThrough=require("readable-stream/passthrough.js"),n.Stream=n,n.prototype.pipe=function(r,n){var o=this;function t(e){r.writable&&!1===r.write(e)&&o.pause&&o.pause()}function s(){o.readable&&o.resume&&o.resume()}o.on("data",t),r.on("drain",s),r._isStdio||n&&!1===n.end||(o.on("end",a),o.on("close",u));var i=!1;function a(){i||(i=!0,r.end())}function u(){i||(i=!0,"function"==typeof r.destroy&&r.destroy())}function d(r){if(l(),0===e.listenerCount(this,"error"))throw r}function l(){o.removeListener("data",t),r.removeListener("drain",s),o.removeListener("end",a),o.removeListener("close",u),o.removeListener("error",d),r.removeListener("error",d),o.removeListener("end",l),o.removeListener("close",l),r.removeListener("close",l)}return o.on("error",d),r.on("error",d),o.on("end",l),o.on("close",l),r.on("close",l),r.emit("pipe",o),r};
},{"events":"wIHY","inherits":"oxwV","readable-stream/readable.js":"YvpY","readable-stream/writable.js":"PbAG","readable-stream/duplex.js":"AyLR","readable-stream/transform.js":"K38q","readable-stream/passthrough.js":"D33E"}],"QrIi":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var t=require("buffer").Buffer;!function(e){e.parser=function(t,e){return new a(t,e)},e.SAXParser=a,e.SAXStream=n,e.createStream=function(t,e){return new n(t,e)},e.MAX_BUFFER_LENGTH=65536;var i,s=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function a(t,i){if(!(this instanceof a))return new a(t,i);!function(t){for(var e=0,i=s.length;e<i;e++)t[s[e]]=""}(this),this.q=this.c="",this.bufferCheckPosition=e.MAX_BUFFER_LENGTH,this.opt=i||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!t,this.noscript=!(!t&&!this.opt.noscript),this.state=S.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(N)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),v(this,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}),a.prototype={end:function(){U(this)},write:function(t){if(this.error)throw this.error;if(this.closed)return L(this,"Cannot write after close. Assign an onready handler.");if(null===t)return U(this);"object"==typeof t&&(t=t.toString());var i=0,a="";for(;a=X(t,i++),this.c=a,a;)switch(this.trackPosition&&(this.position++,"\n"===a?(this.line++,this.column=0):this.column++),this.state){case S.BEGIN:if(this.state=S.BEGIN_WHITESPACE,"\ufeff"===a)continue;q(this,a);continue;case S.BEGIN_WHITESPACE:q(this,a);continue;case S.TEXT:if(this.sawRoot&&!this.closedRoot){for(var r=i-1;a&&"<"!==a&&"&"!==a;)(a=X(t,i++))&&this.trackPosition&&(this.position++,"\n"===a?(this.line++,this.column=0):this.column++);this.textNode+=t.substring(r,i-1)}"<"!==a||this.sawRoot&&this.closedRoot&&!this.strict?(!D(o,a)||this.sawRoot&&!this.closedRoot||B(this,"Text data outside of root node."),"&"===a?this.state=S.TEXT_ENTITY:this.textNode+=a):(this.state=S.OPEN_WAKA,this.startTagPosition=this.position);continue;case S.SCRIPT:"<"===a?this.state=S.SCRIPT_ENDING:this.script+=a;continue;case S.SCRIPT_ENDING:"/"===a?this.state=S.CLOSE_TAG:(this.script+="<"+a,this.state=S.SCRIPT);continue;case S.OPEN_WAKA:if("!"===a)this.state=S.SGML_DECL,this.sgmlDecl="";else if(I(o,a));else if(I(f,a))this.state=S.OPEN_TAG,this.tagName=a;else if("/"===a)this.state=S.CLOSE_TAG,this.tagName="";else if("?"===a)this.state=S.PROC_INST,this.procInstName=this.procInstBody="";else{if(B(this,"Unencoded <"),this.startTagPosition+1<this.position){var n=this.position-this.startTagPosition;a=new Array(n).join(" ")+a}this.textNode+="<"+a,this.state=S.TEXT}continue;case S.SGML_DECL:(this.sgmlDecl+a).toUpperCase()===T?(R(this,"onopencdata"),this.state=S.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+a==="--"?(this.state=S.COMMENT,this.comment="",this.sgmlDecl=""):(this.sgmlDecl+a).toUpperCase()===E?(this.state=S.DOCTYPE,(this.doctype||this.sawRoot)&&B(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===a?(R(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=S.TEXT):I(h,a)?(this.state=S.SGML_DECL_QUOTED,this.sgmlDecl+=a):this.sgmlDecl+=a;continue;case S.SGML_DECL_QUOTED:a===this.q&&(this.state=S.SGML_DECL,this.q=""),this.sgmlDecl+=a;continue;case S.DOCTYPE:">"===a?(this.state=S.TEXT,R(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=a,"["===a?this.state=S.DOCTYPE_DTD:I(h,a)&&(this.state=S.DOCTYPE_QUOTED,this.q=a));continue;case S.DOCTYPE_QUOTED:this.doctype+=a,a===this.q&&(this.q="",this.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:this.doctype+=a,"]"===a?this.state=S.DOCTYPE:I(h,a)&&(this.state=S.DOCTYPE_DTD_QUOTED,this.q=a);continue;case S.DOCTYPE_DTD_QUOTED:this.doctype+=a,a===this.q&&(this.state=S.DOCTYPE_DTD,this.q="");continue;case S.COMMENT:"-"===a?this.state=S.COMMENT_ENDING:this.comment+=a;continue;case S.COMMENT_ENDING:"-"===a?(this.state=S.COMMENT_ENDED,this.comment=P(this.opt,this.comment),this.comment&&R(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+a,this.state=S.COMMENT);continue;case S.COMMENT_ENDED:">"!==a?(B(this,"Malformed comment"),this.comment+="--"+a,this.state=S.COMMENT):this.state=S.TEXT;continue;case S.CDATA:"]"===a?this.state=S.CDATA_ENDING:this.cdata+=a;continue;case S.CDATA_ENDING:"]"===a?this.state=S.CDATA_ENDING_2:(this.cdata+="]"+a,this.state=S.CDATA);continue;case S.CDATA_ENDING_2:">"===a?(this.cdata&&R(this,"oncdata",this.cdata),R(this,"onclosecdata"),this.cdata="",this.state=S.TEXT):"]"===a?this.cdata+="]":(this.cdata+="]]"+a,this.state=S.CDATA);continue;case S.PROC_INST:"?"===a?this.state=S.PROC_INST_ENDING:I(o,a)?this.state=S.PROC_INST_BODY:this.procInstName+=a;continue;case S.PROC_INST_BODY:if(!this.procInstBody&&I(o,a))continue;"?"===a?this.state=S.PROC_INST_ENDING:this.procInstBody+=a;continue;case S.PROC_INST_ENDING:">"===a?(R(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=S.TEXT):(this.procInstBody+="?"+a,this.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:I(_,a)?this.tagName+=a:(x(this),">"===a?M(this):"/"===a?this.state=S.OPEN_TAG_SLASH:(D(o,a)&&B(this,"Invalid character in tag name"),this.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:">"===a?(M(this,!0),V(this)):(B(this,"Forward-slash in opening tag not followed by >"),this.state=S.ATTRIB);continue;case S.ATTRIB:if(I(o,a))continue;">"===a?M(this):"/"===a?this.state=S.OPEN_TAG_SLASH:I(f,a)?(this.attribName=a,this.attribValue="",this.state=S.ATTRIB_NAME):B(this,"Invalid attribute name");continue;case S.ATTRIB_NAME:"="===a?this.state=S.ATTRIB_VALUE:">"===a?(B(this,"Attribute without value"),this.attribValue=this.attribName,G(this),M(this)):I(o,a)?this.state=S.ATTRIB_NAME_SAW_WHITE:I(_,a)?this.attribName+=a:B(this,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if("="===a)this.state=S.ATTRIB_VALUE;else{if(I(o,a))continue;B(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",R(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===a?M(this):I(f,a)?(this.attribName=a,this.state=S.ATTRIB_NAME):(B(this,"Invalid attribute name"),this.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(I(o,a))continue;I(h,a)?(this.q=a,this.state=S.ATTRIB_VALUE_QUOTED):(B(this,"Unquoted attribute value"),this.state=S.ATTRIB_VALUE_UNQUOTED,this.attribValue=a);continue;case S.ATTRIB_VALUE_QUOTED:if(a!==this.q){"&"===a?this.state=S.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=a;continue}G(this),this.q="",this.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:I(o,a)?this.state=S.ATTRIB:">"===a?M(this):"/"===a?this.state=S.OPEN_TAG_SLASH:I(f,a)?(B(this,"No whitespace between attributes"),this.attribName=a,this.attribValue="",this.state=S.ATTRIB_NAME):B(this,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(D(l,a)){"&"===a?this.state=S.ATTRIB_VALUE_ENTITY_U:this.attribValue+=a;continue}G(this),">"===a?M(this):this.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(this.tagName)">"===a?V(this):I(_,a)?this.tagName+=a:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=S.SCRIPT):(D(o,a)&&B(this,"Invalid tagname in closing tag"),this.state=S.CLOSE_TAG_SAW_WHITE);else{if(I(o,a))continue;D(f,a)?this.script?(this.script+="</"+a,this.state=S.SCRIPT):B(this,"Invalid tagname in closing tag."):this.tagName=a}continue;case S.CLOSE_TAG_SAW_WHITE:if(I(o,a))continue;">"===a?V(this):B(this,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var c,u;switch(this.state){case S.TEXT_ENTITY:c=S.TEXT,u="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:c=S.ATTRIB_VALUE_QUOTED,u="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:c=S.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===a?(this[u]+=Y(this),this.entity="",this.state=c):I(this.entity.length?g:d,a)?this.entity+=a:(B(this,"Invalid character in entity name"),this[u]+="&"+this.entity+a,this.entity="",this.state=c);continue;default:throw new Error(this,"Unknown state: "+this.state)}this.position>=this.bufferCheckPosition&&function(t){for(var i=Math.max(e.MAX_BUFFER_LENGTH,10),a=0,r=0,n=s.length;r<n;r++){var o=t[s[r]].length;if(o>i)switch(s[r]){case"textNode":y(t);break;case"cdata":R(t,"oncdata",t.cdata),t.cdata="";break;case"script":R(t,"onscript",t.script),t.script="";break;default:L(t,"Max buffer length exceeded: "+s[r])}a=Math.max(a,o)}var c=e.MAX_BUFFER_LENGTH-a;t.bufferCheckPosition=c+t.position}(this);return this},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;y(t=this),""!==t.cdata&&(R(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(R(t,"onscript",t.script),t.script="")}};try{i=require("stream").Stream}catch(j){i=function(){}}var r=e.EVENTS.filter(function(t){return"error"!==t&&"end"!==t});function n(t,e){if(!(this instanceof n))return new n(t,e);i.apply(this),this._parser=new a(t,e),this.writable=!0,this.readable=!0;var s=this;this._parser.onend=function(){s.emit("end")},this._parser.onerror=function(t){s.emit("error",t),s._parser.error=null},this._decoder=null,r.forEach(function(t){Object.defineProperty(s,"on"+t,{get:function(){return s._parser["on"+t]},set:function(e){if(!e)return s.removeAllListeners(t),s._parser["on"+t]=e,e;s.on(t,e)},enumerable:!0,configurable:!1})})}n.prototype=Object.create(i.prototype,{constructor:{value:n}}),n.prototype.write=function(e){if("function"==typeof t&&"function"==typeof t.isBuffer&&t.isBuffer(e)){if(!this._decoder){var i=require("string_decoder").StringDecoder;this._decoder=new i("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},n.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},n.prototype.on=function(t,e){var s=this;return s._parser["on"+t]||-1===r.indexOf(t)||(s._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),s.emit.apply(s,e)}),i.prototype.on.call(s,t,e)};var o="\r\n\t ",c="0124356789",u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",h="'\"",l=o+">",T="[CDATA[",E="DOCTYPE",p="http://www.w3.org/XML/1998/namespace",m="http://www.w3.org/2000/xmlns/",N={xml:p,xmlns:m};o=A(o),c=A(c),u=A(u);var f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,d=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,g=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function A(t){return t.split("").reduce(function(t,e){return t[e]=!0,t},{})}function I(t,e){return function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}(t)?!!e.match(t):t[e]}function D(t,e){return!I(t,e)}h=A(h),l=A(l);var b,C,O,S=0;for(var F in e.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var i=e.ENTITIES[t],s="number"==typeof i?String.fromCharCode(i):i;e.ENTITIES[t]=s}),e.STATE)e.STATE[e.STATE[F]]=F;function v(t,e,i){t[e]&&t[e](i)}function R(t,e,i){t.textNode&&y(t),v(t,e,i)}function y(t){t.textNode=P(t.opt,t.textNode),t.textNode&&v(t,"ontext",t.textNode),t.textNode=""}function P(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function L(t,e){return y(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,v(t,"onerror",e),t}function U(t){return t.sawRoot&&!t.closedRoot&&B(t,"Unclosed root tag"),t.state!==S.BEGIN&&t.state!==S.BEGIN_WHITESPACE&&t.state!==S.TEXT&&L(t,"Unexpected end"),y(t),t.c="",t.closed=!0,v(t,"onend"),a.call(t,t.strict,t.opt),t}function B(t,e){if("object"!=typeof t||!(t instanceof a))throw new Error("bad call to strictFail");t.strict&&L(t,e)}function x(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,i=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(i.ns=e.ns),t.attribList.length=0,R(t,"onopentagstart",i)}function w(t,e){var i=t.indexOf(":")<0?["",t]:t.split(":"),s=i[0],a=i[1];return e&&"xmlns"===t&&(s="xmlns",a=""),{prefix:s,local:a}}function G(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=w(t.attribName,!0),i=e.prefix,s=e.local;if("xmlns"===i)if("xml"===s&&t.attribValue!==p)B(t,"xml: prefix must be bound to "+p+"\nActual: "+t.attribValue);else if("xmlns"===s&&t.attribValue!==m)B(t,"xmlns: prefix must be bound to "+m+"\nActual: "+t.attribValue);else{var a=t.tag,r=t.tags[t.tags.length-1]||t;a.ns===r.ns&&(a.ns=Object.create(r.ns)),a.ns[s]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,R(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function M(t,e){if(t.opt.xmlns){var i=t.tag,s=w(t.tagName);i.prefix=s.prefix,i.local=s.local,i.uri=i.ns[s.prefix]||"",i.prefix&&!i.uri&&(B(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),i.uri=s.prefix);var a=t.tags[t.tags.length-1]||t;i.ns&&a.ns!==i.ns&&Object.keys(i.ns).forEach(function(e){R(t,"onopennamespace",{prefix:e,uri:i.ns[e]})});for(var r=0,n=t.attribList.length;r<n;r++){var o=t.attribList[r],c=o[0],u=o[1],h=w(c,!0),l=h.prefix,T=h.local,E=""===l?"":i.ns[l]||"",p={name:c,value:u,prefix:l,local:T,uri:E};l&&"xmlns"!==l&&!E&&(B(t,"Unbound namespace prefix: "+JSON.stringify(l)),p.uri=l),t.tag.attributes[c]=p,R(t,"onattribute",p)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),R(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=S.TEXT:t.state=S.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function V(t){if(!t.tagName)return B(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=S.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=S.SCRIPT);R(t,"onscript",t.script),t.script=""}var e=t.tags.length,i=t.tagName;t.strict||(i=i[t.looseCase]());for(var s=i;e--;){if(t.tags[e].name===s)break;B(t,"Unexpected close tag")}if(e<0)return B(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=S.TEXT);t.tagName=i;for(var a=t.tags.length;a-- >e;){var r=t.tag=t.tags.pop();t.tagName=t.tag.name,R(t,"onclosetag",t.tagName);var n={};for(var o in r.ns)n[o]=r.ns[o];var c=t.tags[t.tags.length-1]||t;t.opt.xmlns&&r.ns!==c.ns&&Object.keys(r.ns).forEach(function(e){var i=r.ns[e];R(t,"onclosenamespace",{prefix:e,uri:i})})}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=S.TEXT}function Y(t){var e,i=t.entity,s=i.toLowerCase(),a="";return t.ENTITIES[i]?t.ENTITIES[i]:t.ENTITIES[s]?t.ENTITIES[s]:("#"===(i=s).charAt(0)&&("x"===i.charAt(1)?(i=i.slice(2),a=(e=parseInt(i,16)).toString(16)):(i=i.slice(1),a=(e=parseInt(i,10)).toString(10))),i=i.replace(/^0+/,""),a.toLowerCase()!==i?(B(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function q(t,e){"<"===e?(t.state=S.OPEN_WAKA,t.startTagPosition=t.position):D(o,e)&&(B(t,"Non-whitespace before first tag."),t.textNode=e,t.state=S.TEXT)}function X(t,e){var i="";return e<t.length&&(i=t.charAt(e)),i}S=e.STATE,String.fromCodePoint||(b=String.fromCharCode,C=Math.floor,O=function(){var t,e,i=[],s=-1,a=arguments.length;if(!a)return"";for(var r="";++s<a;){var n=Number(arguments[s]);if(!isFinite(n)||n<0||n>1114111||C(n)!==n)throw RangeError("Invalid code point: "+n);n<=65535?i.push(n):(t=55296+((n-=65536)>>10),e=n%1024+56320,i.push(t,e)),(s+1===a||i.length>16384)&&(r+=b.apply(null,i),i.length=0)}return r},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:O,configurable:!0,writable:!0}):String.fromCodePoint=O)}("undefined"==typeof exports?this.sax={}:exports);
},{"stream":"JMHy","string_decoder":"ikue","buffer":"aMB2"}],"G6Dn":[function(require,module,exports) {
!function(t,e,n,i,o){function s(t,e,n,i){var o=i&&"seq"===i.timeContainer,l=0;i&&(l=o&&n?n.end:i.begin),e.begin=e.explicit_begin?e.explicit_begin+l:l;var r=e.begin,a=null;for(var u in e.sets)s(t,e.sets[u],a,e),r="seq"===e.timeContainer?e.sets[u].end:Math.max(r,e.sets[u].end),a=e.sets[u];if("contents"in e)for(var c in e.contents)s(t,e.contents[c],a,e),r="seq"===e.timeContainer?e.contents[c].end:Math.max(r,e.contents[c].end),a=e.contents[c];else r=o?e.begin:Number.POSITIVE_INFINITY;null!==e.explicit_end&&null!==e.explicit_dur?e.end=Math.min(e.begin+e.explicit_dur,l+e.explicit_end):null===e.explicit_end&&null!==e.explicit_dur?e.end=e.begin+e.explicit_dur:null!==e.explicit_end&&null===e.explicit_dur?e.end=l+e.explicit_end:e.end=r,delete e.explicit_begin,delete e.explicit_dur,delete e.explicit_end,t._registerEvent(e)}function l(t){this.node=t}function r(){this.events=[],this.head=new a,this.body=null}function a(){this.styling=new u,this.layout=new d}function u(){this.styles={},this.initials={}}function c(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function f(){this.styleAttrs=null}function d(){this.regions={}}function p(t,e){h.call(this,"image"),this.src=t,this.type=e}function h(t){this.kind=t}function m(t){this.id=t}function y(t){this.regionID=t}function v(t){this.styleAttrs=t}function g(t){this.sets=t}function b(t){this.contents=t}function x(t,e,n){this.explicit_begin=t,this.explicit_end=e,this.explicit_dur=n}function N(){h.call(this,"body")}function F(){h.call(this,"div")}function _(){h.call(this,"p")}function w(){h.call(this,"span")}function I(){h.call(this,"span")}function R(){h.call(this,"br")}function A(){}function C(){}function M(t){return t&&"xml:id"in t.attributes&&t.attributes["xml:id"].value||null}function T(t){return t&&"style"in t.attributes?t.attributes.style.value.split(" "):[]}function q(t,e){var n={};if(null!==t)for(var o in t.attributes){var s=t.attributes[o].uri+" "+t.attributes[o].local,l=i.byQName[s];if(void 0!==l){var r=l.parse(t.attributes[o].value);null!==r?(n[s]=r,l===i.byName.zIndex&&S(e,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):D(e,"Cannot parse styling attribute "+s+" --\x3e "+t.attributes[o].value)}}return n}function P(t,e,n){for(var i in t.attributes)if(t.attributes[i].uri===e&&t.attributes[i].local===n)return t.attributes[i].value;return null}function k(t,e,n){var i,o=null;return null!==(i=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==e&&(o=parseFloat(i[1])/e):null!==(i=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==t&&(o=parseFloat(i[1])/t):null!==(i=/^(\d+(?:\.\d+)?)ms$/.exec(n))?o=parseFloat(i[1])/1e3:null!==(i=/^(\d+(?:\.\d+)?)s$/.exec(n))?o=parseFloat(i[1]):null!==(i=/^(\d+(?:\.\d+)?)h$/.exec(n))?o=3600*parseFloat(i[1]):null!==(i=/^(\d+(?:\.\d+)?)m$/.exec(n))?o=60*parseFloat(i[1]):null!==(i=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?o=3600*parseInt(i[1])+60*parseInt(i[2])+parseFloat(i[3]):null!==(i=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==e&&(o=3600*parseInt(i[1])+60*parseInt(i[2])+parseInt(i[3])+(null===i[4]?0:parseInt(i[4])/e)),o}function L(t,e,n){for(;e.styleRefs.length>0;){var i=e.styleRefs.pop();i in t.styles?(L(t,t.styles[i],n),E(t.styles[i].styleAttrs,e.styleAttrs)):D(n,"Non-existant style id referenced")}}function $(t,e,n,i){for(var o=e.length-1;o>=0;o--){var s=e[o];s in t.styles?E(t.styles[s].styleAttrs,n):D(i,"Non-existant style id referenced")}}function E(t,e){for(var n in t)n in e||(e[n]=t[n])}function S(t,e){if(t&&t.warn&&t.warn(e))throw e}function D(t,e){if(t&&t.error&&t.error(e))throw e}function O(t,e){throw t&&t.fatal&&t.fatal(e),e}function U(t,e){for(var n,i=0,o=t.length-1;i<=o;){var s=t[n=Math.floor((i+o)/2)];if(s<e)i=n+1;else{if(!(s>e))return{found:!0,index:n};o=n-1}}return{found:!1,index:i}}t.fromXML=function(t,o,h){var m=e.parser(!0,{xmlns:!0}),y=[],v=[],g=[],b=0,x=null;m.onclosetag=function(t){if(y[0]instanceof u)for(var e in y[0].styles)L(y[0],y[0].styles[e],o);else if(y[0]instanceof _||y[0]instanceof w){if(y[0].contents.length>1){var i,s=[y[0].contents[0]];for(i=1;i<y[0].contents.length;i++)y[0].contents[i]instanceof I&&s[s.length-1]instanceof I?s[s.length-1].text+=y[0].contents[i].text:s.push(y[0].contents[i]);y[0].contents=s}y[0]instanceof w&&1===y[0].contents.length&&y[0].contents[0]instanceof I&&(y[0].text=y[0].contents[0].text,delete y[0].contents)}else y[0]instanceof l&&(y[0].node.uri===n.ns_tt&&"metadata"===y[0].node.local?b--:b>0&&h&&"onCloseTag"in h&&h.onCloseTag());g.shift(),v.shift(),y.shift()},m.ontext=function(t){if(void 0===y[0]);else if(y[0]instanceof w||y[0]instanceof _){if(y[0]instanceof w){var e=y[0].styleAttrs[i.byName.ruby.qname];if("container"===e||"textContainer"===e||"baseContainer"===e)return}var n=new I;n.initFromText(x,y[0],t,g[0],o),y[0].contents.push(n)}else y[0]instanceof l&&b>0&&h&&"onText"in h&&h.onText(t)},m.onopentag=function(t){var e=t.attributes["xml:space"];e?g.unshift(e.value):0===g.length?g.unshift("default"):g.unshift(g[0]);var s=t.attributes["xml:lang"];if(s?v.unshift(s.value):0===v.length?v.unshift(""):v.unshift(v[0]),t.uri===n.ns_tt)if("tt"===t.local)null!==x&&O(o,"Two <tt> elements at ("+this.line+","+this.column+")"),(x=new r).initFromNode(t,o),y.unshift(x);else if("head"===t.local)y[0]instanceof r||O(o,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),y.unshift(x.head);else if("styling"===t.local)y[0]instanceof a||O(o,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),y.unshift(x.head.styling);else if("style"===t.local){var m;y[0]instanceof u?((m=new c).initFromNode(t,o),m.id?x.head.styling.styles[m.id]=m:D(o,"<style> element missing @id attribute"),y.unshift(m)):y[0]instanceof A?((m=new c).initFromNode(t,o),E(m.styleAttrs,y[0].styleAttrs),y.unshift(m)):O(o,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("initial"===t.local){var I;if(y[0]instanceof u){for(var M in(I=new f).initFromNode(t,o),I.styleAttrs)x.head.styling.initials[M]=I.styleAttrs[M];y.unshift(I)}else O(o,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if("layout"===t.local)y[0]instanceof a||O(o,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),y.unshift(x.head.layout);else if("region"===t.local){y[0]instanceof d||O(o,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var T=new A;T.initFromNode(x,t,o),!T.id||T.id in x.head.layout.regions?D(o,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):x.head.layout.regions[T.id]=T,y.unshift(T)}else if("body"===t.local){y[0]instanceof r||O(o,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==x.body&&O(o,"Second <body> element at "+this.line+","+this.column+")");var q=new N;q.initFromNode(x,t,o),x.body=q,y.unshift(q)}else if("div"===t.local){y[0]instanceof F||y[0]instanceof N||O(o,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var P=new F;P.initFromNode(x,y[0],t,o);var k=P.styleAttrs[i.byName.backgroundImage.qname];k&&(P.contents.push(new p(k)),delete P.styleAttrs[i.byName.backgroundImage.qname]),y[0].contents.push(P),y.unshift(P)}else if("image"===t.local){y[0]instanceof F||O(o,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var L=new p;L.initFromNode(x,y[0],t,o),y[0].contents.push(L),y.unshift(L)}else if("p"===t.local){y[0]instanceof F||O(o,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var $=new _;$.initFromNode(x,y[0],t,o),y[0].contents.push($),y.unshift($)}else if("span"===t.local){y[0]instanceof w||y[0]instanceof _||O(o,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var S=new w;S.initFromNode(x,y[0],t,g[0],o),y[0].contents.push(S),y.unshift(S)}else if("br"===t.local){y[0]instanceof w||y[0]instanceof _||O(o,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var U=new R;U.initFromNode(x,y[0],t,o),y[0].contents.push(U),y.unshift(U)}else if("set"===t.local){y[0]instanceof w||y[0]instanceof _||y[0]instanceof F||y[0]instanceof N||y[0]instanceof A||y[0]instanceof R||O(o,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var V=new C;V.initFromNode(x,y[0],t,o),y[0].sets.push(V),y.unshift(V)}else y.unshift(new l(t));else y.unshift(new l(t));if(y[0]instanceof l)if(t.uri===n.ns_tt&&"metadata"===t.local)b++;else if(b>0&&h&&"onOpenTag"in h){var Y=[];for(var z in t.attributes)Y[t.attributes[z].uri+" "+t.attributes[z].local]={uri:t.attributes[z].uri,local:t.attributes[z].local,value:t.attributes[z].value};h.onOpenTag(t.uri,t.local,Y)}},m.write(t).close(),delete x.head.styling.styles;var M=!1;for(var T in x.head.layout.regions){M=!0;break}if(!M){var q=A.prototype.createDefaultRegion();x.head.layout.regions[q.id]=q}for(var P in x.head.layout.regions)s(x,x.head.layout.regions[P],null,null);return x.body&&s(x,x.body,null,null),x.body&&function t(e){if(!("contents"in e))return;var n="styleAttrs"in e?e.styleAttrs[i.byName.ruby.qname]:null;var o="span"===e.kind&&("container"===n||"textContainer"===n||"baseContainer"===n);for(var s=e.contents.length-1;s>=0;s--)!o||"styleAttrs"in e.contents[s]&&i.byName.ruby.qname in e.contents[s].styleAttrs?t(e.contents[s]):delete e.contents[s]}(x.body),x},r.prototype.initFromNode=function(t,e){var i=function(t,e){var i=P(t,n.ns_ttp,"cellResolution"),o=15,s=32;if(null!==i){var l=/(\d+) (\d+)/.exec(i);null!==l?(s=parseInt(l[1]),o=parseInt(l[2])):S(e,"Malformed cellResolution value (using initial value instead)")}return{w:s,h:o}}(t,e);this.cellLength={h:new o.ComputedLength(0,1/i.h),w:new o.ComputedLength(1/i.w,0)};var s=function(t,e){var i,o=P(t,n.ns_ttp,"frameRate"),s=30;if(null!==o){null!==(i=/(\d+)/.exec(o))?s=parseInt(i[1]):S(e,"Malformed frame rate attribute (using initial value instead)")}var l=P(t,n.ns_ttp,"frameRateMultiplier"),r=1;if(null!==l){null!==(i=/(\d+) (\d+)/.exec(l))?r=parseInt(i[1])/parseInt(i[2]):S(e,"Malformed frame rate multiplier attribute (using initial value instead)")}var a=r*s,u=1,c=P(t,n.ns_ttp,"tickRate");if(null===c)null!==o&&(u=a);else{null!==(i=/(\d+)/.exec(c))?u=parseInt(i[1]):S(e,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:a,tickRate:u}}(t,e);this.effectiveFrameRate=s.effectiveFrameRate,this.tickRate=s.tickRate,this.aspectRatio=function(t,e){var i=P(t,n.ns_ittp,"aspectRatio");null===i&&(i=P(t,n.ns_ttp,"displayAspectRatio"));var o=null;if(null!==i){var s=/(\d+)\s+(\d+)/.exec(i);if(null!==s){var l=parseInt(s[1]),r=parseInt(s[2]);0!==l&&0!==r?o=l/r:D(e,"Illegal aspectRatio values (ignoring)")}else D(e,"Malformed aspectRatio attribute (ignoring)")}return o}(t,e);var l=P(t,n.ns_ttp,"timeBase");null!==l&&"media"!==l&&O(e,"Unsupported time base");var r=function(t,e){var i=P(t,n.ns_tts,"extent");if(null===i)return null;var s=i.split(" ");if(2!==s.length)return S(e,"Malformed extent (ignoring)"),null;var l=o.parseLength(s[0]),r=o.parseLength(s[1]);if(!r||!l)return S(e,"Malformed extent values (ignoring)"),null;return{h:r,w:l}}(t,e);null===r?this.pxLength={h:null,w:null}:("px"===r.h.unit&&"px"===r.w.unit||O(e,"Extent on TT must be in px or absent"),this.pxLength={h:new o.ComputedLength(0,1/r.h.value),w:new o.ComputedLength(1/r.w.value,0)}),this.dimensions={h:new o.ComputedLength(0,1),w:new o.ComputedLength(1,0)}},r.prototype._registerEvent=function(t){if(!(t.end<=t.begin)){var e=U(this.events,t.begin);if(e.found||this.events.splice(e.index,0,t.begin),t.end!==Number.POSITIVE_INFINITY){var n=U(this.events,t.end);n.found||this.events.splice(n.index,0,t.end)}}},r.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},r.prototype.getMediaTimeEvents=function(){return this.events},c.prototype.initFromNode=function(t,e){this.id=M(t),this.styleAttrs=q(t,e),this.styleRefs=T(t)},f.prototype.initFromNode=function(t,e){for(var i in this.styleAttrs={},t.attributes)if(t.attributes[i].uri===n.ns_itts||t.attributes[i].uri===n.ns_ebutts||t.attributes[i].uri===n.ns_tts){var o=t.attributes[i].uri+" "+t.attributes[i].local;this.styleAttrs[o]=t.attributes[i].value}},p.prototype.initFromNode=function(t,e,n,i){this.src="src"in n.attributes?n.attributes.src.value:null,this.src||D(i,"Invalid image@src attribute"),this.type="type"in n.attributes?n.attributes.type.value:null,this.type||D(i,"Invalid image@type attribute"),v.prototype.initFromNode.call(this,t,e,n,i),x.prototype.initFromNode.call(this,t,e,n,i),g.prototype.initFromNode.call(this,t,e,n,i),y.prototype.initFromNode.call(this,t,e,n,i)},m.prototype.initFromNode=function(t,e,n,i){this.id=M(n)},y.prototype.initFromNode=function(t,e,n,i){this.regionID=function(t){return t&&"region"in t.attributes?t.attributes.region.value:""}(n)},v.prototype.initFromNode=function(t,e,n,i){this.styleAttrs=q(n,i),null!==t.head&&null!==t.head.styling&&$(t.head.styling,T(n),this.styleAttrs,i)},g.prototype.initFromNode=function(t,e,n,i){this.sets=[]},b.prototype.initFromNode=function(t,e,n,i){this.contents=[]},x.prototype.initFromNode=function(t,e,n,i){var o=function(t,e,n,i){var o=null;n&&"begin"in n.attributes&&null===(o=k(t.tickRate,t.effectiveFrameRate,n.attributes.begin.value))&&S(i,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var s=null;n&&"dur"in n.attributes&&null===(s=k(t.tickRate,t.effectiveFrameRate,n.attributes.dur.value))&&S(i,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var l=null;n&&"end"in n.attributes&&null===(l=k(t.tickRate,t.effectiveFrameRate,n.attributes.end.value))&&S(i,"Malformed end value (ignoring)");return{explicit_begin:o,explicit_end:l,explicit_dur:s}}(t,0,n,i);this.explicit_begin=o.explicit_begin,this.explicit_end=o.explicit_end,this.explicit_dur=o.explicit_dur,this.timeContainer=function(t,e){var n=t&&"timeContainer"in t.attributes?t.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(D(e,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(n,i)},N.prototype.initFromNode=function(t,e,n){v.prototype.initFromNode.call(this,t,null,e,n),x.prototype.initFromNode.call(this,t,null,e,n),g.prototype.initFromNode.call(this,t,null,e,n),y.prototype.initFromNode.call(this,t,null,e,n),b.prototype.initFromNode.call(this,t,null,e,n)},F.prototype.initFromNode=function(t,e,n,i){v.prototype.initFromNode.call(this,t,e,n,i),x.prototype.initFromNode.call(this,t,e,n,i),g.prototype.initFromNode.call(this,t,e,n,i),y.prototype.initFromNode.call(this,t,e,n,i),b.prototype.initFromNode.call(this,t,e,n,i)},_.prototype.initFromNode=function(t,e,n,i){v.prototype.initFromNode.call(this,t,e,n,i),x.prototype.initFromNode.call(this,t,e,n,i),g.prototype.initFromNode.call(this,t,e,n,i),y.prototype.initFromNode.call(this,t,e,n,i),b.prototype.initFromNode.call(this,t,e,n,i)},w.prototype.initFromNode=function(t,e,n,i,o){v.prototype.initFromNode.call(this,t,e,n,o),x.prototype.initFromNode.call(this,t,e,n,o),g.prototype.initFromNode.call(this,t,e,n,o),y.prototype.initFromNode.call(this,t,e,n,o),b.prototype.initFromNode.call(this,t,e,n,o),this.space=i},I.prototype.initFromText=function(t,e,n,i,o){x.prototype.initFromNode.call(this,t,e,null,o),this.text=n,this.space=i},R.prototype.initFromNode=function(t,e,n,i){y.prototype.initFromNode.call(this,t,e,n,i),x.prototype.initFromNode.call(this,t,e,n,i)},A.prototype.createDefaultRegion=function(){var t=new A;return m.call(t,""),v.call(t,{}),g.call(t,[]),x.call(t,0,Number.POSITIVE_INFINITY,null),t},A.prototype.initFromNode=function(t,e,n){m.prototype.initFromNode.call(this,t,null,e,n),v.prototype.initFromNode.call(this,t,null,e,n),x.prototype.initFromNode.call(this,t,null,e,n),g.prototype.initFromNode.call(this,t,null,e,n),null!==t.head&&null!==t.head.styling&&$(t.head.styling,T(e),this.styleAttrs,n)},C.prototype.initFromNode=function(t,e,n,i){x.prototype.initFromNode.call(this,t,e,n,i);var o=q(n,i);for(var s in this.qname=null,this.value=null,o){if(this.qname){D(i,"More than one style specified on set");break}this.qname=s,this.value=o[s]}}}("undefined"==typeof exports?this.imscDoc={}:exports,"undefined"==typeof sax?require("sax"):sax,"undefined"==typeof imscNames?require("./names"):imscNames,"undefined"==typeof imscStyles?require("./styles"):imscStyles,"undefined"==typeof imscUtils?require("./utils"):imscUtils);
},{"sax":"QrIi","./names":"H9JC","./styles":"o3uR","./utils":"XcJY"}],"SQ6l":[function(require,module,exports) {
!function(t,e,n){function r(t,e,s){var d;if("region"===s.kind)(d=document.createElement("div")).style.position="absolute";else if("body"===s.kind)d=document.createElement("div");else if("div"===s.kind)d=document.createElement("div");else if("image"===s.kind){if(d=document.createElement("img"),null!==t.imgResolver&&null!==s.src){var p=t.imgResolver(s.src,d);p&&(d.src=p),d.height=t.regionH,d.width=t.regionW}}else if("p"===s.kind)d=document.createElement("p");else if("span"===s.kind){if("container"===s.styleAttrs[n.byName.ruby.qname])d=document.createElement("ruby"),t.ruby=!0;else if("base"===s.styleAttrs[n.byName.ruby.qname])d=document.createElement("rb");else if("text"===s.styleAttrs[n.byName.ruby.qname])d=document.createElement("rt");else if("baseContainer"===s.styleAttrs[n.byName.ruby.qname])d=document.createElement("rbc");else if("textContainer"===s.styleAttrs[n.byName.ruby.qname])d=document.createElement("rtc");else{if("delimiter"===s.styleAttrs[n.byName.ruby.qname])return;d=document.createElement("span")}var g=s.styleAttrs[n.byName.textEmphasis.qname];g&&"none"!==g.style&&(t.textEmphasis=!0)}else"br"===s.kind&&(d=document.createElement("br"));if(d){for(var y in e.appendChild(d),d.style.margin="0",a){var h=a[y],f=s.styleAttrs[h.qname];void 0!==f&&null!==h.map&&h.map(t,d,s,f)}var m=d;if("region"===s.kind){var b=s.styleAttrs[n.byName.writingMode.qname];"lrtb"===b||"lr"===b?(t.ipd="lr",t.bpd="tb"):"rltb"===b||"rl"===b?(t.ipd="rl",t.bpd="tb"):"tblr"===b?(t.ipd="tb",t.bpd="lr"):"tbrl"!==b&&"tb"!==b||(t.ipd="tb",t.bpd="rl")}var w=s.styleAttrs[n.byName.linePadding.qname];if(w&&!w.isZero()){var u=w.toUsedLength(t.w,t.h);if(u>0){var c=Math.ceil(u)+"px";"tb"===t.bpd?(m.style.paddingLeft=c,m.style.paddingRight=c):(m.style.paddingTop=c,m.style.paddingBottom=c),t.lp=w}}var v=s.styleAttrs[n.byName.multiRowAlign.qname];if(v&&"auto"!==v){var x=document.createElement("span");x.style.display="inline-block",x.style.textAlign=v,d.appendChild(x),m=x,t.mra=v}var S=s.styleAttrs[n.byName.rubyReserve.qname];if(S&&"none"!==S[0]&&(t.rubyReserve=S),s.styleAttrs[n.byName.fillLineGap.qname]&&(t.flg=!0),"span"===s.kind&&s.text)if(n.byName.textCombine.qname in s.styleAttrs&&"all"===s.styleAttrs[n.byName.textCombine.qname][0])d.textContent=s.text;else for(var E="",C=0;C<s.text.length;C++){E+=s.text.charAt(C);var L=s.text.charCodeAt(C);if(L<55296||L>56319||C===s.text.length){var R=document.createElement("span");R.textContent=E,d.appendChild(R),E=""}}for(var N in s.contents)r(t,m,s.contents[N]);var A=[];if((t.lp||t.mra||t.flg||t.ruby||t.textEmphasis||t.rubyReserve)&&"p"===s.kind&&(i(t,m,A,null),t.rubyReserve&&(!function(t,e){for(var n=0;n<t.length;n++){var r,l,o=document.createElement("ruby"),i=document.createElement("rb");i.textContent="â",o.appendChild(i);var s=e.rubyReserve[1].toUsedLength(e.w,e.h)+"px";"both"===e.rubyReserve[0]?((r=document.createElement("rtc")).style.rubyPosition="under",r.textContent="â",r.style.fontSize=s,(l=document.createElement("rtc")).style.rubyPosition="over",l.textContent="â",l.style.fontSize=s,o.appendChild(r),o.appendChild(l)):((r=document.createElement("rtc")).textContent="â",r.style.fontSize=s,"after"===e.rubyReserve[0]||"outside"===e.rubyReserve[0]&&n>0?r.style.rubyPosition="tb"===e.bpd||"rl"===e.bpd?"under":"over":r.style.rubyPosition="tb"===e.bpd||"rl"===e.bpd?"over":"under",o.appendChild(r));t[n].elements[0].node.parentElement.insertBefore(o,t[n].elements[0].node)}}(A,t),t.rubyReserve=null),(t.ruby||t.rubyReserve)&&(!function(t,e){for(var n=0;n<t.length;n++)for(var r=0;r<t[n].rbc.length;r++){var l;if(!t[n].rbc[r].style.rubyPosition)l="tb"===e.bpd?0===n?"over":"under":"rl"===e.bpd?0===n?"over":"under":0===n?"under":"over",t[n].rbc[r].style.rubyPosition=l}}(A,t),t.ruby=null),t.textEmphasis&&(!function(t,e){for(var n=0;n<t.length;n++)for(var r=0;r<t[n].te.length;r++){var l;if(!t[n].te[r].style.textEmphasisPosition||"none"===t[n].te[r].style.textEmphasisPosition)l="tb"===e.bpd?0===n?"left over":"left under":"rl"===e.bpd?0===n?"right under":"left under":0===n?"left under":"right under",t[n].te[r].style.textEmphasisPosition=l}}(A,t),t.textEmphasis=null),t.mra&&(!function(t){for(var e=0;e<t.length-1;e++){var n=t[e].elements.length;if(0!==n&&!1===t[e].br){var r=document.createElement("br"),l=t[e].elements[n-1].node;l.parentElement.insertBefore(r,l.nextSibling)}}}(A),t.mra=null),t.lp&&(!function(t,e,n){for(var r in t){var l=t[r].elements.length,o=t[r].elements[t[r].start_elem],i=t[r].elements[t[r].end_elem],s=Math.ceil(e)+"px",a="-"+Math.ceil(e)+"px";0!==l&&("lr"===n.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=s,o.node.style.marginLeft=a):"rl"===n.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=s,o.node.style.marginRight=a):"tb"===n.ipd&&(o.node.style.borderTopColor=o.bgcolor||"#00000000",o.node.style.borderTopStyle="solid",o.node.style.borderTopWidth=s,o.node.style.marginTop=a),"lr"===n.ipd?(i.node.style.borderRightColor=i.bgcolor||"#00000000",i.node.style.borderRightStyle="solid",i.node.style.borderRightWidth=s,i.node.style.marginRight=a):"rl"===n.ipd?(i.node.style.borderLeftColor=i.bgcolor||"#00000000",i.node.style.borderLeftStyle="solid",i.node.style.borderLeftWidth=s,i.node.style.marginLeft=a):"tb"===n.ipd&&(i.node.style.borderBottomColor=i.bgcolor||"#00000000",i.node.style.borderBottomStyle="solid",i.node.style.borderBottomWidth=s,i.node.style.marginBottom=a))}}(A,t.lp.toUsedLength(t.w,t.h),t),t.lp=null),t.flg)){var U=o(m.getBoundingClientRect(),t);!function(t,e,n,r){for(var l=Math.sign(n-e),o=0;o<=t.length;o++){var i,s,a;if(i=0===o?e:o===t.length?n:(t[o].before+t[o-1].after)/2,o>0)for(var d=0;d<t[o-1].elements.length;d++)null!==t[o-1].elements[d].bgcolor&&(a=t[o-1].elements[d],l*(a.after-i)<0&&(s=Math.ceil(Math.abs(i-a.after))+"px",a.node.style.backgroundColor=a.bgcolor,"lr"===r.bpd?a.node.style.paddingRight=s:"rl"===r.bpd?a.node.style.paddingLeft=s:"tb"===r.bpd&&(a.node.style.paddingBottom=s)));if(o<t.length)for(var p=0;p<t[o].elements.length;p++)null!==(a=t[o].elements[p]).bgcolor&&l*(a.before-i)>0&&(s=Math.ceil(Math.abs(a.before-i))+"px",a.node.style.backgroundColor=a.bgcolor,"lr"===r.bpd?a.node.style.paddingLeft=s:"rl"===r.bpd?a.node.style.paddingRight=s:"tb"===r.bpd&&(a.node.style.paddingTop=s))}}(A,U.before,U.after,t),t.flg=null}if("region"===s.kind&&(i(t,m,A),"tb"===t.bpd&&t.enableRollUp&&s.contents.length>0&&"after"===s.styleAttrs[n.byName.displayAlign.qname])){var M=new l(""===s.id?"_":s.id,A);if(t.currentISDState[M.id]=M,t.previousISDState&&M.id in t.previousISDState&&t.previousISDState[M.id].plist.length>0&&M.plist.length>1&&M.plist[M.plist.length-2].text===t.previousISDState[M.id].plist[t.previousISDState[M.id].plist.length-1].text){var k=d.firstElementChild,q=M.plist[M.plist.length-1].after-M.plist[M.plist.length-1].before;k.style.bottom="-"+q+"px",k.style.transition="transform 0.4s",k.style.position="relative",k.style.transform="translateY(-"+q+"px)"}}}else!function(t,e){if(t&&t.error&&t.error(e))throw e}(t.errorHandler,"Error processing ISD element kind: "+s.kind)}function l(t,e){this.id=t,this.plist=e}function o(t,e){var n={before:null,after:null,start:null,end:null};return"tb"===e.bpd?(n.before=t.top,n.after=t.bottom,"lr"===e.ipd?(n.start=t.left,n.end=t.right):(n.start=t.right,n.end=t.left)):"lr"===e.bpd?(n.before=t.left,n.after=t.right,n.start=t.top,n.end=t.bottom):"rl"===e.bpd&&(n.before=t.right,n.after=t.left,n.start=t.top,n.end=t.bottom),n}function i(t,e,n,r){if("rt"!==e.localName&&"rtc"!==e.localName){var l,s,a,d,p=e.style.backgroundColor||r;if(0===e.childElementCount)if("span"===e.localName||"rb"===e.localName){var g=e.getBoundingClientRect();if(0===g.height||0===g.width)return;var y=o(g,t);if(0!==n.length&&(l=y.before,s=y.after,a=n[n.length-1].before,d=n[n.length-1].after,s<d&&l>a||d<=s&&a>=l)){var h=Math.sign(y.after-y.before),f=Math.sign(y.end-y.start);h*(y.before-n[n.length-1].before)<0&&(n[n.length-1].before=y.before),h*(y.after-n[n.length-1].after)>0&&(n[n.length-1].after=y.after),f*(y.start-n[n.length-1].start)<0&&(n[n.length-1].start=y.start,n[n.length-1].start_elem=n[n.length-1].elements.length),f*(y.end-n[n.length-1].end)>0&&(n[n.length-1].end=y.end,n[n.length-1].end_elem=n[n.length-1].elements.length)}else n.push({before:y.before,after:y.after,start:y.start,end:y.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});n[n.length-1].text+=e.textContent,n[n.length-1].elements.push({node:e,bgcolor:p,before:y.before,after:y.after})}else"br"===e.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var m=e.firstChild;m;)m.nodeType===Node.ELEMENT_NODE&&(i(t,m,n,p),"ruby"===m.localName||"rtc"===m.localName?n.length>0&&n[n.length-1].rbc.push(m):"span"===m.localName&&m.style.textEmphasisStyle&&"none"!==m.style.textEmphasisStyle&&n.length>0&&n[n.length-1].te.push(m)),m=m.nextSibling}}function s(t,e){this.qname=t,this.map=e}t.render=function(t,e,n,l,o,i,s,a,d){var p=l||e.clientHeight,g=o||e.clientWidth;if(null!==t.aspectRatio){var y=p*t.aspectRatio;y>g?p=Math.round(g/t.aspectRatio):g=y}var h=document.createElement("div");h.style.position="relative",h.style.width=g+"px",h.style.height=p+"px",h.style.margin="auto",h.style.top=0,h.style.bottom=0,h.style.left=0,h.style.right=0,h.style.zIndex=0;var f={h:p,w:g,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:i||!1,isd:t,errorHandler:s,previousISDState:a,enableRollUp:d||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};for(var m in e.appendChild(h),t.contents)r(f,h,t.contents[m]);return f.currentISDState};var a=[new s("http://www.w3.org/ns/ttml#styling backgroundColor",function(t,e,n,r){0!==r[3]&&(e.style.backgroundColor="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")")}),new s("http://www.w3.org/ns/ttml#styling color",function(t,e,n,r){e.style.color="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")"}),new s("http://www.w3.org/ns/ttml#styling direction",function(t,e,n,r){e.style.direction=r}),new s("http://www.w3.org/ns/ttml#styling display",function(t,e,n,r){}),new s("http://www.w3.org/ns/ttml#styling displayAlign",function(t,e,n,r){e.style.display="flex",e.style.flexDirection="column","before"===r?e.style.justifyContent="flex-start":"center"===r?e.style.justifyContent="center":"after"===r&&(e.style.justifyContent="flex-end")}),new s("http://www.w3.org/ns/ttml#styling extent",function(t,e,n,r){t.regionH=r.h.toUsedLength(t.w,t.h),t.regionW=r.w.toUsedLength(t.w,t.h);var l=0,o=0,i=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];i&&(l=i[0].toUsedLength(t.w,t.h)+i[2].toUsedLength(t.w,t.h),o=i[1].toUsedLength(t.w,t.h)+i[3].toUsedLength(t.w,t.h)),e.style.height=t.regionH-l+"px",e.style.width=t.regionW-o+"px"}),new s("http://www.w3.org/ns/ttml#styling fontFamily",function(t,e,n,r){var l=[];for(var o in r)"monospaceSerif"===r[o]?(l.push("Courier New"),l.push('"Liberation Mono"'),l.push("Courier"),l.push("monospace")):"proportionalSansSerif"===r[o]?(l.push("Arial"),l.push("Helvetica"),l.push('"Liberation Sans"'),l.push("sans-serif")):"monospace"===r[o]?l.push("monospace"):"sansSerif"===r[o]?l.push("sans-serif"):"serif"===r[o]?l.push("serif"):"monospaceSansSerif"===r[o]?(l.push("Consolas"),l.push("monospace")):"proportionalSerif"===r[o]?l.push("serif"):l.push(r[o]);e.style.fontFamily=l.join(",")}),new s("http://www.w3.org/ns/ttml#styling shear",function(t,e,n,r){if(0!==r){var l=-.9*r;"tb"===t.bpd?e.style.transform="skewX("+l+"deg)":e.style.transform="skewY("+l+"deg)"}}),new s("http://www.w3.org/ns/ttml#styling fontSize",function(t,e,n,r){e.style.fontSize=r.toUsedLength(t.w,t.h)+"px"}),new s("http://www.w3.org/ns/ttml#styling fontStyle",function(t,e,n,r){e.style.fontStyle=r}),new s("http://www.w3.org/ns/ttml#styling fontWeight",function(t,e,n,r){e.style.fontWeight=r}),new s("http://www.w3.org/ns/ttml#styling lineHeight",function(t,e,n,r){e.style.lineHeight="normal"===r?"normal":r.toUsedLength(t.w,t.h)+"px"}),new s("http://www.w3.org/ns/ttml#styling opacity",function(t,e,n,r){e.style.opacity=r}),new s("http://www.w3.org/ns/ttml#styling origin",function(t,e,n,r){e.style.top=r.h.toUsedLength(t.w,t.h)+"px",e.style.left=r.w.toUsedLength(t.w,t.h)+"px"}),new s("http://www.w3.org/ns/ttml#styling overflow",function(t,e,n,r){e.style.overflow=r}),new s("http://www.w3.org/ns/ttml#styling padding",function(t,e,n,r){var l=[];l[0]=r[0].toUsedLength(t.w,t.h)+"px",l[1]=r[3].toUsedLength(t.w,t.h)+"px",l[2]=r[2].toUsedLength(t.w,t.h)+"px",l[3]=r[1].toUsedLength(t.w,t.h)+"px",e.style.padding=l.join(" ")}),new s("http://www.w3.org/ns/ttml#styling position",function(t,e,n,r){e.style.top=r.h.toUsedLength(t.w,t.h)+"px",e.style.left=r.w.toUsedLength(t.w,t.h)+"px"}),new s("http://www.w3.org/ns/ttml#styling rubyAlign",function(t,e,n,r){e.style.rubyAlign=r}),new s("http://www.w3.org/ns/ttml#styling rubyPosition",function(t,e,n,r){var l;"before"!==r&&"after"!==r||(l="tb"===t.bpd?"before"===r?"over":"under":"rl"===t.bpd?"before"===r?"over":"under":"before"===r?"under":"over",e.parentElement.style.rubyPosition=l)}),new s("http://www.w3.org/ns/ttml#styling showBackground",null),new s("http://www.w3.org/ns/ttml#styling textAlign",function(t,e,r,l){var o,i=r.styleAttrs[n.byName.direction.qname];o="start"===l?"rtl"===i?"right":"left":"end"===l?"rtl"===i?"left":"right":l,e.style.textAlign=o}),new s("http://www.w3.org/ns/ttml#styling textDecoration",function(t,e,n,r){e.style.textDecoration=r.join(" ").replace("lineThrough","line-through")}),new s("http://www.w3.org/ns/ttml#styling textOutline",function(t,e,n,r){}),new s("http://www.w3.org/ns/ttml#styling textShadow",function(t,e,r,l){var o=r.styleAttrs[n.byName.textOutline.qname];if("none"===l&&"none"===o)e.style.textShadow="";else{var i=[];if("none"!==o&&i.push("rgba("+o.color[0].toString()+","+o.color[1].toString()+","+o.color[2].toString()+","+(o.color[3]/255).toString()+") 0px 0px "+o.thickness.toUsedLength(t.w,t.h)+"px"),"none"!==l)for(var s in l)i.push(l[s].x_off.toUsedLength(t.w,t.h)+"px "+l[s].y_off.toUsedLength(t.w,t.h)+"px "+l[s].b_radius.toUsedLength(t.w,t.h)+"px rgba("+l[s].color[0].toString()+","+l[s].color[1].toString()+","+l[s].color[2].toString()+","+(l[s].color[3]/255).toString()+")");e.style.textShadow=i.join(",")}}),new s("http://www.w3.org/ns/ttml#styling textCombine",function(t,e,n,r){e.style.textCombineUpright=r.join(" ")}),new s("http://www.w3.org/ns/ttml#styling textEmphasis",function(t,e,n,r){var l;"none"!==r.style?("auto"===r.style?e.style.textEmphasisStyle="filled":e.style.textEmphasisStyle=r.style+" "+r.symbol,("before"===r.position||"after"===r.position)&&(l="tb"===t.bpd?"before"===r.position?"left over":"left under":"rl"===t.bpd?"before"===r.position?"right under":"left under":"before"===r.position?"left under":"right under",e.style.textEmphasisPosition=l)):e.style.textEmphasisStyle="none"}),new s("http://www.w3.org/ns/ttml#styling unicodeBidi",function(t,e,n,r){var l;l="bidiOverride"===r?"bidi-override":r,e.style.unicodeBidi=l}),new s("http://www.w3.org/ns/ttml#styling visibility",function(t,e,n,r){e.style.visibility=r}),new s("http://www.w3.org/ns/ttml#styling wrapOption",function(t,e,n,r){"wrap"===r?"preserve"===n.space?e.style.whiteSpace="pre-wrap":e.style.whiteSpace="normal":"preserve"===n.space?e.style.whiteSpace="pre":e.style.whiteSpace="noWrap"}),new s("http://www.w3.org/ns/ttml#styling writingMode",function(t,e,n,r){"lrtb"===r||"lr"===r?t.writingMode="horizontal-tb":"rltb"===r||"rl"===r?t.writingMode="horizontal-tb":"tblr"===r?t.writingMode="vertical-lr":"tbrl"!==r&&"tb"!==r||(t.writingMode="vertical-rl"),e.style.writingMode=t.writingMode}),new s("http://www.w3.org/ns/ttml#styling zIndex",function(t,e,n,r){e.style.zIndex=r}),new s("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(t,e,n,r){t.displayForcedOnlyMode&&!1===r&&(e.style.visibility="hidden")})],d={};for(var p in a)d[a[p].qname]=a[p]}("undefined"==typeof exports?this.imscHTML={}:exports,"undefined"==typeof imscNames?require("./names"):imscNames,"undefined"==typeof imscStyles?require("./styles"):imscStyles,"undefined"==typeof imscUtils?require("./utils"):imscUtils);
},{"./names":"H9JC","./styles":"o3uR","./utils":"XcJY"}],"VbxE":[function(require,module,exports) {
exports.generateISD=require("./isd").generateISD,exports.fromXML=require("./doc").fromXML,exports.renderHTML=require("./html").render;
},{"./isd":"f3iw","./doc":"G6Dn","./html":"SQ6l"}],"cnD0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=f(e),i=require("../../core/EventBus"),n=f(i),r=require("../../core/events/Events"),l=f(r),d=require("../../core/FactoryMaker"),s=f(d),o=require("../../core/Debug"),a=f(o),u=require("imsc"),c=require("../utils/SupervisorTools");function f(e){return e&&e.__esModule?e:{default:e}}function g(){var e=this.context,i=(0,n.default)(e).getInstance(),r=void 0,d=void 0,s=void 0,o=void 0,f=void 0,g=void 0,v=void 0,h=void 0,m=void 0,T=void 0,p=void 0,y=void 0,E=void 0,x=void 0,C=void 0,I=void 0,k=void 0;function b(e){var t=f[e].kind,i=void 0!==f[e].id?f[e].id:f[e].lang,n=f[e].lang,r=f[e].isTTML,l=f[e].isEmbedded,d=o.addTextTrack(t,i,n);return d.isEmbedded=l,d.isTTML=r,d}function S(e,t){var n=o.getClientWidth(),r=o.getClientHeight(),d=o.getVideoWidth(),s=o.getVideoHeight(),a=o.getVideoRelativeOffsetTop(),u=o.getVideoRelativeOffsetLeft(),c=d/s,f=!1;e.isFromCEA608&&(c=3.5/3,f=!0);var g=function(e,t,i,n,r,l){var d=0,s=0;e/t>i/n?d=(s=t)/n*i:s=(d=e)/i*n;var o,a,u=0,c=0;return d/s>r?(c=s,u=s*r):(u=d,c=d/r),o=(e-u)/2,a=(t-c)/2,l?{x:o+.1*u,y:a+.1*c,w:.8*u,h:.8*c}:{x:o,y:a,w:u,h:c}}.call(this,n,r,d,s,c,f),v=g.w,E=g.h,I=g.x,b=g.y;if(v!=T||E!=p||I!=h||b!=m||t){if(h=I+u,m=b+a,T=v,p=E,y){var S=y.style;S&&(S.left=h+"px",S.top=m+"px",S.width=T+"px",S.height=p+"px",S.zIndex=x&&document[x]||C?k:null,i.trigger(l.default.CAPTION_CONTAINER_RESIZE,{}))}var D=e.activeCues;if(D)for(var z=D.length,R=0;R<z;++R){var _=D[R];_.scaleCue(_)}}}function D(e){var t=T,i=p,n=void 0,r=void 0,l=void 0,d=void 0,s=void 0;if(e.cellResolution){var o=[t/e.cellResolution[0],i/e.cellResolution[1]];if(e.linePadding)for(n in e.linePadding)if(e.linePadding.hasOwnProperty(n)){r=(e.linePadding[n]*o[0]).toString();for(var a=document.getElementsByClassName("spanPadding"),u=0;u<a.length;u++)a[u].style.cssText=a[u].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r),a[u].style.cssText=a[u].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}if(e.fontSize){for(n in e.fontSize)if(e.fontSize.hasOwnProperty(n)){"%"===e.fontSize[n][0]?l=e.fontSize[n][1]/100:"c"===e.fontSize[n][0]&&(l=e.fontSize[n][1]),r=(l*o[1]).toString(),s="defaultFontSize"!==n?document.getElementsByClassName(n):document.getElementsByClassName("paragraph");for(var c=0;c<s.length;c++)s[c].style.cssText=s[c].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}if(e.lineHeight)for(n in e.lineHeight)if(e.lineHeight.hasOwnProperty(n)){"%"===e.lineHeight[n][0]?d=e.lineHeight[n][1]/100:"c"===e.fontSize[n][0]&&(d=e.lineHeight[n][1]),r=(d*o[1]).toString(),s=document.getElementsByClassName(n);for(var f=0;f<s.length;f++)s[f].style.cssText=s[f].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}}}if(e.isd){var g=document.getElementById(e.cueID);g&&y.removeChild(g),z(e)}}function z(e){if(y){var t=document.createElement("div");y.appendChild(t),I=(0,u.renderHTML)(e.isd,t,function(t){var i=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,n=/^#(.*)$/;if(i.test(t)){var r=i.exec(t),l=parseInt(r[4],10)-1;return"data:image/png;base64,"+btoa(e.images[l])}if(n.test(t)){var d=n.exec(t)[1];return"data:image/png;base64,"+e.embeddedImages[d]}return null},y.clientHeight,y.clientWidth,!1,function(e){d.info("renderCaption :",e)},I,!0),t.id=e.cueID,i.trigger(l.default.CAPTION_RENDERED,{captionDiv:t,currentTrackIdx:v})}}function R(e){return e>=0&&f[e]?o.getTextTrack(f[e].kind,f[e].id,f[e].lang,f[e].isTTML,f[e].isEmbedded):null}function _(e){if(e!==v){var t=R(v=e);(function(e){w.call(this),e&&"html"===e.renderingType?function(){var e=document.getElementById("native-cue-style");if(e)return;(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,i=o.getElement();try{i&&(i.id?t.insertRule("#"+i.id+"::cue {background: transparent}",0):0!==i.classList.length?t.insertRule("."+i.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(n){d.info(""+n.message)}}.call(this):N.call(this)}).call(this,t),E&&(clearInterval(E),E=null),t&&"html"===t.renderingType&&(S.call(this,t,!0),E=setInterval(S.bind(this,t),500))}}function H(e){if(e.cues)for(var t=e.cues,i=t.length-1;i>=0;i--)e.removeCue(t[i])}function N(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function w(){if(y)for(;y.firstChild;)y.removeChild(y.firstChild)}return r={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(s=window.VTTCue||window.TextTrackCue,f=[],g=[],v=-1,h=0,m=0,T=0,p=0,y=null,E=null,C=!1,k=2147483647,I=null,void 0!==document.fullscreenElement?x="fullscreenElement":void 0!==document.webkitIsFullScreen?x="webkitIsFullScreen":document.msFullscreenElement?x="msFullscreenElement":document.mozFullScreen&&(x="mozFullScreen"))},setDisplayCConTop:function(e){(0,c.checkParameterType)(e,"boolean"),C=e,y&&!document[x]&&(y.style.zIndex=e?k:null)},addTextTrack:function(e,n){if(f.length!==n){if(f.push(e),f.length===n){f.sort(function(e,t){return e.index-t.index}),y=o.getTTMLRenderingDiv();for(var r=-1,s=0;s<f.length;s++){var a=b.call(this,s);g.push(a),f[s].defaultTrack&&(a.default=!0,r=s);var u=R(s);u&&(u.mode=t.default.TEXT_SHOWING,y&&(f[s].isTTML||f[s].isEmbedded)?u.renderingType="html":u.renderingType="default"),this.addCaptions(s,0,f[s].captionData),i.trigger(l.default.TEXT_TRACK_ADDED)}if(_.call(this,r),r>=0)for(var c=0;c<f.length;c++){var h=R(c);h&&(h.mode=c===r?t.default.TEXT_SHOWING:t.default.TEXT_HIDDEN)}i.trigger(l.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:v,tracks:f})}}else d.error("Trying to add too many tracks.")},addCaptions:function(e,n,r){var o=R(e),a=this;if(o&&Array.isArray(r)&&0!==r.length)for(var u=0;u<r.length;u++){var c=void 0,f=r[u];o.cellResolution=f.cellResolution,o.isFromCEA608=f.isFromCEA608,"html"===f.type&&y?((c=new s(f.start-n,f.end-n,"")).cueHTMLElement=f.cueHTMLElement,c.isd=f.isd,c.images=f.images,c.embeddedImages=f.embeddedImages,c.cueID=f.cueID,c.scaleCue=D.bind(a),c.cellResolution=f.cellResolution,c.lineHeight=f.lineHeight,c.linePadding=f.linePadding,c.fontSize=f.fontSize,y.style.left=h+"px",y.style.top=m+"px",y.style.width=T+"px",y.style.height=p+"px",c.onenter=function(){o.mode===t.default.TEXT_SHOWING&&(this.isd?(z(this),d.debug("Cue enter id:"+this.cueID)):(y.appendChild(this.cueHTMLElement),D.call(a,this),i.trigger(l.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:v})))},c.onexit=function(){if(y)for(var e=y.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(d.debug("Cue exit id:"+e[t].id),y.removeChild(e[t]),--t)}):f.data&&(c=new s(f.start-n,f.end-n,f.data),f.styles&&(void 0!==f.styles.align&&"align"in c&&(c.align=f.styles.align),void 0!==f.styles.line&&"line"in c&&(c.line=f.styles.line),void 0!==f.styles.position&&"position"in c&&(c.position=f.styles.position),void 0!==f.styles.size&&"size"in c&&(c.size=f.styles.size)),c.onenter=function(){o.mode===t.default.TEXT_SHOWING&&i.trigger(l.default.CAPTION_RENDERED,{currentTrackIdx:v})});try{c?o.addCue(c):d.error("impossible to display subtitles.")}catch(g){throw H(o),o.addCue(c),g}}},getCurrentTrackIdx:function(){return v},setCurrentTrackIdx:_,getTrackIdxForId:function(e){for(var t=-1,i=0;i<f.length;i++)if(f[i].id===e){t=i;break}return t},getCurrentTrackInfo:function(){return f[v]},setModeForTrackIdx:function(e,t){var i=R(e);i&&i.mode!==t&&(i.mode=t)},deleteCuesFromTrackIdx:function(e){var t=R(e);t&&H(t)},deleteAllTextTracks:function(){for(var e=g?g.length:0,t=0;t<e;t++){var i=R(t);i&&(H.call(this,i),i.mode="disabled")}g=[],f=[],E&&(clearInterval(E),E=null),v=-1,w.call(this)},deleteTextTrack:function(e){o.removeChild(g[e]),g.splice(e,1)},setConfig:function(e){e&&e.videoModel&&(o=e.videoModel)}},d=(0,a.default)(e).getInstance().getLogger(r),r}g.__dashjs_factory_name="TextTracks",exports.default=s.default.getSingletonFactory(g);
},{"../constants/Constants":"jJgo","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","imsc":"VbxE","../utils/SupervisorTools":"A0aa"}],"x4Zx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),n=t(e);function t(e){return e&&e.__esModule?e:{default:e}}function r(){var e=0;function n(e){for(var n="",t=0;t<e.length;++t){n+=e[t].uchar}return n.length-n.replace(/^\s+/,"").length}function t(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function r(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function a(e,n){var t=e.videoHeight/15;return n?"font-size: "+t+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(n.foreground?r(n.foreground):"rgb(255, 255, 255)")+"; font-style: "+(n.italics?"italic":"normal")+"; text-decoration: "+(n.underline?"underline":"none")+"; white-space: pre; background-color: "+(n.background?r(n.background):"transparent")+";":"font-size: "+t+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function o(e){return e.replace(/^\s+/g,"")}function l(e){return e.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(r,s,i,p){var c=null,u=!1,d=-1,m={start:s,end:i,spans:[]},h="style_cea608_white_black",g={},f={},y=[],v=void 0,b=void 0;for(v=0;v<15;++v){var x=p.rows[v],_="",w=null;if(!1===x.isEmpty()){var C=n(x.chars);null===c&&(c={x:C,y1:v,y2:v+1,p:[]}),C!==d&&u&&(c.p.push(m),m={start:s,end:i,spans:[]},c.y2=v,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===g.hasOwnProperty(c.name)?(y.push(c),g[c.name]=c):g[c.name].p.contat(c.p),c={x:C,y1:v,y2:v+1,p:[]});for(var M=0;M<x.chars.length;++M){var k=x.chars[M],E=k.penState;if(null===w||!E.equals(w)){_.trim().length>0&&(m.spans.push({name:h,line:_,row:v}),_="");var S="style_cea608_"+E.foreground+"_"+E.background;E.underline&&(S+="_underline"),E.italics&&(S+="_italics"),f.hasOwnProperty(S)||(f[S]=JSON.parse(JSON.stringify(E))),w=E,h=S}_+=k.uchar}_.trim().length>0&&m.spans.push({name:h,line:_,row:v}),u=!0,d=C}else u=!1,d=-1,c&&(c.p.push(m),m={start:s,end:i,spans:[]},c.y2=v,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===g.hasOwnProperty(c.name)?(y.push(c),g[c.name]=c):g[c.name].p.contat(c.p),c=null)}c&&(c.p.push(m),c.y2=v+1,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===g.hasOwnProperty(c.name)?(y.push(c),g[c.name]=c):g[c.name].p.contat(c.p),c=null);var O=[];for(v=0;v<y.length;++v){var P=y[v],T="sub_cea608_"+e++,N=document.createElement("div");N.id=T;var z=t(P);N.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+z;var H=document.createElement("div");H.className="paragraph bodyStyle",H.style.cssText=a(r);var F=document.createElement("div");F.className="cueUniWrapper",F.style.cssText="unicode-bidi: normal; direction: ltr;";for(var j=0;j<P.p.length;++j){var q=P.p[j],J=0;for(b=0;b<q.spans.length;++b){var L=q.spans[b];if(L.line.length>0){if(0!==b&&J!=L.row){var R=document.createElement("br");R.className="lineBreak",F.appendChild(R)}var A=!1;J===L.row&&(A=!0),J=L.row;var B=f[L.name],D=document.createElement("span");D.className="spanPadding "+L.name+" customSpanColor",D.style.cssText=a(r,B),0!==b&&A?b===q.spans.length-1?D.textContent=l(L.line):D.textContent=L.line:q.spans.length>1&&b<q.spans.length-1&&L.row===q.spans[b+1].row?D.textContent=o(L.line):D.textContent=L.line.trim(),F.appendChild(D)}}}H.appendChild(F),N.appendChild(H);var I={bodyStyle:["%",90]};for(var U in f)f.hasOwnProperty(U)&&(I[U]=["%",90]);O.push({type:"html",start:s,end:i,cueHTMLElement:N,cueID:T,cellResolution:[32,15],isFromCEA608:!0,fontSize:I,lineHeight:{},linePadding:{}})}return O}}}r.__dashjs_factory_name="EmbeddedTextHtmlRender",exports.default=n.default.getSingletonFactory(r);
},{"../../core/FactoryMaker":"FHM8"}],"Wrqa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var E=require("./ErrorsBase"),_=R(E);function R(E){return E&&E.__esModule?E:{default:E}}function e(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")}function O(E,_){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!_||"object"!=typeof _&&"function"!=typeof _?E:_}function A(E,_){if("function"!=typeof _&&null!==_)throw new TypeError("Super expression must either be null or a function, not "+typeof _);E.prototype=Object.create(_&&_.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(E,_):E.__proto__=_)}var D=function(E){function R(){e(this,R);var E=O(this,(R.__proto__||Object.getPrototypeOf(R)).call(this));return E.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,E.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,E.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,E.SEGMENTS_UPDATE_FAILED_ERROR_CODE=13,E.SEGMENTS_UNAVAILABLE_ERROR_CODE=14,E.SEGMENT_BASE_LOADER_ERROR_CODE=15,E.TIME_SYNC_FAILED_ERROR_CODE=16,E.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,E.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,E.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,E.APPEND_ERROR_CODE=20,E.REMOVE_ERROR_CODE=21,E.DATA_UPDATE_FAILED_ERROR_CODE=22,E.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,E.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,E.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,E.DOWNLOAD_ERROR_ID_SIDX_CODE=26,E.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,E.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,E.DOWNLOAD_ERROR_ID_XLINK_CODE=29,E.MANIFEST_ERROR_ID_CODEC_CODE=30,E.MANIFEST_ERROR_ID_PARSE_CODE=31,E.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,E.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,E.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,E.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,E.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",E.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",E.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",E.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",E.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",E.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segments",E.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize time",E.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",E.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",E.APPEND_ERROR_MESSAGE="chunk is not defined",E.REMOVE_ERROR_MESSAGE="buffer is not defined",E.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",E.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",E.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",E.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",E.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",E}return A(R,_.default),R}(),t=new D;exports.default=t;
},{"./ErrorsBase":"zN1Q"}],"EyvP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=D(e),r=require("../vo/metrics/HTTPRequest"),a=require("../vo/TextTrackInfo"),i=D(a),n=require("../utils/BoxParser"),d=D(n),o=require("../utils/CustomTimeRanges"),l=D(o),s=require("../../core/FactoryMaker"),u=D(s),f=require("../../core/Debug"),c=D(f),v=require("./TextTracks"),T=D(v),g=require("./EmbeddedTextHtmlRender"),m=D(g),h=require("codem-isoboxer"),p=D(h),b=require("../../../externals/cea608-parser"),E=D(b),C=require("../../core/EventBus"),x=D(C),I=require("../../core/events/Events"),y=D(I),M=require("../vo/DashJSError"),S=D(M),_=require("../../core/errors/Errors"),k=D(_);function D(e){return e&&e.__esModule?e:{default:e}}function R(){var e=this.context,a=(0,x.default)(e).getInstance(),n=!1,o=void 0,s=void 0,u=void 0,f=void 0,v=void 0,g=void 0,h=void 0,b=void 0,C=void 0,I=void 0,M=void 0,_=void 0,D=void 0,R=void 0,q=void 0,P=void 0,F=void 0,V=void 0,w=void 0,A=void 0,N=void 0,z=void 0,L=void 0,O=void 0,H=void 0,U=void 0,X=void 0;function B(){D=null,q=NaN,P=[],w=null,R=!1}function G(){B(),M=[],b=null}function j(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&Q(t.bytes,t)}function K(){N=[],(_=(0,T.default)(e).getInstance()).setConfig({videoModel:F}),_.initialize(),u=(0,d.default)(e).getInstance(),A=null,z=0,H=[],O=[],L=null,n=!0,U=(0,m.default)(e).getInstance();var t=V.getActiveStreamProcessors();for(var r in t)if("video"===t[r].getType()){X=t[r].getRepresentationInfo().MSETimeOffset;break}a.on(y.default.VIDEO_CHUNK_RECEIVED,j,this)}function J(e){A=e}function Y(e,r){var a,n,d=new i.default,o={subtitle:"subtitles",caption:"captions"};d.captionData=e,d.lang=r.lang,d.labels=r.labels,d.id=r.id?r.id:r.index,d.index=r.index,d.isTTML=(a=!1,r.codec&&r.codec.search(t.default.STPP)>=0&&(a=!0),r.mimeType&&r.mimeType.search(t.default.TTML)>=0&&(a=!0),a),d.defaultTrack=function(e){var r=!1;N.length>1&&e.isEmbedded?r=e.id&&e.id===t.default.CC1:1===N.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(r=!0):0===N.length&&(r=e.index===M[0].index);return r}(r),d.isFragmented=!v.getIsTextTrack(r.mimeType),d.isEmbedded=!!r.isEmbedded,d.kind=n=(n=r.roles.length>0?o[r.roles[0]]:o.caption)===o.caption||n===o.subtitle?n:o.caption,d.roles=r.roles,d.accessibility=r.accessibility;var l=(M?M.length:0)+N.length;_.addTextTrack(d,l)}function Q(e,a){var i=void 0,n=void 0,d=void 0,o=void 0,l=void 0,c=void 0,v=void 0,T=a.mediaInfo,m=T.type,h=T.mimeType,C=T.codec||h;if(C){if(m===t.default.FRAGMENTED_TEXT)if(R||"InitializationSegment"!==a.segmentType){if(!R)return;if(n=(c=u.getSamplesInfo(e)).sampleList,null===w&&n.length>0&&(w=n[0].cts-a.start*q),C.search(t.default.STPP)>=0)for(b=null!==b?b:W(C),d=0;d<n.length;d++){var x=n[d],I=x.cts,y=I-w;this.buffered.add(y/q,(y+x.duration)/q);var M=new DataView(e,x.offset,x.subSizes[0]);v=p.default.Utils.dataViewToString(M,t.default.UTF8);var P=[],V=x.offset+x.subSizes[0];for(o=1;o<x.subSizes.length;o++){var B=new Uint8Array(e,V,x.subSizes[o]),G=String.fromCharCode.apply(null,B);P.push(G),V+=x.subSizes[o]}try{var j=g.getValue().ttmlTimeIsRelative?I/q:0;i=b.parse(v,j,I/q,(I+x.duration)/q,P),_.addCaptions(A,w/q,i)}catch(ve){D.removeExecutedRequestsBeforeTime(),this.remove(),s.error("TTML parser error: "+ve.message)}}else{var K=[];for(d=0;d<n.length;d++){var J=n[d];J.cts-=w,this.buffered.add(J.cts/q,(J.cts+J.duration)/q);var Q=e.slice(J.offset,J.offset+J.size),Z=p.default.parseBuffer(Q);for(o=0;o<Z.boxes.length;o++){var $=Z.boxes[o];if(s.debug("VTT box1: "+$.type),"vtte"!==$.type&&"vttc"===$.type)for(s.debug("VTT vttc boxes.length = "+$.boxes.length),l=0;l<$.boxes.length;l++){var ee=$.boxes[l];if(s.debug("VTT box2: "+ee.type),"payl"===ee.type){var te=ee.cue_text;s.debug("VTT cue_text = "+te);var re=J.cts/q,ae=(J.cts+J.duration)/q;K.push({start:re,end:ae,data:te,styles:{}}),s.debug("VTT "+re+"-"+ae+" : "+te)}}}}K.length>0&&_.addCaptions(A,0,K)}}else R=!0,q=u.getMediaTimescaleFromMoov(e);else if(m===t.default.TEXT){var ie=new DataView(e,0,e.byteLength);v=p.default.Utils.dataViewToString(ie,t.default.UTF8);try{i=W(C).parse(v,0),_.addCaptions(_.getCurrentTrackIdx(),0,i)}catch(ve){f.error(new S.default(k.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,k.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+ve.message,v))}}else if(m===t.default.VIDEO)if(a.segmentType===r.HTTPRequest.INIT_SEGMENT_TYPE){if(0===z)for(z=u.getMediaTimescaleFromMoov(e),d=0;d<N.length;d++)Y(null,N[d])}else{if(0===z)return void s.warn("CEA-608: No timescale for embeddedTextTrack yet");var ne=function(e,t){return function(e,r,a){var i=null;i=F.getTTMLRenderingDiv()?U.createHTMLCaptionsFromScreen(F.getElement(),e,r,a):[{start:e,end:r,data:a.getDisplayText(),styles:{}}],i&&_.addCaptions(t,0,i)}},de=(c=u.getSamplesInfo(e)).lastSequenceNumber;if(!H[0]&&!H[1]){var oe=void 0,le=void 0;for(d=0;d<N.length;d++){if(N[d].id===t.default.CC1?(0,le=_.getTrackIdxForId(t.default.CC1)):N[d].id===t.default.CC3&&(1,le=_.getTrackIdxForId(t.default.CC3)),-1===le)return void s.warn("CEA-608: data before track is ready.");oe=ne(0,le),H[d]=new E.default.Cea608Parser(d+1,{newCue:oe},null)}}if(z&&-1==O.indexOf(de)){if(null!==L&&de!==L+c.numSequences)for(d=0;d<H.length;d++)H[d]&&H[d].reset();for(var se=function(e,t){if(0===t.length)return null;for(var r={splits:[],fields:[[],[]]},a=new DataView(e),i=0;i<t.length;i++)for(var n=t[i],d=E.default.findCea608Nalus(a,n.offset,n.size),o=null,l=0,s=0;s<d.length;s++)for(var u=E.default.extractCea608DataFromRange(a,d[s]),f=0;f<2;f++)u[f].length>0&&(n.cts!==o?l=0:l+=1,r.fields[f].push([n.cts+X*z,u[f],l]),o=n.cts);return r.fields.forEach(function(e){e.sort(function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]})}),r}(e,c.sampleList),ue=0;ue<H.length;ue++){var fe=se.fields[ue],ce=H[ue];if(ce)for(d=0;d<fe.length;d++)ce.addData(fe[d][0]/z,fe[d][1])}L=de,O.push(de)}}}else s.error("No text type defined")}function W(e){var r=void 0;return e.search(t.default.VTT)>=0?r=C:(e.search(t.default.TTML)>=0||e.search(t.default.STPP)>=0)&&(r=I),r}return o={initialize:function(r,a){n||K(),_.setConfig({videoModel:F}),_.initialize(),u||(u=(0,d.default)(e).getInstance()),function(r,a){var i=!v.getIsTextTrack(r);if(a){if(M=M.concat(a.getMediaInfoArr()),i){D=a.getFragmentModel(),o.buffered=(0,l.default)(e).create(),P=h.getTracksFor(t.default.FRAGMENTED_TEXT,a.getStreamInfo());for(var n=h.getCurrentTrackFor(t.default.FRAGMENTED_TEXT,a.getStreamInfo()),d=0;d<P.length;d++)if(P[d]===n){J(d);break}}for(var s=0;s<M.length;s++)Y(null,M[s])}}(r,a)},append:Q,abort:function(){_.deleteAllTextTracks(),B(),u=null,M=[]},addEmbeddedTrack:function(e){if(n||K(),e)if(e.id===t.default.CC1||e.id===t.default.CC3){for(var r=0;r<N.length;r++)if(N[r].id===e.id)return;N.push(e)}else s.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){a.off(y.default.VIDEO_CHUNK_RECEIVED,j,this),_&&_.deleteAllTextTracks(),n=!1,N=[],H=[null,null],O=[],L=null},setConfig:function(e){e&&(e.errHandler&&(f=e.errHandler),e.adapter&&(v=e.adapter),e.manifestModel&&(g=e.manifestModel),e.mediaController&&(h=e.mediaController),e.videoModel&&(F=e.videoModel),e.streamController&&(V=e.streamController),e.textTracks&&(_=e.textTracks),e.vttParser&&(C=e.vttParser),e.ttmlParser&&(I=e.ttmlParser))},getConfig:function(){return{fragmentModel:D,fragmentedTracks:P,videoModel:F}},setCurrentFragmentedTrackIdx:J,remove:function(e,t){void 0===e&&e===t&&(e=this.buffered.start(0),t=this.buffered.end(this.buffered.length-1)),this.buffered.remove(e,t)},reset:function(){G(),V=null,F=null,_=null}},s=(0,c.default)(e).getInstance().getLogger(o),G(),o}R.__dashjs_factory_name="TextSourceBuffer",exports.default=u.default.getSingletonFactory(R);
},{"../constants/Constants":"jJgo","../vo/metrics/HTTPRequest":"yMBz","../vo/TextTrackInfo":"r8R8","../utils/BoxParser":"Yc5r","../utils/CustomTimeRanges":"j59Z","../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","./TextTracks":"cnD0","./EmbeddedTextHtmlRender":"x4Zx","codem-isoboxer":"tss1","../../../externals/cea608-parser":"xj1q","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../vo/DashJSError":"gyaG","../../core/errors/Errors":"Wrqa"}],"TDan":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=i(e),r=require("../../core/Debug"),a=i(r);function i(e){return e&&e.__esModule?e:{default:e}}var n="WEBVTT";function o(){var e=this.context,t=void 0,r=void 0,i=void 0,o=void 0,s=void 0,c=void 0;function u(e){var t=e.split(":"),r=t.length-1;return e=60*parseInt(t[r-1],10)+parseFloat(t[r]),2===r&&(e+=3600*parseInt(t[0],10)),e}function l(e){var t=e.split(o),r=t[1].split(c);return r.shift(),t[1]=r[0],r.shift(),{cuePoints:t,styles:f(r)}}function f(e){var t={};return e.forEach(function(e){if(e.split(/:/).length>1){var r=e.split(/:/)[1];r&&-1!=r.search(/%/)&&(r=parseInt(r.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=r),(e.match(/line/)||e.match(/L/))&&(t.line=r),(e.match(/position/)||e.match(/P/))&&(t.position=r),(e.match(/size/)||e.match(/S/))&&(t.size=r)}}),t}function p(e,t){for(var r,a=t,i="",n="";""!==e[a]&&a<e.length;)a++;if((r=a-t)>1)for(var s=0;s<r;s++){if((n=e[t+s]).match(o)){i="";break}i+=n,s!==r-1&&(i+="\n")}else(n=e[t]).match(o)||(i=n);return i}return t={parse:function(e){var t,a=[],c=void 0;if(!e)return a;t=(e=e.split(i)).length,c=-1;for(var f=0;f<t;f++){var h=e[f];if(h.length>0&&h!==n&&h.match(o)){var v=l(h),d=v.cuePoints,g=v.styles,m=p(e,f+1),y=u(d[0].replace(s,"")),_=u(d[1].replace(s,""));!isNaN(y)&&!isNaN(_)&&y>=c&&_>y?""!==m?(c=y,a.push({start:y,end:_,data:m,styles:g})):r.error("Skipping cue due to empty/malformed cue text"):r.error("Skipping cue due to incorrect cue timing")}}return a}},r=(0,a.default)(e).getInstance().getLogger(t),i=/(?:\r\n|\r|\n)/gm,o=/-->/,s=/(^[\s]+|[\s]+$)/g,c=/\s\b/g,t}o.__dashjs_factory_name="VTTParser",exports.default=t.default.getSingletonFactory(o);
},{"../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O"}],"AXZD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=d(e),r=require("../../core/Debug"),n=d(r),a=require("../../core/EventBus"),o=d(a),i=require("../../core/events/Events"),u=d(i),s=require("imsc");function d(e){return e&&e.__esModule?e:{default:e}}function c(){var e=this.context,t=(0,o.default)(e).getInstance(),r=void 0,a=void 0,i=0;return r={parse:function(e,r,n,o,d){var c="",g=[],f=void 0,m=void 0,l=void 0,v={},p={},T="",_="",w={onOpenTag:function(e,t,r){if("image"===t&&"http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e){if(!r[" imagetype"]||"PNG"!==r[" imagetype"].value)return void a.warn("smpte-tt imagetype != PNG. Discarded");T=r["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){T&&(p[T]=_.trim()),_="",T=""},onText:function(e){T&&(_+=e)}};if(!e)throw c="no ttml data to parse",new Error(c);v.data=e,t.trigger(u.default.TTML_TO_PARSE,v);var h=(0,s.fromXML)(v.data,function(e){c=e},w);t.trigger(u.default.TTML_PARSED,{ttmlString:v.data,ttmlDoc:h});var M,y=h.getMediaTimeEvents();for(l=0;l<y.length;l++){var E=(0,s.generateISD)(h,y[l],function(e){c=e});E.contents.some(function(e){return e.contents.length})&&(f=y[l]+r<n?n:y[l]+r)<(m=y[l+1]+r>o?o:y[l+1]+r)&&g.push({start:f,end:m,type:"html",cueID:(M=void 0,M="cue_TTML_"+i,i++,M),isd:E,images:d,embeddedImages:p})}if(""!==c)throw a.error(c),new Error(c);return g}},a=(0,n.default)(e).getInstance().getLogger(r),r}c.__dashjs_factory_name="TTMLParser",exports.default=t.default.getSingletonFactory(c);
},{"../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","imsc":"VbxE"}],"IrZJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=k(e),r=require("../../core/FactoryMaker"),a=k(r),n=require("./TextSourceBuffer"),o=k(n),i=require("./TextTracks"),d=k(i),s=require("../utils/VTTParser"),u=k(s),l=require("../utils/TTMLParser"),c=k(l),T=require("../../core/EventBus"),f=k(T),g=require("../../core/events/Events"),v=k(g),x=require("../utils/SupervisorTools");function k(e){return e&&e.__esModule?e:{default:e}}function m(){var e=this.context,r=void 0,a=void 0,n=void 0,i=void 0,s=void 0,l=void 0,T=void 0,g=void 0,k=void 0,m=void 0,E=void 0,I=void 0,C=void 0,_=void 0,M=void 0,h=void 0,b=void 0,P=void 0;function D(e){void 0===P&&null!==e.fromStreamInfo&&(P=this.getCurrentTrackIdx())}function S(){void 0===P&&(P=this.getCurrentTrackIdx())}function A(){void 0!==P&&(this.setTextTrack(P),P=void 0)}function p(e){var t=this,r=e.tracks,a=e.index;r.some(function(e,r){if(e.lang===C)return t.setTextTrack(r),a=r,!0}),M||this.setTextTrack(-1),_=a,I.trigger(v.default.TEXT_TRACKS_ADDED,{enabled:F(),index:a,tracks:r})}function F(){var e=!0;return h&&!b&&(e=!1),e}function q(){h=!1}return r={setConfig:function(e){e&&(e.errHandler&&(n=e.errHandler),e.adapter&&(i=e.adapter),e.manifestModel&&(s=e.manifestModel),e.mediaController&&(l=e.mediaController),e.videoModel&&(T=e.videoModel),e.streamController&&(g=e.streamController),e.textTracks&&(k=e.textTracks),e.vttParser&&(m=e.vttParser),e.ttmlParser&&(E=e.ttmlParser),a.setConfig({errHandler:n,adapter:i,manifestModel:s,mediaController:l,videoModel:T,streamController:g,textTracks:k,vttParser:m,ttmlParser:E}))},getTextSourceBuffer:function(){return a},getAllTracksAreDisabled:function(){return h},addEmbeddedTrack:function(e){a.addEmbeddedTrack(e)},getTextDefaultLanguage:function(){return C},setTextDefaultLanguage:function(e){(0,x.checkParameterType)(e,"string"),C=e},setTextDefaultEnabled:function(e){(0,x.checkParameterType)(e,"boolean"),(M=e)||this.setTextTrack(-1)},getTextDefaultEnabled:function(){return M},enableText:function(e){(0,x.checkParameterType)(e,"boolean"),F()!==e&&(e&&this.setTextTrack(_),e||(_=this.getCurrentTrackIdx(),this.setTextTrack(-1)))},isTextEnabled:F,setTextTrack:function(e){var r=a.getConfig(),n=r.fragmentModel,o=r.fragmentedTracks,i=r.videoModel,d=void 0,s=void 0;h=-1===e;var u=k.getCurrentTrackIdx();if(u!==e){k.setModeForTrackIdx(u,t.default.TEXT_HIDDEN),k.setCurrentTrackIdx(e),k.setModeForTrackIdx(e,t.default.TEXT_SHOWING);var c=k.getCurrentTrackInfo();if(c&&c.isFragmented&&!c.isEmbedded)for(var T=0;T<o.length;T++){var f=o[T];if(c.lang===f.lang&&c.index===f.index&&(f.id?c.id===f.id:c.id===f.index))if(f!==l.getCurrentTrackFor(t.default.FRAGMENTED_TEXT,g.getActiveStreamInfo()))n.abortRequests(),n.removeExecutedRequestsBeforeTime(),a.remove(),k.deleteCuesFromTrackIdx(u),l.setTrack(f),a.setCurrentFragmentedTrackIdx(T);else if(-1===u){for(var v=g.getActiveStreamProcessors(),x=0;x<v.length;x++)if(v[x].getType()===t.default.FRAGMENTED_TEXT){s=v[x];break}s.setIndexHandlerTime(i.getTime()),s.getScheduleController().start()}}else if(c&&!c.isFragmented){for(var m=g.getActiveStreamProcessors(),E=0;E<m.length;E++)if(m[E].getType()===t.default.TEXT){d=(s=m[E]).getMediaInfoArr();break}if(s&&d)for(var I=0;I<d.length;I++)if(d[I].index===c.index&&d[I].lang===c.lang){s.selectMediaInfo(d[I]);break}}}},getCurrentTrackIdx:function(){return k.getCurrentTrackIdx()},enableForcedTextStreaming:function(e){(0,x.checkParameterType)(e,"boolean"),b=e},reset:function(){q(),a.resetEmbedded(),a.reset()}},C="",_=-1,M=!0,b=!1,k=(0,d.default)(e).getInstance(),m=(0,u.default)(e).getInstance(),E=(0,c.default)(e).getInstance(),a=(0,o.default)(e).getInstance(),I=(0,f.default)(e).getInstance(),k.initialize(),I.on(v.default.TEXT_TRACKS_QUEUE_INITIALIZED,p,r),I.on(v.default.PERIOD_SWITCH_STARTED,D,r),I.on(v.default.STREAM_COMPLETED,S,r),I.on(v.default.PERIOD_SWITCH_COMPLETED,A,r),q(),r}m.__dashjs_factory_name="TextController",exports.default=a.default.getSingletonFactory(m);
},{"../constants/Constants":"jJgo","../../core/FactoryMaker":"FHM8","./TextSourceBuffer":"EyvP","./TextTracks":"cnD0","../utils/VTTParser":"TDan","../utils/TTMLParser":"AXZD","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../utils/SupervisorTools":"A0aa"}],"mFuc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../core/Debug"),t=p(e),r=require("./vo/DashJSError"),n=p(r),a=require("../core/EventBus"),o=p(a),u=require("../core/events/Events"),i=p(u),f=require("../core/FactoryMaker"),c=p(f),s=require("./text/TextController"),d=p(s),l=require("../core/errors/Errors"),g=p(l);function p(e){return e&&e.__esModule?e:{default:e}}var h=.1;function v(e,r,a,u){var f=this.context,c=(0,o.default)(f).getInstance(),s=void 0,l=void 0,p=void 0,v=void 0,E=void 0,m=[],y=[],b=a;function S(){try{return p.buffered}catch(e){return l.error("getAllBufferRanges exception: "+e.message),null}}function O(){if(m.length>0){var e=m.shift();p.updating?x(e):(e(),O())}}function _(){p.updating||O()}function B(){p.updating||O()}function R(){l.error("SourceBufferSink error",r.type)}function x(e){m.push(e),p.updating||O()}return s={getAllBufferRanges:S,getBuffer:function(){return p},append:function(e){e?(y.push(e),v||x(function e(){var t=this;if(y.length>0){v=!0;var r=y[0];y.splice(0,1);var a=[],o=function(){var n=S();!function(e,t,r,n){t&&t.length>0&&t.length<r.length&&function(e,t){for(var r=0;r<e.length;r++){var n=Math.round(e.start(r)),a=Math.round(e.end(r));if(a===t.start||n===t.end||t.start>=n&&t.end<=a)return!0}return!1}(t,n)&&c.trigger(i.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:r.end(r.length-2),to:r.start(r.length-1),unintended:!0})}(t,a,n,r),y.length>0?e.call(this):(v=!1,b&&b({chunk:r}))};try{0===r.bytes.length?o.call(this):(a=S(),p.appendBuffer?p.appendBuffer(r.bytes):p.append(r.bytes,r),x(o.bind(this)))}catch(u){l.fatal('SourceBuffer append failed "'+u+'"'),y.length>0?e():v=!1,b&&b({chunk:r,error:new n.default(u.code,u.message)})}}}.bind(this))):b({chunk:e,error:new n.default(g.default.APPEND_ERROR_CODE,g.default.APPEND_ERROR_MESSAGE)})},remove:function(t,r,a){var o=this;x(function(){try{t>=0&&r>t&&(a||"ended"!==e.readyState)&&p.remove(t,r),x(function(){c.trigger(i.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:o,from:t,to:r,unintended:!1})})}catch(u){c.trigger(i.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:o,from:t,to:r,unintended:!1,error:new n.default(u.code,u.message)})}})},abort:function(){try{"open"===e.readyState?p.abort():p.setTextTrack&&"ended"===e.readyState&&p.abort()}catch(t){l.error('SourceBuffer append abort failed: "'+t+'"')}y=[]},reset:function(t){if(p){if("function"==typeof p.removeEventListener&&(p.removeEventListener("updateend",B,!1),p.removeEventListener("error",R,!1),p.removeEventListener("abort",R,!1)),clearInterval(E),!t){try{p.getClassName&&"TextSourceBuffer"===p.getClassName()||e.removeSourceBuffer(p)}catch(r){l.error("Failed to remove source buffer from media source.")}p=null}v=!1}y=[],b=null},updateTimestampOffset:function(e){p.timestampOffset===e||isNaN(e)||x(function(){p.timestampOffset=e})},hasDiscontinuitiesAfter:function(e){try{var t=S();if(t&&t.length>1)for(var r=0,n=t.length;r<n;r++)if(r>0&&e<t.start(r)&&t.start(r)>t.end(r-1)+h)return!0}catch(a){l.error("hasDiscontinuities exception: "+a.message)}return!1},waitForUpdateEnd:x},function(){l=(0,t.default)(f).getInstance().getLogger(s),v=!1;var n=r.codec;try{if(n.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new Error("not really supported");if((p=u||e.addSourceBuffer(n)).changeType&&u&&(l.debug("Doing period transition with changeType"),p.changeType(n)),"function"==typeof p.addEventListener)try{p.addEventListener("updateend",B,!1),p.addEventListener("error",R,!1),p.addEventListener("abort",R,!1)}catch(o){E=setInterval(_,50)}else E=setInterval(_,50)}catch(i){if(!r.isText&&-1===n.indexOf('codecs="stpp')&&-1===n.indexOf('codecs="wvtt'))throw i;var a=(0,d.default)(f).getInstance();p=a.getTextSourceBuffer()}}(),s}v.__dashjs_factory_name="SourceBufferSink";var E=c.default.getClassFactory(v);exports.default=E;
},{"../core/Debug":"iL1O","./vo/DashJSError":"gyaG","../core/EventBus":"Opee","../core/events/Events":"W3G1","../core/FactoryMaker":"FHM8","./text/TextController":"IrZJ","../core/errors/Errors":"Wrqa"}],"A6uG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../core/Debug"),e=u(t),n=require("../core/FactoryMaker"),r=u(n);function u(t){return t&&t.__esModule?t:{default:t}}function i(t){var n=this.context,r=void 0,u=void 0,i=void 0,a=[],o=t;function s(t,e){a=a.filter(function(n){return!((isNaN(e)||n.start<e)&&(isNaN(t)||n.end>t))})}return r={getAllBufferRanges:function(){for(var t=[],e=0;e<a.length;e++){var n=a[e];0===t.length||n.start>t[t.length-1].end?t.push({start:n.start,end:n.end}):t[t.length-1].end=n.end}var r={start:function(e){return t[e].start},end:function(e){return t[e].end}};return Object.defineProperty(r,"length",{get:function(){return t.length}}),r},append:function(t){"InitializationSegment"!==t.segmentType?(a.push(t),a.sort(function(t,e){return t.start-e.start}),i=null):i=t,u.debug("PreBufferSink appended chunk s: "+t.start+"; e: "+t.end),o&&o({chunk:t})},remove:s,abort:function(){},discharge:function(t,e){var n=function(t,e){return a.filter(function(n){return(isNaN(e)||n.start<e)&&(isNaN(t)||n.end>t)})}(t,e);return i&&(n.push(i),i=null),s(t,e),n},reset:function(){a=[],i=null,o=null},updateTimestampOffset:function(){},hasDiscontinuitiesAfter:function(){return!1},waitForUpdateEnd:function(t){t()},getBuffer:function(){return this}},u=(0,e.default)(n).getInstance().getLogger(r),r}i.__dashjs_factory_name="PreBufferSink";var a=r.default.getClassFactory(i);exports.default=a;
},{"../core/Debug":"iL1O","../core/FactoryMaker":"FHM8"}],"sVRR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}var a=-1,u={DEFAULT:.5,STRONG:1,WEAK:0};function o(e,r,t){return{quality:void 0===e?a:e,reason:void 0===r?null:r,priority:function(e){var r=u.DEFAULT;return e!==u.DEFAULT&&e!==u.STRONG&&e!==u.WEAK||(r=e),r}(t)}}o.__dashjs_factory_name="SwitchRequest";var s=r.default.getClassFactory(o);s.NO_CHANGE=a,s.PRIORITY=u,r.default.updateClassFactory(o.__dashjs_factory_name,s),exports.default=s;
},{"../../core/FactoryMaker":"FHM8"}],"nsvu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../controllers/BufferController"),t=h(e),r=require("../../controllers/AbrController"),o=h(r),a=require("../../../core/FactoryMaker"),n=h(a),u=require("../../../core/Debug"),s=h(u),i=require("../SwitchRequest"),l=h(i),f=require("../../constants/Constants"),c=h(f),g=require("../../constants/MetricsConstants"),d=h(g);function h(e){return e&&e.__esModule?e:{default:e}}function y(e){e=e||{};var r=this.context,a=e.dashMetrics,n=void 0,u=void 0;return n={getMaxIndex:function(e){var n=(0,l.default)(r).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return n;!function(){if(!a||!a.hasOwnProperty("getLatestBufferInfoVO"))throw new Error(c.default.MISSING_CONFIG_ERROR)}();var s=e.getMediaInfo(),i=e.getMediaType(),f=a.getLatestBufferInfoVO(i,!0,d.default.BUFFER_STATE),g=e.getScheduleController(),h=e.getAbrController(),y=e.getStreamInfo(),p=y&&y.manifestInfo?y.manifestInfo.isDynamic:null,O=h.getThroughputHistory(),A=O.getSafeAverageThroughput(i,p),_=O.getAverageLatency(i),I=e.useBufferOccupancyABR();return isNaN(A)||!f||I?n:(h.getAbandonmentStateFor(i)!==o.default.ABANDON_LOAD&&(f.state===t.default.BUFFER_LOADED||p)&&(n.quality=h.getQualityForBitrate(s,A,_),g.setTimeToLoadDelay(0),u.debug("requesting switch to index: ",n.quality,"type: ",i,"Average throughput",Math.round(A),"kbps"),n.reason={throughput:A,latency:_}),n)},reset:function(){}},u=(0,s.default)(r).getInstance().getLogger(n),n}y.__dashjs_factory_name="ThroughputRule",exports.default=n.default.getClassFactory(y);
},{"../../controllers/BufferController":"REuJ","../../controllers/AbrController":"pZlR","../../../core/FactoryMaker":"FHM8","../../../core/Debug":"iL1O","../SwitchRequest":"sVRR","../../constants/Constants":"jJgo","../../constants/MetricsConstants":"RxE2"}],"zOVD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../controllers/BufferController"),t=y(e),r=require("../../../core/EventBus"),n=y(r),u=require("../../../core/events/Events"),f=y(u),a=require("../../../core/FactoryMaker"),o=y(a),i=require("../../../core/Debug"),s=y(i),c=require("../SwitchRequest"),d=y(c),l=require("../../constants/Constants"),g=y(l),v=require("../../constants/MetricsConstants"),B=y(v);function y(e){return e&&e.__esModule?e:{default:e}}function E(e){e=e||{};var r=.5,u=this.context,a=(0,n.default)(u).getInstance(),o=e.dashMetrics,i=void 0,c=void 0,l=void 0;function v(){l={}}function y(){v()}return i={getMaxIndex:function(e){var n=(0,d.default)(u).create();if(!e||!e.hasOwnProperty("getMediaType"))return n;!function(){if(!o||!o.hasOwnProperty("getCurrentBufferLevel")||!o.hasOwnProperty("getLatestBufferInfoVO"))throw new Error(g.default.MISSING_CONFIG_ERROR)}();var f=e.getMediaType(),a=o.getLatestBufferInfoVO(f,!0,B.default.BUFFER_STATE),i=e.getRepresentationInfo().fragmentDuration;if(!a||!function(e,r){l[e]=l[e]||{};var n=!1;return l[e].firstBufferLoadedEvent?n=!0:r&&r.state===t.default.BUFFER_LOADED&&(l[e].firstBufferLoadedEvent=!0,n=!0),n}(f,a)||!i)return n;if(a.state===t.default.BUFFER_EMPTY)c.debug("Switch to index 0; buffer is empty."),n.quality=0,n.reason="InsufficientBufferRule: Buffer is empty";else{var s=e.getMediaInfo(),v=e.getAbrController(),y=v.getThroughputHistory(),E=o.getCurrentBufferLevel(f,!0),I=y.getAverageThroughput(f),_=y.getAverageLatency(f),h=I*(E/i)*r;n.quality=v.getQualityForBitrate(s,h,_),n.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return n},reset:function(){v(),a.off(f.default.PLAYBACK_SEEKING,y,i)}},c=(0,s.default)(u).getInstance().getLogger(i),v(),a.on(f.default.PLAYBACK_SEEKING,y,i),i}E.__dashjs_factory_name="InsufficientBufferRule",exports.default=o.default.getClassFactory(E);
},{"../../controllers/BufferController":"REuJ","../../../core/EventBus":"Opee","../../../core/events/Events":"W3G1","../../../core/FactoryMaker":"FHM8","../../../core/Debug":"iL1O","../SwitchRequest":"sVRR","../../constants/Constants":"jJgo","../../constants/MetricsConstants":"RxE2"}],"LRib":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../SwitchRequest"),t=n(e),a=require("../../../core/FactoryMaker"),r=n(a),i=require("../../../core/Debug"),d=n(i);function n(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var a=1.8,r=500,i=5,n=this.context,o=e.mediaPlayerModel,u=e.dashMetrics,l=e.settings,f=void 0,y=void 0,g=void 0,b=void 0,h=void 0;function m(){g={},b={},h=[]}return f={shouldAbandon:function(e){var d=(0,t.default)(n).create(t.default.NO_CHANGE,{name:s.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return d;var f,m,p=e.getMediaInfo(),c=e.getMediaType(),T=e.getCurrentRequest();if(!isNaN(T.index)){f=c,m=T.index,g[f]=g[f]||{},g[f][m]=g[f][m]||{};var w=o.getStableBufferTime();if(u.getCurrentBufferLevel(c,!0)>w)return d;var v=g[c][T.index];if(null===v||null===T.firstByteDate||b.hasOwnProperty(v.id))return d;if(void 0===v.firstByteTime&&(h[c]=[],v.firstByteTime=T.firstByteDate.getTime(),v.segmentDuration=T.duration,v.bytesTotal=T.bytesTotal,v.id=T.index),v.bytesLoaded=T.bytesLoaded,v.elapsedTime=(new Date).getTime()-v.firstByteTime,v.bytesLoaded>0&&v.elapsedTime>0&&function(e,t){h[e]=h[e]||[],h[e].push(t)}(c,Math.round(8*v.bytesLoaded/v.elapsedTime)),h[c].length>=i&&v.elapsedTime>r&&v.bytesLoaded<v.bytesTotal){var B=h[c].reduce(function(e,t){return e+t},0);if(v.measuredBandwidthInKbps=Math.round(B/h[c].length),v.estimatedTimeOfDownload=+(8*v.bytesTotal/v.measuredBandwidthInKbps/1e3).toFixed(2),v.estimatedTimeOfDownload<v.segmentDuration*a||0===e.getRepresentationInfo().quality)return d;if(!b.hasOwnProperty(v.id)){var _=e.getAbrController(),I=v.bytesTotal-v.bytesLoaded,M=_.getBitrateList(p),O=_.getQualityForBitrate(p,v.measuredBandwidthInKbps*l.get().streaming.abr.bandwidthSafetyFactor);I>v.bytesTotal*M[O].bitrate/M[_.getQualityFor(c)].bitrate&&(d.quality=O,d.reason.throughput=v.measuredBandwidthInKbps,d.reason.fragmentID=v.id,b[v.id]=v,y.debug("( ",c,"frag id",v.id,") is asking to abandon and switch to quality to ",O," measured bandwidth was",v.measuredBandwidthInKbps),delete g[c][v.id])}}else v.bytesLoaded===v.bytesTotal&&delete g[c][v.id]}return d},reset:m},y=(0,d.default)(n).getInstance().getLogger(f),m(),f}s.__dashjs_factory_name="AbandonRequestsRule",exports.default=r.default.getClassFactory(s);
},{"../SwitchRequest":"sVRR","../../../core/FactoryMaker":"FHM8","../../../core/Debug":"iL1O"}],"c3sP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../../core/FactoryMaker"),r=u(e),t=require("../SwitchRequest"),a=u(t),o=require("../../../core/Debug"),d=u(o);function u(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,r=void 0,t=void 0,o=.15,u=375;return r={getMaxIndex:function(r){var d=(0,a.default)(e).create();if(!r||!r.hasOwnProperty("getDroppedFramesHistory"))return d;var s=r.getDroppedFramesHistory();if(s){for(var i=s.getFrameHistory(),n=0,f=0,p=a.default.NO_CHANGE,c=1;c<i.length;c++)if(i[c]&&(n=i[c].droppedVideoFrames,(f=i[c].totalVideoFrames)>u&&n/f>o)){p=c-1,t.debug("index: "+p+" Dropped Frames: "+n+" Total Frames: "+f);break}return(0,a.default)(e).create(p,{droppedFrames:n})}return d}},t=(0,d.default)(e).getInstance().getLogger(r),r}s.__dashjs_factory_name="DroppedFramesRule",exports.default=r.default.getClassFactory(s);
},{"../../../core/FactoryMaker":"FHM8","../SwitchRequest":"sVRR","../../../core/Debug":"iL1O"}],"yjOW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../../core/FactoryMaker"),t=s(e),r=require("../../../core/Debug"),o=s(r),i=require("../SwitchRequest"),u=s(i);function s(e){return e&&e.__esModule?e:{default:e}}function a(){var e=this.context,t=void 0,r=void 0,i=.075,s=6;return t={getMaxIndex:function(t){for(var o=t?t.getSwitchHistory():null,a=o?o.getSwitchRequests():[],d=0,n=0,c=0,l=(0,u.default)(e).create(),f=0;f<a.length;f++)if(void 0!==a[f]&&(d+=a[f].drops,n+=a[f].noDrops,c+=a[f].dropSize,d+n>=s&&d/n>i)){l.quality=f>0&&a[f].drops>0?f-1:f,l.reason={index:l.quality,drops:d,noDrops:n,dropSize:c},r.debug("Switch history rule index: "+l.quality+" samples: "+(d+n)+" drops: "+d);break}return l}},r=(0,o.default)(e).getInstance().getLogger(t),t}a.__dashjs_factory_name="SwitchHistoryRule",exports.default=t.default.getClassFactory(a);
},{"../../../core/FactoryMaker":"FHM8","../../../core/Debug":"iL1O","../SwitchRequest":"sVRR"}],"W7Rn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../constants/MetricsConstants"),t=d(e),a=require("../SwitchRequest"),r=d(a),n=require("../../../core/FactoryMaker"),i=d(n),u=require("../../vo/metrics/HTTPRequest"),l=require("../../../core/EventBus"),s=d(l),f=require("../../../core/events/Events"),o=d(f),c=require("../../../core/Debug"),m=d(c);function d(e){return e&&e.__esModule?e:{default:e}}var g=0,h=1,p=2,T=10,S=2,v=.99;function N(e){e=e||{};var a=this.context,n=e.dashMetrics,i=e.mediaPlayerModel,l=(0,s.default)(a).getInstance(),f=void 0,c=void 0,d=void 0;function N(e,t,a){var r=a.reduce(function(e,t,r){return t>a[e]?r:e},0);if(0===r)return null;var n=Math.max(e,T+S*t.length),i=(a[r]-1)/(n/T-1);return{gp:i,Vp:T/i}}function y(e){var t={},a=e.getMediaInfo().bitrateList.map(function(e){return e.bandwidth}),r=function(e){return e.map(function(e){return Math.log(e)})}(a);r=r.map(function(e){return e-r[0]+1});var n=i.getStableBufferTime(),u=N(n,a,r);return u?(t.state=h,t.bitrates=a,t.utilities=r,t.stableBufferTime=n,t.Vp=u.Vp,t.gp=u.gp,t.lastQuality=0,M(t)):t.state=g,t}function M(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function B(e,t){var a=i.getStableBufferTime();if(e.stableBufferTime!==a){var r=N(a,e.bitrates,e.utilities);if(r.Vp!==e.Vp||r.gp!==e.gp){var u=n.getCurrentBufferLevel(t,!0),l=u+e.placeholderBuffer;l-=T,l*=r.Vp/e.Vp,l+=T,e.stableBufferTime=a,e.Vp=r.Vp,e.gp=r.gp,e.placeholderBuffer=Math.max(0,l-u)}}}function E(e,t){return e.Vp*(e.utilities[t]+e.gp)}function A(e,t){for(var a=e.bitrates[t],r=e.utilities[t],n=0,i=t-1;i>=0;--i)if(e.utilities[i]<e.utilities[t]){var u=e.bitrates[i],l=e.utilities[i],s=e.Vp*(e.gp+(a*l-u*r)/(a-u));n=Math.max(n,s)}return n}function D(){for(var e in d)d.hasOwnProperty(e)&&d[e].state===p&&(d[e].placeholderBuffer=0)}function _(){for(var e in d)if(d.hasOwnProperty(e)){var t=d[e];t.state!==g&&(t.state=h,M(t))}}function R(){}function I(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=d[e.chunk.mediaInfo.type];if(t&&t.state!==g){var a=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||a>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=a,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=a,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,q(t,e.chunk.mediaInfo.type)}}}function b(e){if(e&&e.metric===t.default.HTTP_REQUEST&&e.value&&e.value.type===u.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var a=d[e.mediaType];a&&a.state!==g&&(a.lastSegmentRequestTimeMs=e.value.trequest.getTime(),a.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),q(a,e.mediaType))}}function q(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=v,!isNaN(e.lastSegmentFinishTimeMs)){var a=n.getCurrentBufferLevel(t,!0)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),r=E(e,e.lastQuality),i=Math.max(0,r-a);e.placeholderBuffer=Math.min(i,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function C(e){if(e){var t=d[e.mediaType];t&&t.state!==g&&(t.abrQuality=e.newQuality)}}function F(e){if(e){var t=d[e.mediaType];if(t&&t.state!==g){var a=n.getCurrentBufferLevel(e.mediaType,!0),r=void 0;r=t.abrQuality>0?A(t,t.abrQuality):T;var i=Math.max(0,r-a);t.placeholderBuffer=Math.min(t.placeholderBuffer,i)}}}function O(){d={}}return f={getMaxIndex:function(e){var t=(0,r.default)(a).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return t;var i=e.getMediaInfo(),u=e.getMediaType(),l=e.getScheduleController(),s=e.getStreamInfo(),f=e.getAbrController(),o=f.getThroughputHistory(),m=s?s.id:null,T=s&&s.manifestInfo&&s.manifestInfo.isDynamic,S=e.useBufferOccupancyABR();if(t.reason=t.reason||{},!S)return t;l.setTimeToLoadDelay(0);var v=function(e){var t=e.getMediaType(),a=d[t];return a?a.state!==g&&B(a,t):(a=y(e),d[t]=a),a}(e);if(v.state===g)return t;var N=n.getCurrentBufferLevel(u,!0),D=o.getAverageThroughput(u,T),_=o.getSafeAverageThroughput(u,T),R=o.getAverageLatency(u),I=void 0;if(t.reason.state=v.state,t.reason.throughput=D,t.reason.latency=R,isNaN(D))return t;switch(v.state){case h:I=f.getQualityForBitrate(i,_,R),t.quality=I,t.reason.throughput=_,v.placeholderBuffer=Math.max(0,A(v,I)-N),v.lastQuality=I,!isNaN(v.lastSegmentDurationS)&&N>=v.lastSegmentDurationS&&(v.state=p);break;case p:!function(e,t){var a=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var r=.001*(a-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,r)}}else{var n=.001*(a-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,n)}e.lastCallTimeMs=a,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,B(e,t)}(v,u),I=function(e,t){for(var a=e.bitrates.length,r=NaN,n=NaN,i=0;i<a;++i){var u=(e.Vp*(e.utilities[i]+e.gp)-t)/e.bitrates[i];(isNaN(n)||u>=n)&&(n=u,r=i)}return r}(v,N+v.placeholderBuffer);var b=f.getQualityForBitrate(i,_,R);I>v.lastQuality&&I>b&&(I=Math.max(b,v.lastQuality));var q=Math.max(0,N+v.placeholderBuffer-E(v,I));q<=v.placeholderBuffer?(v.placeholderBuffer-=q,q=0):(q-=v.placeholderBuffer,v.placeholderBuffer=0,I<f.getTopQualityIndexFor(u,m)?l.setTimeToLoadDelay(1e3*q):q=0),t.quality=I,t.reason.throughput=D,t.reason.latency=R,t.reason.bufferLevel=N,t.reason.placeholderBuffer=v.placeholderBuffer,t.reason.delay=q,v.lastQuality=I;break;default:c.debug("BOLA ABR rule invoked in bad state."),t.quality=f.getQualityForBitrate(i,_,R),t.reason.state=v.state,t.reason.throughput=_,t.reason.latency=R,v.state=h,M(v)}return t},reset:function(){O(),l.off(o.default.BUFFER_EMPTY,D,f),l.off(o.default.PLAYBACK_SEEKING,_,f),l.off(o.default.PERIOD_SWITCH_STARTED,R,f),l.off(o.default.MEDIA_FRAGMENT_LOADED,I,f),l.off(o.default.METRIC_ADDED,b,f),l.off(o.default.QUALITY_CHANGE_REQUESTED,C,f),l.off(o.default.FRAGMENT_LOADING_ABANDONED,F,f)}},c=(0,m.default)(a).getInstance().getLogger(f),O(),l.on(o.default.BUFFER_EMPTY,D,f),l.on(o.default.PLAYBACK_SEEKING,_,f),l.on(o.default.PERIOD_SWITCH_STARTED,R,f),l.on(o.default.MEDIA_FRAGMENT_LOADED,I,f),l.on(o.default.METRIC_ADDED,b,f),l.on(o.default.QUALITY_CHANGE_REQUESTED,C,f),l.on(o.default.FRAGMENT_LOADING_ABANDONED,F,f),f}N.__dashjs_factory_name="BolaRule",exports.default=i.default.getClassFactory(N);
},{"../../constants/MetricsConstants":"RxE2","../SwitchRequest":"sVRR","../../../core/FactoryMaker":"FHM8","../../vo/metrics/HTTPRequest":"yMBz","../../../core/EventBus":"Opee","../../../core/events/Events":"W3G1","../../../core/Debug":"iL1O"}],"uS6f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./ThroughputRule"),t=N(e),u=require("./InsufficientBufferRule"),a=N(u),r=require("./AbandonRequestsRule"),l=N(r),i=require("./DroppedFramesRule"),n=N(i),d=require("./SwitchHistoryRule"),f=N(d),o=require("./BolaRule"),s=N(o),c=require("../../../core/FactoryMaker"),R=N(c),h=require("../SwitchRequest"),A=N(h);function N(e){return e&&e.__esModule?e:{default:e}}var _="qualitySwitchRules",O="abandonFragmentRules";function p(e){e=e||{};var u=this.context,r=e.mediaPlayerModel,i=e.dashMetrics,d=e.settings,o=void 0,c=void 0;function R(e){return e.filter(function(e){return e.quality>A.default.NO_CHANGE})}function h(e){var t,a={},r=void 0,l=void 0,i=void 0,n=void 0;if(0!==e.length){for(a[A.default.PRIORITY.STRONG]=A.default.NO_CHANGE,a[A.default.PRIORITY.WEAK]=A.default.NO_CHANGE,a[A.default.PRIORITY.DEFAULT]=A.default.NO_CHANGE,r=0,t=e.length;r<t;r+=1)(l=e[r]).quality!==A.default.NO_CHANGE&&(a[l.priority]=a[l.priority]>A.default.NO_CHANGE?Math.min(a[l.priority],l.quality):l.quality);return a[A.default.PRIORITY.WEAK]!==A.default.NO_CHANGE&&(i=a[A.default.PRIORITY.WEAK]),a[A.default.PRIORITY.DEFAULT]!==A.default.NO_CHANGE&&(i=a[A.default.PRIORITY.DEFAULT]),a[A.default.PRIORITY.STRONG]!==A.default.NO_CHANGE&&(i=a[A.default.PRIORITY.STRONG]),i!==A.default.NO_CHANGE&&(n=i),(0,A.default)(u).create(n)}}return{initialize:function(){o=[],c=[],d.get().streaming.abr.useDefaultABRRules&&(o.push((0,s.default)(u).create({dashMetrics:i,mediaPlayerModel:r,settings:d})),o.push((0,t.default)(u).create({dashMetrics:i})),o.push((0,a.default)(u).create({dashMetrics:i})),o.push((0,f.default)(u).create()),o.push((0,n.default)(u).create()),c.push((0,l.default)(u).create({dashMetrics:i,mediaPlayerModel:r,settings:d}))),r.getABRCustomRules().forEach(function(e){e.type===_&&o.push(e.rule(u).create()),e.type===O&&c.push(e.rule(u).create())})},reset:function(){[o,c].forEach(function(e){e&&e.length&&e.forEach(function(e){return e.reset&&e.reset()})}),o=[],c=[]},getMaxQuality:function(e){return h(R(o.map(function(t){return t.getMaxIndex(e)})))||(0,A.default)(u).create()},shouldAbandonFragment:function(e){return h(R(c.map(function(t){return t.shouldAbandon(e)})))||(0,A.default)(u).create()}}}p.__dashjs_factory_name="ABRRulesCollection";var E=R.default.getClassFactory(p);E.QUALITY_SWITCH_RULES=_,E.ABANDON_FRAGMENT_RULES=O,R.default.updateSingletonFactory(p.__dashjs_factory_name,E),exports.default=E;
},{"./ThroughputRule":"nsvu","./InsufficientBufferRule":"zOVD","./AbandonRequestsRule":"LRib","./DroppedFramesRule":"c3sP","./SwitchHistoryRule":"yjOW","./BolaRule":"W7Rn","../../../core/FactoryMaker":"FHM8","../SwitchRequest":"sVRR"}],"riIO":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};exports.default=e;
},{}],"Z0sy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}function n(e){var r=(e=e||{}).abrController,t=e.switchHistory,n=e.droppedFramesHistory,o=e.currentRequest,u=e.useBufferOccupancyABR,s=e.streamProcessor?e.streamProcessor.getScheduleController():null,c=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null;function a(){return c?c.mediaInfo:null}return{getMediaType:function(){var e=a();return e?e.type:null},getMediaInfo:a,getDroppedFramesHistory:function(){return n},getCurrentRequest:function(){return o},getSwitchHistory:function(){return t},getStreamInfo:function(){var e=a();return e?e.streamInfo:null},getScheduleController:function(){return s},getAbrController:function(){return r},getRepresentationInfo:function(){return c},useBufferOccupancyABR:function(){return u}}}n.__dashjs_factory_name="RulesContext",exports.default=r.default.getClassFactory(n);
},{"../../core/FactoryMaker":"FHM8"}],"iZr5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),o=t(e),r=require("./SwitchRequest"),u=t(r);function t(e){return e&&e.__esModule?e:{default:e}}var d=8;function a(){var e=[],o=[];return{push:function(r){r.newValue===u.default.NO_CHANGE&&(r.newValue=r.oldValue),e[r.oldValue]||(e[r.oldValue]={noDrops:0,drops:0,dropSize:0});var t=r.newValue-r.oldValue,a=t<0?1:0,l=a?-t:0,s=a?0:1;if(e[r.oldValue].drops+=a,e[r.oldValue].dropSize+=l,e[r.oldValue].noDrops+=s,o.push({idx:r.oldValue,noDrop:s,drop:a,dropSize:l}),o.length>d){var i=o.shift();e[i.idx].drops-=i.drop,e[i.idx].dropSize-=i.dropSize,e[i.idx].noDrops-=i.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],o=[]}}}a.__dashjs_factory_name="SwitchRequestHistory";var l=o.default.getClassFactory(a);exports.default=l;
},{"../../core/FactoryMaker":"FHM8","./SwitchRequest":"sVRR"}],"arnS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),r=o(e);function o(e){return e&&e.__esModule?e:{default:e}}function t(){var e=[],r=0,o=0;return{push:function(t,a){var d=a&&a.droppedVideoFrames?a.droppedVideoFrames:0,s=a&&a.totalVideoFrames?a.totalVideoFrames:0,i=d-r;r=d;var u=s-o;o=s,isNaN(t)||(e[t]?(e[t].droppedVideoFrames+=i,e[t].totalVideoFrames+=u):e[t]={droppedVideoFrames:i,totalVideoFrames:u})},getFrameHistory:function(){return e},reset:function(t){e=[],r=t.droppedVideoFrames,o=t.totalVideoFrames}}}t.__dashjs_factory_name="DroppedFramesHistory";var a=r.default.getClassFactory(t);exports.default=a;
},{"../../core/FactoryMaker":"FHM8"}],"ci2P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../constants/Constants"),e=n(t),a=require("../../core/FactoryMaker"),r=n(a);function n(t){return t&&t.__esModule?t:{default:t}}function i(t){var a=20,r=3,n=4,i=4,s=1.3,o=1.3,u=8,f=3,l=2,h=1,c=(t=t||{}).settings,g=void 0,d=void 0,v=void 0,m=void 0,p=void 0;function E(t,e,a,r){var n=Math.pow(.5,a/r.fast);t.fastEstimate=(1-n)*e+n*t.fastEstimate;var i=Math.pow(.5,a/r.slow);t.slowEstimate=(1-i)*e+i*t.slowEstimate,t.totalWeight+=a}function w(t,a,u){return c.get().streaming.abr.movingAverageMethod!==e.default.MOVING_AVERAGE_SLIDING_WINDOW?function(t,e){var a=t?p.throughputHalfLife:p.latencyHalfLife,r=t?v[e]:m[e];if(!r||r.totalWeight<=0)return NaN;var n=r.fastEstimate/(1-Math.pow(.5,r.totalWeight/a.fast)),i=r.slowEstimate/(1-Math.pow(.5,r.totalWeight/a.slow));return t?Math.min(n,i):Math.max(n,i)}(t,a):function(t,e,a){var u=function(t,e,a){var u=void 0,f=void 0;if(t?(u=g[e],f=a?r:n):(u=d[e],f=i),u){if(f>=u.length)f=u.length;else if(t)for(var l=1;l<f;++l){var h=u[l]/u[l-1];if((h>=o||h<=1/s)&&(f+=1)===u.length)break}}else f=0;return f}(t,e,a),f=(t?g:d)[e];if(0===u||!f||0===f.length)return NaN;return(f=f.slice(-u)).reduce(function(t,e){return t+e})/f.length}(t,a,u)}function M(t,e){return w(!0,t,e)}function _(t){g[t]=g[t]||[],d[t]=d[t]||[],v[t]=v[t]||{fastEstimate:0,slowEstimate:0,totalWeight:0},m[t]=m[t]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function y(){g={},d={},v={},m={}}var L={push:function(t,r,n){if(r.trace&&r.trace.length){var i=r.tresponse.getTime()-r.trequest.getTime()||1,s=r._tfinish.getTime()-r.tresponse.getTime()||1,o=r.trace.reduce(function(t,e){return t+e.b[0]},0),u=void 0;u=c.get().streaming.lowLatencyEnabled?r.trace.reduce(function(t,e){return t+e.d},0):n?s:i+s;var f=Math.round(8*o/u);if(_(t),function(t,a,r){return t===e.default.VIDEO?r<c.get().streaming.cacheLoadThresholds[e.default.VIDEO]:t===e.default.AUDIO?r<c.get().streaming.cacheLoadThresholds[e.default.AUDIO]:void 0}(t,0,s)){if(g[t].length>0&&!g[t].hasCachedEntries)return;g[t].hasCachedEntries=!0}else g[t]&&g[t].hasCachedEntries&&function(t){delete g[t],delete d[t],delete v[t],delete m[t],_(t)}(t);g[t].push(f),g[t].length>a&&g[t].shift(),d[t].push(i),d[t].length>a&&d[t].shift(),E(v[t],f,.001*s,p.throughputHalfLife),E(m[t],i,1,p.latencyHalfLife)}},getAverageThroughput:M,getSafeAverageThroughput:function(t,e){var a=M(t,e);return isNaN(a)||(a*=c.get().streaming.abr.bandwidthSafetyFactor),a},getAverageLatency:function(t){return w(!1,t)},reset:y};return p={throughputHalfLife:{fast:f,slow:u},latencyHalfLife:{fast:h,slow:l}},y(),L}i.__dashjs_factory_name="ThroughputHistory",exports.default=r.default.getClassFactory(i);
},{"../constants/Constants":"jJgo","../../core/FactoryMaker":"FHM8"}],"pZlR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../rules/abr/ABRRulesCollection"),t=B(e),r=require("../constants/Constants"),i=B(r),a=require("../constants/MetricsConstants"),n=B(a),o=require("../vo/BitrateInfo"),u=B(o),l=require("../models/FragmentModel"),d=B(l),f=require("../../core/EventBus"),s=B(f),c=require("../../core/events/Events"),g=B(c),v=require("../../core/FactoryMaker"),y=B(v),m=require("../rules/RulesContext"),h=B(m),E=require("../rules/SwitchRequest"),p=B(E),T=require("../rules/SwitchRequestHistory"),A=B(T),R=require("../rules/DroppedFramesHistory"),I=B(R),_=require("../rules/ThroughputHistory"),b=B(_),D=require("../../core/Debug"),O=B(D),S=require("../vo/metrics/HTTPRequest"),M=require("../utils/SupervisorTools");function B(e){return e&&e.__esModule?e:{default:e}}var w="abandonload",C="allowload",L=1e3,q=100,P=0;function N(){var e=this.context,r=(0,O.default)(e).getInstance(),a=(0,s.default)(e).getInstance(),o=void 0,l=void 0,f=void 0,c=void 0,v=void 0,y=void 0,m=void 0,E=void 0,T=void 0,R=void 0,_=void 0,D=void 0,B=void 0,N=void 0,F=void 0,G=void 0,x=void 0,H=void 0,Q=void 0,U=void 0,V=void 0,k=void 0,Y=void 0;function W(){(f=(0,t.default)(e).create({dashMetrics:k,mediaPlayerModel:F,settings:Y})).initialize()}function j(){v={},y={},E={},m={},H={},V={},void 0===R&&(R=!1),x=void 0,Q=void 0,U=void 0,clearTimeout(T),T=null}function z(e){e.mediaType===i.default.VIDEO&&(x=e.oldQuality,Q.push(x,N.getPlaybackQuality()))}function X(e){e.metric!==n.default.HTTP_REQUEST||!e.value||e.value.type!==S.HTTPRequest.MEDIA_SEGMENT_TYPE||e.mediaType!==i.default.AUDIO&&e.mediaType!==i.default.VIDEO||U.push(e.mediaType,e.value,Y.get().streaming.abr.useDeadTimeLatency),e.metric!==n.default.BUFFER_LEVEL||e.mediaType!==i.default.AUDIO&&e.mediaType!==i.default.VIDEO||function(e,t){var r=Y.get().streaming.ABRStrategy;if(r===i.default.ABR_STRATEGY_BOLA)return void(V[e]=!0);if(r===i.default.ABR_STRATEGY_THROUGHPUT)return void(V[e]=!1);var a=F.getStableBufferTime(),n=a,o=.5*a,u=V[e],d=t>(u?o:n);V[e]=d,d!==u&&(d?l.info("AbrController ("+e+") switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):l.info("AbrController ("+e+") switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."))}(e.mediaType,.001*e.value.level)}function J(e,t){return v[t]=v[t]||{},v[t].hasOwnProperty(e)||(v[t][e]=0),function(e,t){if(t!==i.default.VIDEO||!Y.get().streaming.abr.limitBitrateByPortal||!m[t])return e;R||ue();var r=B.getAdaptationForType(0,t).Representation,a=e;if(_>0&&D>0){for(;a>0&&r[a]&&_<r[a].width&&_-r[a-1].width<r[a].width-_;)a-=1;for(;a<r.length-1&&r[a].width===r[a+1].width;)a+=1}return a}(function(e,t,r){var i=function(e){return Y.get().streaming.abr.maxRepresentationRatio[e]}(t);if(isNaN(i)||i>=1||i<0)return e;return Math.min(e,Math.round(r*i))}(function(e,t){var r=e;if(!m[t])return r;var i=Z(t);void 0!==i&&(r=Math.max(e,i));var a=K(t);void 0!==a&&(r=Math.min(r,a));return r}(v[t][e],e),e,v[t][e]),e)}function K(e){var t=function(e){return Y.get().streaming.abr.maxBitrate[e]}(e);return t>-1?ie(m[e].getMediaInfo(),t):void 0}function Z(e){var t=function(e){return Y.get().streaming.abr.minBitrate[e]}(e);if(t>-1){var r=m[e].getMediaInfo(),i=ae(r),a=ie(r,t);return i[a]&&a<i.length-1&&i[a].bitrate<1e3*t&&a++,a}}function $(e){return!!Y.get().streaming.abr.autoSwitchBitrate[e]}function ee(e,t,r,i){var a=t.id,n=oe(e);(0,M.checkInteger)(r);var o=J(e,a);r!==n&&r>=0&&r<=o&&te(e,n,r,o,i)}function te(e,t,r,i,n){if(e&&m[e]){var o=m[e].getStreamInfo(),u=o?o.id:null;if(Y.get().debug.logLevel===O.default.LOG_LEVEL_DEBUG){var d=k.getCurrentBufferLevel(e,!0);l.info("AbrController ("+e+") switch from "+t+" to "+r+"/"+i+" (buffer: "+d+") "+(n?JSON.stringify(n):"."))}!function(e,t,r){y[t]=y[t]||{},y[t][e]=r}(e,u,r),a.trigger(g.default.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:o,oldQuality:t,newQuality:r,reason:n});var f=U.getAverageThroughput(e);isNaN(f)||G.setSavedBitrateSettings(e,f)}}function re(e,t){E[e].state=t}function ie(e,t,r){var i=e&&e.type?m[e.type].getRepresentationInfo():null;if(Y.get().streaming.abr.useDeadTimeLatency&&r&&i&&i.fragmentDuration){r/=1e3;var a=i.fragmentDuration;if(r>a)return 0;t*=1-r/a}for(var n=ae(e),o=n.length-1;o>=0;o--){if(1e3*t>=n[o].bitrate)return o}return P}function ae(e){var t=[];if(!e||!e.bitrateList)return t;for(var r=e.bitrateList,i=e.type,a=void 0,n=0,o=r.length;n<o;n++)(a=new u.default).mediaType=i,a.qualityIndex=n,a.bitrate=r[n].bandwidth,a.width=r[n].width,a.height=r[n].height,a.scanType=r[n].scanType,t.push(a);return t}function ne(e){return V[e]}function oe(e){if(e&&m[e]){var t=m[e].getStreamInfo(),r=t?t.id:null;if(r)return y[r]=y[r]||{},y[r].hasOwnProperty(e)||(y[r][e]=P),y[r][e]}return P}function ue(){if(N){var e=Y.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;_=N.getClientWidth()*e,D=N.getClientHeight()*e}}function le(t){var r=t.request.mediaType;if($(r)){var i=m[r];if(!i)return;var a=(0,h.default)(e).create({abrController:o,streamProcessor:i,currentRequest:t.request,useBufferOccupancyABR:ne(r)}),n=f.shouldAbandonFragment(a);if(n.quality>p.default.NO_CHANGE){var u=i.getFragmentModel();u.getRequests({state:d.default.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(u.abortRequests(),re(r,w),H[r].reset(),H[r].push({oldValue:oe(r),newValue:n.quality,confidence:1,reason:n.reason}),ee(r,c.getActiveStreamInfo(),n.quality,n.reason),clearTimeout(T),T=setTimeout(function(){re(r,C),T=null},Y.get().streaming.abandonLoadTimeout))}}}return o={isPlayingAtTopQuality:function(e){var t=e?e.id:null,r=oe(i.default.AUDIO),a=oe(i.default.VIDEO);return r===J(i.default.AUDIO,t)&&a===J(i.default.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,r=e.streamInfo.id,i=e.representationCount-1;return function(e,t,r){v[t]=v[t]||{},v[t][e]=r}(t,r,i),i},getThroughputHistory:function(){return U},getBitrateList:ae,getQualityForBitrate:ie,getTopBitrateInfoFor:function(e){if(e&&m&&m[e]){var t=m[e].getStreamInfo();if(t&&t.id){var r=J(e,t.id),i=ae(m[e].getMediaInfo());return i[r]?i[r]:null}}return null},getMaxAllowedIndexFor:K,getMinAllowedIndexFor:Z,getInitialBitrateFor:function(e){if(function(){if(!G||!G.hasOwnProperty("getSavedBitrateSettings"))throw new Error(i.default.MISSING_CONFIG_ERROR)}(),e===i.default.TEXT||e===i.default.FRAGMENTED_TEXT)return NaN;var t=G.getSavedBitrateSettings(e),r=Y.get().streaming.abr.initialBitrate[e],a=Y.get().streaming.abr.initialRepresentationRatio[e];if(-1===r)if(a>-1){var n=B.getAdaptationForType(0,e).Representation;r=Array.isArray(n)?n[Math.max(Math.round(n.length*a)-1,0)].bandwidth:0}else r=isNaN(t)?e===i.default.VIDEO?L:q:t;return r},getQualityFor:oe,getAbandonmentStateFor:function(e){return E[e]?E[e].state:null},setPlaybackQuality:ee,checkPlaybackQuality:function(t){if(t&&m&&m[t]){var r=m[t].getStreamInfo(),i=r?r.id:null,a=oe(t),n=(0,h.default)(e).create({abrController:o,streamProcessor:m[t],currentValue:a,switchHistory:H[t],droppedFramesHistory:Q,useBufferOccupancyABR:ne(t)});if(Q){var u=N.getPlaybackQuality();u&&Q.push(x,u)}if($(t)){var d=Z(t),s=J(t,i),c=f.getMaxQuality(n),g=c.quality;if(void 0!==d&&(g>p.default.NO_CHANGE?g:a)<d&&(g=d),g>s&&(g=s),H[t].push({oldValue:a,newValue:g}),g>p.default.NO_CHANGE&&g!=a)(E[t].state===C||g>a)&&te(t,a,g,s,c.reason);else if(Y.get().debug.logLevel===O.default.LOG_LEVEL_DEBUG){var v=k.getCurrentBufferLevel(t,!0);l.debug("AbrController ("+t+") stay on "+a+"/"+s+" (buffer: "+v+")")}}}},getTopQualityIndexFor:J,setElementSize:ue,setWindowResizeEventCalled:function(e){R=e},createAbrRulesCollection:W,registerStreamType:function(t,r){H[t]=H[t]||(0,A.default)(e).create(),m[t]=r,E[t]=E[t]||{},E[t].state=C,V[t]=!1,a.on(g.default.LOADING_PROGRESS,le,this),t==i.default.VIDEO&&(a.on(g.default.QUALITY_CHANGE_RENDERED,z,this),Q=Q||(0,I.default)(e).create(),ue()),a.on(g.default.METRIC_ADDED,X,this),a.on(g.default.PERIOD_SWITCH_COMPLETED,W,this),U=U||(0,b.default)(e).create({settings:Y})},unRegisterStreamType:function(e){delete m[e]},setConfig:function(e){e&&(e.streamController&&(c=e.streamController),e.domStorage&&(G=e.domStorage),e.mediaPlayerModel&&(F=e.mediaPlayerModel),e.dashMetrics&&(k=e.dashMetrics),e.adapter&&(B=e.adapter),e.videoModel&&(N=e.videoModel),e.settings&&(Y=e.settings))},reset:function(){j(),a.off(g.default.LOADING_PROGRESS,le,this),a.off(g.default.QUALITY_CHANGE_RENDERED,z,this),a.off(g.default.METRIC_ADDED,X,this),a.off(g.default.PERIOD_SWITCH_COMPLETED,W,this),f&&f.reset()}},l=r.getLogger(o),j(),o}N.__dashjs_factory_name="AbrController";var F=y.default.getSingletonFactory(N);F.ABANDON_LOAD=w,F.QUALITY_DEFAULT=P,y.default.updateSingletonFactory(N.__dashjs_factory_name,F),exports.default=F;
},{"../rules/abr/ABRRulesCollection":"uS6f","../constants/Constants":"jJgo","../constants/MetricsConstants":"RxE2","../vo/BitrateInfo":"riIO","../models/FragmentModel":"OnkV","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../rules/RulesContext":"Z0sy","../rules/SwitchRequest":"sVRR","../rules/SwitchRequestHistory":"iZr5","../rules/DroppedFramesHistory":"arnS","../rules/ThroughputHistory":"ci2P","../../core/Debug":"iL1O","../vo/metrics/HTTPRequest":"yMBz","../utils/SupervisorTools":"A0aa"}],"xiaR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../constants/Constants"),e=c(t),n=require("../../core/events/Events"),i=c(n),r=require("../../core/EventBus"),o=c(r),a=require("../../core/FactoryMaker"),u=c(a),l=require("../../core/Debug"),s=c(l);function c(t){return t&&t.__esModule?t:{default:t}}var d="neverReplace",f="alwaysReplace",g="highestBitrate",v="widestRange",C=g;function h(){var t=this.context,n=(0,o.default)(t).getInstance(),r=void 0,a=void 0,u=void 0,l=void 0,c=void 0,h=void 0,T=void 0,E=[f,d],S=[g,v];function _(t,e){if(!t||!e)return[];var n=e.id;return u[n]&&u[n][t]?u[n][t].list:[]}function p(t,e){return!t||!e||e&&!u[e.id]?null:u[e.id][t].current}function I(t){if(t&&t.streamInfo){var e=t.type,r=t.streamInfo,o=r.id,a=p(e,r);if(u[o]&&u[o][e]&&!A(t,a)){u[o][e].current=t,u[o][e].current&&n.trigger(i.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:a,newMediaInfo:t,switchMode:h[e]});var l=function(t){var e={lang:t.lang,viewpoint:t.viewpoint,roles:t.roles,accessibility:t.accessibility,audioChannelConfiguration:t.audioChannelConfiguration};return e.lang||e.viewpoint||e.role&&e.role.length>0||e.accessibility&&e.accessibility.length>0||e.audioChannelConfiguration&&e.audioChannelConfiguration.length>0?e:null}(t);l&&u[o][e].storeLastSettings&&(l.roles&&(l.role=l.roles[0],delete l.roles),l.accessibility&&(l.accessibility=l.accessibility[0]),l.audioChannelConfiguration&&(l.audioChannelConfiguration=l.audioChannelConfiguration[0]),T.setSavedMediaSettings(e,l))}}}function y(t,e){t&&e&&(l[t]=e)}function M(t){return t?l[t]:null}function w(){return c||C}function b(t){return t===e.default.AUDIO||t===e.default.VIDEO||t===e.default.TEXT||t===e.default.FRAGMENTED_TEXT||t===e.default.IMAGE}function A(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;var n=t.id===e.id,i=t.viewpoint===e.viewpoint,r=t.lang===e.lang,o=t.roles.toString()===e.roles.toString(),a=t.accessibility.toString()===e.accessibility.toString(),u=t.audioChannelConfiguration.toString()===e.audioChannelConfiguration.toString();return n&&i&&r&&o&&a&&u}function R(){u={},l={audio:null,video:null},h={audio:f,video:d}}function k(t,e){var n=!t.lang||t.lang===e.lang,i=!t.viewpoint||t.viewpoint===e.viewpoint,r=!t.role||!!e.roles.filter(function(e){return e===t.role})[0],o=!t.accessibility||!!e.accessibility.filter(function(e){return e===t.accessibility})[0],a=!t.audioChannelConfiguration||!!e.audioChannelConfiguration.filter(function(e){return e===t.audioChannelConfiguration})[0];return n&&i&&r&&o&&a}function m(t){var e=w(),n=[],i=function(t){var e=0,n=[],i=void 0;return t.forEach(function(t){(i=Math.max.apply(Math,t.bitrateList.map(function(t){return t.bandwidth})))>e?(e=i,n=[t]):i===e&&n.push(t)}),n},r=function(t){var e=0,n=[],i=void 0;return t.forEach(function(t){(i=t.representationCount)>e?(e=i,n=[t]):i===e&&n.push(t)}),n};switch(e){case g:(n=i(t)).length>1&&(n=r(n));break;case v:(n=r(t)).length>1&&(n=i(t));break;default:a.warn("Track selection mode is not supported: "+e)}return n[0]}return r={checkInitialMediaSettingsForType:function(t,n){var i=M(t),r=_(t,n),o=[];t!==e.default.FRAGMENTED_TEXT?(i||y(t,i=T.getSavedMediaSettings(t)),r&&0!==r.length&&(i&&r.forEach(function(t){k(i,t)&&o.push(t)}),0===o.length?I(m(r)):o.length>1?I(m(o)):I(o[0]))):I(r[0])},addTrack:function(t){if(t){var e=t.type;if(b(e)){var n=t.streamInfo.id;u[n]||(u[n]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var i=u[n][e].list,r=0,o=i.length;r<o;++r)if(A(i[r],t))return;i.push(t);var a=M(e);a&&k(a,t)&&!p(e,t.streamInfo)&&I(t)}}},getTracksFor:_,getCurrentTrackFor:p,isCurrentTrack:function(t){if(!t)return!1;var e=t.type,n=t.streamInfo.id;return u[n]&&u[n][e]&&A(u[n][e].current,t)},setTrack:I,setInitialSettings:y,getInitialSettings:M,setSwitchMode:function(t,e){-1!==E.indexOf(e)?h[t]=e:a.warn("Track switch mode is not supported: "+e)},getSwitchMode:function(t){return h[t]},setSelectionModeForInitialTrack:function(t){-1!==S.indexOf(t)?c=t:a.warn("Track selection mode is not supported: "+t)},getSelectionModeForInitialTrack:w,isMultiTrackSupportedByType:b,isTracksEqual:A,setConfig:function(t){t&&t.domStorage&&(T=t.domStorage)},reset:R},a=(0,s.default)(t).getInstance().getLogger(r),R(),r}h.__dashjs_factory_name="MediaController";var T=u.default.getSingletonFactory(h);T.TRACK_SWITCH_MODE_NEVER_REPLACE=d,T.TRACK_SWITCH_MODE_ALWAYS_REPLACE=f,T.TRACK_SELECTION_MODE_HIGHEST_BITRATE=g,T.TRACK_SELECTION_MODE_WIDEST_RANGE=v,T.DEFAULT_INIT_TRACK_SELECTION_MODE=C,u.default.updateSingletonFactory(h.__dashjs_factory_name,T),exports.default=T;
},{"../constants/Constants":"jJgo","../../core/events/Events":"W3G1","../../core/EventBus":"Opee","../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O"}],"eXbI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(){var e={};return{save:function(t){var r=t.streamId,n=t.representationId;e[r]=e[r]||{},e[r][n]=t},extract:function(t,r){return e&&e[t]&&e[t][r]?e[t][r]:null},reset:function(){e={}}}}n.__dashjs_factory_name="InitCache",exports.default=t.default.getSingletonFactory(n);
},{"../../core/FactoryMaker":"FHM8"}],"REuJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=S(e),r=require("../models/FragmentModel"),n=S(r),a=require("../SourceBufferSink"),f=S(a),i=require("../PreBufferSink"),u=S(i),o=require("./AbrController"),d=S(o),s=require("./MediaController"),l=S(s),g=require("../../core/EventBus"),E=S(g),T=require("../../core/events/Events"),c=S(T),h=require("../utils/BoxParser"),m=S(h),A=require("../../core/FactoryMaker"),_=S(A),I=require("../../core/Debug"),v=S(I),D=require("../utils/InitCache"),R=S(D),p=require("../vo/DashJSError"),M=S(p),C=require("../../core/errors/Errors"),B=S(C),P=require("../vo/metrics/HTTPRequest");function S(e){return e&&e.__esModule?e:{default:e}}var F="bufferLoaded",L="bufferStalled",b=.5,N=.5,y=.01,O=22,U="BufferController";function q(e){e=e||{};var r=this.context,a=(0,E.default)(r).getInstance(),i=e.dashMetrics,o=e.errHandler,s=e.streamController,g=e.mediaController,T=e.adapter,h=e.textController,A=e.abrController,_=e.playbackController,I=e.type,D=e.streamProcessor,p=e.settings,C=void 0,S=void 0,q=void 0,G=void 0,x=void 0,Y=void 0,K=void 0,k=void 0,w=void 0,H=void 0,Q=void 0,V=void 0,X=void 0,W=void 0,z=void 0,j=void 0,J=void 0,Z=void 0,$=void 0,ee=void 0,te=void 0;function re(e,t){if(!j||!e||!D)return null;if(K)try{"function"==typeof(H=t&&t[I]?(0,f.default)(r).create(K,e,ue.bind(this),t[I]):(0,f.default)(r).create(K,e,ue.bind(this))).getBuffer().initialize&&H.getBuffer().initialize(I,D)}catch(n){S.fatal("Caught error on create SourceBuffer: "+n),o.error(new M.default(B.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,B.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+I))}else H=(0,u.default)(r).create(ue.bind(this));return Me(D.getRepresentationInfo(q).MSETimeOffset),H}function ne(e){e.fragmentModel===D.getFragmentModel()&&(S.info("Init fragment finished loading saving to",I+"'s init cache"),j.save(e.chunk),S.debug("Append Init fragment",I," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),fe(e.chunk))}function ae(e){if(e.fragmentModel===D.getFragmentModel()){var t=e.chunk,a=t.bytes,f=t.quality,i=D.getRepresentationInfo(f),u=D.getRepresentationController(),o=u&&i?u.getRepresentationForQuality(i.quality):null,d=T.getEventsFor(i.mediaInfo),s=T.getEventsFor(i,o);if(d&&d.length>0||s&&s.length>0){var l=function(e,t,n,a){for(var f=Math.max(!t||isNaN(t.startTime)?0:t.startTime,0),i=[],u=[],o=n.concat(a),d=0,s=o.length;d<s;d++)i[o[d].schemeIdUri+"/"+o[d].value]=o[d];for(var l=(0,m.default)(r).getInstance().parse(e).getBoxes("emsg"),g=0,E=l.length;g<E;g++){var c=T.getEvent(l[g],i,f);c&&u.push(c)}return u}(a,D.getFragmentModel().getRequests({state:n.default.FRAGMENT_MODEL_EXECUTED,quality:f,index:t.index})[0],d,s);D.addInbandEvents(l)}if(ee){te=t;var g=H&&H.getAllBufferRanges();g&&g.length>0&&_.getTimeToStreamEnd()>b&&(S.debug("Clearing buffer because track changed - "+(g.end(g.length-1)+N)),De([{start:0,end:g.end(g.length-1)+N,force:!0}]))}else fe(t)}}function fe(e){H.append(e),e.mediaInfo.type===t.default.VIDEO&&a.trigger(c.default.VIDEO_CHUNK_RECEIVED,{chunk:e})}function ie(e){if(e&&e.length>0)for(var t=0,r=e.length;t<r;t++)S.debug("Buffered Range for type:",I,":",e.start(t)," - ",e.end(t)," currentTime = ",_.getTime())}function ue(e){if(e.error){if(e.error.code===O&&(Y=.8*be(),S.warn("Quota exceeded for type: "+I+", Critical Buffer: "+Y),Y>0)){var t=Math.max(.2*Y,1),r=Y-t,n={streaming:{bufferToKeep:parseFloat(t.toFixed(5)),bufferAheadToKeep:parseFloat(r.toFixed(5))}};p.update(n)}e.error.code!==O&&Ne()||(S.warn("Clearing playback buffer to overcome quota exceed situation for type: "+I),a.trigger(c.default.QUOTA_EXCEEDED,{sender:C,criticalBufferLevel:Y}),le())}else{(X=e.chunk)&&!isNaN(X.index)&&(k=Math.max(X.index,k),Ae());var f=H.getAllBufferRanges();if(X.segmentType===P.HTTPRequest.MEDIA_SEGMENT_TYPE)ie(f),ge();else if(ee){var i=_.getTime();S.debug("AppendToBuffer seek target should be "+i),D.getScheduleController().setSeekTarget(i),D.setIndexHandlerTime(i)}var u={sender:C,quality:X.quality,startTime:X.start,index:X.index,bufferedRanges:f};X&&!X.endFragment?a.trigger(c.default.BYTES_APPENDED,u):X&&a.trigger(c.default.BYTES_APPENDED_END_FRAGMENT,u)}}function oe(e){q!==e.newQuality&&I===e.mediaType&&D.getStreamInfo().id===e.streamInfo.id&&(Me(D.getRepresentationInfo(e.newQuality).MSETimeOffset),q=e.newQuality)}function de(){G&&(Z=!0,G=!1,w=Number.POSITIVE_INFINITY),I!==t.default.FRAGMENTED_TEXT?le():ge()}function se(){J=void 0}function le(){H.waitForUpdateEnd(function(){var e=function(){var e=[],t=H.getAllBufferRanges();if(!t||0===t.length)return e;var r=_.getTime(),a=t.end(t.length-1)+N,f=D.getFragmentModel().getRequests({state:n.default.FRAGMENT_MODEL_EXECUTED,time:r,threshold:y})[0];if(f){var i={start:0,end:f.startTime-b},u=D.getFragmentModel().getRequests({state:n.default.FRAGMENT_MODEL_EXECUTED,time:f.startTime-f.duration/2,threshold:y})[0];u&&u.startTime!=f.startTime&&(i.end=u.startTime),i.start<i.end&&i.end>t.start(0)&&e.push(i);var o={start:f.startTime+f.duration+b,end:a},d=D.getFragmentModel().getRequests({state:n.default.FRAGMENT_MODEL_EXECUTED,time:f.startTime+f.duration+b,threshold:y})[0];d&&d.startTime!==f.startTime&&(o.start=d.startTime+d.duration+b),o.start<o.end&&o.start<a&&e.push(o)}else S.debug("getAllRangesWithSafetyFactor for",I,"- No request found in current time position, removing full buffer 0 -",a),e.push({start:0,end:a});return e}();e&&0!==e.length||ge(),De(e)})}function ge(){(!ee||I===t.default.FRAGMENTED_TEXT&&h.isTextEnabled())&&(he(),me())}function Ee(){_e()}function Te(){_e()}function ce(e,t){var r=H.getAllBufferRanges(),n=0,a=0,f=null,i=null,u=0,o=void 0,d=void 0,s=t||.15;if(null!=r){for(d=0,o=r.length;d<o;d++)if(n=r.start(d),a=r.end(d),null===f)u=Math.abs(n-e),e>=n&&e<a?(f=n,i=a):u<=s&&(f=n,i=a);else{if(!((u=n-i)<=s))break;i=a}if(null!==f)return{start:f,end:i}}return null}function he(){var e,t,r;_&&(e=function(){var e=_.getTime();if(J){var t=H.getAllBufferRanges();t&&t.length&&(e=Math.max(t.start(0),J))}return e}()||0,x=null===(r=ce(e,t))?0:r.end-e,a.trigger(c.default.BUFFER_LEVEL_UPDATED,{sender:C,bufferLevel:x}),_e())}function me(){D&&s&&D.getStreamInfo()&&(i.addBufferState(I,V,D.getScheduleController().getBufferTarget()),i.addBufferLevel(I,new Date,1e3*x))}function Ae(){k>=w-1&&!G&&void 0===H.discharge&&(G=!0,S.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED"),a.trigger(c.default.BUFFERING_COMPLETED,{sender:C,streamInfo:D.getStreamInfo()}))}function _e(){"audio"!==I&&"video"!==I||(Z&&!G&&_&&_.getTimeToStreamEnd()-x<b&&(Z=!1,G=!0,S.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED"),a.trigger(c.default.BUFFERING_COMPLETED,{sender:C,streamInfo:D.getStreamInfo()})),(!p.get().streaming.lowLatencyEnabled&&x<b||0===x)&&!G?Ie(L):(G||x>=D.getStreamInfo().manifestInfo.minBufferTime)&&Ie(F))}function Ie(e){V===e||e===L&&0===_.getTime()||I===t.default.FRAGMENTED_TEXT&&!h.isTextEnabled()||(V=e,me(),a.trigger(c.default.BUFFER_LEVEL_STATE_CHANGED,{sender:C,state:e,mediaType:I,streamInfo:D.getStreamInfo()}),a.trigger(e===F?c.default.BUFFER_LOADED:c.default.BUFFER_EMPTY,{mediaType:I}),S.debug(e===F?"Got enough buffer to start for "+I:"Waiting for more buffer before starting playback for "+I))}function ve(){H&&I!==t.default.FRAGMENTED_TEXT&&(G||De(function(){var e=[],t=H.getAllBufferRanges();if(!t||0===t.length)return e;var r=_.getTime(),a={start:Math.max(0,r-p.get().streaming.bufferToKeep),end:r+p.get().streaming.bufferAheadToKeep},f=D.getFragmentModel().getRequests({state:n.default.FRAGMENT_MODEL_EXECUTED,time:r,threshold:y})[0];if(f)a.start=Math.min(f.startTime,a.start),a.end=Math.max(f.startTime+f.duration,a.end);else if(0===r&&_.getIsDynamic())return[];if(t.start(0)<=a.start){for(var i={start:0,end:a.start},u=0;u<t.length&&t.end(u)<=a.start;u++)i.end=t.end(u);i.start<i.end&&e.push(i)}if(t.end(t.length-1)>=a.end){var o={start:a.end,end:t.end(t.length-1)+y};o.start<o.end&&e.push(o)}return e}()))}function De(e){e&&H&&0!==e.length&&($.push.apply($,e),z||Re())}function Re(){if(0===$.length||!H)return S.debug("Nothing to prune, halt pruning"),$=[],void(z=!1);var e=H.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return S.debug("SourceBuffer is empty (or does not exist), halt pruning"),$=[],void(z=!1);var t=$.shift();S.debug("Removing",I,"buffer from:",t.start,"to",t.end),z=!0;var r=_.getTime();r<t.end&&(G=!1,k=0,ee||(D.getScheduleController().setSeekTarget(r),D.setIndexHandlerTime(r))),H.remove(t.start,t.end,t.force)}function pe(e){H===e.buffer&&(S.debug("onRemoved buffer from:",e.from,"to",e.to),ie(H.getAllBufferRanges()),0===$.length&&(z=!1),e.unintended&&(S.warn("Detected unintended removal from:",e.from,"to",e.to,"setting index handler time to",e.from),D.setIndexHandlerTime(e.from)),z?Re():(ee?(ee=!1,te&&fe(te)):(S.debug("onRemoved : call updateBufferLevel"),he()),a.trigger(c.default.BUFFER_CLEARED,{sender:C,from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:Ne()})))}function Me(e){H&&H.updateTimestampOffset&&H.updateTimestampOffset(e)}function Ce(e){e.sender.getStreamProcessor()!==D||e.error||Me(e.currentRepresentation.MSETimeOffset)}function Be(e){e.fragmentModel===D.getFragmentModel()&&(w=e.request.index,Ae())}function Pe(e){var t=H&&H.getAllBufferRanges();t&&e.newMediaInfo.type===I&&e.newMediaInfo.streamInfo.id===D.getStreamInfo().id&&(S.info("Track change asked"),g.getSwitchMode(I)===l.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&t&&t.length>0&&_.getTimeToStreamEnd()>b&&(G=!1,w=Number.POSITIVE_INFINITY))}function Se(){++W*(p.get().streaming.wallclockTimeUpdateInterval/1e3)>=p.get().streaming.bufferPruningInterval&&(W=0,ve())}function Fe(){_e()}function Le(e,t){K=e,H&&t&&"function"==typeof H.discharge&&(Q=H,re(t))}function be(){var e,t=H.getAllBufferRanges(),r=0,n=void 0;if(!t)return r;for(n=0,e=t.length;n<e;n++)r+=t.end(n)-t.start(n);return r}function Ne(){return be()<Y}function ye(e,t){Y=Number.POSITIVE_INFINITY,V=void 0,q=d.default.QUALITY_DEFAULT,w=Number.POSITIVE_INFINITY,k=0,X=null,G=!1,z=!1,Z=!1,x=0,W=0,$=[],H&&(e||H.abort(),H.reset(t),H=null),ee=!1}return C={getBufferControllerType:function(){return U},initialize:function(e){Le(e),q=A.getQualityFor(I),a.on(c.default.DATA_UPDATE_COMPLETED,Ce,this),a.on(c.default.INIT_FRAGMENT_LOADED,ne,this),a.on(c.default.MEDIA_FRAGMENT_LOADED,ae,this),a.on(c.default.QUALITY_CHANGE_REQUESTED,oe,this),a.on(c.default.STREAM_COMPLETED,Be,this),a.on(c.default.PLAYBACK_PLAYING,Te,this),a.on(c.default.PLAYBACK_PROGRESS,ge,this),a.on(c.default.PLAYBACK_TIME_UPDATED,ge,this),a.on(c.default.PLAYBACK_RATE_CHANGED,Fe,this),a.on(c.default.PLAYBACK_SEEKING,de,this),a.on(c.default.PLAYBACK_SEEKED,se,this),a.on(c.default.PLAYBACK_STALLED,Ee,this),a.on(c.default.WALLCLOCK_TIME_UPDATED,Se,this),a.on(c.default.CURRENT_TRACK_CHANGED,Pe,this,E.default.EVENT_PRIORITY_HIGH),a.on(c.default.SOURCEBUFFER_REMOVE_COMPLETED,pe,this)},createBuffer:re,dischargePreBuffer:function(){if(H&&Q&&"function"==typeof Q.discharge){var e=Q.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+I+"PreBuffer discharge, adding buffer for:",r=0;r<e.length;r++)t+=" start: "+e.start(r)+", end: "+e.end(r)+";";S.debug(t)}else S.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");for(var n=Q.discharge(),a=null,f=0;f<n.length;f++){var i=n[f],u=j.extract(i.streamId,i.representationId);u&&(a!==u&&(H.append(u),a=u),H.append(i))}Q.reset(),Q=null}},getType:function(){return I},getStreamProcessor:function(){return D},setSeekStartTime:function(e){J=e},getBuffer:function(){return H},setBuffer:function(e){H=e},getBufferLevel:function(){return x},getRangeAt:ce,setMediaSource:Le,getMediaSource:function(){return K},getIsBufferingCompleted:function(){return G},switchInitData:function(e,t,r){var n=j.extract(e,t);ee=!0===r&&r,n?(S.info("Append Init fragment",I," with representationId:",n.representationId," and quality:",n.quality,", data size:",n.bytes.byteLength),fe(n)):a.trigger(c.default.INIT_REQUESTED,{sender:C})},getIsPruningInProgress:function(){return z},reset:function(e,t){a.off(c.default.DATA_UPDATE_COMPLETED,Ce,this),a.off(c.default.QUALITY_CHANGE_REQUESTED,oe,this),a.off(c.default.INIT_FRAGMENT_LOADED,ne,this),a.off(c.default.MEDIA_FRAGMENT_LOADED,ae,this),a.off(c.default.STREAM_COMPLETED,Be,this),a.off(c.default.CURRENT_TRACK_CHANGED,Pe,this),a.off(c.default.PLAYBACK_PLAYING,Te,this),a.off(c.default.PLAYBACK_PROGRESS,ge,this),a.off(c.default.PLAYBACK_TIME_UPDATED,ge,this),a.off(c.default.PLAYBACK_RATE_CHANGED,Fe,this),a.off(c.default.PLAYBACK_SEEKING,de,this),a.off(c.default.PLAYBACK_SEEKED,se,this),a.off(c.default.PLAYBACK_STALLED,Ee,this),a.off(c.default.WALLCLOCK_TIME_UPDATED,Se,this),a.off(c.default.SOURCEBUFFER_REMOVE_COMPLETED,pe,this),ye(e,t)}},S=(0,v.default)(r).getInstance().getLogger(C),j=(0,R.default)(r).getInstance(),ye(),C}q.__dashjs_factory_name=U;var G=_.default.getClassFactory(q);G.BUFFER_LOADED=F,G.BUFFER_EMPTY=L,_.default.updateClassFactory(q.__dashjs_factory_name,G),exports.default=G;
},{"../constants/Constants":"jJgo","../models/FragmentModel":"OnkV","../SourceBufferSink":"mFuc","../PreBufferSink":"A6uG","./AbrController":"pZlR","./MediaController":"xiaR","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../utils/BoxParser":"Yc5r","../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","../utils/InitCache":"eXbI","../vo/DashJSError":"gyaG","../../core/errors/Errors":"Wrqa","../vo/metrics/HTTPRequest":"yMBz"}],"PWsS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=v(e),n=require("./BufferController"),i=v(n),a=require("../../core/EventBus"),r=v(a),o=require("../../core/events/Events"),d=v(o),s=require("../../core/FactoryMaker"),l=v(s),f=require("../../core/Debug"),u=v(f);function v(e){return e&&e.__esModule?e:{default:e}}var g=500;function m(){var e=this.context,n=(0,r.default)(e).getInstance(),a=void 0,o=void 0,s=void 0,l=void 0,f=void 0,v=void 0,m=void 0,c=void 0,E=void 0,L=void 0,A=void 0,D=void 0,T=void 0,P=void 0,N=void 0,_=void 0,y=void 0,h=void 0,S=void 0,C=void 0,p=void 0,R=void 0,I=void 0,M=void 0;function B(e){!P&&e.fromStreamInfo&&void 0!==L[e.fromStreamInfo.id]&&(delete D[e.fromStreamInfo.id],delete L[e.fromStreamInfo.id])}function k(){return parseFloat((Y()-O()).toFixed(5))}function Y(){var e=j(!0),t=P&&T?e-T.start:0;return e+(T?T.duration-t:t)}function K(){T&&v&&v.getElement()?v.play():_=!0}function b(){return T&&v?v.isPaused():null}function F(){T&&v&&v.pause()}function w(){return T&&v?v.isSeeking():null}function U(e,t,i){T&&v&&(!0===i?e!==v.getTime()&&(v.removeEventListener("seeking",ae),o.info("Requesting seek to time: "+e),v.setCurrentTime(e,t)):(n.trigger(d.default.PLAYBACK_SEEK_ASKED),o.info("Requesting seek to time: "+e),v.setCurrentTime(e,t)))}function O(){return T&&v?v.getTime():null}function x(){var e=O();if(P&&!isNaN(h)){var t=h/1e3;e>t&&(e-=t)}return e}function G(){return T&&v?v.getPlaybackRate():null}function q(){return T&&v?v.getEnded():null}function V(){return P}function W(){if(!P||isNaN(h))return NaN;var e=x();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*m.getClientTimeOffset();return Math.max(((t-h-1e3*e)/1e3).toFixed(3),0)}function z(){c=NaN,_=!1,L={},A=0,h=0,D={},v&&(n.off(d.default.DATA_UPDATE_COMPLETED,Z,this),n.off(d.default.BUFFER_LEVEL_STATE_CHANGED,Le,this),n.off(d.default.BYTES_APPENDED_END_FRAGMENT,ce,this),n.off(d.default.LOADING_PROGRESS,Ee,this),n.off(d.default.PERIOD_SWITCH_STARTED,B,this),n.off(d.default.PLAYBACK_PROGRESS,ge,this),n.off(d.default.PLAYBACK_TIME_UPDATED,ge,this),n.off(d.default.PLAYBACK_ENDED,ue,this),Q(),v.removeEventListener("canplay",$),v.removeEventListener("play",ee),v.removeEventListener("waiting",te),v.removeEventListener("playing",ne),v.removeEventListener("pause",ie),v.removeEventListener("error",ve),v.removeEventListener("seeking",ae),v.removeEventListener("seeked",re),v.removeEventListener("timeupdate",oe),v.removeEventListener("progress",de),v.removeEventListener("ratechange",se),v.removeEventListener("loadedmetadata",le),v.removeEventListener("stalled",Ae),v.removeEventListener("ended",fe)),E=null,v=null,T=null,P=null}function H(){var e=I.getURIFragmentData(),t=void 0;if(e){t={};var n=parseInt(e.r,10);n>=0&&T&&n<T.manifestInfo.DVRWindowSize&&null===e.t&&(e.t=Math.max(Math.floor(Date.now()/1e3)-T.manifestInfo.DVRWindowSize,T.manifestInfo.availableFrom.getTime()/1e3+T.start)+n),t.fragS=parseFloat(e.s),t.fragT=parseFloat(e.t)}return t}function j(e,t){var n=void 0,i=NaN;if(e)i=T?T.start:i;else{var a=H();i=a?isNaN(a.fragS)?a.fragT:a.fragS:0}if(P)!isNaN(i)&&T&&((n=i-T.manifestInfo.availableFrom.getTime()/1e3)>c||n<(isNaN(t)?NaN:t-T.manifestInfo.DVRWindowSize))&&(n=null),n=n||c;else if(T)if(!isNaN(i)&&i<Math.max(T.manifestInfo.duration,T.duration)&&i>=0)n=i;else{var r=L[T.id];n=void 0!==r?Math.max(void 0!==r.audio?r.audio:0,void 0!==r.video?r.video:0,T.start):T.start}return n}function J(){if(null===E){E=setInterval(function(){var e;n.trigger(d.default.WALLCLOCK_TIME_UPDATED,{isDynamic:P,time:new Date}),V()&&b()&&(e=Date.now(),(!y||e>y+g)&&(y=e,oe()))},M.get().streaming.wallclockTimeUpdateInterval)}}function Q(){clearInterval(E),E=null}function X(){if(!b()&&P&&0!==v.getReadyState()){var e=x(),t=function(e){var t=l.getCurrentDVRInfo(),n=t?t.range:null;return n?e>n.end?Math.max(n.end-2*T.manifestInfo.minBufferTime,n.start):e+.25<n.start&&n.start-e>n.start-31536e4?n.start:e:NaN}(e);!isNaN(t)&&t!==e&&U(t)}}function Z(e){if(!e.error){var t=f.convertDataToRepresentationInfo(e.currentRepresentation).mediaInfo.streamInfo;T.id===t.id&&(T=t,X())}}function $(){n.trigger(d.default.CAN_PLAY)}function ee(){o.info("Native video element event: play"),X(),J(),n.trigger(d.default.PLAYBACK_STARTED,{startTime:O()})}function te(){o.info("Native video element event: waiting"),n.trigger(d.default.PLAYBACK_WAITING,{playingTime:O()})}function ne(){o.info("Native video element event: playing"),n.trigger(d.default.PLAYBACK_PLAYING,{playingTime:O()})}function ie(){o.info("Native video element event: pause"),n.trigger(d.default.PLAYBACK_PAUSED,{ended:q()})}function ae(){var e=O();o.info("Seeking to: "+e),J(),n.trigger(d.default.PLAYBACK_SEEKING,{seekTime:e})}function re(){o.info("Native video element event: seeked"),n.trigger(d.default.PLAYBACK_SEEKED),v.addEventListener("seeking",ae)}function oe(){T&&n.trigger(d.default.PLAYBACK_TIME_UPDATED,{timeToEnd:k(),time:O()})}function de(){n.trigger(d.default.PLAYBACK_PROGRESS)}function se(){var e=G();o.info("Native video element event: ratechange: ",e),n.trigger(d.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function le(){o.info("Native video element event: loadedmetadata"),n.trigger(d.default.PLAYBACK_METADATA_LOADED),J()}function fe(){o.info("Native video element event: ended"),F(),Q(),n.trigger(d.default.PLAYBACK_ENDED,{isLast:s.getActiveStreamInfo().isLast})}function ue(e){E&&e.isLast&&(o.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended"),v.setCurrentTime(Y()),F(),Q())}function ve(e){var t=e.target||e.srcElement;n.trigger(d.default.PLAYBACK_ERROR,{error:t.error})}function ge(){P&&M.get().streaming.lowLatencyEnabled&&M.get().streaming.lowLatencyEnabled>0&&!b()&&!w()&&(M.get().streaming.liveCatchUpPlaybackRate>0&&O()>0&&Math.abs(W()-N.getLiveDelay())>M.get().streaming.liveCatchUpMinDrift?function(){if(v){var e=M.get().streaming.liveCatchUpPlaybackRate,t=N.getLiveDelay(),n=W()-t,i=5*n,a=2*e/(1+Math.pow(Math.E,-i)),r=1-e+a;if(p){var d=function(){var e=null;return s.getActiveStreamProcessors().forEach(function(t){var n=t.getBufferLevel();e=null===e?n:Math.min(e,n)}),e}();d>t/2?p=!1:n>0&&(r=1)}Math.abs(v.getPlaybackRate()-r)>R&&v.setPlaybackRate(r),M.get().streaming.liveCatchUpMaxDrift>0&&!C&&n>M.get().streaming.liveCatchUpMaxDrift?(o.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),C=!0,U(((f=l.getCurrentDVRInfo())?f.range:null).end-N.getLiveDelay(),!0,!1)):C=!1}var f}():me())}function me(){v&&v.setPlaybackRate(1)}function ce(e){var n,i=void 0,a=e.bufferedRanges;if(a&&a.length&&(!L[T.id]||!0!==L[T.id].started)){var r=e.sender.getType();void 0===D[T.id]&&(D[T.id]=[]),D[T.id][r]=a,void 0===L[T.id]&&(L[T.id]=[],L[T.id].started=!1),void 0===L[T.id][r]&&(L[T.id][r]=Math.max(a.start(0),T.start));var o=s.isTrackTypePresent(t.default.VIDEO),d=s.isTrackTypePresent(t.default.AUDIO);n=j(!1),d&&o?isNaN(L[T.id].audio)||isNaN(L[T.id].video)||(L[T.id].audio<L[T.id].video?(i=L[T.id].video>n?L[T.id].video:n,a=D[T.id].audio):(i=L[T.id].audio>n?L[T.id].audio:n,a=D[T.id].video),function(e,t){if(t&&t.length>0)for(var n=0,i=t.length;n<i;n++)if(e>=t.start(n)&&e<t.end(n))return!0;return!1}(i,a)&&(w()||S||0===i||U(i,!0,!0),L[T.id].started=!0)):L[T.id][r]&&(i=L[T.id][r]>n?L[T.id][r]:n,w()||S||U(i,!1,!0),L[T.id].started=!0)}}function Ee(e){if(!1===e.stream&&M.get().streaming.lowLatencyEnabled&&!isNaN(e.request.duration)){var t=1.2*e.request.duration;if(t>N.getLiveDelay()){o.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",t.toFixed(2));var n={streaming:{liveDelay:t}};M.update(n)}}}function Le(e){e.streamInfo.id===T.id&&(M.get().streaming.lowLatencyEnabled?e.state!==i.default.BUFFER_EMPTY||w()||p||(p=!0,me()):v.setStallState(e.mediaType,e.state===i.default.BUFFER_EMPTY))}function Ae(e){n.trigger(d.default.PLAYBACK_STALLED,{e:e})}return a={initialize:function(e,t){T=e,v.addEventListener("canplay",$),v.addEventListener("play",ee),v.addEventListener("waiting",te),v.addEventListener("playing",ne),v.addEventListener("pause",ie),v.addEventListener("error",ve),v.addEventListener("seeking",ae),v.addEventListener("seeked",re),v.addEventListener("timeupdate",oe),v.addEventListener("progress",de),v.addEventListener("ratechange",se),v.addEventListener("loadedmetadata",le),v.addEventListener("stalled",Ae),v.addEventListener("ended",fe),P=T.manifestInfo.isDynamic,C=!1,p=!1,c=T.start,S=t;var i="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",a=/safari/.test(i)&&!/chrome/.test(i);R=a?.25:.02,n.on(d.default.DATA_UPDATE_COMPLETED,Z,this),n.on(d.default.BYTES_APPENDED_END_FRAGMENT,ce,this),n.on(d.default.LOADING_PROGRESS,Ee,this),n.on(d.default.BUFFER_LEVEL_STATE_CHANGED,Le,this),n.on(d.default.PERIOD_SWITCH_STARTED,B,this),n.on(d.default.PLAYBACK_PROGRESS,ge,this),n.on(d.default.PLAYBACK_TIME_UPDATED,ge,this),n.on(d.default.PLAYBACK_ENDED,ue,this),_&&(_=!1,K())},setConfig:function(e){e&&(e.streamController&&(s=e.streamController),e.dashMetrics&&(l=e.dashMetrics),e.mediaPlayerModel&&(N=e.mediaPlayerModel),e.adapter&&(f=e.adapter),e.videoModel&&(v=e.videoModel),e.timelineConverter&&(m=e.timelineConverter),e.uriFragmentModel&&(I=e.uriFragmentModel),e.settings&&(M=e.settings))},getStartTimeFromUriParameters:H,getStreamStartTime:j,getTimeToStreamEnd:k,getTime:O,getNormalizedTime:x,getPlaybackRate:G,getPlayedRanges:function(){return T&&v?v.getPlayedRanges():null},getEnded:q,getIsDynamic:V,getStreamController:function(){return s},setLiveStartTime:function(e){c=e},getLiveStartTime:function(){return c},computeLiveDelay:function(e,t){var n,i=void 0,a=void 0,r=f.getSuggestedPresentationDelay();if(i=M.get().streaming.useSuggestedPresentationDelay&&null!==r?r:M.get().streaming.lowLatencyEnabled?0:N.getLiveDelay()?N.getLiveDelay():isNaN(e)?2*T.manifestInfo.minBufferTime:e*M.get().streaming.liveDelayFragmentCount,null!==(n=f.getAvailabilityStartTime())&&(h=n),t>0){var o=Math.max(t-10,t/2);a=Math.min(i,o)}else a=i;return A=a,a},getLiveDelay:function(){return A},getCurrentLiveLatency:W,play:K,isPaused:b,pause:F,isSeeking:w,seek:U,reset:z},o=(0,u.default)(e).getInstance().getLogger(a),z(),a}m.__dashjs_factory_name="PlaybackController",exports.default=l.default.getSingletonFactory(m);
},{"../constants/Constants":"jJgo","./BufferController":"REuJ","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O"}],"lfFL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=o(e),r=require("../constants/Constants"),n=o(r);function o(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=(e=e||{}).timelineConverter,r=e.streamProcessor;return{getLiveEdge:function(){!function(){if(!(t&&t.hasOwnProperty("getExpectedLiveEdge")&&r&&r.hasOwnProperty("getRepresentationInfo")))throw new Error(n.default.MISSING_CONFIG_ERROR)}();var e=r.getRepresentationInfo(),o=e.DVRWindow?e.DVRWindow.end:0,i=o;return e.useCalculatedLiveEdgeTime&&(i=t.getExpectedLiveEdge(),t.setClientTimeOffset(i-o)),i},reset:function(){t=null,r=null}}}i.__dashjs_factory_name="LiveEdgeFinder",exports.default=t.default.getClassFactory(i);
},{"../../core/FactoryMaker":"FHM8","../constants/Constants":"jJgo"}],"UnUH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=S(e),r=require("../../core/EventBus"),n=S(r),u=require("../../core/events/Events"),o=S(u),f=require("../../core/FactoryMaker"),a=S(f),i=require("../utils/InitCache"),s=S(i),c=require("../SourceBufferSink"),d=S(c),l=require("../../streaming/text/TextController"),E=S(l),g=require("../../streaming/vo/DashJSError"),T=S(g),_=require("../../core/errors/Errors"),D=S(_);function S(e){return e&&e.__esModule?e:{default:e}}var P="NotFragmentedTextBufferController";function m(e){e=e||{};var r=this.context,u=(0,n.default)(r).getInstance(),f=(0,E.default)(r).getInstance(),a=e.errHandler,i=e.type,c=e.mimeType,l=e.streamProcessor,g=void 0,_=void 0,S=void 0,m=void 0,I=void 0,M=void 0;function O(e){m=e}function v(e){if(e.sender.getStreamProcessor()===l&&!e.error){var t=l.getStreamInfo(),r=e.sender.getCurrentRepresentation();M.extract(t?t.id:null,r?r.id:null)||u.trigger(o.default.TIMED_TEXT_REQUESTED,{index:0,sender:e.sender})}}function A(e){e.fragmentModel===l.getFragmentModel()&&e.chunk.bytes&&(M.save(e.chunk),I.append(e.chunk),u.trigger(o.default.STREAM_COMPLETED,{request:e.request,fragmentModel:e.fragmentModel}))}return g={getBufferControllerType:function(){return P},initialize:function(e){O(e),M=(0,s.default)(r).getInstance()},createBuffer:function(e){try{if(I=(0,d.default)(r).create(m,e),!S){var n=I.getBuffer();n.hasOwnProperty(t.default.INITIALIZE)&&n.initialize(c,l),S=!0}return I}catch(u){if(e&&(e.isText||-1!==e.codec.indexOf('codecs="stpp')||-1!==e.codec.indexOf('codecs="wvtt')))try{I=f.getTextSourceBuffer()}catch(u){a.error(new T.default(D.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,D.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+i+" : "+u.message))}else a.error(new T.default(D.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,D.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+i))}},getType:function(){return i},getStreamProcessor:function(){return l},setSeekStartTime:function(){},getBuffer:function(){return I},getBufferLevel:function(){return 0},setMediaSource:O,getMediaSource:function(){return m},getIsBufferingCompleted:function(){return _},getIsPruningInProgress:function(){return!1},dischargePreBuffer:function(){},switchInitData:function(e,t){M.extract(e,t)||u.trigger(o.default.TIMED_TEXT_REQUESTED,{index:0,sender:g})},getRangeAt:function(){return null},reset:function(e){u.off(o.default.DATA_UPDATE_COMPLETED,v,g),u.off(o.default.INIT_FRAGMENT_LOADED,A,g),!e&&I&&(I.abort(),I.reset(),I=null)},updateTimestampOffset:function(e){I.timestampOffset===e||isNaN(e)||(I.timestampOffset=e)}},S=!1,m=null,_=!1,u.on(o.default.DATA_UPDATE_COMPLETED,v,g),u.on(o.default.INIT_FRAGMENT_LOADED,A,g),g}m.__dashjs_factory_name=P,exports.default=a.default.getClassFactory(m);
},{"../constants/Constants":"jJgo","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../utils/InitCache":"eXbI","../SourceBufferSink":"mFuc","../../streaming/text/TextController":"IrZJ","../../streaming/vo/DashJSError":"gyaG","../../core/errors/Errors":"Wrqa"}],"rvjc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),r=f(e),t=require("../../core/FactoryMaker"),n=f(t),o=require("./../controllers/BufferController"),a=f(o),s=require("./NotFragmentedTextBufferController"),u=f(s);function f(e){return e&&e.__esModule?e:{default:e}}function i(e){e=e||{};var t,n=this.context,o=void 0;function s(){return o.getBuffer()}return t={getBufferControllerType:function(){return o.getBufferControllerType()},initialize:function(e,r){return o.initialize(e,r)},createBuffer:function(e){return o.createBuffer(e)},getType:function(){return o.getType()},getStreamProcessor:function(){o.getStreamProcessor()},setSeekStartTime:function(e){o.setSeekStartTime(e)},getBuffer:s,setBuffer:function(e){o.setBuffer(e)},getBufferLevel:function(){return o.getBufferLevel()},setMediaSource:function(e){o.setMediaSource(e)},getMediaSource:function(){return o.getMediaSource()},getIsBufferingCompleted:function(){return o.getIsBufferingCompleted()},getIsPruningInProgress:function(){return o.getIsPruningInProgress()},dischargePreBuffer:function(){return o.dischargePreBuffer()},switchInitData:function(e,r){o.switchInitData(e,r)},getRangeAt:function(e){return o.getRangeAt(e)},reset:function(e){o.reset(e)},updateTimestampOffset:function(e){var r=s();r.timestampOffset===e||isNaN(e)||(r.timestampOffset=e)}},o=e.type===r.default.FRAGMENTED_TEXT?(0,a.default)(n).create({type:e.type,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,manifestModel:e.manifestModel,errHandler:e.errHandler,streamController:e.streamController,mediaController:e.mediaController,adapter:e.adapter,textController:e.textController,abrController:e.abrController,playbackController:e.playbackController,streamProcessor:e.streamProcessor,settings:e.settings}):(0,u.default)(n).create({type:e.type,mimeType:e.mimeType,errHandler:e.errHandler,streamProcessor:e.streamProcessor}),t}i.__dashjs_factory_name="TextBufferController",exports.default=n.default.getClassFactory(i);
},{"../constants/Constants":"jJgo","../../core/FactoryMaker":"FHM8","./../controllers/BufferController":"REuJ","./NotFragmentedTextBufferController":"UnUH"}],"siyq":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};e.INITIAL_PLAYOUT_START_REASON="initial_playout",e.SEEK_START_REASON="seek",e.RESUME_FROM_PAUSE_START_REASON="resume",e.METRICS_COLLECTION_START_REASON="metrics_collection_start";var _=function e(){t(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};_.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",_.REBUFFERING_REASON="rebuffering",_.USER_REQUEST_STOP_REASON="user_request",_.END_OF_PERIOD_STOP_REASON="end_of_period",_.END_OF_CONTENT_STOP_REASON="end_of_content",_.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",_.FAILURE_STOP_REASON="failure",exports.PlayList=e,exports.PlayListTrace=_;
},{}],"i5Nk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../constants/Constants"),t=n(e),r=require("../../../core/FactoryMaker"),a=n(r);function n(e){return e&&e.__esModule?e:{default:e}}function u(e){var r=(e=e||{}).dashMetrics,a=e.mediaPlayerModel,n=e.textController,u=e.abrController,o=e.settings;function f(e,f){var i=NaN;if(!e)return i;var l=e.getType(),s=e.getRepresentationInfo();if(l===t.default.FRAGMENTED_TEXT)i=n.isTextEnabled()?s.fragmentDuration:0;else if(l===t.default.AUDIO&&f){var g=r.getCurrentBufferLevel(t.default.VIDEO,!0);i=isNaN(s.fragmentDuration)?g:Math.max(g,s.fragmentDuration)}else{var d=s.mediaInfo.streamInfo;if(u.isPlayingAtTopQuality(d))i=d.manifestInfo.duration>=o.get().streaming.longFormContentDurationThreshold?o.get().streaming.bufferTimeAtTopQualityLongForm:o.get().streaming.bufferTimeAtTopQuality;else i=a.getStableBufferTime()}return i}return{execute:function(e,t){return!e||r.getCurrentBufferLevel(e.getType(),!0)<f(e,t)},getBufferTarget:f}}u.__dashjs_factory_name="BufferLevelRule",exports.default=a.default.getClassFactory(u);
},{"../../constants/Constants":"jJgo","../../../core/FactoryMaker":"FHM8"}],"s2O8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../constants/Constants"),t=i(e),r=require("../../../core/Debug"),n=i(r),a=require("../../../core/FactoryMaker"),u=i(a),o=require("../../../streaming/vo/FragmentRequest"),s=i(o);function i(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var r=this.context,a=e.textController,u=e.playbackController,o=void 0;return o={execute:function(e,r,n){if(!e)return null;var o=e.getRepresentationInfo(),i=e.getType(),l=!isNaN(r),g=e.getBufferController(),d=u.getNormalizedTime(),f=l?r:e.getIndexHandlerTime(),c=!1,m=void 0;if(isNaN(f)||i===t.default.FRAGMENTED_TEXT&&!a.isTextEnabled())return null;if(g){var T=g.getRangeAt(f),F=g.getRangeAt(d),R=g.getBuffer().hasDiscontinuitiesAfter(d);null===T&&null===F||l||(!T||F&&F.start!=T.start&&F.end!=T.end)&&(R&&i!==t.default.FRAGMENTED_TEXT&&(e.getFragmentModel().removeExecutedRequestsAfterTime(F.end),c=!0),T=F)}if(n)f=n.startTime+n.duration/2,m=e.getFragmentRequest(o,f,{timeThreshold:0,ignoreIsFinished:!0});else for(m=e.getFragmentRequest(o,l||c?f:void 0,{keepIdx:!l&&!c});m&&m.action!==s.default.ACTION_COMPLETE&&e.getFragmentModel().isFragmentLoaded(m);)m=e.getFragmentRequest(o);return m}},(0,n.default)(r).getInstance().getLogger(o),o}l.__dashjs_factory_name="NextFragmentRequestRule",exports.default=u.default.getClassFactory(l);
},{"../../constants/Constants":"jJgo","../../../core/Debug":"iL1O","../../../core/FactoryMaker":"FHM8","../../../streaming/vo/FragmentRequest":"Vb3t"}],"AMLk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=S(e),i=require("../vo/metrics/PlayList"),n=require("./AbrController"),a=S(n),r=require("./BufferController"),o=S(r),s=require("../rules/scheduling/BufferLevelRule"),u=S(s),d=require("../rules/scheduling/NextFragmentRequestRule"),f=S(d),l=require("../models/FragmentModel"),E=S(l),g=require("../../core/EventBus"),c=S(g),T=require("../../core/events/Events"),m=S(T),A=require("../../core/FactoryMaker"),I=S(A),D=require("../../core/Debug"),_=S(D),R=require("./MediaController"),h=S(R);function S(e){return e&&e.__esModule?e:{default:e}}function N(e){e=e||{};var n=this.context,r=(0,c.default)(n).getInstance(),s=e.adapter,d=e.dashMetrics,l=e.timelineConverter,g=e.mediaPlayerModel,T=e.abrController,A=e.playbackController,I=e.streamController,D=e.textController,R=e.type,S=e.streamProcessor,N=e.mediaController,y=e.settings,C=void 0,L=void 0,v=void 0,p=void 0,P=void 0,q=void 0,M=void 0,b=void 0,F=void 0,B=void 0,x=void 0,O=void 0,k=void 0,U=void 0,w=void 0,G=void 0,Q=void 0,Y=void 0,K=void 0,H=void 0;function W(){p&&!S.isBufferingCompleted()?(L.debug("Schedule Controller starts"),Re(),q=!1,P&&(P=!1),j(0)):L.warn("Start denied to Schedule Controller")}function V(){q||(L.debug("Schedule Controller stops"),q=!0,clearTimeout(F))}function X(){var e=S.getBufferController();if(q||M||!e||A.isPaused()&&!y.get().streaming.scheduleWhilePaused||!(R!==t.default.FRAGMENTED_TEXT&&R!==t.default.TEXT||D.isTextEnabled()))L.debug("Schedule stop!");else if(e.getIsBufferingCompleted())L.debug("Schedule stop because buffering is completed!");else{!function(){var e=A.getTime(),t=1.5*p.fragmentDuration,i=v.getRequests({state:E.default.FRAGMENT_MODEL_EXECUTED,time:e+t,threshold:0})[0];if(i&&-1===G.indexOf(i)&&!s.getIsTextTrack(R)){var n=y.get().streaming.fastSwitchEnabled,r=S.getBufferLevel(),o=T.getAbandonmentStateFor(R),u=!N.isCurrentTrack(i.mediaInfo)&&N.getSwitchMode(i.mediaInfo.type)===h.default.TRACK_SWITCH_MODE_NEVER_REPLACE,d=i.quality<p.quality;n&&(u||d)&&r>=t&&o!==a.default.ABANDON_LOAD?($(i),H=!0,L.debug("Reloading outdated fragment at index: ",i.index)):i.quality>p.quality&&!Y&&Ie(A.getTime()+S.getBufferLevel())}}();var i=G.length>0,n=S.getStreamInfo();if(Y||isNaN(w)||Q||i||function(e,t){U[t]=U[t]||{};var i=T.getTopQualityIndexFor(e,t);return U[t][e]!=i&&(L.info("Top quality "+e+" index has changed from "+U[t][e]+" to "+i),U[t][e]=i,!0)}(p.mediaInfo.type,n.id)||x.execute(S,I.isTrackTypePresent(t.default.VIDEO))){Z(!0),i||Q||T.checkPlaybackQuality(R),function(){var e=S.getFragmentController();if(p.quality===w&&!Q||Y){var t=G.shift();if(e.isInitializationRequest(t))S.switchInitData(t.representationId);else{var i=void 0;S.getBufferController().getIsPruningInProgress()||(i=O.execute(S,B,t),Ie(NaN),i&&!t&&(isNaN(i.startTime+i.duration)||S.setIndexHandlerTime(i.startTime+i.duration),i.delayLoadingTime=(new Date).getTime()+b,De(0)),!i&&n.manifestInfo&&n.manifestInfo.isDynamic&&L.debug("Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling.")),i?(L.debug("Next fragment request url is "+i.url),v.executeRequest(i)):(Z(!1),j(y.get().streaming.lowLatencyEnabled?100:500))}}else L.debug("Quality has changed, get init request for representationid = "+p.id),Q?(Y=N.getSwitchMode(R)===h.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,L.debug("Switch track has been asked, get init request for "+R+" with representationid = "+p.id+"bufferResetInProgress = "+Y),S.switchInitData(p.id,Y),Q=!1):S.switchInitData(p.id),w=p.quality}()}else j(500)}}function j(e){clearTimeout(F),F=setTimeout(X,e)}function z(e){e.sender&&e.sender.getStreamProcessor()===S&&J(p.quality)}function Z(e){M!==e?M=e:L.debug("isFragmentProcessingInProgress is already equal to",e)}function J(e){var t=S.getInitRequest(e);t&&(Z(!0),v.executeRequest(t))}function $(e){G.push(e)}function ee(e){if(R===e.mediaType&&S.getStreamInfo().id===e.streamInfo.id){if(null==(p=S.getRepresentationInfo(e.newQuality)))throw new Error("Unexpected error! - currentRepresentationInfo is null or undefined");_e(new Date,i.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),Re()}}function te(e){if(A&&v){var t=v.getRequests({state:E.default.FRAGMENT_MODEL_EXECUTED,time:A.getTime(),threshold:0})[0];t&&A.getTime()>=t.startTime&&((!k.mediaInfo||t.mediaInfo.type===k.mediaInfo.type&&t.mediaInfo.id!==k.mediaInfo.id)&&e&&r.trigger(m.default.TRACK_CHANGE_RENDERED,{mediaType:R,oldMediaInfo:k.mediaInfo,newMediaInfo:t.mediaInfo}),t.quality===k.quality&&t.adaptationIndex===k.adaptationIndex||!e||r.trigger(m.default.QUALITY_CHANGE_RENDERED,{mediaType:R,oldQuality:k.quality,newQuality:t.quality}),k={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function ie(e){e.error||e.sender.getStreamProcessor()!==S||(p=s.convertDataToRepresentationInfo(e.currentRepresentation))}function ne(e){S.getStreamInfo().id===e.streamInfo.id&&(p=S.getRepresentationInfo(),P&&(A.getIsDynamic()?(l.setTimeSyncCompleted(!0),function(){var e=S.getLiveEdgeFinder();if(e){var t=e.getLiveEdge(),i=p.mediaInfo.streamInfo.manifestInfo.DVRWindowSize/2,n=t-A.computeLiveDelay(p.fragmentDuration,i),a=S.getFragmentRequest(p,n,{ignoreIsFinished:!0});if(a)if(y.get().streaming.lowLatencyEnabled){var r=a.duration<g.getLiveDelay()?a.startTime:a.startTime+a.duration-g.getLiveDelay();A.setLiveStartTime(r)}else A.setLiveStartTime(a.startTime);else L.debug("setLiveEdgeSeekTarget : getFragmentRequest returned undefined request object");Ie(A.getStreamStartTime(!1,t)),S.getBufferController().setSeekStartTime(B),B>p.mediaInfo.streamInfo.start+p.mediaInfo.streamInfo.duration&&A.seek(B),d.updateManifestUpdateInfo({currentTime:B,presentationStartTime:t,latency:t-B,clientTimeOffset:l.getClientTimeOffset()})}}()):(Ie(A.getStreamStartTime(!1)),S.getBufferController().setSeekStartTime(B))),q&&W())}function ae(e){e.fragmentModel===v&&(V(),Z(!1),L.info("Stream is complete"))}function re(e){e.sender===v&&(L.info("OnFragmentLoadingCompleted - Url:",e.request?e.request.url:"undefined",", Range:",e.request.range?e.request.range:"undefined"),s.getIsTextTrack(R)&&Z(!1),e.error&&e.request.serviceLocation&&!q&&($(e.request),Z(!1),j(0)),Y&&(K=e.request))}function oe(){te(!0)}function se(e){if(e.sender.getStreamProcessor()===S)if(Y&&!isNaN(e.startTime)&&(Y=!1,v.addExecutedRequest(K)),Z(!1),H&&!isNaN(e.startTime)){var t=A.getTime(),i=e.startTime+p.fragmentDuration,n=1.5*p.fragmentDuration;j(t+n>=i?0:1e3*(i-(t+n))),H=!1}else j(0)}function ue(e){e.streamProcessor===S&&(L.info("onFragmentLoadingAbandoned for "+R+", request: "+e.request.url+" has been aborted"),A.isSeeking()||Q||(L.info("onFragmentLoadingAbandoned for "+R+", request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),$(e.request)),Z(!1),j(0))}function de(e){e.sender.getStreamProcessor()===S&&V()}function fe(e){if(e.sender.getStreamProcessor()===S){var t=S.getStreamInfo();t&&(e.unintended?v.removeExecutedRequestsAfterTime(e.from):v.syncExecutedRequestsWithBufferedRange(S.getBufferController().getBuffer().getAllBufferRanges(),t.duration)),e.hasEnoughSpaceToAppend&&q&&W()}}function le(e){e.sender.getStreamProcessor()!==S||e.state!==o.default.BUFFER_EMPTY||A.isSeeking()||(L.info("Buffer is empty! Stalling!"),_e(new Date,i.PlayListTrace.REBUFFERING_REASON))}function Ee(e){e.sender.getStreamProcessor()===S&&(V(),Z(!1))}function ge(){v.abortRequests(),V()}function ce(e){e.sender.getStreamProcessor()===S&&D.isTextEnabled()&&J(e.index)}function Te(){!q&&y.get().streaming.scheduleWhilePaused||W()}function me(e){Ie(e.seekTime),De(0),q&&W();var t=p.DVRWindow&&A?p.DVRWindow.end-A.getTime():NaN;d.updateManifestUpdateInfo({latency:t}),M?(L.debug("onPlaybackSeeking for "+R+", call fragmentModel.abortRequests in order to seek quicker"),v.abortRequests()):j(0)}function Ae(e){d.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function Ie(e){B=e}function De(e){b=e}function _e(e,t){d.pushPlayListTraceMetrics(e,t)}function Re(){if(p){var e=A.getPlaybackRate();d.createPlaylistTraceMetrics(p.id,1e3*A.getTime(),null!==e?e.toString():null)}}function he(){M=!1,b=0,B=NaN,P=!0,w=NaN,k={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},U={},G=[],q=!0,Q=!1,Y=!1,K=null,H=!1}return C={initialize:function(){v=S.getFragmentModel(),x=(0,u.default)(n).create({abrController:T,dashMetrics:d,mediaPlayerModel:g,textController:D,settings:y}),O=(0,f.default)(n).create({textController:D,playbackController:A}),s.getIsTextTrack(e.mimeType)&&r.on(m.default.TIMED_TEXT_REQUESTED,ce,this),r.on(m.default.QUALITY_CHANGE_REQUESTED,ee,this),r.on(m.default.DATA_UPDATE_STARTED,de,this),r.on(m.default.DATA_UPDATE_COMPLETED,ie,this),r.on(m.default.FRAGMENT_LOADING_COMPLETED,re,this),r.on(m.default.STREAM_COMPLETED,ae,this),r.on(m.default.STREAM_INITIALIZED,ne,this),r.on(m.default.BUFFER_LEVEL_STATE_CHANGED,le,this),r.on(m.default.BUFFER_CLEARED,fe,this),r.on(m.default.BYTES_APPENDED_END_FRAGMENT,se,this),r.on(m.default.INIT_REQUESTED,z,this),r.on(m.default.QUOTA_EXCEEDED,Ee,this),r.on(m.default.PLAYBACK_SEEKING,me,this),r.on(m.default.PLAYBACK_STARTED,Te,this),r.on(m.default.PLAYBACK_RATE_CHANGED,Ae,this),r.on(m.default.PLAYBACK_TIME_UPDATED,oe,this),r.on(m.default.URL_RESOLUTION_FAILED,ge,this),r.on(m.default.FRAGMENT_LOADING_ABANDONED,ue,this)},getType:function(){return R},setSeekTarget:Ie,setTimeToLoadDelay:De,replaceRequest:$,switchTrackAsked:function(){Q=!0},isStarted:function(){return!1===q},start:W,stop:V,reset:function(){r.off(m.default.DATA_UPDATE_STARTED,de,this),r.off(m.default.DATA_UPDATE_COMPLETED,ie,this),r.off(m.default.BUFFER_LEVEL_STATE_CHANGED,le,this),r.off(m.default.QUALITY_CHANGE_REQUESTED,ee,this),r.off(m.default.FRAGMENT_LOADING_COMPLETED,re,this),r.off(m.default.STREAM_COMPLETED,ae,this),r.off(m.default.STREAM_INITIALIZED,ne,this),r.off(m.default.QUOTA_EXCEEDED,Ee,this),r.off(m.default.BYTES_APPENDED_END_FRAGMENT,se,this),r.off(m.default.BUFFER_CLEARED,fe,this),r.off(m.default.INIT_REQUESTED,z,this),r.off(m.default.PLAYBACK_RATE_CHANGED,Ae,this),r.off(m.default.PLAYBACK_SEEKING,me,this),r.off(m.default.PLAYBACK_STARTED,Te,this),r.off(m.default.PLAYBACK_TIME_UPDATED,oe,this),r.off(m.default.URL_RESOLUTION_FAILED,ge,this),r.off(m.default.FRAGMENT_LOADING_ABANDONED,ue,this),s.getIsTextTrack(R)&&r.off(m.default.TIMED_TEXT_REQUESTED,ce,this),V(),te(!1),he()},getBufferTarget:function(){return x.getBufferTarget(S,I.isTrackTypePresent(t.default.VIDEO))},finalisePlayList:function(e,t){_e(e,t)}},L=(0,_.default)(n).getInstance().getLogger(C),he(),C}N.__dashjs_factory_name="ScheduleController",exports.default=I.default.getClassFactory(N);
},{"../constants/Constants":"jJgo","../vo/metrics/PlayList":"siyq","./AbrController":"pZlR","./BufferController":"REuJ","../rules/scheduling/BufferLevelRule":"i5Nk","../rules/scheduling/NextFragmentRequestRule":"s2O8","../models/FragmentModel":"OnkV","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","./MediaController":"xiaR"}],"wYnc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,i){for(var e=0;e<i.length;e++){var E=i[e];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(t,E.key,E)}}return function(i,e,E){return e&&t(i.prototype,e),E&&t(i,E),i}}();function i(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var e=function(){function e(){i(this,e),this.init()}return t(e,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay"}}]),e}(),E=new e;exports.default=E;
},{}],"rH33":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),e=require("../constants/DashConstants"),n=i(e);function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=function(){function e(){a(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return t(e,null,[{key:"hasInitialization",value:function(t){return null!==t.initialization||null!==t.range}},{key:"hasSegments",value:function(t){return t.segmentInfoType!==n.default.BASE_URL&&t.segmentInfoType!==n.default.SEGMENT_BASE&&!t.indexRange}}]),e}();exports.default=l;
},{"../constants/DashConstants":"wYnc"}],"SDXM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../streaming/constants/Constants"),t=A(e),n=require("../../core/errors/Errors"),r=A(n),a=require("../constants/DashConstants"),i=A(a),o=require("../../streaming/vo/DashJSError"),d=A(o),u=require("../../core/EventBus"),l=A(u),f=require("../../core/events/Events"),s=A(f),g=require("../../core/FactoryMaker"),E=A(g),T=require("../vo/Representation"),c=A(T);function A(e){return e&&e.__esModule?e:{default:e}}function D(){var e=this.context,n=(0,l.default)(e).getInstance(),a=void 0,o=void 0,u=void 0,f=void 0,g=void 0,E=void 0,T=void 0,A=void 0,D=void 0,p=void 0,_=void 0,v=void 0;function m(){if(!(E&&p&&A&&D&&v&&_))throw new Error(t.default.MISSING_CONFIG_ERROR)}function R(){return u}function I(){return g}function y(){o=null,u=!0,f=[],E=null,A=null,D=null,p=null}function S(){m();var e=new Date,t=I(),n=1e3*A.getTime();t&&p.addRepresentationSwitch(t.adaptation.type,e,n,t.id)}function U(){m();var e=_.getStreamInfo(),t=e?e.manifestInfo:null,n=t?t.isDynamic:null,r=D.calcSegmentAvailabilityRange(g,n);p.addDVRInfo(_.getType(),A.getTime(),t,r)}function C(e){return null==e||e>=f.length?null:f[e]}function P(e){var t=e;u=!1,n.trigger(s.default.AST_IN_FUTURE,{delay:t}),setTimeout(function(){if(!R()){u=!0,n.trigger(s.default.DATA_UPDATE_STARTED,{sender:a}),f.forEach(function(e){e.segmentAvailabilityRange=null});for(var e=0;e<f.length;e++)T.updateRepresentation(f[e],!0)}},t)}function M(e){if(e.sender.getStreamProcessor()===_&&R())if(e.error)n.trigger(s.default.DATA_UPDATE_COMPLETED,{sender:this,error:e.error});else{var t,a=e.representation,l=p.getCurrentManifestUpdate(),T=!1,D=0,v=void 0,m=void 0;if(a.adaptation.period.mpd.manifest.type===i.default.DYNAMIC&&!a.adaptation.period.mpd.manifest.ignorePostponeTimePeriod){var y=a.segmentAvailabilityRange.end-a.segmentAvailabilityRange.start;D=1e3*(A.computeLiveDelay(g.segmentDuration,_.getStreamInfo().manifestInfo.DVRWindowSize)-y)}if(D>0)return U(),P(D),m=new d.default(r.default.SEGMENTS_UPDATE_FAILED_ERROR_CODE,r.default.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE),void n.trigger(s.default.DATA_UPDATE_COMPLETED,{sender:this,data:o,currentRepresentation:g,error:m});if(l){for(var C=0;C<l.representationInfo.length;C++)if((v=l.representationInfo[C]).index===a.index&&v.mediaType===_.getType()){T=!0;break}T||p.addManifestUpdateRepresentationInfo(a,_.getType())}(function(){for(var e=0,t=f.length;e<t;e++){var n=f[e].segmentInfoType;if(null===f[e].segmentAvailabilityRange||!c.default.hasInitialization(f[e])||(n===i.default.SEGMENT_BASE||n===i.default.BASE_URL)&&!f[e].segments)return!1}return!0})()&&(u=!1,E.setPlaybackQuality(_.getType(),_.getStreamInfo(),(t=g,f.indexOf(t))),p.updateManifestUpdateInfo({latency:g.segmentAvailabilityRange.end-A.getTime()}),p.getCurrentRepresentationSwitch(I().adaptation.type)||S(),n.trigger(s.default.DATA_UPDATE_COMPLETED,{sender:this,data:o,currentRepresentation:g}))}}function h(e){e.isDynamic&&function(e){var t=void 0;m();for(var n=0,r=f.length;n<r;n++)(t=f[n]).segmentAvailabilityRange=D.calcSegmentAvailabilityRange(t,e)}(e.isDynamic)}function L(e){e.sender.getStreamProcessor()===_&&(v.getValue().doNotUpdateDVRWindowOnBufferUpdated||U())}function F(e){e.mediaType===_.getType()&&_.getStreamInfo().id===e.streamInfo.id&&(g=C(e.newQuality),S())}function N(e){if(e.newDuration){var t=I();if(t&&t.adaptation.period)t.adaptation.period.duration=e.newDuration}}return a={initialize:function(){T=_.getIndexHandler()},setConfig:function(e){e.abrController&&(E=e.abrController),e.dashMetrics&&(p=e.dashMetrics),e.playbackController&&(A=e.playbackController),e.timelineConverter&&(D=e.timelineConverter),e.manifestModel&&(v=e.manifestModel),e.streamProcessor&&(_=e.streamProcessor)},getData:function(){return o},isUpdating:R,updateData:function(e,r,a){m();var i=_.getStreamInfo(),d=E.getTopQualityIndexFor(a,i?i.id:null),l=E.getMinAllowedIndexFor(a),c=void 0,A=null;if(u=!0,n.trigger(s.default.DATA_UPDATE_STARTED,{sender:this}),f=r,null!==o&&o.id==e.id||a===t.default.FRAGMENTED_TEXT?c=E.getQualityFor(a):(A=E.getThroughputHistory().getAverageThroughput(a)||E.getInitialBitrateFor(a,i),c=E.getQualityForBitrate(_.getMediaInfo(),A)),void 0!==l&&c<l&&(c=l),c>d&&(c=d),g=C(c),o=e,a!==t.default.VIDEO&&a!==t.default.AUDIO&&a!==t.default.FRAGMENTED_TEXT)return u=!1,void n.trigger(s.default.DATA_UPDATE_COMPLETED,{sender:this,data:o,currentRepresentation:g});for(var D=0;D<f.length;D++)T.updateRepresentation(f[D],!0)},getStreamProcessor:function(){return _},getCurrentRepresentation:I,getRepresentationForQuality:C,reset:function(){n.off(s.default.QUALITY_CHANGE_REQUESTED,F,a),n.off(s.default.REPRESENTATION_UPDATED,M,a),n.off(s.default.WALLCLOCK_TIME_UPDATED,h,a),n.off(s.default.BUFFER_LEVEL_UPDATED,L,a),n.off(s.default.MANIFEST_VALIDITY_CHANGED,N,a),y()}},y(),n.on(s.default.QUALITY_CHANGE_REQUESTED,F,a),n.on(s.default.REPRESENTATION_UPDATED,M,a),n.on(s.default.WALLCLOCK_TIME_UPDATED,h,a),n.on(s.default.BUFFER_LEVEL_UPDATED,L,a),n.on(s.default.MANIFEST_VALIDITY_CHANGED,N,a),a}D.__dashjs_factory_name="RepresentationController",exports.default=E.default.getClassFactory(D);
},{"../../streaming/constants/Constants":"jJgo","../../core/errors/Errors":"Wrqa","../constants/DashConstants":"wYnc","../../streaming/vo/DashJSError":"gyaG","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../vo/Representation":"rH33"}],"ogFR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../core/FactoryMaker"),r=e(t);function e(t){return t&&t.__esModule?t:{default:t}}function n(){var t=void 0,r=/^[a-z][a-z0-9+\-.]*:/i,e=/^https?:\/\//i,n=/^https:\/\//i,i=/^([a-z][a-z0-9+\-.]*:\/\/[^\/]+)\/?/i,u=function(t,r){try{return new window.URL(t,r).toString()}catch(e){return t}},a=function(t,r){var e=c;if(!r)return t;if(!f(t))return t;l(t)&&(e=o),d(t)&&(e=s);var n=e(r),i="/"!==n.charAt(n.length-1)&&"/"!==t.charAt(0)?"/":"";return[n,t].join(i)};function c(t){var r=t.indexOf("/"),e=t.lastIndexOf("/");return-1!==r?e===r+1?t:(-1!==t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),t.substring(0,e+1)):""}function o(t){var r=t.match(i);return r?r[1]:""}function s(t){var e=t.match(r);return e?e[0]:""}function f(t){return!r.test(t)}function l(t){return f(t)&&"/"===t.charAt(0)}function d(t){return 0===t.indexOf("//")}return function(){try{new window.URL("x","http://y"),t=u}catch(r){}finally{t=t||a}}(),{parseBaseUrl:c,parseOrigin:o,parseScheme:s,isRelative:f,isPathAbsolute:l,isSchemeRelative:d,isHTTPURL:function(t){return e.test(t)},isHTTPS:function(t){return n.test(t)},resolve:function(r,e){return t(r,e)}}}n.__dashjs_factory_name="URLUtils",exports.default=r.default.getSingletonFactory(n);
},{"../../core/FactoryMaker":"FHM8"}],"vrHZ":[function(require,module,exports) {
"use strict";function t(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function i(){t(this,i),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null};exports.default=i;
},{}],"Z2QK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unescapeDollarsInTemplate=n,exports.replaceIDForTemplate=o,exports.replaceTokenForTemplate=d,exports.getIndexBasedSegment=s,exports.getTimeBasedSegment=p;var e=require("./../vo/Segment"),t=i(e);function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(;e.length<t;)e="0"+e;return e}function r(e,t){return e.representation.startNumber+t}function n(e){return e?e.split("$$").join("$"):e}function o(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var i=t.toString();return e.split("$RepresentationID$").join(i)}function d(e,t,i){var r=void 0,n=void 0,o=void 0,d=void 0,m=void 0,l=void 0,s=t.length,p="%0".length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((n=e.indexOf("$",r+s))<0)return e;if((o=e.indexOf("%0",r+s))>r&&o<n)switch(d=e.charAt(n-1),m=parseInt(e.substring(o+p,n-1),10),d){case"d":case"i":case"u":l=a(i.toString(),m);break;case"x":l=a(i.toString(16),m);break;case"X":l=a(i.toString(16),m).toUpperCase();break;case"o":l=a(i.toString(8),m);break;default:return e}else l=i;e=e.substring(0,r)+l+e.substring(n+1)}}function m(e,i,a,n,o,d,m,l,s){var p=new t.default;return p.representation=e,p.duration=i,p.presentationStartTime=a,p.mediaStartTime=n,p.availabilityStartTime=o,p.availabilityEndTime=d.calcAvailabilityEndTimeFromPresentationTime(m,e.adaptation.period.mpd,l),p.wallStartTime=d.calcWallTimeForSegment(p,l),p.replacementNumber=r(p,s),p.availabilityIdx=s,p}function l(e,t,i,a){var r=e.getPeriodEnd(t,a),n=e.calcPeriodRelativeTimeFromMpdRelativeTime(t,r);return!(e.calcPeriodRelativeTimeFromMpdRelativeTime(t,i.presentationStartTime)>=n)}function s(e,t,i,a){var r,n,o=void 0;o=i.segmentDuration,isNaN(o)&&(o=i.adaptation.period.duration),r=parseFloat((i.adaptation.period.start+a*o).toFixed(5)),n=parseFloat((r+o).toFixed(5));var d=m(i,o,r,e.calcMediaTimeFromPresentationTime(r,i),e.calcAvailabilityStartTimeFromPresentationTime(r,i.adaptation.period.mpd,t),e,n,t,a);return l(e,i,d,t)?d:null}function p(e,t,i,a,r,n,o,s,p,u){var c,T,v=a/n,f=Math.min(r/n,i.adaptation.period.mpd.maxSegmentDuration),g=void 0;return T=(c=e.calcPresentationTimeFromMediaTime(v,i))+f,l(e,i,g=m(i,f,c,v,i.adaptation.period.mpd.manifest.loadedTime,e,T,t,p),t)?(g.replacementTime=u||a,o=d(o,"Number",g.replacementNumber),o=d(o,"Time",g.replacementTime),g.media=o,g.mediaRange=s,g):null}
},{"./../vo/Segment":"vrHZ"}],"QOHN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=i(e),a=require("../../streaming/constants/Constants"),n=i(a),r=require("./SegmentsUtils");function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a=(e=e||{}).timelineConverter;function i(){if(!a||!a.hasOwnProperty("calcMediaTimeFromPresentationTime")||!a.hasOwnProperty("calcSegmentAvailabilityRange"))throw new Error(n.default.MISSING_CONFIG_ERROR)}function o(e,n){var r,i,o,d=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=d.SegmentTimeline,m=d.SegmentURL_asArray,l=0,u=0,g=-1,c=void 0,f=void 0,p=void 0,v=void 0,y=void 0,S=void 0;o=e.timescale;var _=!1;for(f=0,i=(r=s.S_asArray).length;f<i&&!_;f++){if(v=0,(c=r[f]).hasOwnProperty("r")&&(v=c.r),c.hasOwnProperty("t")&&(u=(l=c.t)/o),v<0){if((S=r[f+1])&&S.hasOwnProperty("t"))y=S.t/o;else{var A=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:a.calcSegmentAvailabilityRange(e,t).end;y=a.calcMediaTimeFromPresentationTime(A,e),e.segmentDuration=c.d/o}v=Math.ceil((y-u)/(c.d/o))-1}for(p=0;p<=v&&!_;p++)(_=n(l,u,d,m,c,o,++g,f))&&(e.segmentDuration=c.d/o,(p<v-1||f<i-1)&&g++),u=(l+=c.d)/o}e.availableSegmentsNumber=g}return{getSegmentByIndex:function(e,n,d){if(i(),!e)throw new Error("no representation");var s=null,m=!1;return o(e,function(n,i,o,l,u,g,c,f){if(m||d<0){var p=o.media,v=u.mediaRange;return l&&(p=l[f].media||"",v=l[f].mediaRange),s=(0,r.getTimeBasedSegment)(a,t,e,n,u.d,g,p,v,c,u.tManifest),!0}return i>=d-.5&&(m=!0),!1}),s},getSegmentByTime:function(e,n){if(i(),!e)throw new Error("no representation");void 0===n&&(n=null);var d=null,s=a.calcMediaTimeFromPresentationTime(n,e);return o(e,function(n,i,o,m,l,u,g,c){if(i>=s-l.d/u*1.5){var f=o.media,p=l.mediaRange;return m&&(f=m[c].media||"",p=m[c].mediaRange),d=(0,r.getTimeBasedSegment)(a,t,e,n,l.d,u,f,p,g,l.tManifest),!0}return!1}),d}}}o.__dashjs_factory_name="TimelineSegmentsGetter";var d=t.default.getClassFactory(o);exports.default=d;
},{"../../core/FactoryMaker":"FHM8","../../streaming/constants/Constants":"jJgo","./SegmentsUtils":"Z2QK"}],"vvoW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=i(e),r=require("../../streaming/constants/Constants"),a=i(r),n=require("./SegmentsUtils");function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r=(e=e||{}).timelineConverter;function i(){if(!r||!r.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(a.default.MISSING_CONFIG_ERROR)}function o(e,a){if(i(),!e)throw new Error("no representation");var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;a=Math.max(a,0);var m=(0,n.getIndexBasedSegment)(r,t,e,a);if(m){m.replacementTime=(a-1)*e.segmentDuration;var s=o.media;s=(0,n.replaceTokenForTemplate)(s,"Number",m.replacementNumber),s=(0,n.replaceTokenForTemplate)(s,"Time",m.replacementTime),m.media=s}var l=e.segmentDuration,d=e.segmentAvailabilityRange;return isNaN(l)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((d.end-d.start)/l),m}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(i(),!e)throw new Error("no representation");var a=e.segmentDuration;if(isNaN(a))return null;var n=r.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(n/a)-1)}}}o.__dashjs_factory_name="TemplateSegmentsGetter";var m=t.default.getClassFactory(o);exports.default=m;
},{"../../core/FactoryMaker":"FHM8","../../streaming/constants/Constants":"jJgo","./SegmentsUtils":"Z2QK"}],"V976":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=i(e),r=require("../../streaming/constants/Constants"),a=i(r),n=require("./SegmentsUtils");function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r=(e=e||{}).timelineConverter;function i(){if(!r||!r.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(a.default.MISSING_CONFIG_ERROR)}function o(e,a){if(i(),!e)throw new Error("no representation");var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=o.SegmentURL_asArray.length,d=e.startNumber,m=null;if(a<s){var u=o.SegmentURL_asArray[a];(m=(0,n.getIndexBasedSegment)(r,t,e,a)).replacementTime=(d+a-1)*e.segmentDuration,m.media=u.media?u.media:"",m.mediaRange=u.mediaRange,m.index=a,m.indexRange=u.indexRange}return e.availableSegmentsNumber=s,m}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(i(),!e)throw new Error("no representation");var a=e.segmentDuration;if(isNaN(a))return null;var n=r.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(n/a))}}}o.__dashjs_factory_name="ListSegmentsGetter";var s=t.default.getClassFactory(o);exports.default=s;
},{"../../core/FactoryMaker":"FHM8","../../streaming/constants/Constants":"jJgo","./SegmentsUtils":"Z2QK"}],"SIRs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=i(e),r=require("../../streaming/constants/Constants"),n=i(r);function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=(e=e||{}).timelineConverter;function r(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(n.default.MISSING_CONFIG_ERROR)}function i(e,t){if(r(),!e)throw new Error("no representation");var n=e.segments?e.segments.length:0,i=void 0;if(t<n&&(i=e.segments[t])&&i.availabilityIdx===t)return i;for(var a=0;a<n;a++)if((i=e.segments[a])&&i.availabilityIdx===t)return i;return null}return{getSegmentByIndex:i,getSegmentByTime:function(e,n){if(r(),!e)throw new Error("no representation");return i(e,function(e,t){var r=e.segments,n=r?r.length:null,i=-1,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0;if(r&&n>0)for(u=0;u<n;u++)if(o=r[u],s=o.presentationStartTime,l=o.duration,t+(a=l/2)>=s&&t-a<s+l){i=o.availabilityIdx;break}return i}(e,t.calcPeriodRelativeTimeFromMpdRelativeTime(e,n)))}}}a.__dashjs_factory_name="SegmentBaseGetter";var o=t.default.getClassFactory(a);exports.default=o;
},{"../../core/FactoryMaker":"FHM8","../../streaming/constants/Constants":"jJgo"}],"NKNS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function u(){return{modifyRequestURL:function(e){return e},modifyRequestHeader:function(e){return e}}}u.__dashjs_factory_name="RequestModifier",exports.default=t.default.getSingletonFactory(u);
},{"../../core/FactoryMaker":"FHM8"}],"pe2U":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),r=o(e);function o(e){return e&&e.__esModule?e:{default:e}}function t(e){var r=(e=e||{}).requestModifier;return{load:function(e){var o=new Date,t=e.request,n=new XMLHttpRequest;n.open(e.method,e.url,!0),t.responseType&&(n.responseType=t.responseType),t.range&&n.setRequestHeader("Range","bytes="+t.range),t.requestStartDate||(t.requestStartDate=o),r&&(n=r.modifyRequestHeader(n)),n.withCredentials=e.withCredentials,n.onload=e.onload,n.onloadend=e.onend,n.onerror=e.onerror,n.onprogress=e.progress,n.onabort=e.onabort,n.send(),e.response=n},abort:function(e){var r=e.response;r.onloadend=r.onerror=r.onprogress=void 0,r.abort()}}}t.__dashjs_factory_name="XHRLoader";var n=r.default.getClassFactory(t);exports.default=n;
},{"../../core/FactoryMaker":"FHM8"}],"kR3V":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}function n(e){var r=(e=e||{}).requestModifier,t=e.boxParser;function n(e,r){e.reader.read().then(r).catch(function(r){e.onerror&&200===e.response.status&&e.onerror(r)})}function o(e,r){if((e=e.filter(function(t){return t.bytes>r/4/e.length})).length>1){var t=0,n=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach(function(r,o){var a=e[o+1];if(a){var s=a.ts-r.ts;t+=s<n?s:0}}),t}return null}return{load:function(e){var a=new Date,s=e.request,l=new Headers;s.range&&l.append("Range","bytes="+s.range),s.requestStartDate||(s.requestStartDate=a),r&&r.modifyRequestHeader({setRequestHeader:function(e,r){l.append(e,r)}});var u=void 0;"function"==typeof window.AbortController&&(u=new AbortController,e.abortController=u);var d={method:e.method,headers:l,credentials:e.withCredentials?"include":void 0,signal:u?u.signal:void 0};fetch(e.url,d).then(function(r){e.response||(e.response={}),e.response.status=r.status,e.response.statusText=r.statusText,e.response.responseURL=r.url,r.ok||e.onerror();var a="",s=!0,l=!1,u=void 0;try{for(var d,i=r.headers.keys()[Symbol.iterator]();!(s=(d=i.next()).done);s=!0){var f=d.value;a+=f+": "+r.headers.get(f)+"\n"}}catch(b){l=!0,u=b}finally{try{!s&&i.return&&i.return()}finally{if(l)throw u}}if(e.response.responseHeaders=a,!r.body)return r.arrayBuffer().then(function(r){e.response.response=r;var t={loaded:r.byteLength,total:r.byteLength,stream:!1};e.progress(t),e.onload(),e.onend()});var c=parseInt(r.headers.get("Content-Length"),10),h=0,p=!1,g=new Uint8Array,v=0;e.reader=r.body.getReader();var y=[];n(e,function r(a){var s=a.value;if(a.done)return g&&(e.progress({loaded:h,total:isNaN(c)?h:c,lengthComputable:!0,time:o(y,h),stream:!0}),e.response.response=g.buffer),e.onload(),void e.onend();if(s&&s.length>0){g=function(e,r){if(0===e.length)return r;var t=new Uint8Array(e.length+r.length);return t.set(e),t.set(r,e.length),t}(g,s),h+=s.length,y.push({ts:Date.now(),bytes:s.length});var l=t.findLastTopIsoBoxCompleted(["moov","mdat"],g,v);if(l.found){var u=l.lastCompletedOffset+l.size,d=void 0;u===g.length?(d=g,g=new Uint8Array):(d=new Uint8Array(g.subarray(0,u)),g=g.subarray(u)),e.progress({data:d.buffer,lengthComputable:!1,noTrace:!0}),v=0}else v=l.lastCompletedOffset,p||(e.progress({lengthComputable:!1,noTrace:!0}),p=!0)}n(e,r)})}).catch(function(r){e.onerror&&e.onerror(r)})},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel()}catch(r){}},calculateDownloadedTime:o}}n.__dashjs_factory_name="FetchLoader";var o=r.default.getClassFactory(n);exports.default=o;
},{"../../core/FactoryMaker":"FHM8"}],"MYRf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./XHRLoader"),t=T(e),r=require("./FetchLoader"),s=T(r),o=require("../vo/metrics/HTTPRequest"),a=require("../../core/FactoryMaker"),n=T(a),u=require("../../core/errors/Errors"),i=T(u),d=require("../vo/DashJSError"),l=T(d);function T(e){return e&&e.__esModule?e:{default:e}}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){e=e||{};var r,a,n=this.context,u=e.errHandler,d=e.dashMetrics,T=e.mediaPlayerModel,p=e.requestModifier,f=e.boxParser,E=e.useFetch||!1,_=void 0,R=void 0,D=void 0,O=void 0;return r={load:function(e){e.request?function e(r,a){var i=r.request,c=[],q=!0,y=!0,N=new Date,m=N,P=0,h=void 0;if(!p||!d||!u)throw new Error("config object is not correct or missing");var g=function(e){y=!1,i.requestStartDate=N,i.requestEndDate=new Date,i.firstByteDate=i.firstByteDate||N,i.checkExistenceOnly||(d.addHttpRequest(i,h.response?h.response.responseURL:null,h.response?h.response.status:null,h.response&&h.response.getAllResponseHeaders?h.response.getAllResponseHeaders():h.response?h.response.responseHeaders:[],e?c:null),i.type===o.HTTPRequest.MPD_TYPE&&d.addManifestUpdate(i.type,i.requestStartDate,i.requestEndDate))},I=function(){if(-1!==_.indexOf(h)&&(_.splice(_.indexOf(h),1),y))if(g(!1),a>0){a--;var t={config:r};D.push(t),t.timeout=setTimeout(function(){-1!==D.indexOf(t)&&(D.splice(D.indexOf(t),1),e(r,a))},T.getRetryIntervalsForType(i.type))}else u.error(new l.default(O[i.type],i.url+" is not available",{request:i,response:h.response})),r.error&&r.error(i,"error",h.response.statusText),r.complete&&r.complete(i,h.response.statusText)},b=void 0;b=E&&window.fetch&&"arraybuffer"===i.responseType&&i.type===o.HTTPRequest.MEDIA_SEGMENT_TYPE?(0,s.default)(n).create({requestModifier:p,boxParser:f}):(0,t.default)(n).create({requestModifier:p});var v=p.modifyRequestURL(i.url),H=i.checkExistenceOnly?o.HTTPRequest.HEAD:o.HTTPRequest.GET,L=T.getXHRWithCredentialsForType(i.type);h={url:v,method:H,withCredentials:L,request:i,onload:function(){h.response.status>=200&&h.response.status<=299&&(g(!0),r.success&&r.success(h.response.response,h.response.statusText,h.response.responseURL),r.complete&&r.complete(i,h.response.statusText))},onend:I,onerror:I,progress:function(e){var t=new Date;q&&(q=!1,(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(i.firstByteDate=t)),e.lengthComputable&&(i.bytesLoaded=e.loaded,i.bytesTotal=e.total),e.noTrace||(c.push({s:m,d:e.time?e.time:t.getTime()-m.getTime(),b:[e.loaded?e.loaded-P:0]}),m=t,P=e.loaded),r.progress&&e&&r.progress(e)},onabort:function(){r.abort&&r.abort(i)},loader:b};var M=(new Date).getTime();if(isNaN(i.delayLoadingTime)||M>=i.delayLoadingTime)_.push(h),b.load(h);else{var A={httpRequest:h};R.push(A),A.delayTimeout=setTimeout(function(){if(-1!==R.indexOf(A)){R.splice(R.indexOf(A),1);try{N=new Date,m=N,_.push(A.httpRequest),b.load(A.httpRequest)}catch(e){A.httpRequest.onerror()}}},i.delayLoadingTime-M)}}(e,T.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){D.forEach(function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)}),D=[],R.forEach(function(e){return clearTimeout(e.delayTimeout)}),R=[],_.forEach(function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e),e.onabort()}),_=[]}},_=[],R=[],D=[],c(a={},o.HTTPRequest.MPD_TYPE,i.default.DOWNLOAD_ERROR_ID_MANIFEST_CODE),c(a,o.HTTPRequest.XLINK_EXPANSION_TYPE,i.default.DOWNLOAD_ERROR_ID_XLINK_CODE),c(a,o.HTTPRequest.INIT_SEGMENT_TYPE,i.default.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),c(a,o.HTTPRequest.MEDIA_SEGMENT_TYPE,i.default.DOWNLOAD_ERROR_ID_CONTENT_CODE),c(a,o.HTTPRequest.INDEX_SEGMENT_TYPE,i.default.DOWNLOAD_ERROR_ID_CONTENT_CODE),c(a,o.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,i.default.DOWNLOAD_ERROR_ID_CONTENT_CODE),c(a,o.HTTPRequest.OTHER_TYPE,i.default.DOWNLOAD_ERROR_ID_CONTENT_CODE),O=a,r}p.__dashjs_factory_name="HTTPLoader";var f=n.default.getClassFactory(p);exports.default=f;
},{"./XHRLoader":"pe2U","./FetchLoader":"kR3V","../vo/metrics/HTTPRequest":"yMBz","../../core/FactoryMaker":"FHM8","../../core/errors/Errors":"Wrqa","../vo/DashJSError":"gyaG"}],"dFRw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../streaming/utils/RequestModifier"),r=I(e),t=require("./vo/Segment"),n=I(t),a=require("../streaming/vo/DashJSError"),i=I(a),o=require("../core/events/Events"),s=I(o),d=require("../core/EventBus"),l=I(d),u=require("../streaming/utils/BoxParser"),g=I(u),f=require("../core/FactoryMaker"),c=I(f),v=require("../core/Debug"),m=I(v),p=require("../streaming/vo/metrics/HTTPRequest"),E=require("../streaming/vo/FragmentRequest"),T=I(E),_=require("../streaming/net/HTTPLoader"),y=I(_),L=require("../core/errors/Errors"),b=I(L);function I(e){return e&&e.__esModule?e:{default:e}}function S(){var e=this.context,t=(0,l.default)(e).getInstance(),a=void 0,o=void 0,d=void 0,u=void 0,f=void 0,c=void 0,v=void 0,E=void 0,_=void 0;function L(){if(!_||!_.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function I(e){if(e.url){var r=new T.default;return r.type=e.init?p.HTTPRequest.INIT_SEGMENT_TYPE:p.HTTPRequest.MEDIA_SEGMENT_TYPE,r.url=e.url,r.range=e.range.start+"-"+e.range.end,r.mediaType=e.mediaType,r}}function S(e,r,n){e?t.trigger(s.default.SEGMENTS_LOADED,{segments:e,representation:r,mediaType:n}):t.trigger(s.default.SEGMENTS_LOADED,{segments:null,representation:r,mediaType:n,error:new i.default(b.default.SEGMENT_BASE_LOADER_ERROR_CODE,b.default.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}return a={setConfig:function(e){e.baseURLController&&(_=e.baseURLController),e.dashMetrics&&(c=e.dashMetrics),e.mediaPlayerModel&&(v=e.mediaPlayerModel),e.errHandler&&(d=e.errHandler)},initialize:function(){u=(0,g.default)(e).getInstance(),f=(0,r.default)(e).getInstance(),E=(0,y.default)(e).create({errHandler:d,dashMetrics:c,mediaPlayerModel:v,requestModifier:f})},loadInitialization:function e(r,n){L();var a=null,i=r?_.resolve(r.path):null,d=n||{init:!0,url:i?i.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:r&&r.adaptation?r.adaptation.type:null};o.debug("Start searching for initialization.");var l=I(d);E.load({request:l,success:function(n){d.bytesLoaded=d.range.end,(a=u.findInitRange(n))?(r.range=a,t.trigger(s.default.INITIALIZATION_LOADED,{representation:r})):(d.range.end=d.bytesLoaded+d.bytesToLoad,e(r,d))},error:function(){t.trigger(s.default.INITIALIZATION_LOADED,{representation:r})}}),o.debug("Perform init search: "+d.url)},loadSegments:function e(r,t,a,i,s){if(L(),a&&(void 0===a.start||void 0===a.end)){var d=a?a.toString().split("-"):null;a=d?{start:parseFloat(d[0]),end:parseFloat(d[1])}:null}s=s||S;var l=null,g=null,f=!!a,c=r?_.resolve(r.path):null,v={init:!1,url:c?c.url:void 0,range:f?a:{start:0,end:1500},searching:!f,bytesLoaded:i?i.bytesLoaded:0,bytesToLoad:1500,mediaType:r&&r.adaptation?r.adaptation.type:null},m=I(v);E.load({request:m,success:function(a){var i=v.bytesToLoad,d=a.byteLength;if(v.bytesLoaded=v.range.end-v.range.start,l=u.parse(a),(g=l.getBox("sidx"))&&g.isComplete){var f=g.references,c=void 0,m=void 0;if(null!=f&&f.length>0&&(c=1===f[0].reference_type),c){o.debug("Initiate multiple SIDX load."),v.range.end=v.range.start+g.size;var p=void 0,E=void 0,T=void 0,_=void 0,y=[],L=0,b=(g.offset||v.range.start)+g.size,I=function(e){e?(y=y.concat(e),++L>=E&&s(y,r,t)):s(null,r,t)};for(p=0,E=f.length;p<E;p++)T=b,_=b+f[p].referenced_size-1,b+=f[p].referenced_size,e(r,null,{start:T,end:_},v,I)}else o.debug("Parsing segments from SIDX."),m=function(e,r){for(var t=e.references,a=t.length,i=e.timescale,o=e.earliest_presentation_time,s=r.range.start+e.offset+e.first_offset+e.size,d=[],l=void 0,u=void 0,g=void 0,f=void 0,c=0;c<a;c++)g=t[c].subsegment_duration,f=t[c].referenced_size,(l=new n.default).duration=g,l.startTime=o,l.timescale=i,u=s+f-1,l.mediaRange=s+"-"+u,d.push(l),o+=g,s+=f;return d}(g,v),s(m,r,t)}else{if(g)v.range.start=g.offset||v.range.start,v.range.end=v.range.start+(g.size||i);else{if(d<v.bytesLoaded)return void s(null,r,t);var S=l.getLastBox();S&&S.size?(v.range.start=S.offset+S.size,v.range.end=v.range.start+i):v.range.end+=i}e(r,t,v.range,v,s)}},error:function(){s(null,r,t)}}),o.debug("Perform SIDX load: "+v.url)},reset:function(){E.abort(),E=null,d=null,u=null,f=null}},o=(0,m.default)(e).getInstance().getLogger(a),a}S.__dashjs_factory_name="SegmentBaseLoader",exports.default=c.default.getSingletonFactory(S);
},{"../streaming/utils/RequestModifier":"NKNS","./vo/Segment":"vrHZ","../streaming/vo/DashJSError":"gyaG","../core/events/Events":"W3G1","../core/EventBus":"Opee","../streaming/utils/BoxParser":"Yc5r","../core/FactoryMaker":"FHM8","../core/Debug":"iL1O","../streaming/vo/metrics/HTTPRequest":"yMBz","../streaming/vo/FragmentRequest":"Vb3t","../streaming/net/HTTPLoader":"MYRf","../core/errors/Errors":"Wrqa"}],"DaRx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../core/FactoryMaker"),e=r(t);function r(t){return t&&t.__esModule?t:{default:t}}function n(t){t=t||{};var e=void 0,r=new DataView(t.data),n=0;function a(t,e){var a=!0,o=0;if(void 0===e&&(e=!1),t.tag>16777215?(r.getUint32(n)!==t.tag&&(a=!1),o=4):t.tag>65535?(256*r.getUint16(n)+r.getUint8(n+2)!==t.tag&&(a=!1),o=3):t.tag>255?(r.getUint16(n)!==t.tag&&(a=!1),o=2):(r.getUint8(n)!==t.tag&&(a=!1),o=1),!a&&t.required&&!e)throw new Error("required tag not found");return a&&(n+=o),a}function o(t){var e=1,a=128,o=-1,i=0,u=r.getUint8(n),g=0;for(g=0;g<8;g+=1){if((u&a)===a){i=void 0===t?u&~a:u,o=g;break}a>>=1}for(g=0;g<o;g+=1,e+=1)i=i<<8|255&r.getUint8(n+e);return n+=e,i}return e={getPos:function(){return n},setPos:function(t){n=t},consumeTag:a,consumeTagAndSize:function(t,e){var r=a(t,e);return r&&o(),r},parseTag:function(t){var r;return a(t),r=o(),e[t.parse](r)},skipOverElement:function(t,e){var r=a(t,e),i=void 0;return r&&(i=o(),n+=i),r},getMatroskaCodedNum:o,getMatroskaFloat:function(t){var e=void 0;switch(t){case 4:e=r.getFloat32(n),n+=4;break;case 8:e=r.getFloat64(n),n+=8}return e},getMatroskaUint:function(t){for(var e=0,a=0;a<t;a+=1)e<<=8,e|=255&r.getUint8(n+a);return n+=t,e},moreData:function(){return n<r.byteLength}}}n.__dashjs_factory_name="EBMLParser",exports.default=e.default.getClassFactory(n);
},{"../../core/FactoryMaker":"FHM8"}],"jYPY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../core/events/Events"),r=h(e),t=require("../core/EventBus"),a=h(t),n=require("../streaming/utils/EBMLParser"),o=h(n),i=require("../streaming/constants/Constants"),u=h(i),s=require("../core/FactoryMaker"),l=h(s),d=require("../core/Debug"),g=h(d),c=require("../streaming/utils/RequestModifier"),f=h(c),m=require("./vo/Segment"),T=h(m),v=require("../streaming/vo/metrics/HTTPRequest"),C=require("../streaming/vo/FragmentRequest"),E=h(C),S=require("../streaming/net/HTTPLoader"),p=h(S),q=require("../streaming/vo/DashJSError"),P=h(q),k=require("../core/errors/Errors"),M=h(k);function h(e){return e&&e.__esModule?e:{default:e}}function _(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,i=void 0,s=void 0,l=void 0,d=void 0,c=void 0,m=void 0,C=void 0,S=void 0;function q(r,t,a,n){var u,l,d=void 0,g=void 0,c=void 0,f=void 0,m=void 0,v=void 0;for(g=[],f=0,l=(u=function(r){var t=[],a=(0,o.default)(e).create({data:r}),n=void 0,i=void 0;for(a.consumeTagAndSize(s.Segment.Cues);a.moreData()&&a.consumeTagAndSize(s.Segment.Cues.CuePoint,!0);){for((n={}).CueTime=a.parseTag(s.Segment.Cues.CuePoint.CueTime),n.CueTracks=[];a.moreData()&&a.consumeTag(s.Segment.Cues.CuePoint.CueTrackPositions,!0);){var u=a.getMatroskaCodedNum(),l=a.getPos();if((i={}).Track=a.parseTag(s.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===i.Track)throw new Error("Cue track cannot be 0");i.ClusterPosition=a.parseTag(s.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),n.CueTracks.push(i),a.setPos(l+u)}if(0===n.CueTracks.length)throw new Error("Mandatory cuetrack not found");t.push(n)}if(0===t.length)throw new Error("mandatory cuepoint not found");return t}(r)).length;f<l;f+=1)c=new T.default,d=0,d=f<u.length-1?u[f+1].CueTime-u[f].CueTime:n-u[f].CueTime,c.duration=d,c.startTime=u[f].CueTime,c.timescale=1e3,m=u[f].CueTracks[0].ClusterPosition+t,v=f<u.length-1?u[f+1].CueTracks[0].ClusterPosition+t-1:a-1,c.mediaRange=m+"-"+v,g.push(c);return i.debug("Parsed cues: "+g.length+" cues."),g}function k(){if(!S||!S.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function h(e,a,n){e?t.trigger(r.default.SEGMENTS_LOADED,{segments:e,representation:a,mediaType:n}):t.trigger(r.default.SEGMENTS_LOADED,{segments:null,representation:a,mediaType:n,error:new P.default(M.default.SEGMENT_BASE_LOADER_ERROR_CODE,M.default.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function _(e){var r=new E.default;return r.type=e.init?v.HTTPRequest.INIT_SEGMENT_TYPE:v.HTTPRequest.MEDIA_SEGMENT_TYPE,r.url=e.url,r.range=e.range.start+"-"+e.range.end,r}return n={setConfig:function(e){if(!(e.baseURLController&&e.dashMetrics&&e.mediaPlayerModel&&e.errHandler))throw new Error(u.default.MISSING_CONFIG_ERROR);S=e.baseURLController,c=e.dashMetrics,m=e.mediaPlayerModel,l=e.errHandler},initialize:function(){d=(0,f.default)(e).getInstance(),C=(0,p.default)(e).create({errHandler:l,dashMetrics:c,mediaPlayerModel:m,requestModifier:d})},loadInitialization:function(e,a){k();var n=null,o=e?S.resolve(e.path):null,u=o?o.url:void 0,s=e?e.range.split("-"):null,l=a||{range:{start:s?parseFloat(s[0]):null,end:s?parseFloat(s[1]):null},request:n,url:u,init:!0};i.info("Start loading initialization."),n=_(l),C.load({request:n,success:function(){t.trigger(r.default.INITIALIZATION_LOADED,{representation:e})},error:function(){t.trigger(r.default.INITIALIZATION_LOADED,{representation:e})}}),i.debug("Perform init load: "+l.url)},loadSegments:function(r,t,a,n){k();var u=null,l=r?S.resolve(r.path):null,d=l?l.url:void 0;n=n||h,u=_({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:u,url:d,init:!1}),i.debug("Parsing ebml header"),C.load({request:u,success:function(u){!function(r,t,a,n){if(r&&0!==r.byteLength){var u,l=(0,o.default)(e).create({data:r}),d=void 0,g=void 0,c=void 0,f=a?a.split("-"):null,m=null,T={url:t,range:{start:f?parseFloat(f[0]):null,end:f?parseFloat(f[1]):null},request:m};for(i.debug("Parse EBML header: "+T.url),l.skipOverElement(s.EBML),l.consumeTag(s.Segment),c=l.getMatroskaCodedNum(),c+=l.getPos(),u=l.getPos();l.moreData()&&!l.consumeTagAndSize(s.Segment.Info,!0);)if(!(l.skipOverElement(s.Segment.SeekHead,!0)||l.skipOverElement(s.Segment.Tracks,!0)||l.skipOverElement(s.Segment.Cues,!0)||l.skipOverElement(s.Void,!0)))throw new Error("no valid top level element found");for(;void 0===d;){var v=l.getMatroskaCodedNum(!0),E=l.getMatroskaCodedNum();switch(v){case s.Segment.Info.Duration.tag:d=l[s.Segment.Info.Duration.parse](E);break;default:l.setPos(l.getPos()+E)}}m=_(T),C.load({request:m,success:function(e){g=q(e,u,c,d),n(g)},error:function(){i.error("Download Error: Cues "+T.url),n(null)}}),i.debug("Perform cues load: "+T.url+" bytes="+T.range.start+"-"+T.range.end)}else n(null)}(u,d,a,function(e){n(e,r,t)})},error:function(){n(null,r,t)}})},reset:function(){l=null,d=null}},i=(0,g.default)(e).getInstance().getLogger(n),s={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},n}_.__dashjs_factory_name="WebmSegmentBaseLoader",exports.default=l.default.getSingletonFactory(_);
},{"../core/events/Events":"W3G1","../core/EventBus":"Opee","../streaming/utils/EBMLParser":"DaRx","../streaming/constants/Constants":"jJgo","../core/FactoryMaker":"FHM8","../core/Debug":"iL1O","../streaming/utils/RequestModifier":"NKNS","./vo/Segment":"vrHZ","../streaming/vo/metrics/HTTPRequest":"yMBz","../streaming/vo/FragmentRequest":"Vb3t","../streaming/net/HTTPLoader":"MYRf","../streaming/vo/DashJSError":"gyaG","../core/errors/Errors":"Wrqa"}],"vS2Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/DashConstants"),t=E(e),r=require("../../core/FactoryMaker"),n=E(r),a=require("../utils/TimelineSegmentsGetter"),i=E(a),u=require("../utils/TemplateSegmentsGetter"),l=E(u),s=require("../utils/ListSegmentsGetter"),o=E(s),d=require("../utils/SegmentBaseGetter"),f=E(d),c=require("../SegmentBaseLoader"),m=E(c),g=require("../WebmSegmentBaseLoader"),S=E(g);function E(e){return e&&e.__esModule?e:{default:e}}function T(e){e=e||{};var r,n,a=this.context,u=e.dashMetrics,s=e.mediaPlayerModel,d=e.errHandler,c=e.baseURLController,g=void 0,E=void 0;function T(e){return e.segments?g[t.default.SEGMENT_BASE]:g[e.segmentInfoType]}return r={initialize:function(r){E.initialize(),g[t.default.SEGMENT_TIMELINE]=(0,i.default)(a).create(e,r),g[t.default.SEGMENT_TEMPLATE]=(0,l.default)(a).create(e,r),g[t.default.SEGMENT_LIST]=(0,o.default)(a).create(e,r),g[t.default.SEGMENT_BASE]=(0,f.default)(a).create(e,r)},update:function(e,t,r,n){r||function(e){E.loadInitialization(e)}(e),n||function(e,t){E.loadSegments(e,t,e.indexRange)}(e,t)},getSegmentByIndex:function(e,t,r){var n=T(e);return n?n.getSegmentByIndex(e,t,r):null},getSegmentByTime:function(e,t){var r=T(e);return r?r.getSegmentByTime(e,t):null}},g={},n=e.mimeType,(E="webm"===(n?n.split("/")[1]:"").toLowerCase()?(0,S.default)(a).getInstance():(0,m.default)(a).getInstance()).setConfig({baseURLController:c,dashMetrics:u,mediaPlayerModel:s,errHandler:d}),r}T.__dashjs_factory_name="SegmentsController";var M=n.default.getClassFactory(T);exports.default=M;
},{"../constants/DashConstants":"wYnc","../../core/FactoryMaker":"FHM8","../utils/TimelineSegmentsGetter":"QOHN","../utils/TemplateSegmentsGetter":"vvoW","../utils/ListSegmentsGetter":"V976","../utils/SegmentBaseGetter":"SIRs","../SegmentBaseLoader":"dFRw","../WebmSegmentBaseLoader":"jYPY"}],"JELT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./constants/DashConstants"),t=b(e),i=require("../streaming/vo/FragmentRequest"),a=b(i),n=require("../streaming/vo/DashJSError"),r=b(n),o=require("../streaming/vo/metrics/HTTPRequest"),l=require("../core/events/Events"),d=b(l),u=require("../core/EventBus"),s=b(u),m=require("../core/errors/Errors"),g=b(m),f=require("../core/FactoryMaker"),T=b(f),p=require("../core/Debug"),v=b(p),c=require("../streaming/utils/URLUtils"),E=b(c),I=require("./vo/Representation"),S=b(I),y=require("./utils/SegmentsUtils"),A=require("./controllers/SegmentsController"),R=b(A);function b(e){return e&&e.__esModule?e:{default:e}}function _(e){e=e||{};var i=this.context,n=(0,s.default)(i).getInstance(),l=(0,E.default)(i).getInstance(),u=e.timelineConverter,m=e.dashMetrics,f=e.baseURLController,T=void 0,p=void 0,c=void 0,I=void 0,A=void 0,b=void 0,_=void 0,N=void 0;function x(){return _?_.getType():null}function h(){var e=_?_.getStreamInfo():null;return e?e.manifestInfo.isDynamic:null}function D(){return _?_.getMediaInfo():null}function q(){c=-1,I=null}function L(){q(),b=0,A=null,_=null,N=null}function P(e,t,i){var a=f.resolve(i.path),n=void 0,r=void 0;return a&&t!==a.url&&l.isRelative(t)?(n=a.url,r=a.serviceLocation,t&&(n=l.resolve(t,n))):n=t,!l.isRelative(n)&&(e.url=n,e.serviceLocation=r,!0)}function M(e){u.setExpectedLiveEdge(e),m.updateManifestUpdateInfo({presentationStartTime:e})}function O(e){if(null==e)return null;var t=new a.default,i=e.representation,n=i.adaptation.period.mpd.manifest.Period_asArray[i.adaptation.period.index].AdaptationSet_asArray[i.adaptation.index].Representation_asArray[i.index].bandwidth,r=e.media;return r=(0,y.replaceTokenForTemplate)(r,"Number",e.replacementNumber),r=(0,y.replaceTokenForTemplate)(r,"Time",e.replacementTime),r=(0,y.replaceTokenForTemplate)(r,"Bandwidth",n),r=(0,y.replaceIDForTemplate)(r,i.id),r=(0,y.unescapeDollarsInTemplate)(r),t.mediaType=x(),t.type=o.HTTPRequest.MEDIA_SEGMENT_TYPE,t.range=e.mediaRange,t.startTime=e.presentationStartTime,t.duration=e.duration,t.timescale=i.timescale,t.availabilityStartTime=e.availabilityStartTime,t.availabilityEndTime=e.availabilityEndTime,t.wallStartTime=e.wallStartTime,t.quality=i.index,t.index=e.availabilityIdx,t.mediaInfo=D(),t.adaptationIndex=i.adaptation.index,t.representationId=i.id,P(t,r,i)?t:void 0}function F(e){var t=!1;if(h()){if(I){var i=parseFloat((I.presentationStartTime-e.adaptation.period.start).toFixed(5));t=(I.duration>0?i+1.5*I.duration:i)>=e.adaptation.period.duration}}else c>=e.availableSegmentsNumber&&(t=!0);return t}function C(e){var t=e.representation;t.segments&&n.trigger(d.default.REPRESENTATION_UPDATED,{sender:this,representation:t})}function w(e){if(!e.error&&x()===e.mediaType){var t=e.segments,i=e.representation,a=[],r=0,o=void 0,l=void 0,s=void 0,m=void 0;for(o=0,l=t.length;o<l;o++)s=t[o],(m=(0,y.getTimeBasedSegment)(u,h(),i,s.startTime,s.duration,s.timescale,s.media,s.mediaRange,r))&&(a.push(m),m=null,r++);if(l=a.length,i.segmentAvailabilityRange={start:a[0].presentationStartTime,end:a[l-1].presentationStartTime},i.availableSegmentsNumber=l,i.segments=a,a&&a.length>0)if(h())M(a[a.length-1].presentationStartTime-8);S.default.hasInitialization(i)&&n.trigger(d.default.REPRESENTATION_UPDATED,{sender:this,representation:i})}}return T={initialize:function(e){_=e,N.initialize(h())},getStreamProcessor:function(){return _},getInitRequest:function(e){return e?function(e,t){var i=new a.default,n=e.adaptation.period,r=n.start,l=h();if(i.mediaType=t,i.type=o.HTTPRequest.INIT_SEGMENT_TYPE,i.range=e.range,i.availabilityStartTime=u.calcAvailabilityStartTimeFromPresentationTime(r,n.mpd,l),i.availabilityEndTime=u.calcAvailabilityEndTimeFromPresentationTime(r+n.duration,n.mpd,l),i.quality=e.index,i.mediaInfo=D(),i.representationId=e.id,P(i,e.initialization,e))return i.url=(0,y.replaceTokenForTemplate)(i.url,"Bandwidth",e.bandwidth),i}(e,x()):null},getSegmentRequestForTime:function(e,i,n){var r=void 0;if(!e||!e.segmentInfoType)return null;var o=x(),l=c,d=!!n&&n.keepIdx,u=!(!n||!n.ignoreIsFinished);A!==i&&(A=i,p.debug("Getting the request for "+o+" time : "+i));var s=N.getSegmentByTime(e,i);return s?(c=s.availabilityIdx,I=s,p.debug("Index for "+o+" time "+i+" is "+c),r=O(s)):!u&&F(e)&&((r=new a.default).action=a.default.ACTION_COMPLETE,r.index=c-1,r.mediaType=o,r.mediaInfo=D(),p.debug("Signal complete in getSegmentRequestForTime -",o)),d&&l>=0&&(c=e.segmentInfoType===t.default.SEGMENT_TIMELINE&&h()?c:l),r},getNextSegmentRequest:function(e){var t=void 0;if(!e||!e.segmentInfoType)return null;var i=I?I.mediaStartTime:-1,n=x();A=null;var r=c+1;p.debug("Getting the next request at index: "+r+", type: "+n);var o=N.getSegmentByIndex(e,r,i);return o||function(e){return!h()||h()&&isFinite(e.adaptation.period.duration)}(e)?(o?(t=O(o),c=o.availabilityIdx):c=r,o?(I=o,t=O(o)):F(e)&&((t=new a.default).action=a.default.ACTION_COMPLETE,t.index=c-1,t.mediaType=n,t.mediaInfo=D(),p.debug("Signal complete -",n)),t):(p.debug("No segment found at index: "+r+". Wait for next loop"),null)},updateRepresentation:function(e,t){var i=S.default.hasInitialization(e),a=S.default.hasSegments(e),o=void 0;if(e.segmentAvailabilityRange=u.calcSegmentAvailabilityRange(e,h()),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime)return o=new r.default(g.default.SEGMENTS_UNAVAILABLE_ERROR_CODE,g.default.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE,{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end}),void n.trigger(d.default.REPRESENTATION_UPDATED,{sender:this,representation:e,error:o});h()&&M(e.segmentAvailabilityRange.end),t||q(),N.update(e,x(),i,a),i&&a&&n.trigger(d.default.REPRESENTATION_UPDATED,{sender:this,representation:e})},setCurrentTime:function(e){b=e},getCurrentTime:function(){return b},reset:function(){L(),n.off(d.default.INITIALIZATION_LOADED,C,T),n.off(d.default.SEGMENTS_LOADED,w,T)},resetIndex:q},p=(0,v.default)(i).getInstance().getLogger(T),L(),N=(0,R.default)(i).create(e),n.on(d.default.INITIALIZATION_LOADED,C,T),n.on(d.default.SEGMENTS_LOADED,w,T),T}_.__dashjs_factory_name="DashHandler",exports.default=T.default.getClassFactory(_);
},{"./constants/DashConstants":"wYnc","../streaming/vo/FragmentRequest":"Vb3t","../streaming/vo/DashJSError":"gyaG","../streaming/vo/metrics/HTTPRequest":"yMBz","../core/events/Events":"W3G1","../core/EventBus":"Opee","../core/errors/Errors":"Wrqa","../core/FactoryMaker":"FHM8","../core/Debug":"iL1O","../streaming/utils/URLUtils":"ogFR","./vo/Representation":"rH33","./utils/SegmentsUtils":"Z2QK","./controllers/SegmentsController":"vS2Q"}],"WGTD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./constants/Constants"),t=v(e),r=require("./utils/LiveEdgeFinder"),n=v(r),o=require("./controllers/BufferController"),l=v(o),i=require("./text/TextBufferController"),a=v(i),u=require("./controllers/ScheduleController"),s=v(u),d=require("../dash/controllers/RepresentationController"),f=v(d),c=require("../core/FactoryMaker"),g=v(c),m=require("./utils/SupervisorTools"),C=require("../dash/DashHandler"),p=v(C);function v(e){return e&&e.__esModule?e:{default:e}}function y(e){e=e||{};var r=this.context,o=e.type,i=e.errHandler,u=e.mimeType,d=e.timelineConverter,c=e.adapter,g=e.manifestModel,C=e.mediaPlayerModel,v=e.stream,y=e.abrController,M=e.playbackController,I=e.streamController,h=e.mediaController,x=e.textController,R=e.dashMetrics,T=e.settings,B=void 0,b=void 0,q=void 0,P=void 0,S=void 0,F=void 0,k=void 0,E=void 0,H=void 0,D=void 0;function _(){H=[]}function A(){q=[],b=null,_()}function L(){return v?v.getStreamInfo():null}function z(){return b}return B={initialize:function(n){(D=(0,p.default)(r).create({mimeType:u,timelineConverter:d,dashMetrics:R,mediaPlayerModel:C,baseURLController:e.baseURLController,errHandler:i,settings:T})).initialize(B),y.registerStreamType(o,B),(E=v.getFragmentController().getModel(o)).setStreamProcessor(B),P=function(e){return e===t.default.VIDEO||e===t.default.AUDIO?(0,l.default)(r).create({type:e,dashMetrics:R,mediaPlayerModel:C,manifestModel:g,errHandler:i,streamController:I,mediaController:h,adapter:c,textController:x,abrController:y,playbackController:M,streamProcessor:B,settings:T}):(0,a.default)(r).create({type:e,mimeType:u,dashMetrics:R,mediaPlayerModel:C,manifestModel:g,errHandler:i,streamController:I,mediaController:h,adapter:c,textController:x,abrController:y,playbackController:M,streamProcessor:B,settings:T})}(o),S=(0,s.default)(r).create({type:o,mimeType:u,adapter:c,dashMetrics:R,timelineConverter:d,mediaPlayerModel:C,abrController:y,playbackController:M,streamController:I,textController:x,streamProcessor:B,mediaController:h,settings:T}),(k=(0,f.default)(r).create()).setConfig({abrController:y,dashMetrics:R,manifestModel:g,playbackController:M,timelineConverter:d,streamProcessor:B}),P.initialize(n),S.initialize(),k.initialize()},isUpdating:function(){return!!k&&k.isUpdating()},getType:function(){return o},getBufferController:function(){return P},getFragmentModel:function(){return E},getScheduleController:function(){return S},getLiveEdgeFinder:function(){return F},getFragmentController:function(){return v?v.getFragmentController():null},getRepresentationController:function(){return k},getIndexHandler:function(){return D},getRepresentationInfo:function(e){var t=void 0;return void 0!==e?((0,m.checkInteger)(e),t=k?k.getRepresentationForQuality(e):null):t=k?k.getCurrentRepresentation():null,t?c.convertDataToRepresentationInfo(t):null},getBufferLevel:function(){return P.getBufferLevel()},switchInitData:function(e,t){P&&P.switchInitData(L().id,e,t)},isBufferingCompleted:function(){return!!P&&P.getIsBufferingCompleted()},createBuffer:function(e){return P.getBuffer()||P.createBuffer(b,e)},getStreamInfo:L,selectMediaInfo:function(e){e===b||e&&b&&e.type!==b.type||(b=e);var t=c.getRealAdaptation(L(),b),r=c.getVoRepresentations(b);k&&k.updateData(t,r,o)},addMediaInfo:function(e,t){-1===q.indexOf(e)&&q.push(e),t&&this.selectMediaInfo(e)},switchTrackAsked:function(){S.switchTrackAsked()},getMediaInfoArr:function(){return q},getMediaInfo:z,getMediaSource:function(){return P.getMediaSource()},setMediaSource:function(e){P.setMediaSource(e,z())},dischargePreBuffer:function(){P.dischargePreBuffer()},getBuffer:function(){return P.getBuffer()},setBuffer:function(e){P.setBuffer(e)},registerExternalController:function(e){H.push(e)},unregisterExternalController:function(e){var t=H.indexOf(e);-1!==t&&H.splice(t,1)},getExternalControllers:function(){return H},unregisterAllExternalController:_,addInbandEvents:function(e){v&&v.addInbandEvents(e)},setIndexHandlerTime:function(e){D&&D.setCurrentTime(e)},getIndexHandlerTime:function(){return D?D.getCurrentTime():NaN},resetIndexHandler:function(){D&&D.resetIndex()},getInitRequest:function(e){(0,m.checkInteger)(e);var t=k?k.getRepresentationForQuality(e):null;return D?D.getInitRequest(t):null},getFragmentRequest:function(e,t,r){var n=null,o=k&&e?k.getRepresentationForQuality(e.quality):null;return D&&(n=void 0!==t&&void 0!==r?D.getSegmentRequestForTime(o,t,r):D.getNextSegmentRequest(o)),n},reset:function(e,t){D.reset(),P&&(P.reset(e,t),P=null),S&&(S.reset(),S=null),k&&(k.reset(),k=null),y&&y.unRegisterStreamType(o),H.forEach(function(e){e.reset()}),A(),o=null,v=null,F&&(F.reset(),F=null)}},M&&M.getIsDynamic()&&(F=(0,n.default)(r).create({timelineConverter:d,streamProcessor:B})),A(),B}y.__dashjs_factory_name="StreamProcessor",exports.default=g.default.getClassFactory(y);
},{"./constants/Constants":"jJgo","./utils/LiveEdgeFinder":"lfFL","./controllers/BufferController":"REuJ","./text/TextBufferController":"rvjc","./controllers/ScheduleController":"AMLk","../dash/controllers/RepresentationController":"SDXM","../core/FactoryMaker":"FHM8","./utils/SupervisorTools":"A0aa","../dash/DashHandler":"JELT"}],"lVxT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=v(e),n=require("../../core/Debug"),i=v(n),r=require("../../core/EventBus"),a=v(r),d=require("../../core/events/Events"),o=v(d),l=require("../net/XHRLoader"),u=v(l);function v(e){return e&&e.__esModule?e:{default:e}}function s(){var e="urn:mpeg:dash:event:2012",t=1,n="urn:mpeg:dash:event:callback:2015",r=1,d=this.context,l=(0,a.default)(d).getInstance(),v=void 0,s=void 0,f=void 0,c=void 0,m=void 0,g=void 0,h=void 0,p=void 0,b=void 0,I=void 0,S=void 0;function y(){S=!1,f={},c={},m={},g=null,h=100,p=Date.now()/1e3}function E(){if(!b||!I)throw new Error("setConfig function has to be called previously")}function T(){null!==g&&S&&(clearInterval(g),g=null,S=!1)}function _(e){if(e.eventStream.value==t){var n=e.eventStream.timescale||1,i=e.presentationTime/n,r=void 0;r=4294967295==e.presentationTime?NaN:(e.presentationTime+e.duration)/n,s.info("Manifest validity changed: Valid until: "+i+"; remaining duration: "+r),l.trigger(o.default.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:i,newDuration:r,newManifestValidAfter:NaN})}}function w(){var e=I.getTime(),t=e-p;p=e,C(c,t,e),C(f,t,e),function(){if(m)for(var e=I.getTime(),t=Object.keys(m),n=0;n<t.length;n++){var i=t[n],r=m[i];null!==r&&(r.duration+r.presentationTime)/r.eventStream.timescale<e&&(s.debug("Remove Event "+i+" at time "+e),r=null,delete m[i])}}()}function C(i,a,o){var v,f;if(i)for(var c=Object.keys(i),g=0;g<c.length;g++){var h=c[g],p=i[h];void 0!==p&&(0===(v=p.presentationTime/p.eventStream.timescale)||v<=o&&v+a>o)&&(s.debug("Start Event "+h+" at "+o),p.duration>0&&(m[h]=p),p.eventStream.schemeIdUri==e&&p.eventStream.value==t?0===p.duration&&0===p.presentationTimeDelta||(E(),b.refreshManifest()):p.eventStream.schemeIdUri==n&&p.eventStream.value==r?(f=p.messageData,(0,u.default)(d).create({}).load({method:"get",url:f,request:{responseType:"arraybuffer"}})):l.trigger(p.eventStream.schemeIdUri,{event:p}),delete i[h])}}return v={addInlineEvents:function(e){if(E(),f={},e)for(var t=0;t<e.length;t++){var n=e[t];f[n.id]=n,s.debug("Add inline event with id "+n.id)}s.debug("Added "+e.length+" inline events")},addInbandEvents:function(t){E();for(var n=0;n<t.length;n++){var i=t[n];i.id in c?s.debug("Repeated event with id "+i.id):(i.eventStream.schemeIdUri===e&&void 0===c[i.id]&&_(i),c[i.id]=i,s.debug("Add inband event with id "+i.id))}},stop:T,start:function(){E(),s.debug("Start Event Controller"),S||isNaN(h)||(S=!0,g=setInterval(w,h))},setConfig:function(e){e&&(e.manifestUpdater&&(b=e.manifestUpdater),e.playbackController&&(I=e.playbackController))},reset:function(){T(),y()}},s=(0,i.default)(d).getInstance().getLogger(v),y(),v}s.__dashjs_factory_name="EventController",exports.default=t.default.getClassFactory(s);
},{"../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../net/XHRLoader":"pe2U"}],"NpwA":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null};exports.default=e;
},{}],"d3Cq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./FragmentRequest"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(e){function r(e){n(this,r);var t=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.url=e||null,t.checkForExistenceOnly=!0,t}return u(r,t.default),r}();exports.default=c;
},{"./FragmentRequest":"Vb3t"}],"SJ36":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./net/HTTPLoader"),r=O(e),t=require("./vo/HeadRequest"),a=O(t),u=require("./vo/DashJSError"),n=O(u),s=require("./../core/EventBus"),o=O(s),i=require("../streaming/utils/BoxParser"),d=O(i),l=require("./../core/events/Events"),c=O(l),f=require("./../core/errors/Errors"),E=O(f),_=require("../core/FactoryMaker"),R=O(_);function O(e){return e&&e.__esModule?e:{default:e}}function g(e){e=e||{};var t,u=this.context,s=(0,o.default)(u).getInstance(),i=void 0,l=void 0;return i={checkForExistence:function(e){var r=function(r){s.trigger(c.default.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:r})};if(e){var t=new a.default(e.url);l.load({request:t,success:function(){r(!0)},error:function(){r(!1)}})}else r(!1)},load:function(e){var r=function(r,t){s.trigger(c.default.LOADING_COMPLETED,{request:e,response:r||null,error:t||null,sender:i})};e?l.load({request:e,progress:function(r){s.trigger(c.default.LOADING_PROGRESS,{request:e,stream:r.stream}),r.data&&s.trigger(c.default.LOADING_DATA_PROGRESS,{request:e,response:r.data||null,error:null,sender:i})},success:function(e){r(e)},error:function(e,t,a){r(void 0,new n.default(E.default.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,a,t))},abort:function(e){e&&s.trigger(c.default.LOADING_ABANDONED,{request:e,mediaType:e.mediaType,sender:i})}}):r(void 0,new n.default(E.default.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,E.default.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){l&&l.abort()},reset:function(){l&&(l.abort(),l=null)}},t=(0,d.default)(u).getInstance(),l=(0,r.default)(u).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,boxParser:t,useFetch:e.settings.get().streaming.lowLatencyEnabled}),i}g.__dashjs_factory_name="FragmentLoader",exports.default=R.default.getClassFactory(g);
},{"./net/HTTPLoader":"MYRf","./vo/HeadRequest":"d3Cq","./vo/DashJSError":"gyaG","./../core/EventBus":"Opee","../streaming/utils/BoxParser":"Yc5r","./../core/events/Events":"W3G1","./../core/errors/Errors":"Wrqa","../core/FactoryMaker":"FHM8"}],"iL1U":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=q(e),r=require("../vo/metrics/HTTPRequest"),a=require("../vo/DataChunk"),n=q(a),i=require("../models/FragmentModel"),s=q(i),u=require("../FragmentLoader"),d=q(u),o=require("../utils/RequestModifier"),f=q(o),l=require("../../core/EventBus"),c=q(l),T=require("../../core/events/Events"),E=q(T),_=require("../../core/FactoryMaker"),I=q(_),M=require("../../core/Debug"),m=q(M);function q(e){return e&&e.__esModule?e:{default:e}}function g(e){e=e||{};var a=this.context,i=(0,c.default)(a).getInstance(),u=e.errHandler,o=e.mediaPlayerModel,l=e.dashMetrics,T=void 0,_=void 0,I=void 0;function M(e){return e&&e.type&&e.type===r.HTTPRequest.INIT_SEGMENT_TYPE}function q(){for(var e in I)I[e].reset();I={}}function g(e){if(I[e.request.mediaType]===e.sender){var r=e.request,a=e.response,s=M(r),u=r.mediaInfo.streamInfo;if(e.error&&(e.request.mediaType!==t.default.AUDIO&&e.request.mediaType!==t.default.VIDEO&&e.request.mediaType!==t.default.FRAGMENTED_TEXT||i.trigger(E.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation})),a&&u){var d=function(e,t,r,a){var i=new n.default;return i.streamId=r,i.mediaInfo=t.mediaInfo,i.segmentType=t.type,i.start=t.startTime,i.duration=t.duration,i.end=i.start+i.duration,i.bytes=e,i.index=t.index,i.quality=t.quality,i.representationId=t.representationId,i.endFragment=a,i}(a,r,u.id,e.type!==E.default.FRAGMENT_LOADING_PROGRESS);i.trigger(s?E.default.INIT_FRAGMENT_LOADED:E.default.MEDIA_FRAGMENT_LOADED,{chunk:d,fragmentModel:e.sender})}else _.warn("No "+r.mediaType+" bytes to push or stream is inactive.")}}return T={getModel:function(t){var r=I[t];return r||(r=(0,s.default)(a).create({dashMetrics:l,fragmentLoader:(0,d.default)(a).create({dashMetrics:l,mediaPlayerModel:o,errHandler:u,requestModifier:(0,f.default)(a).getInstance(),settings:e.settings})}),I[t]=r),r},isInitializationRequest:M,reset:function(){i.off(E.default.FRAGMENT_LOADING_COMPLETED,g,this),i.off(E.default.FRAGMENT_LOADING_PROGRESS,g,this),q()}},_=(0,m.default)(a).getInstance().getLogger(T),q(),i.on(E.default.FRAGMENT_LOADING_COMPLETED,g,T),i.on(E.default.FRAGMENT_LOADING_PROGRESS,g,T),T}g.__dashjs_factory_name="FragmentController",exports.default=I.default.getClassFactory(g);
},{"../constants/Constants":"jJgo","../vo/metrics/HTTPRequest":"yMBz","../vo/DataChunk":"NpwA","../models/FragmentModel":"OnkV","../FragmentLoader":"SJ36","../utils/RequestModifier":"NKNS","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O"}],"FUWv":[function(require,module,exports) {
"use strict";function t(t,l){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var l=function l(){t(this,l),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null};exports.default=l;
},{}],"tTzM":[function(require,module,exports) {
"use strict";function t(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function i(){t(this,i),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""};exports.default=i;
},{}],"Sgau":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.THUMBNAILS_SCHEME_ID_URIS=void 0;var e=require("../constants/Constants"),t=v(e),r=require("../../dash/constants/DashConstants"),a=v(r),i=require("../../core/FactoryMaker"),n=v(i),s=require("../vo/ThumbnailTrackInfo"),o=v(s),l=require("../../streaming/utils/URLUtils"),u=v(l),d=require("../../dash/utils/SegmentsUtils"),f=require("../../dash/SegmentBaseLoader"),m=v(f),c=require("../../streaming/utils/BoxParser"),g=v(c),h=require("../../streaming/net/XHRLoader"),p=v(h);function v(e){return e&&e.__esModule?e:{default:e}}var T=exports.THUMBNAILS_SCHEME_ID_URIS=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function I(e){var r,i=this.context,n=e.adapter,s=e.baseURLController,l=e.stream,f=e.timelineConverter,c=e.dashMetrics,h=e.mediaPlayerModel,v=e.errHandler,I=(0,u.default)(i).getInstance(),S=void 0,_=void 0,b=void 0,M=void 0,E=void 0;function y(){R(),b=(0,p.default)(i).create({}),E=(0,g.default)(i).getInstance(),(M=(0,m.default)(i).getInstance()).setConfig({baseURLController:s,dashMetrics:c,mediaPlayerModel:h,errHandler:v}),function(){if(!l||!n)return;var e=l.getStreamInfo();if(!e)return;var r=n.getMediaInfoForType(e,t.default.IMAGE);if(!r)return;var i=n.getVoRepresentations(r);i&&i.length>0&&i.forEach(function(e){e.segmentInfoType===a.default.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media&&L(e),e.segmentInfoType===a.default.SEGMENT_BASE&&L(e,!0)});S.length>0&&(S.sort(function(e,t){return e.bitrate-t.bitrate}),_=S.length-1)}()}function L(e,r){var a=new o.default;a.id=e.id,a.bitrate=e.bandwidth,a.width=e.width,a.height=e.height,a.tilesHor=1,a.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach(function(e){if(T.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(a.tilesHor=parseInt(t[0],10),a.tilesVert=parseInt(t[1],10))}}),r?M.loadSegments(e,t.default.IMAGE,e.indexRange,{},function(e,t){var r=[];e=function(e,t){var r,a=[],i=0,s=void 0,o=void 0,l=void 0;for(s=0,r=e.length;s<r;s++)o=e[s],(l=(0,d.getTimeBasedSegment)(f,n.getIsDynamic(),t,o.startTime,o.duration,o.timescale,o.media,o.mediaRange,i))&&(a.push(l),l=null,i++);return a}(e,t),a.segmentDuration=e[0].duration,a.readThumbnail=function(a,i){var n=null;r.some(function(e){if(e.start<=a&&e.end>a)return n=e.url,!0}),n?i(n):e.some(function(e){if(e.mediaStartTime<=a&&e.mediaStartTime+e.duration>a){var n=s.resolve(t.path);return b.load({method:"get",url:n.url,request:{range:e.mediaRange,responseType:"arraybuffer"},onload:function(t){var a=E.getSamplesInfo(t.target.response),n=new Blob([t.target.response.slice(a.sampleList[0].offset,a.sampleList[0].offset+a.sampleList[0].size)],{type:"image/jpeg"}),s=window.URL.createObjectURL(n);r.push({start:e.mediaStartTime,end:e.mediaStartTime+e.duration,url:s}),i&&i(s)}}),!0}})}}):(a.startNumber=e.startNumber,a.segmentDuration=e.segmentDuration,a.timescale=e.timescale,a.templateUrl=function(e){var t=I.isRelative(e.media)?I.resolve(e.media,s.resolve(e.path).url):e.media;if(!t)return"";return(0,d.replaceIDForTemplate)(t,e.id)}(e)),a.tilesHor>0&&a.tilesVert>0&&(a.widthPerTile=a.width/a.tilesHor,a.heightPerTile=a.height/a.tilesVert,S.push(a))}function R(){S=[],_=-1}return r={initialize:y,getTracks:function(){return S},reset:R,setTrackByIndex:function(e){S&&0!==S.length&&(e>=S.length&&(e=S.length-1),_=e)},getCurrentTrack:function(){return _<0?null:S[_]},getCurrentTrackIndex:function(){return _}},y(),r}I.__dashjs_factory_name="ThumbnailTracks",exports.default=n.default.getClassFactory(I);
},{"../constants/Constants":"jJgo","../../dash/constants/DashConstants":"wYnc","../../core/FactoryMaker":"FHM8","../vo/ThumbnailTrackInfo":"tTzM","../../streaming/utils/URLUtils":"ogFR","../../dash/utils/SegmentsUtils":"Z2QK","../../dash/SegmentBaseLoader":"dFRw","../../streaming/utils/BoxParser":"Yc5r","../../streaming/net/XHRLoader":"pe2U"}],"sv8U":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=h(e),r=require("../constants/Constants"),a=h(r),n=require("../vo/Thumbnail"),i=h(n),o=require("./ThumbnailTracks"),l=h(o),u=require("../vo/BitrateInfo"),s=h(u),d=require("../../dash/utils/SegmentsUtils");function h(e){return e&&e.__esModule?e:{default:e}}function c(e){var t,r=this.context,n=void 0;function o(){n&&n.reset()}return t={get:function(e,t){var r=n.getCurrentTrack();if(!r||r.segmentDuration<=0||null==e)return null;var a=Math.floor(e/r.segmentDuration),o=e%r.segmentDuration,l=Math.floor(o*r.tilesHor*r.tilesVert/r.segmentDuration),u=new i.default;return u.width=Math.floor(r.widthPerTile),u.height=Math.floor(r.heightPerTile),u.x=Math.floor(l%r.tilesHor)*r.widthPerTile,u.y=Math.floor(l/r.tilesHor)*r.heightPerTile,"readThumbnail"in r?r.readThumbnail(e,function(e){u.url=e,t&&t(u)}):(u.url=function(e,t){var r=t+e.startNumber,a=(0,d.replaceTokenForTemplate)(e.templateUrl,"Number",r);return a=(0,d.replaceTokenForTemplate)(a,"Time",(r-1)*e.segmentDuration),a=(0,d.replaceTokenForTemplate)(a,"Bandwidth",e.bandwidth),(0,d.unescapeDollarsInTemplate)(a)}(r,a),t&&t(u),u)},setTrackByIndex:function(e){n.setTrackByIndex(e)},getCurrentTrackIndex:function(){return n.getCurrentTrackIndex()},getBitrateList:function(){var e=n.getTracks(),t=0;return e.map(function(e){var r=new s.default;return r.mediaType=a.default.IMAGE,r.qualityIndex=t++,r.bitrate=e.bitrate,r.width=e.width,r.height=e.height,r})},reset:o},o(),n=(0,l.default)(r).create({adapter:e.adapter,baseURLController:e.baseURLController,stream:e.stream,timelineConverter:e.timelineConverter}),t}c.__dashjs_factory_name="ThumbnailController",exports.default=t.default.getClassFactory(c);
},{"../../core/FactoryMaker":"FHM8","../constants/Constants":"jJgo","../vo/Thumbnail":"FUWv","./ThumbnailTracks":"Sgau","../vo/BitrateInfo":"riIO","../../dash/utils/SegmentsUtils":"Z2QK"}],"r0Ba":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./constants/Constants"),t=v(e),r=require("./StreamProcessor"),n=v(r),a=require("./controllers/EventController"),o=v(a),i=require("./controllers/FragmentController"),f=v(i),d=require("./thumbnail/ThumbnailController"),u=v(d),l=require("../core/EventBus"),E=v(l),s=require("../core/events/Events"),c=v(s),T=require("../core/Debug"),g=v(T),p=require("../core/errors/Errors"),I=v(p),_=require("../core/FactoryMaker"),D=v(_),A=require("./vo/DashJSError"),M=v(A);function v(e){return e&&e.__esModule?e:{default:e}}function C(e){e=e||{};var r=this.context,a=(0,E.default)(r).getInstance(),i=e.manifestModel,d=e.mediaPlayerModel,l=e.manifestUpdater,s=e.adapter,T=e.capabilities,p=e.errHandler,_=e.timelineConverter,D=e.dashMetrics,A=e.abrController,v=e.playbackController,C=e.mediaController,m=e.textController,R=e.videoModel,S=e.settings,y=void 0,O=void 0,h=void 0,F=void 0,N=void 0,U=void 0,P=void 0,b=void 0,G=void 0,L=void 0,x=void 0,B=void 0,w=void 0,X=void 0,k=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function V(e){for(var t=h?h.length:0,r=0;r<t;r++){h[r].getFragmentModel().removeExecutedRequestsBeforeTime(H()+K()),h[r].reset(!1,e)}h=[],F=!1,N=!1,Ee(!1),a.off(c.default.CURRENT_TRACK_CHANGED,$,y)}function Y(){V(),U=null,P={},b=!1}function q(){j(),v&&v.pause(),L&&(L.reset(),L=null),Y(),a.off(c.default.DATA_UPDATE_COMPLETED,ie,y),a.off(c.default.BUFFERING_COMPLETED,oe,y),G&&(a.off(c.default.KEY_ERROR,J,y),a.off(c.default.SERVER_CERTIFICATE_UPDATED,J,y),a.off(c.default.LICENSE_REQUEST_COMPLETE,J,y),a.off(c.default.KEY_SYSTEM_SELECTED,J,y),a.off(c.default.KEY_SESSION_CREATED,J,y),a.off(c.default.KEY_STATUSES_CHANGED,J,y)),Ee(!1)}function K(){return U?U.duration:NaN}function H(){return U?U.start:NaN}function Q(){return U}function z(){if(!(A&&A.hasOwnProperty("getBitrateList")&&s&&s.hasOwnProperty("getAllMediaInfoForType")&&s.hasOwnProperty("getEventsFor")))throw new Error(t.default.MISSING_CONFIG_ERROR)}function j(){B&&B.stop()}function J(e){e.error&&(p.error(e.error),O.fatal(e.error.message),q())}function Z(e){var r,n=e?e.type:null,a=void 0;if(n===t.default.MUXED)return a="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",O.fatal(a),p.error(new M.default(I.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,a,i.getValue())),!1;if(n===t.default.TEXT||n===t.default.FRAGMENTED_TEXT||n===t.default.EMBEDDED_TEXT||n===t.default.IMAGE)return!0;if(r=e.codec,O.debug(n+" codec: "+r),e.contentProtection&&!T.supportsEncryptedMedia())p.error(new M.default(I.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,I.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE));else if(!T.supportsCodec(r))return a=n+"Codec ("+r+") is not supported.",O.error(a),!1;return!0}function $(e){if(e.newMediaInfo.streamInfo.id===U.id){var r=e.newMediaInfo,n=i.getValue();s.setCurrentMediaInfo(U.id,r.type,r);var a=fe(e.newMediaInfo);if(a){var o=v.getTime();O.info("Stream -  Process track changed at current time "+o),O.debug("Stream -  Update stream controller"),n.refreshManifestOnSwitchTrack?(O.debug("Stream -  Refreshing manifest for switch track"),X=e,l.refreshManifest()):(a.selectMediaInfo(r),r.type!==t.default.FRAGMENTED_TEXT?(A.updateTopQualityIndex(r),a.switchTrackAsked(),a.getFragmentModel().abortRequests()):(a.getScheduleController().setSeekTarget(NaN),a.setIndexHandlerTime(o),a.resetIndexHandler()))}}}function W(a,o){var f=s.getAllMediaInfoForType(U,a),l=null,E=void 0;if(f&&0!==f.length){for(var c=0,T=f.length;c<T;c++)if(l=f[c],a===t.default.EMBEDDED_TEXT)m.addEmbeddedTrack(l);else{if(!Z(l))continue;C.addTrack(l)}a!==t.default.EMBEDDED_TEXT&&0!==C.getTracksFor(a,U).length&&(a!==t.default.IMAGE?((a!==t.default.FRAGMENTED_TEXT||a===t.default.FRAGMENTED_TEXT&&m.getTextDefaultEnabled())&&(C.checkInitialMediaSettingsForType(a,U),E=C.getCurrentTrackFor(a,U)),a!==t.default.FRAGMENTED_TEXT||m.getTextDefaultEnabled()||(E=C.getTracksFor(a,U)[0]),function(a,o,f,u){var l=(0,n.default)(r).create({type:a?a.type:null,mimeType:a?a.mimeType:null,timelineConverter:_,adapter:s,manifestModel:i,mediaPlayerModel:d,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,stream:y,abrController:A,playbackController:v,mediaController:C,streamController:e.streamController,textController:m,errHandler:p,settings:S});if(l.initialize(f),A.updateTopQualityIndex(a),u?(l.setBuffer(u.buffer),l.setIndexHandlerTime(u.currentTime),h[u.replaceIdx]=l):h.push(l),!u||!u.ignoreMediaInfo)if(!a||a.type!==t.default.TEXT&&a.type!==t.default.FRAGMENTED_TEXT)l.addMediaInfo(a,!0);else{for(var E=void 0,c=0;c<o.length;c++)o[c].index===a.index&&(E=c),l.addMediaInfo(o[c]);l.selectMediaInfo(o[E])}}(E,f,o)):x=(0,u.default)(r).create({adapter:s,baseURLController:e.baseURLController,stream:y,timelineConverter:e.timelineConverter}))}else O.info("No "+a+" data.")}function ee(){B||((B=(0,o.default)(r).create()).setConfig({manifestUpdater:l,playbackController:v}),te())}function te(){var e=s.getEventsFor(U);B.addInlineEvents(e)}function re(e){var t=s.getAdaptationForType(U.index,e,U);t&&Array.isArray(t.Representation_asArray)&&(t.Representation_asArray=t.Representation_asArray.filter(function(e,r){if(0===r)return!0;var n=s.getCodec(t,r,!0);return!!T.supportsCodec(n)||(O.error("[Stream] codec not supported: "+n),!1)}))}function ne(){for(var e=h.length,r=!!P.audio||!!P.video?new M.default(I.default.DATA_UPDATE_FAILED_ERROR_CODE,I.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,n=0;n<e;n++)if(h[n].isUpdating()||b)return;if(N){if(G)for(var o=0;o<e&&h[o];o++)h[o].getType()!==t.default.AUDIO&&h[o].getType()!==t.default.VIDEO&&h[o].getType()!==t.default.FRAGMENTED_TEXT||G.initializeForMedia(h[o].getMediaInfo());r?p.error(r):a.trigger(c.default.STREAM_INITIALIZED,{streamInfo:U})}}function ae(e){for(var t={},r=0,n=h.length;r<n;r++){var a=h[r].createBuffer(e);a&&(t[h[r].getType()]=a.getBuffer())}return t}function oe(e){if(e.streamInfo===U){var r=de(),n=r.length;if(0!==n){for(var o=0;o<n;o++)if(!r[o].isBufferingCompleted()&&(r[o].getType()===t.default.AUDIO||r[o].getType()===t.default.VIDEO))return void O.warn("onBufferingCompleted - One streamProcessor has finished but",r[o].getType(),"one is not buffering completed");O.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),a.trigger(c.default.STREAM_BUFFERING_COMPLETED,{streamInfo:U})}else O.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}}function ie(e){var t=e.sender.getStreamProcessor();t.getStreamInfo()===U&&(P[t.getType()]=e.error,ne())}function fe(e){return e?de().filter(function(t){return t.getType()===e.type})[0]:null}function de(){for(var e=h.length,r=[],n=void 0,a=void 0,o=0;o<e;o++)(n=(a=h[o]).getType())!==t.default.AUDIO&&n!==t.default.VIDEO&&n!==t.default.FRAGMENTED_TEXT&&n!==t.default.TEXT||r.push(a);return r}function ue(e,t){if(!e)return!1;var r=e.getStreamInfo(),n=Q();if(!r||!n)return!1;var a=s.getAdaptationForType(r.index,t,r),o=s.getAdaptationForType(n.index,t,n);return a&&o?!a.ContentProtection&&!o.ContentProtection:!a&&!o}function le(e,t){if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;var r=e.getStreamInfo(),n=Q();if(!r||!n)return!1;var a=s.getAdaptationForType(r.index,t,r),o=s.getAdaptationForType(n.index,t,n);if(!a||!o)return!a&&!o;var i=a&&o&&a.mimeType===o.mimeType,f=o.Representation_asArray.map(function(e){return e.codecs}),d=a.Representation_asArray.map(function(e){return e.codecs}),u=d.some(function(e){return f.indexOf(e)>-1}),l=d.some(function(e){return f.some(function(t){return function(e,t){for(var r=e.split(".")[0],n=0===t.indexOf(r),a=void 0,o=0;o<k.length;o++)if(k[o].codec===r){a=k[o];break}if(a)return n||a.compatibleCodecs.some(function(e){return 0===t.indexOf(e)});return n}(t,e)})});return u||l&&i}function Ee(e){w=e}function se(){return w}return y={initialize:function(e,t){U=e,(G=t)&&(a.on(c.default.KEY_ERROR,J,y),a.on(c.default.SERVER_CERTIFICATE_UPDATED,J,y),a.on(c.default.LICENSE_REQUEST_COMPLETE,J,y),a.on(c.default.KEY_SYSTEM_SELECTED,J,y),a.on(c.default.KEY_SESSION_CREATED,J,y),a.on(c.default.KEY_STATUSES_CHANGED,J,y))},activate:function(e,r){if(!F){var n=void 0;return a.on(c.default.CURRENT_TRACK_CHANGED,$,y),se()?(function(){if(b=!0,z(),re(t.default.VIDEO),re(t.default.AUDIO),N=!0,b=!1,0===h.length){var e="No streams to play.";p.error(new M.default(I.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e,i.getValue())),O.debug(e)}else ne()}(),n=r):n=function(e,r){z();var n=R.getElement();ee(),b=!0,re(t.default.VIDEO),re(t.default.AUDIO),(!n||n&&/^VIDEO$/i.test(n.nodeName))&&W(t.default.VIDEO,e),W(t.default.AUDIO,e),W(t.default.TEXT,e),W(t.default.FRAGMENTED_TEXT,e),W(t.default.EMBEDDED_TEXT,e),W(t.default.MUXED,e),W(t.default.IMAGE,e);var a=ae(r);if(N=!0,b=!1,0===h.length){var o="No streams to play.";p.error(new M.default(I.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,o,i.getValue())),O.fatal(o)}else ne();return a}(e,r),F=!0,n}return r},deactivate:V,isActive:function(){return F},getDuration:K,getStartTime:H,getId:function(){return U?U.id:null},getStreamInfo:Q,preload:function(e,r){ee(),W(t.default.VIDEO,e),W(t.default.AUDIO,e),W(t.default.TEXT,e),W(t.default.FRAGMENTED_TEXT,e),W(t.default.EMBEDDED_TEXT,e),W(t.default.MUXED,e),W(t.default.IMAGE,e),ae(r),a.on(c.default.CURRENT_TRACK_CHANGED,$,y);for(var n=0;n<h.length&&h[n];n++)h[n].getScheduleController().start();Ee(!0)},getFragmentController:function(){return L},getThumbnailController:function(){return x},getBitrateListFor:function(e){if(z(),e===t.default.IMAGE)return x?x.getBitrateList():[];var r=function(e){for(var t=h.length,r=null,n=0;n<t;n++)if((r=h[n]).getType()===e)return r.getMediaInfo();return null}(e);return A.getBitrateList(r)},startEventController:function(){B&&B.start()},stopEventController:j,updateData:function(e){O.info("Manifest updated... updating data system wide."),F=!1,b=!0,U=e,B&&te(),re(t.default.VIDEO),re(t.default.AUDIO);for(var r=0,n=h.length;r<n;r++){var a=h[r],o=s.getMediaInfoForType(U,a.getType());A.updateTopQualityIndex(o),a.addMediaInfo(o,!0)}if(X&&"fragmentedText"!==X.newMediaInfo.type){var i=fe(X.oldMediaInfo);if(!i)return;i.switchTrackAsked(),X=void 0}b=!1,ne()},reset:q,getProcessors:de,setMediaSource:function(e){for(var t=0;t<h.length;)Z(h[t].getMediaInfo())?(h[t].setMediaSource(e),t++):(h[t].reset(),h.splice(t,1));for(var r=0;r<h.length;r++)h[r].dischargePreBuffer();if(0===h.length){var n="No streams to play.";p.error(new M.default(I.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,n+"nostreams",i.getValue())),O.fatal(n)}},isMediaCodecCompatible:function(e){return le(e,t.default.VIDEO)&&le(e,t.default.AUDIO)},isProtectionCompatible:function(e){return ue(e,t.default.VIDEO)&&ue(e,t.default.AUDIO)},getPreloaded:se,addInbandEvents:function(e){B&&B.addInbandEvents(e)}},O=(0,g.default)(r).getInstance().getLogger(y),Y(),L=(0,f.default)(r).create({mediaPlayerModel:d,dashMetrics:D,errHandler:p,settings:S}),a.on(c.default.BUFFERING_COMPLETED,oe,y),a.on(c.default.DATA_UPDATE_COMPLETED,ie,y),y}C.__dashjs_factory_name="Stream",exports.default=D.default.getClassFactory(C);
},{"./constants/Constants":"jJgo","./StreamProcessor":"WGTD","./controllers/EventController":"lVxT","./controllers/FragmentController":"iL1U","./thumbnail/ThumbnailController":"sv8U","../core/EventBus":"Opee","../core/events/Events":"W3G1","../core/Debug":"iL1O","../core/errors/Errors":"Wrqa","../core/FactoryMaker":"FHM8","./vo/DashJSError":"gyaG"}],"ba4o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../core/EventBus"),t=u(e),i=require("../core/events/Events"),r=u(i),n=require("../core/FactoryMaker"),a=u(n),o=require("../core/Debug"),s=u(o),f=require("../core/errors/Errors"),d=u(f);function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e=this.context,i=(0,t.default)(e).getInstance(),n=void 0,a=void 0,o=void 0,f=void 0,u=void 0,l=void 0,c=void 0,A=void 0,E=void 0,_=void 0,g=void 0;function v(){o=NaN,l=!1,u=!0,M()}function M(){null!==f&&(clearInterval(f),f=null)}function m(e){M(),isNaN(e)&&!isNaN(o)&&(e=1e3*o),isNaN(e)||(a.debug("Refresh manifest in "+e+" milliseconds."),f=setTimeout(h,e))}function T(){l=!0;var e=A.getValue(),t=e.url,i=E.getLocation(e);i&&(t=i),c.load(t)}function N(e){A.setValue(e);var t=new Date,n=(t.getTime()-e.loadedTime.getTime())/1e3;1e3*(o=E.getManifestUpdatePeriod(e,n))>2147483647&&(o=2147483.647),i.trigger(r.default.MANIFEST_UPDATED,{manifest:e}),a.info("Manifest has been refreshed at "+t+"["+t.getTime()/1e3+"] "),u||m()}function h(){u&&!g.get().streaming.scheduleWhilePaused||(l?m(g.get().streaming.manifestUpdateRetryInterval):T())}function D(e){e.error?e.error.code===d.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&_.error(e.error):N(e.manifest)}function P(){u=!1,m()}function S(){u=!0,M()}function L(){l=!1}return n={initialize:function(){v(),i.on(r.default.STREAMS_COMPOSED,L,this),i.on(r.default.PLAYBACK_STARTED,P,this),i.on(r.default.PLAYBACK_PAUSED,S,this),i.on(r.default.INTERNAL_MANIFEST_LOADED,D,this)},setManifest:function(e){N(e)},refreshManifest:T,setConfig:function(e){e&&(e.manifestModel&&(A=e.manifestModel),e.adapter&&(E=e.adapter),e.mediaPlayerModel&&e.mediaPlayerModel,e.manifestLoader&&(c=e.manifestLoader),e.errHandler&&(_=e.errHandler),e.settings&&(g=e.settings))},reset:function(){i.off(r.default.PLAYBACK_STARTED,P,this),i.off(r.default.PLAYBACK_PAUSED,S,this),i.off(r.default.STREAMS_COMPOSED,L,this),i.off(r.default.INTERNAL_MANIFEST_LOADED,D,this),v()}},a=(0,s.default)(e).getInstance().getLogger(n),n}l.__dashjs_factory_name="ManifestUpdater",exports.default=a.default.getClassFactory(l);
},{"../core/EventBus":"Opee","../core/events/Events":"W3G1","../core/FactoryMaker":"FHM8","../core/Debug":"iL1O","../core/errors/Errors":"Wrqa"}],"yxZg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../core/events/EventsBase"),t=a(e);function a(e){return e&&e.__esModule?e:{default:e}}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var n=function(e){function a(){A(this,a);var e=E(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return e.AST_IN_FUTURE="astInFuture",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.SOURCE_INITIALIZED="sourceInitialized",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_SEEK_ASKED="playbackSeekAsked",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e}return r(a,t.default),a}(),_=new n;exports.default=_;
},{"../core/events/EventsBase":"zN1Q"}],"muVL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./../vo/DashJSError"),t=g(e),n=require("./../vo/metrics/HTTPRequest"),r=require("./../../core/EventBus"),a=g(r),u=require("./../../core/events/Events"),i=g(u),o=require("./../../core/errors/Errors"),s=g(o),c=require("../../core/FactoryMaker"),d=g(c),l=require("../../core/Debug"),f=g(l),p=require("../utils/URLUtils"),v=g(p);function g(e){return e&&e.__esModule?e:{default:e}}var h=5e3;function m(){var e=this.context,r=(0,a.default)(e).getInstance(),u=(0,v.default)(e).getInstance(),o=void 0,c=void 0,d=void 0,l=void 0,p=void 0,g=void 0,m=void 0,T=void 0;function _(e){l=e}function D(e){d=e}function I(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t=void 0,n=void 0,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(n=60*parseInt(r[9],10)+parseInt(r[10],10),t+=("+"===r[8]?-1:1)*n*60*1e3),new Date(t).getTime()}(e)),t}function E(e){return Date.parse(e)}function R(e){return Date.parse(e)}function N(e,t,n){n()}function M(e,t,n){var r=I(e);isNaN(r)?n():t(r)}function q(e,t,r,a,i){var o,s,c=!1,d=new XMLHttpRequest,l=i?n.HTTPRequest.HEAD:n.HTTPRequest.GET,f=t.match(/\S+/g);if(t=f.shift(),o=function(){c||(c=!0,f.length?q(e,f.join(" "),r,a,i):a())},s=function(){var t=void 0,n=void 0;200===d.status&&(t=i?d.getResponseHeader("Date"):d.response,n=e(t),isNaN(n)||(r(n),c=!0))},u.isRelative(t)){var p=T.resolve();p&&(t=u.resolve(t,p.url))}d.open(l,t),d.timeout=h||0,d.onload=s,d.onloadend=o,d.send()}function S(e,t,n){q(R,e,t,n,!0)}function L(e,n,a){_(!1),r.trigger(i.default.TIME_SYNCHRONIZATION_COMPLETED,{time:n,offset:a,error:e?new t.default(s.default.TIME_SYNC_FAILED_ERROR_CODE,s.default.TIME_SYNC_FAILED_ERROR_MESSAGE):null})}return o={initialize:function(e,t){p=t,d=0,l=!1,g={"urn:mpeg:dash:utc:http-head:2014":S,"urn:mpeg:dash:utc:http-xsdate:2014":q.bind(null,I),"urn:mpeg:dash:utc:http-iso:2014":q.bind(null,E),"urn:mpeg:dash:utc:direct:2014":M,"urn:mpeg:dash:utc:http-head:2012":S,"urn:mpeg:dash:utc:http-xsdate:2012":q.bind(null,I),"urn:mpeg:dash:utc:http-iso:2012":q.bind(null,E),"urn:mpeg:dash:utc:direct:2012":M,"urn:mpeg:dash:utc:http-ntp:2014":N,"urn:mpeg:dash:utc:ntp:2014":N,"urn:mpeg:dash:utc:sntp:2014":N},l||function e(t,n){var r=n||0,a=t[r],u=function(e,t){var n,r,a=!e||!t;a&&p?(n=m.getLatestMPDRequestHeaderValueByID("Date"),r=null!==n?new Date(n).getTime():Number.NaN,isNaN(r)?L(!0):(D(r-(new Date).getTime()),L(!1,r/1e3,d))):L(a,e,t)};_(!0),a?g.hasOwnProperty(a.schemeIdUri)?g[a.schemeIdUri](a.value,function(e){var t=(new Date).getTime(),n=function(e,t){return e-t}(e,t);D(n),c.info("Local time: "+new Date(t)),c.info("Server time: "+new Date(e)),c.info("Server Time - Local Time (ms): "+n),u(e,n)},function(){e(t,r+1)}):e(t,r+1):(D(0),u())}(e)},getOffsetToDeviceTimeMs:function(){return d},setConfig:function(e){e&&(e.dashMetrics&&(m=e.dashMetrics),e.baseURLController&&(T=e.baseURLController))},reset:function(){_(!1)}},c=(0,f.default)(e).getInstance().getLogger(o),o}m.__dashjs_factory_name="TimeSyncController";var T=d.default.getSingletonFactory(m);T.HTTP_TIMEOUT_MS=h,d.default.updateSingletonFactory(m.__dashjs_factory_name,T),exports.default=T;
},{"./../vo/DashJSError":"gyaG","./../vo/metrics/HTTPRequest":"yMBz","./../../core/EventBus":"Opee","./../../core/events/Events":"W3G1","./../../core/errors/Errors":"Wrqa","../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","../utils/URLUtils":"ogFR"}],"mdKr":[function(require,module,exports) {
"use strict";var r=Array.isArray,t=Object.keys,e=Object.prototype.hasOwnProperty;module.exports=function n(i,f){if(i===f)return!0;if(i&&f&&"object"==typeof i&&"object"==typeof f){var o,u,a,c=r(i),g=r(f);if(c&&g){if((u=i.length)!=f.length)return!1;for(o=u;0!=o--;)if(!n(i[o],f[o]))return!1;return!0}if(c!=g)return!1;var s=i instanceof Date,p=f instanceof Date;if(s!=p)return!1;if(s&&p)return i.getTime()==f.getTime();var l=i instanceof RegExp,y=f instanceof RegExp;if(l!=y)return!1;if(l&&y)return i.toString()==f.toString();var h=t(i);if((u=h.length)!==t(f).length)return!1;for(o=u;0!=o--;)if(!e.call(f,h[o]))return!1;for(o=u;0!=o--;)if(!n(i[a=h[o]],f[a]))return!1;return!0}return i!=i&&f!=f};
},{}],"KpNL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=a(e),r=require("fast-deep-equal"),u=a(r);function a(e){return e&&e.__esModule?e:{default:e}}function n(){return{areEqual:function(e,t){return(0,u.default)(e,t)}}}n.__dashjs_factory_name="ObjectUtils",exports.default=t.default.getSingletonFactory(n);
},{"../../core/FactoryMaker":"FHM8","fast-deep-equal":"mdKr"}],"XFXr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../utils/ObjectUtils"),t=n(e),a=require("../../core/FactoryMaker"),r=n(a);function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=NaN,i=function e(t,a){o(this,e),this.data={baseUrls:t||null,selectedIdx:a||s},this.children=[]};function c(){var e,a=void 0,r=void 0,n=this.context,o=(0,t.default)(n).getInstance();function c(e,t,a){var n=r.getBaseURLsFromElement(a);e[t]?o.areEqual(n,e[t].data.baseUrls)||(e[t].data.baseUrls=n,e[t].data.selectedIdx=s):e[t]=new i(n)}function d(e){!function(){if(!r||!r.hasOwnProperty("getBaseURLsFromElement")||!r.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var t=r.getBaseURLsFromElement(e);o.areEqual(t,a.data.baseUrls)||(a.data.baseUrls=t,a.data.selectedIdx=s),e&&e.Period_asArray&&e.Period_asArray.forEach(function(e,t){c(a.children,t,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,n){c(a.children[t].children,n,e),e.Representation_asArray&&e.Representation_asArray.sort(r.getRepresentationSortFunction()).forEach(function(e,r){c(a.children[t].children[n].children,r,e)})})})}function l(){a=new i}return e={reset:l,update:function(e){d(e)},getForPath:function(e){var t=a,r=[t.data];return e&&e.forEach(function(e){(t=t.children[e])&&r.push(t.data)}),r.filter(function(e){return e.baseUrls.length})},invalidateSelectedIndexes:function(e){!function e(t,r){var n=r||a;t(n.data),n.children&&n.children.forEach(function(a){return e(t,a)})}(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=s)})},setConfig:function(e){e.adapter&&(r=e.adapter)}},l(),e}c.__dashjs_factory_name="BaseURLTreeModel",exports.default=r.default.getClassFactory(c);
},{"../utils/ObjectUtils":"KpNL","../../core/FactoryMaker":"FHM8"}],"R4AG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=a(e),n=require("../../core/EventBus"),r=a(n);function a(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t=[],n=(0,r.default)(this.context).getInstance(),a=e.updateEventName,u=e.addBlacklistEventName;function o(e){-1===t.indexOf(e)&&(t.push(e),n.trigger(a,{entry:e}))}function c(e){o(e.entry)}return function(){u&&n.on(u,c,this)}(),{add:o,contains:function(e){return!!(t.length&&e&&e.length)&&-1!==t.indexOf(e)},reset:function(){t=[]}}}u.__dashjs_factory_name="BlackListController",exports.default=t.default.getClassFactory(u);
},{"../../core/FactoryMaker":"FHM8","../../core/EventBus":"Opee"}],"S8lB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../../../core/FactoryMaker"),t=e(r);function e(r){return r&&r.__esModule?r:{default:r}}function i(r){var t=(r=r||{}).blacklistController;return{select:function(r){return r&&function(r){var t=0,e=[],i=0,o=void 0,n=void 0;if((n=r.sort(function(r,t){var e=r.dvb_priority-t.dvb_priority;return isNaN(e)?0:e}).filter(function(r,t,e){return!t||e[0].dvb_priority&&r.dvb_priority&&e[0].dvb_priority===r.dvb_priority})).length)return n.length>1&&(n.forEach(function(r){t+=r.dvb_weight,e.push(t)}),o=Math.floor(Math.random()*(t-1)),e.every(function(r,t){return i=t,!(o<r)})),n[i]}((e=[],r.filter(function(r){return!t.contains(r.serviceLocation)||(r.dvb_priority&&e.push(r.dvb_priority),!1)}).filter(function(r){return!e.length||!r.dvb_priority||-1===e.indexOf(r.dvb_priority)})));var e}}}i.__dashjs_factory_name="DVBSelector",exports.default=t.default.getClassFactory(i);
},{"../../../core/FactoryMaker":"FHM8"}],"l3wF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../../core/FactoryMaker"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}function o(e){var r=(e=e||{}).blacklistController;return{select:function(e){var t=0,o=void 0;return e&&e.some(function(e,o){return t=o,!r.contains(e.serviceLocation)})&&(o=e[t]),o}}}o.__dashjs_factory_name="BasicSelector",exports.default=r.default.getClassFactory(o);
},{"../../../core/FactoryMaker":"FHM8"}],"lCMJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/errors/Errors"),r=I(e),t=require("../../core/EventBus"),o=I(t),l=require("../../core/events/Events"),a=I(l),s=require("../controllers/BlacklistController"),u=I(s),c=require("./baseUrlResolution/DVBSelector"),i=I(c),n=require("./baseUrlResolution/BasicSelector"),d=I(n),E=require("../../core/FactoryMaker"),_=I(E),f=require("../vo/DashJSError"),R=I(f),v=require("../utils/SupervisorTools");function I(e){return e&&e.__esModule?e:{default:e}}function L(){var e,t=this.context,l=(0,o.default)(t).getInstance(),s=void 0,c=void 0,n=void 0,E=void 0;function _(){s.reset()}return e={chooseSelector:function(e){(0,v.checkParameterType)(e,"boolean"),E=e?n:c},select:function(e){if(e){var t=e.baseUrls,o=e.selectedIdx;if(!isNaN(o))return t[o];var s=E.select(t);return s?(e.selectedIdx=t.indexOf(s),s):(l.trigger(a.default.URL_RESOLUTION_FAILED,{error:new R.default(r.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,r.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(E===c&&_()))}},reset:_,setConfig:function(e){e.selector&&(E=e.selector)}},s=(0,u.default)(t).create({updateEventName:a.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:a.default.SERVICE_LOCATION_BLACKLIST_ADD}),c=(0,d.default)(t).create({blacklistController:s}),n=(0,i.default)(t).create({blacklistController:s}),E=c,e}L.__dashjs_factory_name="BaseURLSelector",exports.default=_.default.getClassFactory(L);
},{"../../core/errors/Errors":"Wrqa","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../controllers/BlacklistController":"R4AG","./baseUrlResolution/DVBSelector":"S8lB","./baseUrlResolution/BasicSelector":"l3wF","../../core/FactoryMaker":"FHM8","../vo/DashJSError":"gyaG","../utils/SupervisorTools":"A0aa"}],"mKMn":[function(require,module,exports) {
"use strict";function i(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=1,e=1,s=function s(a,o,r,n){i(this,s),this.url=a||"",this.serviceLocation=o||a||"",this.dvb_priority=r||t,this.dvb_weight=n||e,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};s.DEFAULT_DVB_PRIORITY=t,s.DEFAULT_DVB_WEIGHT=e,exports.default=s;
},{}],"W31W":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../models/BaseURLTreeModel"),t=L(e),r=require("../utils/BaseURLSelector"),a=L(r),i=require("../utils/URLUtils"),l=L(i),o=require("../../dash/vo/BaseURL"),u=L(o),n=require("../../core/FactoryMaker"),s=L(n),c=require("../../core/EventBus"),d=L(c),f=require("../../core/events/Events"),v=L(f);function L(e){return e&&e.__esModule?e:{default:e}}function R(){var e=void 0,r=void 0,i=this.context,o=(0,d.default)(i).getInstance(),n=(0,l.default)(i).getInstance(),s=void 0,c=void 0;function f(e){s.invalidateSelectedIndexes(e.entry)}return e={reset:function(){s.reset(),c.reset()},initialize:function(e){var t;s.setConfig({adapter:r}),t=e,s.update(t),c.chooseSelector(r.getIsDVB(t))},resolve:function(e){var t=s.getForPath(e).reduce(function(e,t){var r=c.select(t);return r?(n.isRelative(r.url)?e.url=n.resolve(r.url,e.url):(e.url=r.url,e.serviceLocation=r.serviceLocation),e.availabilityTimeOffset=r.availabilityTimeOffset,e.availabilityTimeComplete=r.availabilityTimeComplete,e):new u.default},new u.default);if(!n.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(s=e.baseURLTreeModel),e.baseURLSelector&&(c=e.baseURLSelector),e.adapter&&(r=e.adapter)}},s=(0,t.default)(i).create(),c=(0,a.default)(i).create(),o.on(v.default.SERVICE_LOCATION_BLACKLIST_CHANGED,f,e),e}R.__dashjs_factory_name="BaseURLController",exports.default=s.default.getSingletonFactory(R);
},{"../models/BaseURLTreeModel":"XFXr","../utils/BaseURLSelector":"lCMJ","../utils/URLUtils":"ogFR","../../dash/vo/BaseURL":"mKMn","../../core/FactoryMaker":"FHM8","../../core/EventBus":"Opee","../../core/events/Events":"W3G1"}],"Un1z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=a(e),r=require("../../core/Debug"),n=a(r);function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0,t=void 0,r=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){var r=window.URL.createObjectURL(e);return t.setSource(r),r},detachMediaSource:function(e){e.setSource(null)},setDuration:function(e,t){return e.duration!=t&&(e.duration=t),e.duration},setSeekable:function(e,t,r){e&&"function"==typeof e.setLiveSeekableRange&&"function"==typeof e.clearLiveSeekableRange&&"open"===e.readyState&&t>=0&&t<r&&(e.clearLiveSeekableRange(),e.setLiveSeekableRange(t,r))},signalEndOfStream:function(e){var r=e.sourceBuffers,n=r.length;if("open"===e.readyState){for(var a=0;a<n;a++){if(r[a].updating)return;if(0===r[a].buffered.length)return}t.info("call to mediaSource endOfStream"),e.endOfStream()}}},t=(0,n.default)(r).getInstance().getLogger(e),e}o.__dashjs_factory_name="MediaSourceController",exports.default=t.default.getSingletonFactory(o);
},{"../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O"}],"P6bB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=b(e),i=require("../constants/MetricsConstants"),r=b(i),a=require("../Stream"),o=b(a),n=require("../ManifestUpdater"),l=b(n),d=require("../../core/EventBus"),s=b(d),u=require("../../core/events/Events"),f=b(u),c=require("../../core/FactoryMaker"),E=b(c),g=require("../vo/metrics/PlayList"),m=require("../../core/Debug"),v=b(m),T=require("../utils/InitCache"),S=b(T),_=require("../utils/URLUtils"),C=b(_),p=require("../MediaPlayerEvents"),A=b(p),D=require("./TimeSyncController"),I=b(D),P=require("./BaseURLController"),O=b(P),h=require("./MediaSourceController"),R=b(h),M=require("../vo/DashJSError"),L=b(M),N=require("../../core/errors/Errors"),y=b(N);function b(e){return e&&e.__esModule?e:{default:e}}function U(){var e=40,i=2e3,a=this.context,n=(0,s.default)(a).getInstance(),d=void 0,u=void 0,c=void 0,E=void 0,m=void 0,T=void 0,_=void 0,p=void 0,D=void 0,P=void 0,h=void 0,M=void 0,N=void 0,b=void 0,U=void 0,F=void 0,B=void 0,k=void 0,w=void 0,K=void 0,Y=void 0,x=void 0,q=void 0,H=void 0,V=void 0,G=void 0,z=void 0,W=void 0,j=void 0,J=void 0,Q=void 0,Z=void 0,X=void 0,$=void 0,ee=void 0,te=void 0,ie=void 0,re=void 0,ae=void 0,oe=void 0,ne=void 0,le=void 0,de=void 0,se=void 0;function ue(){if(Ne(t.default.VIDEO)){var e=W.getPlaybackQuality();e&&p.addDroppedFrames(e)}}function fe(){if(!(!se.get().streaming.jumpGaps||0===pe()||j.isSeeking()||Q||H||V||G)&&++re>=e){var t=j.getTime();le===t?function(e){for(var t=pe(),i=se.get().streaming.smallGapLimit,r=void 0,a=0;a<t.length;a++){var o=t[a].getBuffer(),l=o.getAllBufferRanges(),d=void 0;if(l&&!(l.length<=1)){for(var s=0;s<l.length;s++)if(e<l.start(s)){d=l.start(s);break}if(d>0){var c=d-e;c>0&&c<=i&&(void 0===r||d>r)&&(r=d)}}}var E=j.getTimeToStreamEnd();void 0===r&&!isNaN(E)&&E<i&&(r=e+E);r>0&&(!isNaN(E)&&r>=e+E?(u.info("Jumping media gap (discontinuity) at time ",e,". Jumping to end of the stream"),n.trigger(f.default.PLAYBACK_ENDED,{isLast:Be().isLast})):(u.info("Jumping media gap (discontinuity) at time ",e,". Jumping to time position",r),j.seek(r,!0,!0)))}(t):le=t,re=0}}function ce(e){var t=Ce(e.seekTime);te&&(me(),ee=!1),ie&&(u.debug("[PreloadTimer] stop period preload timer."),clearTimeout(ie),ie=void 0),t===K&&ne&&ne.deactivate(!0),t&&(t!==K||ne&&!K.isActive())?(be(g.PlayListTrace.END_OF_PERIOD_STOP_REASON),Ie(K,t,e.seekTime)):be(g.PlayListTrace.USER_REQUEST_STOP_REASON),Ue(g.PlayList.SEEK_START_REASON)}function Ee(){u.debug("[onPlaybackStarted]"),Z?(Z=!1,Ue(g.PlayList.INITIAL_PLAYOUT_START_REASON)):Q&&(Q=!1,Ue(g.PlayList.RESUME_FROM_PAUSE_START_REASON),ve())}function ge(e){u.debug("[onPlaybackPaused]"),e.ended||(Q=!0,be(g.PlayListTrace.USER_REQUEST_STOP_REASON),ve())}function me(){u.debug("[toggleEndPeriodTimer] stop end period timer."),clearTimeout(te),te=void 0}function ve(){if(ee)if(te)me();else{var e=j.getTimeToStreamEnd(),t=e>0?1e3*e:0,r=t<i?t/4:t-i;u.debug("[toggleEndPeriodTimer] Going to fire preload in",r,"milliseconds"),ie=setTimeout(_e,r),u.debug("[toggleEndPeriodTimer] start-up of timer to notify PLAYBACK_ENDED event. It will be triggered in",t,"milliseconds"),te=setTimeout(function(){n.trigger(f.default.PLAYBACK_ENDED,{isLast:Be().isLast})},t)}}function Te(e){if(e.sender&&(e.sender.getType()===t.default.AUDIO||e.sender.getType()===t.default.VIDEO)){var i=Be().isLast;z&&!i&&void 0===te&&(u.info("[onTrackBufferingCompleted] end of period detected. Track",e.sender.getType(),"has finished"),ee=!0,!1===Q&&ve())}}function Se(){var e=Be().isLast;z&&e&&(u.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),D.signalEndOfStream(z))}function _e(){var e=Be().isLast;if(z&&!e){var t=De();(oe=K.isProtectionCompatible(t)&&(de||K.isMediaCodecCompatible(t)))&&(u.info("[onStreamCanLoadNext] Preloading next stream"),K.stopEventController(),K.deactivate(!0),t.preload(z,ae),ne=t,t.getProcessors().forEach(function(e){e.setIndexHandlerTime(t.getStartTime())}))}}function Ce(e){var t=0,i=null,r=w.length;r>0&&(t+=w[0].getStartTime());for(var a=0;a<r;a++)if(i=w[a],e<(t=parseFloat((t+i.getDuration()).toFixed(5))))return i;return null}function pe(){return K?K.getProcessors():[]}function Ae(){var e=De();e?($=void 0,X=void 0,Ie(K,e,NaN)):u.debug("StreamController no next stream found"),be(e?g.PlayListTrace.END_OF_PERIOD_STOP_REASON:g.PlayListTrace.END_OF_CONTENT_STOP_REASON),te=void 0,ee=!1}function De(){if(K){var e=Be().start,t=Be().duration;return w.filter(function(i){return i.getStreamInfo().start===parseFloat((e+t).toFixed(5))})[0]}}function Ie(e,t,i){H||!t||e===t&&t.isActive()||(H=!0,n.trigger(f.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:e?e.getStreamInfo():null,toStreamInfo:t.getStreamInfo()}),oe=!1,e&&(e.stopEventController(),oe=K.isProtectionCompatible(t)&&(de||K.isMediaCodecCompatible(t))&&!i||t.getPreloaded(),e.deactivate(oe)),K=t,ne=!1,j.initialize(Be(),oe),W.getElement()?Pe(i,e,!1,oe):function(e){Oe(e,oe)}(i))}function Pe(e,t,i,r){var a=void 0;function o(){z&&(u.debug("MediaSource is open!"),window.URL.revokeObjectURL(a),z.removeEventListener("sourceopen",o),z.removeEventListener("webkitsourceopen",o),he(),t||n.trigger(f.default.SOURCE_INITIALIZED),i?K.setMediaSource(z):Oe(e,r))}z?r?(Oe(e,r),t||n.trigger(f.default.SOURCE_INITIALIZED)):(D.detachMediaSource(W),z.addEventListener("sourceopen",o,!1),z.addEventListener("webkitsourceopen",o,!1),a=D.attachMediaSource(z,W),u.debug("MediaSource attached to element.  Waiting on open...")):((z=D.createMediaSource()).addEventListener("sourceopen",o,!1),z.addEventListener("webkitsourceopen",o,!1),a=D.attachMediaSource(z,W),u.debug("MediaSource attached to element.  Waiting on open..."))}function Oe(e,i){if(ae=K.activate(z,i?ae:void 0),$=ye(t.default.AUDIO),X=ye(t.default.VIDEO),ae){var r=Object.keys(ae);r.length>0&&ae[r[0]].changeType&&(u.debug("SourceBuffer changeType method supported. Use it to switch codecs in periods transitions"),de=!0)}if(!Z)if(isNaN(e)){var a=j.getStreamStartTime(!0);i||pe().forEach(function(e){_.setIndexHandlerTime(e,a)})}else j.seek(e);K.startEventController(),!q&&Z||j.play(),H=!1,n.trigger(f.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:Be()})}function he(e){var t=e||Be().manifestInfo.duration,i=D.setDuration(z,t);u.debug("Duration successfully set to: "+i)}function Re(e){for(var t=0,i=w.length;t<i;t++)if(w[t].getId()===e.id)return w[t];return null}function Me(){var e=T.getValue();Y&&(n.trigger(f.default.PROTECTION_CREATED,{controller:Y,manifest:e}),Y.setMediaElement(W.getElement()),x&&Y.setProtectionData(x)),function(){try{var e=_.getStreamsInfo();if(0===e.length)throw new Error("There are no streams");p.updateManifestUpdateInfo({currentTime:j.getTime(),buffered:W.getBufferRange(),presentationStartTime:e[0].start,clientTimeOffset:k.getClientTimeOffset()});for(var t=0,i=e.length;t<i;t++){var r=e[t],l=Re(r);l?l.updateData(r):(l=(0,o.default)(a).create({manifestModel:T,mediaPlayerModel:J,dashMetrics:p,manifestUpdater:E,adapter:_,timelineConverter:k,capabilities:c,errHandler:B,baseURLController:h,abrController:M,playbackController:j,mediaController:N,textController:b,videoModel:W,streamController:d,settings:se}),w.push(l),l.initialize(r,Y)),p.addManifestUpdateStreamInfo(r)}if(!K){var s=j.getStartTimeFromUriParameters(),u=null;s&&(u=Ce(isNaN(s.fragS)?s.fragT:s.fragS)),Ie(null,null!==u?u:w[0],NaN)}n.trigger(f.default.STREAMS_COMPOSED)}catch(g){B.error(new L.default(y.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,g.message+"nostreamscomposed",T.getValue())),G=!0,Ye()}}()}function Le(e){if(e.error)G=!0,Ye();else{var i=e.manifest;_.updatePeriods(i);var r=_.getStreamsInfo(void 0,1)[0],a=_.getMediaInfoForType(r,t.default.VIDEO)||_.getMediaInfoForType(r,t.default.AUDIO),o=void 0;if(a&&(o=_.getUseCalculatedLiveEdgeTimeForMediaInfo(a))){u.debug("SegmentTimeline detected using calculated Live Edge Time");se.update({streaming:{useManifestDateHeaderTimeSource:!1}})}var n=_.getUTCTimingSources(),l=!_.getIsDynamic()||o?n:n.concat(J.getUTCTimingSources()),d=F.isHTTPS(e.manifest.url);l.forEach(function(e){e.value.replace(/.*?:\/\//g,"")===J.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(d?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),d?"https://":"http://"),u.debug("Matching default timing source protocol to manifest protocol: ",e.value))}),h.initialize(i),P.setConfig({dashMetrics:p,baseURLController:h}),P.initialize(l,se.get().streaming.useManifestDateHeaderTimeSource)}}function Ne(e){var i=void 0;if(!e)return i;switch(e){case t.default.VIDEO:i=X;break;case t.default.AUDIO:i=$}return i}function ye(e){var t=!1;return pe().forEach(function(i){i.getMediaInfo().type===e&&(t=!0)}),t}function be(e,t){t=t||new Date,pe().forEach(function(i){var r=i.getScheduleController();r&&r.finalisePlayList(t,e)}),p.addPlayList()}function Ue(e){p.createPlaylistMetrics(1e3*j.getTime(),e)}function Fe(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}V=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),u.fatal("Video Element Error: "+t),e.error&&u.fatal(e.error),B.error(new L.default(e.error.code,t)),Ye()}}function Be(){return K?K.getStreamInfo():null}function ke(){if(!(m&&m.hasOwnProperty("load")&&k&&k.hasOwnProperty("initialize")&&k.hasOwnProperty("reset")&&k.hasOwnProperty("getClientTimeOffset")&&T&&B&&p&&j))throw new Error("setConfig function has to be called previously")}function we(e){isNaN(e.newDuration)||he(e.newDuration)}function Ke(){w=[],Y=null,H=!1,K=null,V=!1,G=!1,X=void 0,$=void 0,Z=!0,Q=!1,q=!0,te=void 0,ee=!1,re=0}function Ye(){ke(),P.reset(),be(V||G?g.PlayListTrace.FAILURE_STOP_REASON:g.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,t=w?w.length:0;e<t;e++){w[e].reset(V)}!function(){n.off(f.default.PLAYBACK_TIME_UPDATED,ue,this),n.off(f.default.PLAYBACK_SEEKING,ce,this),n.off(f.default.PLAYBACK_ERROR,Fe,this),n.off(f.default.PLAYBACK_STARTED,Ee,this),n.off(f.default.PLAYBACK_PAUSED,ge,this),n.off(f.default.PLAYBACK_ENDED,Ae,this),n.off(f.default.MANIFEST_UPDATED,Le,this),n.off(f.default.BUFFERING_COMPLETED,Te,this),n.off(f.default.STREAM_BUFFERING_COMPLETED,Se,this),n.off(f.default.MANIFEST_VALIDITY_CHANGED,we,this),n.off(f.default.TIME_SYNCHRONIZATION_COMPLETED,Me,this),n.off(f.default.WALLCLOCK_TIME_UPDATED,fe,this),n.off(A.default.METRIC_ADDED,xe,this)}(),h.reset(),E.reset(),p.clearAllCurrentMetrics(),T.setValue(null),m.reset(),k.reset(),U.reset(),z&&(D.detachMediaSource(W),z=null),W=null,Y&&(Y.setMediaElement(null),Y=null,x=null,T.getValue()&&n.trigger(f.default.PROTECTION_DESTROYED,{data:T.getValue().url})),n.trigger(f.default.STREAM_TEARDOWN_COMPLETE),Ke()}function xe(e){e.metric===r.default.DVR_INFO&&e.mediaType===t.default.AUDIO&&D.setSeekable(z,e.value.range.start,e.value.range.end)}return d={initialize:function(e,t){ke(),q=e,x=t,k.initialize(),(E=(0,l.default)(a).create()).setConfig({manifestModel:T,adapter:_,mediaPlayerModel:J,manifestLoader:m,errHandler:B,settings:se}),E.initialize(),h.setConfig({adapter:_}),function(){n.on(f.default.PLAYBACK_TIME_UPDATED,ue,this),n.on(f.default.PLAYBACK_SEEKING,ce,this),n.on(f.default.PLAYBACK_ERROR,Fe,this),n.on(f.default.PLAYBACK_STARTED,Ee,this),n.on(f.default.PLAYBACK_PAUSED,ge,this),n.on(f.default.PLAYBACK_ENDED,Ae,this),n.on(f.default.MANIFEST_UPDATED,Le,this),n.on(f.default.BUFFERING_COMPLETED,Te,this),n.on(f.default.STREAM_BUFFERING_COMPLETED,Se,this),n.on(f.default.MANIFEST_VALIDITY_CHANGED,we,this),n.on(f.default.TIME_SYNCHRONIZATION_COMPLETED,Me,this),n.on(f.default.WALLCLOCK_TIME_UPDATED,fe,this),n.on(A.default.METRIC_ADDED,xe,this)}()},getActiveStreamInfo:Be,isTrackTypePresent:Ne,switchToVideoElement:function(e){K&&(j.initialize(Be()),Pe(e,null,!0,!1))},getStreamById:function(e){return w.filter(function(t){return t.getId()===e})[0]},getStreamForTime:Ce,getTimeRelativeToStreamId:function(e,t){for(var i=null,r=0,a=0,o=null,n=w.length,l=0;l<n;l++){if(a=(i=w[l]).getStartTime(),o=i.getDuration(),Number.isFinite(a)&&(r=a),i.getId()===t)return e-r;Number.isFinite(o)&&(r+=o)}return null},load:function(e){ke(),m.load(e)},loadWithManifest:function(e){!function(){if(!E||!E.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),E.setManifest(e)},getActiveStreamProcessors:pe,setConfig:function(e){e&&(e.capabilities&&(c=e.capabilities),e.manifestLoader&&(m=e.manifestLoader),e.manifestModel&&(T=e.manifestModel),e.mediaPlayerModel&&(J=e.mediaPlayerModel),e.protectionController&&(Y=e.protectionController),e.adapter&&(_=e.adapter),e.dashMetrics&&(p=e.dashMetrics),e.errHandler&&(B=e.errHandler),e.timelineConverter&&(k=e.timelineConverter),e.videoModel&&(W=e.videoModel),e.playbackController&&(j=e.playbackController),e.abrController&&(M=e.abrController),e.mediaController&&(N=e.mediaController),e.textController&&(b=e.textController),e.settings&&(se=e.settings))},setProtectionData:function(e){x=e},reset:Ye},u=(0,v.default)(a).getInstance().getLogger(d),P=(0,I.default)(a).getInstance(),h=(0,O.default)(a).getInstance(),D=(0,R.default)(a).getInstance(),U=(0,S.default)(a).getInstance(),F=(0,C.default)(a).getInstance(),Ke(),d}U.__dashjs_factory_name="StreamController",exports.default=E.default.getSingletonFactory(U);
},{"../constants/Constants":"jJgo","../constants/MetricsConstants":"RxE2","../Stream":"r0Ba","../ManifestUpdater":"ba4o","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../vo/metrics/PlayList":"siyq","../../core/Debug":"iL1O","../utils/InitCache":"eXbI","../utils/URLUtils":"ogFR","../MediaPlayerEvents":"yxZg","./TimeSyncController":"muVL","./BaseURLController":"W31W","./MediaSourceController":"Un1z","../vo/DashJSError":"gyaG","../../core/errors/Errors":"Wrqa"}],"DBCd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=o(e),r=require("./FragmentRequest"),n=o(r);function o(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(e){function r(e,n){u(this,r);var o=i(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return o.url=e||null,o.type=n||null,o.mediaType=t.default.STREAM,o.responseType="",o}return s(r,n.default),r}();exports.default=a;
},{"../constants/Constants":"jJgo","./FragmentRequest":"Vb3t"}],"h0C4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./vo/DashJSError"),r=v(e),t=require("./net/HTTPLoader"),u=v(t),o=require("./vo/metrics/HTTPRequest"),a=require("./vo/TextRequest"),l=v(a),n=require("../core/EventBus"),s=v(n),d=require("../core/events/Events"),i=v(d),c=require("../core/FactoryMaker"),f=v(c),_=require("../core/errors/Errors"),E=v(_);function v(e){return e&&e.__esModule?e:{default:e}}function q(e){e=e||{};var t="urn:mpeg:dash:resolve-to-zero:2013",a=this.context,n=(0,s.default)(a).getInstance(),d=(0,u.default)(a).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier});return{load:function(e,u,a){var s=function(t,o){u.resolved=!0,u.resolvedContent=t||null,n.trigger(i.default.XLINK_ELEMENT_LOADED,{element:u,resolveObject:a,error:t||o?null:new r.default(E.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,E.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if(e===t)s(null,!0);else{var c=new l.default(e,o.HTTPRequest.XLINK_EXPANSION_TYPE);d.load({request:c,success:function(e){s(e)},error:function(){s(null)}})}},reset:function(){d&&(d.abort(),d=null)}}}q.__dashjs_factory_name="XlinkLoader",exports.default=f.default.getClassFactory(q);
},{"./vo/DashJSError":"gyaG","./net/HTTPLoader":"MYRf","./vo/metrics/HTTPRequest":"yMBz","./vo/TextRequest":"DBCd","../core/EventBus":"Opee","../core/events/Events":"W3G1","../core/FactoryMaker":"FHM8","../core/errors/Errors":"Wrqa"}],"uTsa":[function(require,module,exports) {
"use strict";function e(e){e=e||{},function(){void 0===e.escapeMode&&(e.escapeMode=!0);void 0===e.attributePrefix&&(e.attributePrefix="_");e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0);e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0);void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0);e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1);e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1);void 0===e.ignoreRoot&&(e.ignoreRoot=!1)}();var t={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function r(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function n(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function i(e,t,r,n){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==n)break}else if(a instanceof RegExp){if(a.test(n))break}else if("function"==typeof a&&a(t,r,n))break}return i!=e.length}function a(t,r,n){switch(e.arrayAccessForm){case"property":t[r]instanceof Array?t[r+"_asArray"]=t[r]:t[r+"_asArray"]=[t[r]]}!(t[r]instanceof Array)&&e.arrayAccessFormPaths.length>0&&i(e.arrayAccessFormPaths,t,r,n)&&(t[r]=[t[r]])}function s(e){var t=e.split(/[-T:+Z]/g),r=new Date(t[0],t[1]-1,t[2]),n=t[5].split(".");if(r.setHours(t[3],t[4],n[0]),n.length>1&&r.setMilliseconds(n[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),r.setMinutes(r.getMinutes()-i-r.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(r=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())));return r}function o(r,n,a,s){return!(n==t.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||i(e.xmlElementsFilter,r,a,s)}function l(n,c){if(n.nodeType==t.DOCUMENT_NODE){for(var u=new Object,_=n.childNodes,f=0;f<_.length;f++){if((p=_[f]).nodeType==t.ELEMENT_NODE)if(e.ignoreRoot)u=l(p);else(u={})[x=r(p)]=l(p)}return u}if(n.nodeType==t.ELEMENT_NODE){(u=new Object).__cnt=0;var d=[];for(_=n.childNodes,f=0;f<_.length;f++){var p,x=r(p=_[f]);if(p.nodeType!=t.COMMENT_NODE){var m=c+"."+x;if(o(u,p.nodeType,x,m))if(u.__cnt++,null==u[x]){var g=l(p,m);if("#text"!=x||/[^\s]/.test(g))(h={})[x]=g,d.push(h);u[x]=g,a(u,x,m)}else{null!=u[x]&&(u[x]instanceof Array||(u[x]=[u[x]],a(u,x,m)));var h;g=l(p,m);if("#text"!=x||/[^\s]/.test(g))(h={})[x]=g,d.push(h);u[x][u[x].length]=g}}}u.__children=d;for(var v=r(n),y=0;y<n.attributes.length;y++){var O=n.attributes[y];u.__cnt++;for(var E=O.value,N=0,T=e.matchers.length;N<T;N++){var D=e.matchers[N];D.test(O,v)&&(E=D.converter(O.value))}u[e.attributePrefix+O.name]=E}var b=function(e){return e.prefix}(n);return null!=b&&""!=b&&(u.__cnt++,u.__prefix=b),null!=u["#text"]&&(u.__text=u["#text"],u.__text instanceof Array&&(u.__text=u.__text.join("\n")),e.stripWhitespaces&&(u.__text=u.__text.trim()),delete u["#text"],"property"==e.arrayAccessForm&&delete u["#text_asArray"],u.__text=function(t,r,n){if(e.datetimeAccessFormPaths.length>0){var a=n.split(".#")[0];return i(e.datetimeAccessFormPaths,t,r,a)?s(t):t}return t}(u.__text,x,c+"."+x)),null!=u["#cdata-section"]&&(u.__cdata=u["#cdata-section"],delete u["#cdata-section"],"property"==e.arrayAccessForm&&delete u["#cdata-section_asArray"]),0==u.__cnt&&"text"==e.emptyNodeForm?u="":1==u.__cnt&&null!=u.__text?u=u.__text:1!=u.__cnt||null==u.__cdata||e.keepCData?u.__cnt>1&&null!=u.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==u.__text||""==u.__text.trim())&&delete u.__text:u=u.__cdata,delete u.__cnt,!e.enableToStringFunc||null==u.__text&&null==u.__cdata||(u.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),u}if(n.nodeType==t.TEXT_NODE||n.nodeType==t.CDATA_SECTION_NODE)return n.nodeValue}function c(t,r,i,a){var s="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+r;if(null!=i)for(var o=0;o<i.length;o++){var l=i[o],c=t[l];e.escapeMode&&(c=n(c)),s+=" "+l.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?s+='"'+c+'"':s+="'"+c+"'"}return s+=a?"/>":">"}function u(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function _(t,r){return"property"==e.arrayAccessForm&&(n=r.toString(),i="_asArray",-1!==n.indexOf(i,n.length-i.length))||0==r.toString().indexOf(e.attributePrefix)||0==r.toString().indexOf("__")||t[r]instanceof Function;var n,i}function f(e){var t=0;if(e instanceof Object)for(var r in e)_(e,r)||t++;return t}function d(t,r,n){return 0==e.jsonPropertiesFilter.length||""==n||i(e.jsonPropertiesFilter,t,r,n)}function p(t){var r=[];if(t instanceof Object)for(var n in t)-1==n.toString().indexOf("__")&&0==n.toString().indexOf(e.attributePrefix)&&r.push(n);return r}function x(t){var r="";return t instanceof Object?r+=function(t){var r="";return null!=t.__cdata&&(r+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?r+=n(t.__text):r+=t.__text),r}(t):null!=t&&(e.escapeMode?r+=n(t):r+=t),r}function m(e,t){return""===e?t:e+"."+t}function g(e,t,r,n){var i="";if(0==e.length)i+=c(e,t,r,!0);else for(var a=0;a<e.length;a++)i+=c(e[a],t,p(e[a]),!1),i+=h(e[a],m(n,t)),i+=u(e[a],t);return i}function h(e,t){var r="";if(f(e)>0)for(var n in e)if(!_(e,n)&&(""==t||d(e,n,m(t,n)))){var i=e[n],a=p(i);if(null==i||null==i)r+=c(i,n,a,!0);else if(i instanceof Object)if(i instanceof Array)r+=g(i,n,a,t);else if(i instanceof Date)r+=c(i,n,a,!1),r+=i.toISOString(),r+=u(i,n);else{f(i)>0||null!=i.__text||null!=i.__cdata?(r+=c(i,n,a,!1),r+=h(i,m(t,n)),r+=u(i,n)):r+=c(i,n,a,!0)}else r+=c(i,n,a,!1),r+=x(i),r+=u(i,n)}return r+=x(e)}this.parseXmlString=function(e){var t;window.ActiveXObject||window;if(void 0===e)return null;if(window.DOMParser){var r=new window.DOMParser;try{(t=r.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(n){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?s(e):e},this.xml2json=function(e){return l(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return h(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"mvxz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../XlinkLoader"),t=h(e),r=require("../../core/EventBus"),n=h(r),o=require("../../core/events/Events"),a=h(o),l=require("../../core/FactoryMaker"),s=h(l),i=require("../../../externals/xml2json"),d=h(i),u=require("../utils/URLUtils"),f=h(u),v=require("../../dash/constants/DashConstants"),c=h(v);function h(e){return e&&e.__esModule?e:{default:e}}var p="onLoad",E="onActuate",A="urn:mpeg:dash:resolve-to-zero:2013";function _(e){e=e||{};var r=this.context,o=(0,n.default)(r).getInstance(),l=(0,f.default)(r).getInstance(),s=void 0,i=void 0,u=void 0,v=void 0,h=void 0,_=void 0;function y(e,t,r){var n={},o=void 0,a=void 0;n.elements=e,n.type=t,n.resolveType=r,0===n.elements.length&&m(n);for(var s=0;s<n.elements.length;s++)o=n.elements[s],a=l.isHTTPURL(o.url)?o.url:o.originalContent.BaseURL+o.url,_.load(a,o,n)}function T(e){var t,r=void 0,n="";if(r=e.element,t=e.resolveObject,r.resolvedContent){var o=0;0===r.resolvedContent.indexOf("<?xml")&&(o=r.resolvedContent.indexOf("?>")+2),n=r.resolvedContent.substr(0,o)+"<response>"+r.resolvedContent.substr(o)+"</response>",r.resolvedContent=h.xml_str2json(n)}(function(e){var t=void 0;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0})(t)&&m(t)}function m(e){var t=[],r=void 0,n=void 0;if(function(e){var t=[],r=void 0,n=void 0,o=void 0,a=void 0,l=void 0,s=void 0;for(a=e.elements.length-1;a>=0;a--){if(r=e.elements[a],n=r.type+"_asArray",r.resolvedContent){if(r.resolvedContent)for(l=0;l<r.resolvedContent[n].length;l++)o=r.resolvedContent[n][l],t.push(o)}else delete r.originalContent["xlink:actuate"],delete r.originalContent["xlink:href"],t.push(r.originalContent);for(r.parentElement[n].splice(r.index,1),s=0;s<t.length;s++)r.parentElement[n].splice(r.index+s,0,t[s]);t=[]}e.elements.length>0&&u.run(v)}(e),e.resolveType===E&&o.trigger(a.default.XLINK_READY,{manifest:v}),e.resolveType===p)switch(e.type){case c.default.PERIOD:for(r=0;r<v[c.default.PERIOD+"_asArray"].length;r++)(n=v[c.default.PERIOD+"_asArray"][r]).hasOwnProperty(c.default.ADAPTATION_SET+"_asArray")&&(t=t.concat(g(n[c.default.ADAPTATION_SET+"_asArray"],n,c.default.ADAPTATION_SET,p))),n.hasOwnProperty(c.default.EVENT_STREAM+"_asArray")&&(t=t.concat(g(n[c.default.EVENT_STREAM+"_asArray"],n,c.default.EVENT_STREAM,p)));y(t,c.default.ADAPTATION_SET,p);break;case c.default.ADAPTATION_SET:o.trigger(a.default.XLINK_READY,{manifest:v})}}function g(e,t,r,n){var o=[],a=void 0,l=void 0,s=void 0;for(l=e.length-1;l>=0;l--)(a=e[l]).hasOwnProperty("xlink:href")&&a["xlink:href"]===A&&e.splice(l,1);for(l=0;l<e.length;l++)(a=e[l]).hasOwnProperty("xlink:href")&&a.hasOwnProperty("xlink:actuate")&&a["xlink:actuate"]===n&&(s=O(a["xlink:href"],t,r,l,n,a),o.push(s));return o}function O(e,t,r,n,o,a){return{url:e,parentElement:t,type:r,index:n,resolveType:o,originalContent:a,resolvedContent:null,resolved:!1}}return s={resolveManifestOnLoad:function(e){h=new d.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:i}),y(g((v=e).Period_asArray,v,c.default.PERIOD,p),c.default.PERIOD,p)},setMatchers:function(e){e&&(i=e)},setIron:function(e){e&&(u=e)},reset:function(){o.off(a.default.XLINK_ELEMENT_LOADED,T,s),_&&(_.reset(),_=null)}},o.on(a.default.XLINK_ELEMENT_LOADED,T,s),_=(0,t.default)(r).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier}),s}_.__dashjs_factory_name="XlinkController",exports.default=s.default.getClassFactory(_);
},{"../XlinkLoader":"h0C4","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8","../../../externals/xml2json":"uTsa","../utils/URLUtils":"ogFR","../../dash/constants/DashConstants":"wYnc"}],"eKHY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=require("../../core/FactoryMaker"),n=t(r);function t(e){return e&&e.__esModule?e:{default:e}}function o(r){function n(e,r){for(var n in e)r.hasOwnProperty(n)||(r[n]=e[n])}function t(r,t,o){for(var a=0,i=r.length;a<i;++a){var f=r[a];if(t[f.name])if(o[f.name]){if(f.merge){var u=t[f.name],c=o[f.name];"object"===(void 0===u?"undefined":e(u))&&"object"===(void 0===c?"undefined":e(c))?n(u,c):o[f.name]=u+c}}else o[f.name]=t[f.name]}}function o(e,r){for(var n=0,a=e.children.length;n<a;++n){var i=e.children[n],f=r[i.name+"_asArray"];if(f)for(var u=0,c=f.length;u<c;++u){var d=f[u];t(e.properties,r,d),o(i,d)}}}return{run:function(n){if(null===n||"object"!==(void 0===n?"undefined":e(n)))return n;if("period"in r)for(var t=r.period,a=n.Period_asArray,i=0,f=a.length;i<f;++i){var u=a[i];if(o(t,u),"adaptationset"in r){var c=u.AdaptationSet_asArray;if(c)for(var d=r.adaptationset,l=0,s=c.length;l<s;++l)o(d,c[l])}}return n}}}o.__dashjs_factory_name="ObjectIron";var a=n.default.getClassFactory(o);exports.default=a;
},{"../../core/FactoryMaker":"FHM8"}],"xKz0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function n(e,r){t(this,n),this._test=e,this._converter=r}return e(n,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),n}();exports.default=n;
},{}],"Jf9I":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./BaseMatcher"),t=f(e),u=require("../../constants/DashConstants"),a=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function l(e,t,u){return t in e?Object.defineProperty(e,t,{value:u,enumerable:!0,configurable:!0,writable:!0}):e[t]=u,e}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(e){function u(){return E(this,u),d(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,function(e,t){var u,f=(l(u={},a.default.MPD,[a.default.ID,a.default.PROFILES]),l(u,a.default.PERIOD,[a.default.ID]),l(u,a.default.BASE_URL,[a.default.SERVICE_LOCATION,a.default.BYTE_RANGE]),l(u,a.default.SEGMENT_BASE,[a.default.INDEX_RANGE]),l(u,a.default.INITIALIZATION,[a.default.RANGE]),l(u,a.default.REPRESENTATION_INDEX,[a.default.RANGE]),l(u,a.default.SEGMENT_LIST,[a.default.INDEX_RANGE]),l(u,a.default.BITSTREAM_SWITCHING,[a.default.RANGE]),l(u,a.default.SEGMENT_URL,[a.default.MEDIA_RANGE,a.default.INDEX_RANGE]),l(u,a.default.SEGMENT_TEMPLATE,[a.default.INDEX_RANGE,a.default.MEDIA,a.default.INDEX,a.default.INITIALIZATION_MINUS,a.default.BITSTREAM_SWITCHING_MINUS]),l(u,a.default.ASSET_IDENTIFIER,[a.default.VALUE,a.default.ID]),l(u,a.default.EVENT_STREAM,[a.default.VALUE]),l(u,a.default.ADAPTATION_SET,[a.default.PROFILES,a.default.MIME_TYPE,a.default.SEGMENT_PROFILES,a.default.CODECS,a.default.CONTENT_TYPE]),l(u,a.default.FRAME_PACKING,[a.default.VALUE,a.default.ID]),l(u,a.default.AUDIO_CHANNEL_CONFIGURATION,[a.default.VALUE,a.default.ID]),l(u,a.default.CONTENT_PROTECTION,[a.default.VALUE,a.default.ID]),l(u,a.default.ESSENTIAL_PROPERTY,[a.default.VALUE,a.default.ID]),l(u,a.default.SUPPLEMENTAL_PROPERTY,[a.default.VALUE,a.default.ID]),l(u,a.default.INBAND_EVENT_STREAM,[a.default.VALUE,a.default.ID]),l(u,a.default.ACCESSIBILITY,[a.default.VALUE,a.default.ID]),l(u,a.default.ROLE,[a.default.VALUE,a.default.ID]),l(u,a.default.RATING,[a.default.VALUE,a.default.ID]),l(u,a.default.VIEWPOINT,[a.default.VALUE,a.default.ID]),l(u,a.default.CONTENT_COMPONENT,[a.default.CONTENT_TYPE]),l(u,a.default.REPRESENTATION,[a.default.ID,a.default.DEPENDENCY_ID,a.default.MEDIA_STREAM_STRUCTURE_ID]),l(u,a.default.SUBSET,[a.default.ID]),l(u,a.default.METRICS,[a.default.METRICS_MINUS]),l(u,a.default.REPORTING,[a.default.VALUE,a.default.ID]),u);if(f.hasOwnProperty(t)){var E=f[t];return void 0!==E&&E.indexOf(e.name)>=0}return!1},function(e){return String(e)}))}return I(u,t.default),u}();exports.default=r;
},{"./BaseMatcher":"xKz0","../../constants/DashConstants":"wYnc"}],"de51":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./BaseMatcher"),t=u(e),r=require("../../../streaming/constants/Constants"),n=u(r),o=require("../../constants/DashConstants"),a=u(o);function u(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,c=31536e3,p=2592e3,_=86400,d=3600,T=60,E=function(e){function r(){return s(this,r),f(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,function(e){for(var t=[a.default.MIN_BUFFER_TIME,a.default.MEDIA_PRESENTATION_DURATION,a.default.MINIMUM_UPDATE_PERIOD,a.default.TIMESHIFT_BUFFER_DEPTH,a.default.MAX_SEGMENT_DURATION,a.default.MAX_SUBSEGMENT_DURATION,n.default.SUGGESTED_PRESENTATION_DELAY,a.default.START,n.default.START_TIME,a.default.DURATION],r=t.length,o=0;o<r;o++)if(e.nodeName===t[o])return i.test(e.value);return!1},function(e){var t=i.exec(e),r=parseFloat(t[2]||0)*c+parseFloat(t[4]||0)*p+parseFloat(t[6]||0)*_+parseFloat(t[8]||0)*d+parseFloat(t[10]||0)*T+parseFloat(t[12]||0);return void 0!==t[1]&&(r=-r),r}))}return l(r,t.default),r}();exports.default=E;
},{"./BaseMatcher":"xKz0","../../../streaming/constants/Constants":"jJgo","../../constants/DashConstants":"wYnc"}],"H6tO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./BaseMatcher"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=60,s=60,i=1e3,c=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,f=function(e){function r(){return n(this,r),o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,function(e){return c.test(e.value)},function(e){var t=c.exec(e),r=void 0;if(r=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&parseFloat(t[7])*i||0),t[9]&&t[10]){var n=parseInt(t[9],10)*s+parseInt(t[10],10);r+=("+"===t[8]?-1:1)*n*u*i}return new Date(r)}))}return a(r,t.default),r}();exports.default=f;
},{"./BaseMatcher":"xKz0"}],"lJSC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./BaseMatcher"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,c=function(e){function r(){return n(this,r),o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,function(e){return i.test(e.value)},function(e){return parseFloat(e)}))}return u(r,t.default),r}();exports.default=c;
},{"./BaseMatcher":"xKz0"}],"Ftmz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function n(e){t(this,n);var r;this._name=e,this._merge=(r=e)&&r.length&&r.charAt(0)===r.charAt(0).toUpperCase()}return e(n,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),n}();exports.default=n;
},{}],"asQg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),r=require("./CommonProperty"),t=n(r);function n(e){return e&&e.__esModule?e:{default:e}}function i(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var o=function(){function r(e,n,o){var u=this;i(this,r),this._name=e||"",this._properties=[],this._children=o||[],Array.isArray(n)&&n.forEach(function(e){u._properties.push(new t.default(e))})}return e(r,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),r}();exports.default=o;
},{"./CommonProperty":"Ftmz"}],"Ttj2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./MapNode"),t=f(e),u=require("../../constants/DashConstants"),a=f(u);function f(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(e){function u(){n(this,u);var e=[a.default.PROFILES,a.default.WIDTH,a.default.HEIGHT,a.default.SAR,a.default.FRAMERATE,a.default.AUDIO_SAMPLING_RATE,a.default.MIME_TYPE,a.default.SEGMENT_PROFILES,a.default.CODECS,a.default.MAXIMUM_SAP_PERIOD,a.default.START_WITH_SAP,a.default.MAX_PLAYOUT_RATE,a.default.CODING_DEPENDENCY,a.default.SCAN_TYPE,a.default.FRAME_PACKING,a.default.AUDIO_CHANNEL_CONFIGURATION,a.default.CONTENT_PROTECTION,a.default.ESSENTIAL_PROPERTY,a.default.SUPPLEMENTAL_PROPERTY,a.default.INBAND_EVENT_STREAM];return o(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,a.default.ADAPTATION_SET,e,[new t.default(a.default.REPRESENTATION,e,[new t.default(a.default.SUB_REPRESENTATION,e)])]))}return r(u,t.default),u}();exports.default=l;
},{"./MapNode":"asQg","../../constants/DashConstants":"wYnc"}],"VY2F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./MapNode"),t=r(e),n=require("../../constants/DashConstants"),o=r(n);function r(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(e){function n(){u(this,n);var e=[o.default.SEGMENT_BASE,o.default.SEGMENT_TEMPLATE,o.default.SEGMENT_LIST];return a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,o.default.PERIOD,e,[new t.default(o.default.ADAPTATION_SET,e,[new t.default(o.default.REPRESENTATION,e)])]))}return f(n,t.default),n}();exports.default=i;
},{"./MapNode":"asQg","../../constants/DashConstants":"wYnc"}],"m0wY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),r=q(e),t=require("../../core/Debug"),a=q(t),o=require("./objectiron"),n=q(o),i=require("../../../externals/xml2json"),s=q(i),u=require("./matchers/StringMatcher"),c=q(u),d=require("./matchers/DurationMatcher"),f=q(d),l=require("./matchers/DateTimeMatcher"),m=q(l),p=require("./matchers/NumericMatcher"),w=q(p),h=require("./maps/RepresentationBaseValuesMap"),g=q(h),v=require("./maps/SegmentValuesMap"),M=q(v);function q(e){return e&&e.__esModule?e:{default:e}}function _(){var e=this.context,r=void 0,t=void 0,o=void 0,i=void 0,u=void 0;return r={parse:function(e){var r,a=window.performance.now();if(!(r=i.xml_str2json(e)))throw new Error("parsing the manifest failed");var o=window.performance.now();u.run(r);var n=window.performance.now();return t.info("Parsing complete: ( xml2json: "+(o-a).toPrecision(3)+"ms, objectiron: "+(n-o).toPrecision(3)+"ms, total: "+((n-a)/1e3).toPrecision(3)+"s)"),r},getMatchers:function(){return o},getIron:function(){return u}},t=(0,a.default)(e).getInstance().getLogger(r),o=[new f.default,new m.default,new w.default,new c.default],i=new s.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:o}),u=(0,n.default)(e).create({adaptationset:new g.default,period:new M.default}),r}_.__dashjs_factory_name="DashParser",exports.default=r.default.getClassFactory(_);
},{"../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","./objectiron":"eKHY","../../../externals/xml2json":"uTsa","./matchers/StringMatcher":"Jf9I","./matchers/DurationMatcher":"de51","./matchers/DateTimeMatcher":"H6tO","./matchers/NumericMatcher":"lJSC","./maps/RepresentationBaseValuesMap":"Ttj2","./maps/SegmentValuesMap":"VY2F"}],"JmtG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./constants/Constants"),r=v(e),t=require("./controllers/XlinkController"),a=v(t),l=require("./net/HTTPLoader"),s=v(l),i=require("./utils/URLUtils"),u=v(i),n=require("./vo/TextRequest"),o=v(n),d=require("./vo/DashJSError"),E=v(d),_=require("./vo/metrics/HTTPRequest"),f=require("../core/EventBus"),R=v(f),A=require("../core/events/Events"),I=v(A),c=require("../core/errors/Errors"),M=v(c),L=require("../core/FactoryMaker"),N=v(L),O=require("../dash/parser/DashParser"),D=v(O),S=require("../core/Debug"),T=v(S);function v(e){return e&&e.__esModule?e:{default:e}}function g(e){e=e||{};var t=this.context,l=(0,R.default)(t).getInstance(),i=(0,u.default)(t).getInstance(),n=void 0,d=void 0,f=void 0,A=void 0,c=void 0,L=e.mssHandler,N=e.errHandler;function O(e){l.trigger(I.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}return n={load:function(e){var a=new o.default(e,_.HTTPRequest.MPD_TYPE);f.load({request:a,success:function(a,s,u){if(A){var n=void 0,o=void 0,_=void 0;if(u&&u!==e?(o=i.parseBaseUrl(u),n=u):(i.isRelative(e)&&(e=i.resolve(e,window.location.href)),o=i.parseBaseUrl(e)),null===c&&(c=function(e){var r=null;return e.indexOf("SmoothStreamingMedia")>-1?(L&&(r=L.createMssParser(),L.registerEvents()),r):e.indexOf("MPD")>-1?(0,D.default)(t).create():r}(a)),null!==c){A.setMatchers(c.getMatchers()),A.setIron(c.getIron());try{_=c.parse(a)}catch(f){return void l.trigger(I.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new E.default(M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}_?(_.url=n||e,_.originalUrl||(_.originalUrl=_.url),_.hasOwnProperty(r.default.LOCATION)&&(o=i.parseBaseUrl(_.Location_asArray[0]),d.debug("BaseURI set by Location to: "+o)),_.baseUri=o,_.loadedTime=new Date,A.resolveManifestOnLoad(_)):l.trigger(I.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new E.default(M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}else l.trigger(I.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new E.default(M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}},error:function(r,t,a){l.trigger(I.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new E.default(M.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,M.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+(e+", ")+a)})}})},reset:function(){l.off(I.default.XLINK_READY,O,n),A&&(A.reset(),A=null),f&&(f.abort(),f=null),L&&L.reset()}},d=(0,T.default)(t).getInstance().getLogger(n),l.on(I.default.XLINK_READY,O,n),f=(0,s.default)(t).create({errHandler:N,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier}),A=(0,a.default)(t).create({errHandler:N,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier}),c=null,n}g.__dashjs_factory_name="ManifestLoader";var F=N.default.getClassFactory(g);exports.default=F;
},{"./constants/Constants":"jJgo","./controllers/XlinkController":"mvxz","./net/HTTPLoader":"MYRf","./utils/URLUtils":"ogFR","./vo/TextRequest":"DBCd","./vo/DashJSError":"gyaG","./vo/metrics/HTTPRequest":"yMBz","../core/EventBus":"Opee","../core/events/Events":"W3G1","../core/errors/Errors":"Wrqa","../core/FactoryMaker":"FHM8","../dash/parser/DashParser":"m0wY","../core/Debug":"iL1O"}],"UAeI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/EventBus"),r=a(e),t=require("../../core/events/Events"),n=a(t),o=require("../../core/FactoryMaker"),u=a(o);function a(e){return e&&e.__esModule?e:{default:e}}function c(){var e=this.context,t=(0,r.default)(e).getInstance();return{error:function(e){t.trigger(n.default.ERROR,{error:e})}}}c.__dashjs_factory_name="ErrorHandler",exports.default=u.default.getSingletonFactory(c);
},{"../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8"}],"e9Cw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}function i(){var e,r=void 0;return e={supportsMediaSource:function(){var e="WebKitMediaSource"in window,r="MediaSource"in window;return e||r},supportsEncryptedMedia:function(){return r},supportsCodec:function(e){return!!("MediaSource"in window&&MediaSource.isTypeSupported(e))||!!("WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(e))},setEncryptedMediaSupported:function(e){r=e}},r=!1,e}i.__dashjs_factory_name="Capabilities",exports.default=r.default.getSingletonFactory(i);
},{"../../core/FactoryMaker":"FHM8"}],"mI6y":[function(require,module,exports) {
"use strict";function t(t,l){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var l=function l(){t(this,l),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};exports.default=l;
},{}],"OQcj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../vo/URIFragmentData"),r=a(e),t=require("../../core/FactoryMaker"),n=a(t);function a(e){return e&&e.__esModule?e:{default:e}}function u(){var e=void 0;return{initialize:function(t){if(e=new r.default,!t)return null;var n=t.indexOf("#");if(-1!==n)for(var a=t.substr(n+1).split("&"),u=0,i=a.length;u<i;++u){var o=a[u],f=o.indexOf("=");if(-1!==f){var s=o.substring(0,f);e.hasOwnProperty(s)&&(e[s]=o.substr(f+1))}}},getURIFragmentData:function(){return e}}}u.__dashjs_factory_name="URIFragmentModel",exports.default=n.default.getSingletonFactory(u);
},{"../vo/URIFragmentData":"mI6y","../../core/FactoryMaker":"FHM8"}],"EELk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/EventBus"),t=o(e),r=require("../../core/events/Events"),n=o(r),u=require("../../core/FactoryMaker"),a=o(u);function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,r=(0,t.default)(e).getInstance(),u=void 0;return{getValue:function(){return u},setValue:function(e){u=e,e&&r.trigger(n.default.MANIFEST_LOADED,{data:e})}}}s.__dashjs_factory_name="ManifestModel",exports.default=a.default.getSingletonFactory(s);
},{"../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8"}],"KFq0":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function t(){e(this,t),this.schemeIdUri="",this.value=""};exports.default=t;
},{}],"sSCB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../dash/vo/UTCTiming"),t=g(e),r=require("../../core/FactoryMaker"),n=g(r),i=require("../constants/Constants"),a=g(i),u=require("../rules/abr/ABRRulesCollection"),o=g(u),s=require("../../core/Settings"),l=g(s),c=require("../utils/SupervisorTools");function g(e){return e&&e.__esModule?e:{default:e}}var f=12,m=20,d=3,v=10,y=5,T=!1;function p(){var e,r=void 0,n=void 0,i=void 0,u={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso&ms"},s=this.context,g=(0,l.default)(s).getInstance();function p(e){var t=void 0;for(t=0;t<i.length;t++)if(i[t].rulename===e)return t;return-1}function h(e,n){R(e,n);var i=new t.default;i.schemeIdUri=e,i.value=n,r.push(i)}function R(e,t){(0,c.checkParameterType)(e,"string"),(0,c.checkParameterType)(t,"string"),r.forEach(function(n,i){n.schemeIdUri===e&&n.value===t&&r.splice(i,1)})}return e={getABRCustomRules:function(){return i},addABRCustomRule:function(e,t,r){if("string"!=typeof e||e!==o.default.ABANDON_FRAGMENT_RULES&&e!==o.default.QUALITY_SWITCH_RULES||"string"!=typeof t)throw a.default.BAD_ARGUMENT_ERROR;var n=p(t);-1===n?i.push({type:e,rulename:t,rule:r}):(i[n].type=e,i[n].rule=r)},removeABRCustomRule:function(e){if(e){var t=p(e);-1!==t&&i.splice(t,1)}else i=[]},getStableBufferTime:function(){if(g.get().streaming.lowLatencyEnabled)return.6*g.get().streaming.liveDelay;var e=g.get().streaming.stableBufferTime;return e>-1?e:g.get().streaming.fastSwitchEnabled?m:f},getRetryAttemptsForType:function(e){return g.get().streaming.lowLatencyEnabled?g.get().streaming.retryAttempts[e]*y:g.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){return g.get().streaming.lowLatencyEnabled?g.get().streaming.retryIntervals[e]/v:g.get().streaming.retryIntervals[e]},getLiveDelay:function(){return g.get().streaming.lowLatencyEnabled?g.get().streaming.liveDelay||d:g.get().streaming.liveDelay},addUTCTimingSource:h,removeUTCTimingSource:R,getUTCTimingSources:function(){return r},clearDefaultUTCTimingSources:function(){r=[]},restoreDefaultUTCTimingSources:function(){h(u.scheme,u.value)},setXHRWithCredentialsForType:function e(t,r){t?n[t]=!!r:Object.keys(n).forEach(function(t){e(t,r)})},getXHRWithCredentialsForType:function(e){var t=n[e];return void 0===t?n.default:t},getDefaultUtcTimingSource:function(){return u},reset:function(){}},r=[],n={default:T},i=[],e}p.__dashjs_factory_name="MediaPlayerModel",exports.default=n.default.getSingletonFactory(p);
},{"../../dash/vo/UTCTiming":"KFq0","../../core/FactoryMaker":"FHM8","../constants/Constants":"jJgo","../rules/abr/ABRRulesCollection":"uS6f","../../core/Settings":"yjrH","../utils/SupervisorTools":"A0aa"}],"GvOP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=c(e),n=require("../../core/EventBus"),i=c(n),r=require("../../core/events/Events"),a=c(r),u=require("../../core/Debug"),o=c(u);function c(e){return e&&e.__esModule?e:{default:e}}function d(){var e=void 0,t=void 0,n=void 0,r=void 0,u=void 0,c="element is not video or audio DOM type!",d=this.context,l=(0,i.default)(d).getInstance(),f=[];function s(){n&&(n.playbackRate=u||1,n.removeEventListener("canplay",s))}function g(e){n&&(n.readyState<=2&&e>0?n.addEventListener("canplay",s):n.playbackRate=e)}function v(){return f.length>0}function p(e){var t=f.indexOf(e),i=void 0;null!==e&&(-1!==t&&f.splice(t,1),n&&!1===v()&&0===n.playbackRate&&(g(u||1),n.paused||((i=document.createEvent("Event")).initEvent("playing",!0,!1),n.dispatchEvent(i))))}function T(){if(n&&v()&&0===n.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),n.dispatchEvent(e)}}function y(){return n?n.buffered:null}return e={initialize:function(){l.on(a.default.PLAYBACK_PLAYING,T,this)},setCurrentTime:function(e,t){if(n){if(n.currentTime==e)return;try{e=t?function(e){var t=y(),n=e,i=9999999999;if(t)for(var r=0;r<t.length;r++){var a=t.start(r),u=t.end(r),o=Math.abs(a-e),c=Math.abs(u-e);if(e>=a&&e<=u)return e;o<i&&(i=o,n=a),c<i&&(i=c,n=u)}return n}(e):e,n.currentTime=e}catch(i){0===n.readyState&&i.code===i.INVALID_STATE_ERR&&setTimeout(function(){n.currentTime=e},400)}}},play:function(){if(n){n.autoplay=!0;var e=n.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&l.trigger(a.default.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing ("+e+")")})}},isPaused:function(){return n?n.paused:null},pause:function(){n&&(n.pause(),n.autoplay=!1)},isSeeking:function(){return n?n.seeking:null},getTime:function(){return n?n.currentTime:null},getPlaybackRate:function(){return n?n.playbackRate:null},setPlaybackRate:g,getPlayedRanges:function(){return n?n.played:null},getEnded:function(){return n?n.ended:null},setStallState:function(e,t){!function(e,t){t?function(e){var t=void 0;null===e||n.seeking||-1!==f.indexOf(e)||(f.push(e),n&&1===f.length&&((t=document.createEvent("Event")).initEvent("waiting",!0,!1),u=n.playbackRate,g(0),n.dispatchEvent(t)))}(e):p(e)}(e,t)},getElement:function(){return n},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw c;(n=e)&&(n.preload="auto")},setSource:function(e){n&&(e?n.src=e:(n.removeAttribute("src"),n.load()))},getSource:function(){return n?n.src:null},getTTMLRenderingDiv:function(){return r},setTTMLRenderingDiv:function(e){(r=e).style.position="absolute",r.style.display="flex",r.style.overflow="hidden",r.style.pointerEvents="none",r.style.top=0,r.style.left=0},getPlaybackQuality:function(){if(!n)return null;var e="webkitDroppedFrameCount"in n&&"webkitDecodedFrameCount"in n,t=null;return"getVideoPlaybackQuality"in n?t=n.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:n.webkitDroppedFrameCount,totalVideoFrames:n.webkitDroppedFrameCount+n.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:function(e,t){n&&n.addEventListener(e,t)},removeEventListener:function(e,t){n&&n.removeEventListener(e,t)},getReadyState:function(){return n?n.readyState:NaN},getBufferRange:y,getClientWidth:function(){return n?n.clientWidth:NaN},getClientHeight:function(){return n?n.clientHeight:NaN},getTextTracks:function(){return n?n.textTracks:[]},getTextTrack:function(e,t,i,r,a){if(n)for(var u=0;u<n.textTracks.length;u++)if(n.textTracks[u].kind===e&&(!t||n.textTracks[u].label==t)&&n.textTracks[u].language===i&&n.textTracks[u].isTTML===r&&n.textTracks[u].isEmbedded===a)return n.textTracks[u];return null},addTextTrack:function(e,t,i){return n?n.addTextTrack(e,t,i):null},appendChild:function(e){n&&(n.appendChild(e),void 0!==e.isTTML&&(n.textTracks[n.textTracks.length-1].isTTML=e.isTTML,n.textTracks[n.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){n&&n.removeChild(e)},getVideoWidth:function(){return n?n.videoWidth:NaN},getVideoHeight:function(){return n?n.videoHeight:NaN},getVideoRelativeOffsetTop:function(){return n&&n.parentNode?n.getBoundingClientRect().top-n.parentNode.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){return n&&n.parentNode?n.getBoundingClientRect().left-n.parentNode.getBoundingClientRect().left:NaN},reset:function(){l.off(a.default.PLAYBACK_PLAYING,T,this)}},t=(0,o.default)(d).getInstance().getLogger(e),e}d.__dashjs_factory_name="VideoModel",exports.default=t.default.getSingletonFactory(d);
},{"../../core/FactoryMaker":"FHM8","../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/Debug":"iL1O"}],"H4bj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/FactoryMaker"),t=i(e),a=require("../../core/Debug"),r=i(a),s=require("../constants/Constants"),n=i(s);function i(e){return e&&e.__esModule?e:{default:e}}var o=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],g="dashjs_?_bitrate",c="dashjs_?_settings",d="localStorage",l="sessionStorage",u="lastBitrate",f="lastMediaSettings";function m(e){e=e||{};var t=this.context,a=e.settings,s=void 0,i=void 0,m=void 0;function v(e){if(void 0!==m)return m;m=!1;var t=void 0;try{"undefined"!=typeof window&&(t=window[e])}catch(a){return i.warn("DOMStorage access denied: "+a.message),m}if(!t||e!==d&&e!==l)return m;try{t.setItem("1","1"),t.removeItem("1"),m=!0}catch(a){i.warn("DOMStorage is supported, but cannot be used: "+a.message)}return m}function S(){return 6e5*Math.round((new Date).getTime()/6e5)}function _(e,t){return v(e)&&a.get().streaming[t+"CachingInfo"].enabled}function h(){if(!a)throw new Error(n.default.MISSING_CONFIG_ERROR)}return s={getSavedBitrateSettings:function(e){var t=NaN;if(h(),_(d,u)){var r=g.replace(/\?/,e);try{var s=JSON.parse(localStorage.getItem(r))||{},n=(new Date).getTime()-parseInt(s.timestamp,10)>=a.get().streaming.lastBitrateCachingInfo.ttl||!1,o=parseFloat(s.bitrate);isNaN(o)||n?n&&localStorage.removeItem(r):(t=o,i.debug("Last saved bitrate for "+e+" was "+o))}catch(c){return null}}return t},setSavedBitrateSettings:function(e,t){if(_(d,u)&&t){var a=g.replace(/\?/,e);try{localStorage.setItem(a,JSON.stringify({bitrate:t.toFixed(3),timestamp:S()}))}catch(r){i.error(r.message)}}},getSavedMediaSettings:function(e){var t=null;if(h(),_(d,f)){var r=c.replace(/\?/,e);try{var s=JSON.parse(localStorage.getItem(r))||{},n=(new Date).getTime()-parseInt(s.timestamp,10)>=a.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=s.settings,n&&(localStorage.removeItem(r),t=null)}catch(i){return null}}return t},setSavedMediaSettings:function(e,t){if(_(d,f)){var a=c.replace(/\?/,e);try{localStorage.setItem(a,JSON.stringify({settings:t,timestamp:S()}))}catch(r){i.error(r.message)}}}},i=(0,r.default)(t).getInstance().getLogger(s),v(d)&&o.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(a){i.error(a.message)}}}),s}m.__dashjs_factory_name="DOMStorage";var v=t.default.getSingletonFactory(m);exports.default=v;
},{"../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","../constants/Constants":"jJgo"}],"FY0Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getVersionString=r;var e="3.0.0";function r(){return e}
},{}],"NLnQ":[function(require,module,exports) {
"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function n(){t(this,n),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null};exports.default=n;
},{}],"aItQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,n,e){return n&&t(i.prototype,n),e&&t(i,e),i}}();function i(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var n=function(){function n(){i(this,n),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null}return t(n,[{key:"isMediaInfoEqual",value:function(t){if(!t)return!1;var i=this.id===t.id,n=this.viewpoint===t.viewpoint,e=this.lang===t.lang,l=this.roles.toString()===t.roles.toString(),o=this.accessibility.toString()===t.accessibility.toString(),r=this.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return i&&n&&e&&l&&o&&r}}]),n}();exports.default=n;
},{}],"ixLX":[function(require,module,exports) {
"use strict";function t(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var s=function s(){t(this,s),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0};exports.default=s;
},{}],"GNqJ":[function(require,module,exports) {
"use strict";function i(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function t(){i(this,t),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null};exports.default=t;
},{}],"zgWO":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};exports.default=e;
},{}],"UceV":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.period=null,this.index=-1,this.type=null};exports.default=e;
},{}],"Vnb1":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};e.DEFAULT_ID="defaultId",exports.default=e;
},{}],"T5wX":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};exports.default=e;
},{}],"Ue55":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""};exports.default=e;
},{}],"GvrB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../streaming/constants/Constants"),t=U(e),a=require("../constants/DashConstants"),r=U(a),n=require("../vo/Representation"),i=U(n),o=require("../vo/AdaptationSet"),s=U(o),d=require("../vo/Period"),u=U(d),l=require("../vo/Mpd"),f=U(l),p=require("../vo/UTCTiming"),A=U(p),y=require("../vo/Event"),E=U(y),T=require("../vo/BaseURL"),_=U(T),h=require("../vo/EventStream"),I=U(h),m=require("../../streaming/utils/ObjectUtils"),c=U(m),v=require("../../streaming/utils/URLUtils"),P=U(v),g=require("../../core/FactoryMaker"),O=U(g),w=require("../../core/Debug"),S=U(w),R=require("../../streaming/vo/DashJSError"),N=U(R),M=require("../../core/errors/Errors"),D=U(M),L=require("../../streaming/thumbnail/ThumbnailTracks");function U(e){return e&&e.__esModule?e:{default:e}}function b(){var e=void 0,a=void 0,n=void 0,o=void 0,d=this.context,l=(0,P.default)(d).getInstance(),p=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function y(e,a){var n=void 0,i=void 0,o=void 0,s=void 0,d=void 0,u=void 0,l=!1,f=!1;if(!e)throw new Error("adaptation is not defined");if(!a)throw new Error("type is not defined");if(e.hasOwnProperty("ContentComponent_asArray")&&(s=e.ContentComponent_asArray),d=a!==t.default.TEXT?new RegExp(a):new RegExp("(vtt|ttml)"),e.Representation_asArray&&e.Representation_asArray.length&&e.Representation_asArray.length>0){var p=U(e.Representation_asArray[0]);if(p&&p.length>0&&L.THUMBNAILS_SCHEME_ID_URIS.indexOf(p[0].schemeIdUri)>=0)return a===t.default.IMAGE;if(e.Representation_asArray[0].hasOwnProperty(r.default.CODECS)&&(0===(u=e.Representation_asArray[0].codecs).search(t.default.STPP)||0===u.search(t.default.WVTT)))return a===t.default.FRAGMENTED_TEXT}if(s){if(s.length>1)return a===t.default.MUXED;s[0]&&s[0].contentType===a&&(l=!0,f=!0)}if(e.hasOwnProperty(r.default.MIME_TYPE)&&(l=d.test(e.mimeType),f=!0),!f)for(n=0,i=e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0;!f&&n<i;)(o=e.Representation_asArray[n]).hasOwnProperty(r.default.MIME_TYPE)&&(l=d.test(o.mimeType),f=!0),n++;return l}function T(e){return y(e,t.default.AUDIO)}function h(e){return y(e,t.default.VIDEO)}function m(e){return y(e,t.default.FRAGMENTED_TEXT)}function v(e){return y(e,t.default.IMAGE)}function g(e){return"text/vtt"===e||"application/ttml+xml"===e}function O(){return function(e,t){return e.bandwidth-t.bandwidth}}function w(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort(function(e,t){return e.bandwidth-t.bandwidth}),e}function R(e,t){return e&&e.Period_asArray&&p(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function M(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===r.default.DYNAMIC),t}function U(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map(function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}}):null}function b(e){if(e&&e.period&&p(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&p(e.index))return w(t.AdaptationSet_asArray[e.index])}}function C(e){var t=e.S_asArray[e.S_asArray.length-1];return!t.hasOwnProperty("r")||t.r>=0}function F(e,t){if(!e)throw new Error("Period cannot be null or undefined");var a=u.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty(r.default.ID)&&e.id.length>0&&"__proto__"!==e.id&&(a=e.id),a}function x(e,a){var n=[],i=void 0;if(!e)return n;for(i=0;i<e.length;i++){var o=new I.default;if(o.timescale=1,o.representation=a,!e[i].hasOwnProperty(t.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");o.schemeIdUri=e[i].schemeIdUri,e[i].hasOwnProperty(r.default.TIMESCALE)&&(o.timescale=e[i].timescale),e[i].hasOwnProperty(r.default.VALUE)&&(o.value=e[i].value),n.push(o)}return n}function B(e){var t=[],a=e.BaseURL_asArray||[e.baseUri],n=!1;return a.some(function(a){if(a){var i=new _.default,o=a.__text||a;return l.isRelative(o)&&(n=!0,e.baseUri&&(o=l.resolve(o,e.baseUri))),i.url=o,a.hasOwnProperty(r.default.SERVICE_LOCATION)&&a.serviceLocation.length?i.serviceLocation=a.serviceLocation:i.serviceLocation=o,a.hasOwnProperty(r.default.DVB_PRIORITY)&&(i.dvb_priority=a[r.default.DVB_PRIORITY]),a.hasOwnProperty(r.default.DVB_WEIGHT)&&(i.dvb_weight=a[r.default.DVB_WEIGHT]),a.hasOwnProperty(r.default.AVAILABILITY_TIME_OFFSET)&&(i.availabilityTimeOffset=a[r.default.AVAILABILITY_TIME_OFFSET]),a.hasOwnProperty(r.default.AVAILABILITY_TIME_COMPLETE)&&(i.availabilityTimeComplete="false"!==a[r.default.AVAILABILITY_TIME_COMPLETE]),t.push(i),n}}),t}return e={getIsTypeOf:y,getIsTextTrack:g,getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(r.default.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.ROLE_ASARRAY)?e.Role_asArray:[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,a){var r=R(t,a);return r.length>0&&p(e)?r[e]:null},getIndexForAdaptation:function(e,t,a){var r=R(t,a),n=r.length;if(e)for(var i=0;i<n;i++)if((0,c.default)(d).getInstance().areEqual(r[i],e))return i;return-1},getAdaptationForId:function(e,t,a){var n,i=R(t,a),o=void 0;for(o=0,n=i.length;o<n;o++)if(i[o].hasOwnProperty(r.default.ID)&&i[o].id===e)return i[o];return null},getAdaptationsForType:function(e,t,a){var r,n=R(e,t),i=void 0,o=[];for(i=0,r=n.length;i<r;i++)y(n[i],a)&&o.push(w(n[i]));return o},getCodec:function(e,t,a){var r=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var n=p(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];n&&(r=n.mimeType+';codecs="'+n.codecs+'"',a&&void 0!==n.width&&(r+=';width="'+n.width+'";height="'+n.height+'"'))}return r},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(r.default.CENC_DEFAULT_KID)?e[r.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],a=0;a<e.Label_asArray.length;a++)t.push({lang:e.Label_asArray[a].lang,text:e.Label_asArray[a].__text||e.Label_asArray[a]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(r.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:M,hasProfile:function(e,t){var a=!1;return e&&e.profiles&&e.profiles.length>0&&(a=-1!==e.profiles.indexOf(t)),a},getDuration:function(e){return e&&e.hasOwnProperty(r.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=NaN;return e&&e.hasOwnProperty(r.default.MINIMUM_UPDATE_PERIOD)&&(a=e.minimumUpdatePeriod),isNaN(a)?a:Math.max(a-t,1)},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=w(e);return(t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map(function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null}})},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&p(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,a,n=[],o=b(e),s=void 0,d=void 0;if(o&&o.Representation_asArray){if(e&&e.period&&p(e.period.index)){var u=B(e.period.mpd.manifest);u&&(d=u[0])}for(var l=0,f=o.Representation_asArray.length;l<f;++l){var A=o.Representation_asArray[l],y=new i.default;if(y.index=l,y.adaptation=e,A.hasOwnProperty(r.default.ID)&&(y.id=A.id),A.hasOwnProperty(r.default.CODECS)&&(y.codecs=A.codecs),A.hasOwnProperty(r.default.CODEC_PRIVATE_DATA)&&(y.codecPrivateData=A.codecPrivateData),A.hasOwnProperty(r.default.BANDWITH)&&(y.bandwidth=A.bandwidth),A.hasOwnProperty(r.default.WIDTH)&&(y.width=A.width),A.hasOwnProperty(r.default.HEIGHT)&&(y.height=A.height),A.hasOwnProperty(r.default.SCAN_TYPE)&&(y.scanType=A.scanType),A.hasOwnProperty(r.default.MAX_PLAYOUT_RATE)&&(y.maxPlayoutRate=A.maxPlayoutRate),A.hasOwnProperty(r.default.SEGMENT_BASE)?(s=A.SegmentBase,y.segmentInfoType=r.default.SEGMENT_BASE):A.hasOwnProperty(r.default.SEGMENT_LIST)?(s=A.SegmentList).hasOwnProperty(r.default.SEGMENT_TIMELINE)?(y.segmentInfoType=r.default.SEGMENT_TIMELINE,y.useCalculatedLiveEdgeTime=C(s.SegmentTimeline)):(y.segmentInfoType=r.default.SEGMENT_LIST,y.useCalculatedLiveEdgeTime=!0):A.hasOwnProperty(r.default.SEGMENT_TEMPLATE)?((s=A.SegmentTemplate).hasOwnProperty(r.default.SEGMENT_TIMELINE)?(y.segmentInfoType=r.default.SEGMENT_TIMELINE,y.useCalculatedLiveEdgeTime=C(s.SegmentTimeline)):y.segmentInfoType=r.default.SEGMENT_TEMPLATE,s.hasOwnProperty(r.default.INITIALIZATION_MINUS)&&(y.initialization=s.initialization.split("$Bandwidth$").join(A.bandwidth).split("$RepresentationID$").join(A.id))):y.segmentInfoType=r.default.BASE_URL,y.essentialProperties=U(A),s){if(s.hasOwnProperty(r.default.INITIALIZATION)){var E=s.Initialization;E.hasOwnProperty(r.default.SOURCE_URL)&&(y.initialization=E.sourceURL),E.hasOwnProperty(r.default.RANGE)&&(y.range=E.range)}else A.hasOwnProperty(r.default.MIME_TYPE)&&g(A.mimeType)&&(y.range=0);s.hasOwnProperty(r.default.TIMESCALE)&&(y.timescale=s.timescale),s.hasOwnProperty(r.default.DURATION)&&(y.segmentDuration=s.duration/y.timescale),s.hasOwnProperty(r.default.MEDIA)&&(y.media=s.media),s.hasOwnProperty(r.default.START_NUMBER)&&(y.startNumber=s.startNumber),s.hasOwnProperty(r.default.INDEX_RANGE)&&(y.indexRange=s.indexRange),s.hasOwnProperty(r.default.PRESENTATION_TIME_OFFSET)&&(y.presentationTimeOffset=s.presentationTimeOffset/y.timescale),s.hasOwnProperty(r.default.AVAILABILITY_TIME_OFFSET)?y.availabilityTimeOffset=s.availabilityTimeOffset:d&&void 0!==d.availabilityTimeOffset&&(y.availabilityTimeOffset=d.availabilityTimeOffset),s.hasOwnProperty(r.default.AVAILABILITY_TIME_COMPLETE)?y.availabilityTimeComplete="false"!==s.availabilityTimeComplete:d&&void 0!==d.availabilityTimeComplete&&(y.availabilityTimeComplete=d.availabilityTimeComplete)}y.MSETimeOffset=(a=void 0,a=(t=y).presentationTimeOffset,t.adaptation.period.start-a),y.path=[e.period.index,e.index,l],n.push(y)}}return n},getAdaptationsForPeriod:function(e){var a=e&&p(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,n=[],i=void 0,o=void 0,d=void 0;if(a&&a.AdaptationSet_asArray)for(d=0;d<a.AdaptationSet_asArray.length;d++)o=a.AdaptationSet_asArray[d],i=new s.default,o.hasOwnProperty(r.default.ID)&&(i.id=o.id),i.index=d,i.period=e,y(o,t.default.MUXED)?i.type=t.default.MUXED:T(o)?i.type=t.default.AUDIO:h(o)?i.type=t.default.VIDEO:m(o)?i.type=t.default.FRAGMENTED_TEXT:v(o)?i.type=t.default.IMAGE:i.type=t.default.TEXT,n.push(i);return n},getRegularPeriods:function(e){var t,i=!!e&&M(e.manifest),o=[],s=null,d=null,l=null,f=null,p=void 0;for(p=0,t=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;p<t;p++)(d=e.manifest.Period_asArray[p]).hasOwnProperty(r.default.START)?(f=new u.default).start=d.start:null!==s&&s.hasOwnProperty(r.default.DURATION)&&null!==l?(f=new u.default).start=parseFloat((l.start+l.duration).toFixed(5)):0!==p||i||((f=new u.default).start=0),null!==l&&isNaN(l.duration)&&(null!==f?l.duration=parseFloat((f.start-l.start).toFixed(5)):a.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==f&&(f.id=F(d,p),f.index=p,f.mpd=e,d.hasOwnProperty(r.default.DURATION)&&(f.duration=d.duration),o.push(f),s=d,l=f),d=null,f=null;return 0===o.length?o:(null!==l&&isNaN(l.duration)&&(l.duration=parseFloat((function(e){!function(){if(!n||!n.hasOwnProperty("error"))throw new Error("setConfig function has to be called previously")}();var t=M(e.mpd.manifest),a=void 0;return e.mpd.manifest.mediaPresentationDuration?a=e.mpd.manifest.mediaPresentationDuration:e.duration?a=e.duration:t?a=Number.POSITIVE_INFINITY:n.error(new N.default(D.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e)),a}(l)-l.start).toFixed(5))),o)},getMpd:function(e){var a=new f.default;return e&&(a.manifest=e,e.hasOwnProperty(r.default.AVAILABILITY_START_TIME)?a.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(a.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(r.default.AVAILABILITY_END_TIME)&&(a.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(r.default.MINIMUM_UPDATE_PERIOD)&&(a.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(r.default.MEDIA_PRESENTATION_DURATION)&&(a.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(t.default.SUGGESTED_PRESENTATION_DELAY)&&(a.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(r.default.TIMESHIFT_BUFFER_DEPTH)&&(a.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(r.default.MAX_SEGMENT_DURATION)&&(a.maxSegmentDuration=e.maxSegmentDuration)),a},getEventsForPeriod:function(e){var a=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,n=a?a.Period_asArray:null,i=n&&e&&p(e.index)?n[e.index].EventStream_asArray:null,s=[],d=void 0,u=void 0;if(i)for(d=0;d<i.length;d++){var l=new I.default;if(l.period=e,l.timescale=1,!i[d].hasOwnProperty(t.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(l.schemeIdUri=i[d].schemeIdUri,i[d].hasOwnProperty(r.default.TIMESCALE)&&(l.timescale=i[d].timescale),i[d].hasOwnProperty(r.default.VALUE)&&(l.value=i[d].value),u=0;i[d].Event_asArray&&u<i[d].Event_asArray.length;u++){var f=new E.default;f.presentationTime=0,f.eventStream=l,i[d].Event_asArray[u].hasOwnProperty(r.default.PRESENTATION_TIME)&&(f.presentationTime=i[d].Event_asArray[u].presentationTime),i[d].Event_asArray[u].hasOwnProperty(r.default.DURATION)&&(f.duration=i[d].Event_asArray[u].duration),i[d].Event_asArray[u].hasOwnProperty(r.default.ID)&&(f.id=i[d].Event_asArray[u].id),i[d].Event_asArray[u].Signal&&i[d].Event_asArray[u].Signal.Binary?f.messageData=o.decodeArray(i[d].Event_asArray[u].Signal.Binary):f.messageData=i[d].Event_asArray[u].messageData||i[d].Event_asArray[u].__text,s.push(f)}}return s},getEventStreamForAdaptationSet:function(e,t){var a=void 0,r=void 0,n=void 0;return e&&e.Period_asArray&&t&&t.period&&p(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&p(t.index)&&(n=r.AdaptationSet_asArray[t.index])&&(a=n.InbandEventStream_asArray),x(a,null)},getEventStreamForRepresentation:function(e,t){var a=void 0,r=void 0,n=void 0,i=void 0;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&p(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&p(t.adaptation.index)&&(n=r.AdaptationSet_asArray[t.adaptation.index])&&n.Representation_asArray&&p(t.index)&&(i=n.Representation_asArray[t.index])&&(a=i.InbandEventStream_asArray),x(a,t)},getUTCTimingSources:function(e){var a=M(e),n=!!e&&e.hasOwnProperty(r.default.AVAILABILITY_START_TIME),i=e?e.UTCTiming_asArray:null,o=[];return(a||n)&&i&&i.forEach(function(e){var a=new A.default;e.hasOwnProperty(t.default.SCHEME_ID_URI)&&(a.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(r.default.VALUE)&&(a.value=e.value.toString(),o.push(a)))}),o},getBaseURLsFromElement:B,getRepresentationSortFunction:O,getLocation:function(e){if(e&&e.hasOwnProperty(t.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location},getUseCalculatedLiveEdgeTimeForAdaptation:function(e){var t=b(e),a=t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray[0]:null,n=void 0;if(a){if(a.hasOwnProperty(r.default.SEGMENT_LIST))return!(n=a.SegmentList).hasOwnProperty(r.default.SEGMENT_TIMELINE)||C(n.SegmentTimeline);if(a.hasOwnProperty(r.default.SEGMENT_TEMPLATE)&&(n=a.SegmentTemplate).hasOwnProperty(r.default.SEGMENT_TIMELINE))return C(n.SegmentTimeline)}return!1},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(r.default.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(r.default.AVAILABILITY_START_TIME)?e.availabilityStartTime.getTime():null},setConfig:function(e){e&&(e.errHandler&&(n=e.errHandler),e.BASE64&&(o=e.BASE64))}},a=(0,S.default)(d).getInstance().getLogger(e),e}b.__dashjs_factory_name="DashManifestModel",exports.default=O.default.getSingletonFactory(b);
},{"../../streaming/constants/Constants":"jJgo","../constants/DashConstants":"wYnc","../vo/Representation":"rH33","../vo/AdaptationSet":"UceV","../vo/Period":"Vnb1","../vo/Mpd":"T5wX","../vo/UTCTiming":"KFq0","../vo/Event":"zgWO","../vo/BaseURL":"mKMn","../vo/EventStream":"Ue55","../../streaming/utils/ObjectUtils":"KpNL","../../streaming/utils/URLUtils":"ogFR","../../core/FactoryMaker":"FHM8","../../core/Debug":"iL1O","../../streaming/vo/DashJSError":"gyaG","../../core/errors/Errors":"Wrqa","../../streaming/thumbnail/ThumbnailTracks":"Sgau"}],"zB5j":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./constants/DashConstants"),t=v(e),n=require("./vo/RepresentationInfo"),i=v(n),r=require("./vo/MediaInfo"),a=v(r),o=require("./vo/StreamInfo"),d=v(o),u=require("./vo/ManifestInfo"),s=v(u),f=require("./vo/Event"),l=v(f),g=require("../core/FactoryMaker"),c=v(g),p=require("./models/DashManifestModel"),m=v(p);function v(e){return e&&e.__esModule?e:{default:e}}function h(){var e,n=void 0,r=void 0,o=void 0,u=void 0,f=void 0,g=void 0,c=this.context,p="urn:dvb:dash:profile:dvb-dash:2014";function v(e){return e&&e.streamInfo&&void 0!==e.streamInfo.id&&o[e.streamInfo.id]?o[e.streamInfo.id][e.index]:null}function h(e,i,a){var o,d=r[0].mpd.manifest,s=n.getAdaptationsForType(d,e,i);if(!s||0===s.length)return null;if(s.length>1&&a){var f=A(a,i);if(u[a.id]&&u[a.id][i])for(var l=0,g=s.length;l<g;l++)if(u[a.id][i].isMediaInfoEqual(f[l]))return s[l];for(var c=0,p=s.length;c<p;c++)if(o=s[c],n.getRolesForAdaptation(o).filter(function(e){return e.value===t.default.MAIN})[0])return s[c]}return s[0]}function A(e,t,i){var a,d=r,u=i,s=[],l=void 0,g=void 0,c=void 0,p=void 0,m=void 0,v=void 0;if(u)C(),d=y(u);else{if(!(r.length>0))return s;u=r[0].mpd.manifest}var h=x(e,d);h&&(v=h.id);var A=n.getAdaptationsForType(u,e.index,t!==f.EMBEDDED_TEXT?t:f.VIDEO);if(!A||0===A.length)return s;for(o[v]=o[v]||n.getAdaptationsForPeriod(h),p=0,a=A.length;p<a;p++)if(l=A[p],c=n.getIndexForAdaptation(l,u,e.index),g=D(o[v][c]),t===f.EMBEDDED_TEXT){var I=g.accessibility.length;for(m=0;m<I;m++)if(g){var T=g.accessibility[m];if(0===T.indexOf("cea-608:")){var F=T.substring(8).split(";");if("CC"===F[0].substring(0,2))for(m=0;m<F.length;m++)g||(g=D.call(this,o[v][c])),E(g,F[m].substring(0,3),F[m].substring(4)),s.push(g),g=null;else for(m=0;m<F.length;m++)g||(g=D.call(this,o[v][c])),E(g,"CC"+(m+1),F[m]),s.push(g),g=null}else 0===T.indexOf("cea-608")&&(E(g,f.CC1,"eng"),s.push(g),g=null)}}else t===f.IMAGE?(g.type=f.IMAGE,s.push(g),g=null):g&&s.push(g);return s}function y(e){return I(T(e))}function I(e){var t=e||r[0].mpd;return n.getRegularPeriods(t)}function T(e){var t=e||r[0].mpd.manifest;return n.getMpd(t)}function F(){r=[],o={},u={}}function x(e,t){for(var n=t.length,i=0;i<n;i++){var r=t[i];if(e.id===r.id)return r}return null}function D(e){var t,i=new a.default,r=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];return i.id=e.id,i.index=e.index,i.type=e.type,i.streamInfo=S(e.period),i.representationCount=n.getRepresentationCount(r),i.labels=n.getLabelsForAdaptation(r),i.lang=n.getLanguageForAdaptation(r),t=n.getViewpointForAdaptation(r),i.viewpoint=t?t.value:void 0,i.accessibility=n.getAccessibilityForAdaptation(r).map(function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==g&&(n=t?"cea-608:"+t:"cea-608",i.embeddedCaptions=!0),n}),i.audioChannelConfiguration=n.getAudioChannelConfigurationForAdaptation(r).map(function(e){return e.value}),i.roles=n.getRolesForAdaptation(r).map(function(e){return e.value}),i.codec=n.getCodec(r),i.mimeType=n.getMimeType(r),i.contentProtection=n.getContentProtectionData(r),i.bitrateList=n.getBitrateListForAdaptation(r),i.contentProtection&&i.contentProtection.forEach(function(e){e.KID=n.getKID(e)}),i.isText=n.getIsTextTrack(i.mimeType),i}function E(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=f.EMBEDDED_TEXT,e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=n,e.roles=["caption"]}function S(e){var t,i,r=new d.default;return r.id=e.id,r.index=e.index,r.start=e.start,r.duration=e.duration,r.manifestInfo=(t=e.mpd,(i=new s.default).DVRWindowSize=t.timeShiftBufferDepth,i.loadedTime=t.manifest.loadedTime,i.availableFrom=t.availabilityStartTime,i.minBufferTime=t.manifest.minBufferTime,i.maxFragmentDuration=t.maxSegmentDuration,i.duration=n.getDuration(t.manifest),i.isDynamic=n.getIsDynamic(t.manifest),i),r.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(r.start+r.duration-r.manifestInfo.duration)<1,r}function C(){if(!f)throw new Error("setConfig function has to be called previously")}function M(e){return 0===r.length?null:r[0].mpd.manifest.Period_asArray[e]}function _(e,t,n){var i=void 0,r=void 0,a=void 0,o=void 0,d=void 0;if(e)for(i=e.AdaptationSet_asArray,o=0;o<i.length;o+=1)for(a=i[o].Representation_asArray,d=0;d<a.length;d+=1)if(t===(r=a[d]).id)return n?d:r;return null}return e={getBandwidthForRepresentation:function(e,t){var n;return(n=_(M(t),e))?n.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){var n=_(e,t,!0);return null!==n?n:-1}(M(t),e)},getMaxIndexForBufferType:function(e,t){return function(e,t){var i=void 0,r=void 0,a=void 0,o=void 0;if(!e||!t)return-1;for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)if(i=r[o],a=i.Representation_asArray,n.getIsTypeOf(i,t))return a.length;return-1}(M(t),e)},convertDataToRepresentationInfo:function(e){var t=new i.default,r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],a=n.getRepresentationFor(e.index,r);return t.id=e.id,t.quality=e.index,t.bandwidth=n.getBandwidth(a),t.DVRWindow=e.segmentAvailabilityRange,t.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),t.MSETimeOffset=e.MSETimeOffset,t.useCalculatedLiveEdgeTime=e.useCalculatedLiveEdgeTime,t.mediaInfo=D(e.adaptation),t},getDataForMedia:v,getStreamsInfo:function(e,t){var n=[],i=r;e&&(C(),i=y(e)),t||(t=i.length);for(var a=0;a<t;a++)n.push(S(i[a]));return n},getMediaInfoForType:function(e,t){if(0===r.length)return null;var i=r[0].mpd.manifest,a=h(e.index,t,e);if(!a)return null;var d=x(e,r),u=d.id,s=n.getIndexForAdaptation(a,i,e.index);return o[u]=o[u]||n.getAdaptationsForPeriod(d),D(o[u][s])},getAllMediaInfoForType:A,getAdaptationForType:h,getRealAdaptation:function(e,t){var i,a=void 0,o=x(e,r);return i=t?t.id:null,r.length>0&&(a=i?n.getAdaptationForId(i,r[0].mpd.manifest,o.index):n.getAdaptationForIndex(t.index,r[0].mpd.manifest,o.index)),a},getVoRepresentations:function(e){var t=v(e);return n.getRepresentationsForAdaptation(t)},getEventsFor:function(e,t){var o=[];if(0===r.length)return o;var u=r[0].mpd.manifest;return e instanceof d.default?o=n.getEventsForPeriod(x(e,r)):e instanceof a.default?o=n.getEventStreamForAdaptationSet(u,v(e)):e instanceof i.default&&(o=n.getEventStreamForRepresentation(u,t)),o},getEvent:function(e,t,n){if(!e||!t)return null;var i=new l.default,r=e.scheme_id_uri,a=e.value,o=e.timescale,d=e.presentation_time_delta,u=e.event_duration,s=e.id,f=e.message_data,g=n*o+d;return t[r+"/"+a]?(i.eventStream=t[r+"/"+a],i.eventStream.value=a,i.eventStream.timescale=o,i.duration=u,i.id=s,i.presentationTime=g,i.messageData=f,i.presentationTimeDelta=d,i):null},setConfig:function(e){e&&(e.constants&&(f=e.constants),e.cea608parser&&(g=e.cea608parser),e.errHandler&&n.setConfig({errHandler:e.errHandler}),e.BASE64&&n.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;C(),r=y(e),o={}},setCurrentMediaInfo:function(e,t,n){u[e]=u[e]||{},u[e][t]=u[e][t]||{},u[e][t]=n},getUseCalculatedLiveEdgeTimeForMediaInfo:function(e){var t=v(e);return n.getUseCalculatedLiveEdgeTimeForAdaptation(t)},getIsTextTrack:function(e){return n.getIsTextTrack(e)},getUTCTimingSources:function(){var e=r[0].mpd.manifest;return n.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=r[0].mpd;return n.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var t=e||r[0].mpd;return n.getAvailabilityStartTime(t)},getIsDynamic:function(e){var t=e||r[0].mpd.manifest;return n.getIsDynamic(t)},getDuration:function(e){var t=e||r[0].mpd.manifest;return n.getDuration(t)},getRegularPeriods:I,getMpd:T,getLocation:function(e){return n.getLocation(e)},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n.getManifestUpdatePeriod(e,t)},getIsDVB:function(e){return n.hasProfile(e,p)},getBaseURLsFromElement:function(e){return n.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return n.getRepresentationSortFunction()},getCodec:function(e,t,i){return n.getCodec(e,t,i)},reset:F},n=(0,m.default)(c).getInstance(),F(),e}h.__dashjs_factory_name="DashAdapter",exports.default=c.default.getSingletonFactory(h);
},{"./constants/DashConstants":"wYnc","./vo/RepresentationInfo":"NLnQ","./vo/MediaInfo":"aItQ","./vo/StreamInfo":"ixLX","./vo/ManifestInfo":"GNqJ","./vo/Event":"zgWO","../core/FactoryMaker":"FHM8","./models/DashManifestModel":"GvrB"}],"wHtD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var t=function(){function t(){n(this,t)}return e(t,null,[{key:"round10",value:function(e,n){return r("round",e,n)}}]),t}();function r(e,n,t){return void 0===t||0==+t?Math[e](n):(t=+t,null===(n=+n)||isNaN(n)||"number"!=typeof t||t%1!=0?NaN:(n=n.toString().split("e"),+((n=(n=Math[e](+(n[0]+"e"+(n[1]?+n[1]-t:-t)))).toString().split("e"))[0]+"e"+(n[1]?+n[1]+t:t))))}exports.default=t;
},{}],"wcpZ":[function(require,module,exports) {
"use strict";function t(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var s=function s(){t(this,s),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]};exports.default=s;
},{}],"MGFw":[function(require,module,exports) {
"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function n(){t(this,n),this.t=null,this.mt=null,this.to=null,this.lto=null};exports.default=n;
},{}],"KeOn":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.t=null,this.level=null};exports.default=e;
},{}],"S30Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../controllers/BufferController"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function e(){n(this,e),this.target=null,this.state=t.default.BUFFER_EMPTY};exports.default=o;
},{"../../controllers/BufferController":"REuJ"}],"CHmN":[function(require,module,exports) {
"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function n(){t(this,n),this.time=null,this.range=null,this.manifestInfo=null};exports.default=n;
},{}],"lNmD":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function t(){e(this,t),this.time=null,this.droppedFrames=null};exports.default=t;
},{}],"Pkju":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},i=function e(){t(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},n=function e(){t(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null};exports.ManifestUpdate=e,exports.ManifestUpdateStreamInfo=i,exports.ManifestUpdateRepresentationInfo=n;
},{}],"odNg":[function(require,module,exports) {
"use strict";function t(t,l){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var l=function l(){t(this,l),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null};exports.default=l;
},{}],"Cd21":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function t(){e(this,t),this.loadingRequests=[],this.executedRequests=[]};exports.default=t;
},{}],"RHGx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../constants/Constants"),t=F(e),r=require("../constants/MetricsConstants"),a=F(r),n=require("../vo/MetricsList"),i=F(n),u=require("../vo/metrics/HTTPRequest"),d=require("../vo/metrics/RepresentationSwitch"),s=F(d),f=require("../vo/metrics/BufferLevel"),o=F(f),l=require("../vo/metrics/BufferState"),c=F(l),p=require("../vo/metrics/DVRInfo"),T=F(p),m=require("../vo/metrics/DroppedFrames"),v=F(m),E=require("../vo/metrics/ManifestUpdate"),_=require("../vo/metrics/SchedulingInfo"),R=F(_),M=require("../../core/EventBus"),I=F(M),S=require("../vo/metrics/RequestsQueue"),q=F(S),y=require("../../core/events/Events"),g=F(y),A=require("../../core/FactoryMaker"),D=F(A);function F(e){return e&&e.__esModule?e:{default:e}}function h(e){var r,n=(e=e||{}).settings,d=this.context,f=(0,I.default)(d).getInstance(),l=void 0;function p(){f.trigger(g.default.METRICS_CHANGED)}function m(e){f.trigger(g.default.METRIC_CHANGED,{mediaType:e}),p()}function _(e,t,r){f.trigger(g.default.METRIC_UPDATED,{mediaType:e,metric:t,value:r}),m(e)}function M(e,t,r){f.trigger(g.default.METRIC_ADDED,{mediaType:e,metric:t,value:r}),m(e)}function S(e,t){var r=null;return e?(l.hasOwnProperty(e)?r=l[e]:t||(r=new i.default,l[e]=r),r):r}function y(e,t,r){var a=S(e);a[t].push(r),a[t].length>n.get().streaming.metricsMaxListDepth&&a[t].shift()}function A(e,t,r){y(e,t,r),M(e,t,r)}return r={clearCurrentMetricsForType:function(e){delete l[e],m(e)},clearAllCurrentMetrics:function(){l={},p()},getMetricsFor:S,addHttpRequest:function e(t,r,n,i,d,s,f,o,l,c,p,T,m,v){var E=new u.HTTPRequest;d&&d!==i&&(e(t,null,n,i,null,null,f,o,null,null,null,T,null,null),E.actualurl=d),E.tcpid=r,E.type=n,E.url=i,E.range=f,E.trequest=o,E.tresponse=l,E.responsecode=p,E._tfinish=c,E._stream=t,E._mediaduration=T,E._responseHeaders=m,E._serviceLocation=s,v?v.forEach(function(e){!function(e,t,r,a){var n=new u.HTTPRequestTrace;n.s=t,n.d=r,n.b=a,e.trace.push(n),e.interval||(e.interval=0),e.interval+=r}(E,e.s,e.d,e.b)}):(delete E.interval,delete E.trace),A(t,a.default.HTTP_REQUEST,E)},addRepresentationSwitch:function(e,t,r,n,i){var u=new s.default;u.t=t,u.mt=r,u.to=n,i?u.lto=i:delete u.lto,A(e,a.default.TRACK_SWITCH,u)},addBufferLevel:function(e,t,r){var n=new o.default;n.t=t,n.level=r,A(e,a.default.BUFFER_LEVEL,n)},addBufferState:function(e,t,r){var n=new c.default;n.target=r,n.state=t,A(e,a.default.BUFFER_STATE,n)},addDVRInfo:function(e,t,r,n){var i=new T.default;i.time=t,i.range=n,i.manifestInfo=r,A(e,a.default.DVR_INFO,i)},addDroppedFrames:function(e,t){var r=new v.default,n=S(e).DroppedFrames;r.time=t.creationTime,r.droppedFrames=t.droppedVideoFrames,n.length>0&&n[n.length-1]==r||A(e,a.default.DROPPED_FRAMES,r)},addSchedulingInfo:function(e,t,r,n,i,u,d,s,f){var o=new R.default;o.mediaType=e,o.t=t,o.type=r,o.startTime=n,o.availabilityStartTime=i,o.duration=u,o.quality=d,o.range=s,o.state=f,A(e,a.default.SCHEDULING_INFO,o)},addRequestsQueue:function(e,t,r){var n=new q.default;n.loadingRequests=t,n.executedRequests=r,S(e).RequestsQueue=n,M(e,a.default.REQUESTS_QUEUE,n)},addManifestUpdate:function(e,r,n,i,u,d,s,f,o,l){var c=new E.ManifestUpdate;c.mediaType=e,c.type=r,c.requestTime=n,c.fetchTime=i,c.availabilityStartTime=u,c.presentationStartTime=d,c.clientTimeOffset=s,c.currentTime=f,c.buffered=o,c.latency=l,y(t.default.STREAM,a.default.MANIFEST_UPDATE,c),M(e,a.default.MANIFEST_UPDATE,c)},updateManifestUpdateInfo:function(e,t){if(e){for(var r in t)e[r]=t[r];_(e.mediaType,a.default.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,r,n,i){if(e){var u=new E.ManifestUpdateStreamInfo;u.id=t,u.index=r,u.start=n,u.duration=i,e.streamInfo.push(u),_(e.mediaType,a.default.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,r,n,i,u,d,s){if(e){var f=new E.ManifestUpdateRepresentationInfo;f.id=t,f.index=r,f.streamIndex=n,f.mediaType=i,f.startNumber=d,f.fragmentInfoType=s,f.presentationTimeOffset=u,e.representationInfo.push(f),_(e.mediaType,a.default.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,A(t.default.STREAM,a.default.PLAY_LIST,e)},addDVBErrors:function(e){A(t.default.STREAM,a.default.DVB_ERRORS,e)}},l={},r}h.__dashjs_factory_name="MetricsModel",exports.default=D.default.getSingletonFactory(h);
},{"../constants/Constants":"jJgo","../constants/MetricsConstants":"RxE2","../vo/MetricsList":"wcpZ","../vo/metrics/HTTPRequest":"yMBz","../vo/metrics/RepresentationSwitch":"MGFw","../vo/metrics/BufferLevel":"KeOn","../vo/metrics/BufferState":"S30Z","../vo/metrics/DVRInfo":"CHmN","../vo/metrics/DroppedFrames":"lNmD","../vo/metrics/ManifestUpdate":"Pkju","../vo/metrics/SchedulingInfo":"odNg","../../core/EventBus":"Opee","../vo/metrics/RequestsQueue":"Cd21","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8"}],"Sn7l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../streaming/constants/Constants"),t=c(e),r=require("../streaming/vo/metrics/HTTPRequest"),n=require("../core/FactoryMaker"),a=c(n),i=require("../streaming/constants/MetricsConstants"),u=c(i),s=require("./utils/Round10"),d=c(s),o=require("../streaming/models/MetricsModel"),f=c(o),l=require("../streaming/vo/metrics/PlayList");function c(e){return e&&e.__esModule?e:{default:e}}function p(e){e=e||{};var n,a=this.context,i=void 0,s=void 0,o=void 0,c=e.metricsModel;function p(e,t,r){return v(c.getMetricsFor(e,t),r)}function g(e,t){var r=c.getMetricsFor(e,t);if(!r)return null;var n=r.HttpList,a=null,i=void 0;if(!n||n.length<=0)return null;for(i=n.length-1;i>=0;){if(n[i].responsecode){a=n[i];break}i--}return a}function M(e){var t=c.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function v(e,t){if(!e)return null;var r=e[t];return!r||r.length<=0?null:r[r.length-1]}function D(e){var t={};if(!e)return t;for(var r=e.trim().split("\r\n"),n=0,a=r.length;n<a;n++){var i=r[n],u=i.indexOf(": ");u>0&&(t[i.substring(0,u)]=i.substring(u+2))}return t}return n={getCurrentRepresentationSwitch:function(e,t){return v(c.getMetricsFor(e,t),u.default.TRACK_SWITCH)},getLatestBufferInfoVO:p,getCurrentBufferLevel:function(e,t){var r=p(e,t,u.default.BUFFER_LEVEL);return r?d.default.round10(r.level/1e3,-3):0},getCurrentHttpRequest:g,getHttpRequests:M,getCurrentDroppedFrames:function(){return v(c.getMetricsFor(t.default.VIDEO,!0),u.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return v(c.getMetricsFor(e,!0),u.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return v(e?c.getMetricsFor(e,!0):c.getMetricsFor(t.default.VIDEO,!0)||c.getMetricsFor(t.default.AUDIO,!0),u.default.DVR_INFO)},getCurrentManifestUpdate:function(){return v(c.getMetricsFor(t.default.STREAM),u.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){var r={},n=g(e,!0);return n&&(r=D(n._responseHeaders)),void 0===r[t]?null:r[t]},getLatestMPDRequestHeaderValueByID:function(e){var n,a={},i=void 0,u=void 0;for(u=(n=M(t.default.STREAM)).length-1;u>=0;u--)if((i=n[u]).type===r.HTTPRequest.MPD_TYPE){a=D(i._responseHeaders);break}return void 0===a[e]?null:a[e]},addRepresentationSwitch:function(e,t,r,n,a){c.addRepresentationSwitch(e,t,r,n,a)},addDVRInfo:function(e,t,r,n){c.addDVRInfo(e,t,r,n)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();c.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();c.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration)}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var r=this.getCurrentManifestUpdate();c.addManifestUpdateRepresentationInfo(r,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType)}},addManifestUpdate:function(e){c.addManifestUpdate(t.default.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,r,n,a){c.addHttpRequest(e.mediaType,null,e.type,e.url,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,r,e.duration,n,a)},addSchedulingInfo:function(e,t){c.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,r){c.addRequestsQueue(e,t,r)},addBufferLevel:function(e,t,r){c.addBufferLevel(e,t,r)},addBufferState:function(e,t,r){c.addBufferState(e,t,r)},addDroppedFrames:function(e){c.addDroppedFrames(t.default.VIDEO,e)},addPlayList:function(){o&&(c.addPlayList(o),o=null)},addDVBErrors:function(e){c.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(o=new l.PlayList).start=new Date,o.mstart=e,o.starttype=t},createPlaylistTraceMetrics:function(e,t,r){!0===i&&(i=!1,(s=new l.PlayListTrace).representationid=e,s.start=new Date,s.mstart=t,s.playbackspeed=r)},updatePlayListTraceMetrics:function(e){if(s)for(var t in s)s[t]=e[t]},pushPlayListTraceMetrics:function(e,t){if(!1===i&&o&&s&&s.start){var r=s.start,n=e.getTime()-r.getTime();s.duration=n,s.stopreason=t,o.trace.push(s),i=!0}},clearAllCurrentMetrics:function(){c.clearAllCurrentMetrics()}},c=c||(0,f.default)(a).getInstance({settings:e.settings}),i=!0,s=null,o=null,n}p.__dashjs_factory_name="DashMetrics",exports.default=a.default.getSingletonFactory(p);
},{"../streaming/constants/Constants":"jJgo","../streaming/vo/metrics/HTTPRequest":"yMBz","../core/FactoryMaker":"FHM8","../streaming/constants/MetricsConstants":"RxE2","./utils/Round10":"wHtD","../streaming/models/MetricsModel":"RHGx","../streaming/vo/metrics/PlayList":"siyq"}],"nuFG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/EventBus"),t=o(e),i=require("../../core/events/Events"),a=o(i),n=require("../../core/FactoryMaker"),r=o(n);function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,i=(0,t.default)(e).getInstance(),n=void 0,r=void 0,o=void 0;function s(e){n=e}function l(e,t,i,a){return a?i&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:i?new Date(t.availabilityStartTime.getTime()+1e3*(e-n)):t.availabilityStartTime}function m(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*n)/1e3}function f(e){r||void 0!==e.offset&&(s(e.offset/1e3),r=!0)}function u(){n=0,r=!1,o=NaN}return{initialize:function(){u(),i.on(a.default.TIME_SYNCHRONIZATION_COMPLETED,f,this)},isTimeSyncCompleted:function(){return r},setTimeSyncCompleted:function(e){r=e},getClientTimeOffset:function(){return n},setClientTimeOffset:s,getExpectedLiveEdge:function(){return o},setExpectedLiveEdge:function(e){o=e},calcAvailabilityStartTimeFromPresentationTime:function(e,t,i){return l.call(this,e,t,i)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,i){return l.call(this,e,t,i,!0)},calcPresentationTimeFromWallTime:m,calcPresentationTimeFromMediaTime:function(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)},calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcSegmentAvailabilityRange:function(e,t){var i=e.adaptation.period,a={start:i.start,end:i.start+i.duration};if(!t)return a;if(!r&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var n=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),o=m(new Date,i),s=i.start+i.duration;a.start=Math.max(o-i.mpd.timeShiftBufferDepth,i.start);var l=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<n?n-e.availabilityTimeOffset:n;return a.end=o>=s&&o-l<s?s:o-l,a},getPeriodEnd:function(e,t){var i=e.adaptation.period;if(!t)return i.start+i.duration;if(!r&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var a=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),n=m(new Date,i),o=i.start+i.duration,s=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<a?a-e.availabilityTimeOffset:a;return Math.min(n-s,o)},calcWallTimeForSegment:function(e,t){var i=void 0,a=void 0,n=void 0;return t&&(i=e.representation.adaptation.period.mpd.suggestedPresentationDelay,a=e.presentationStartTime+i,n=new Date(e.availabilityStartTime.getTime()+1e3*a)),n},reset:function(){i.off(a.default.TIME_SYNCHRONIZATION_COMPLETED,f,this),u()}}}s.__dashjs_factory_name="TimelineConverter",exports.default=r.default.getSingletonFactory(s);
},{"../../core/EventBus":"Opee","../../core/events/Events":"W3G1","../../core/FactoryMaker":"FHM8"}],"BwRq":[function(require,module,exports) {
"use strict";var r={encode:function(r){for(var e=[],n=0;n<r.length;++n){var o=r.charCodeAt(n);o<128?e.push(o):o<2048?(e.push(192|o>>6),e.push(128|63&o)):o<65536?(e.push(224|o>>12),e.push(128|63&o>>6),e.push(128|63&o)):(e.push(240|o>>18),e.push(128|63&o>>12),e.push(128|63&o>>6),e.push(128|63&o))}return e},decode:function(r){for(var e=[],n=0;n<r.length;){var o=r[n++];o<128||(o<224?(o=(31&o)<<6,o|=63&r[n++]):o<240?(o=(15&o)<<12,o|=(63&r[n++])<<6,o|=63&r[n++]):(o=(7&o)<<18,o|=(63&r[n++])<<12,o|=(63&r[n++])<<6,o|=63&r[n++])),e.push(String.fromCharCode(o))}return e.join("")}},e={};!function(n){var o=function(r){for(var e=0,o=[],t=0|r.length/3;0<t--;){var h=(r[e]<<16)+(r[e+1]<<8)+r[e+2];e+=3,o.push(n.charAt(63&h>>18)),o.push(n.charAt(63&h>>12)),o.push(n.charAt(63&h>>6)),o.push(n.charAt(63&h))}if(2==r.length-e){h=(r[e]<<16)+(r[e+1]<<8);o.push(n.charAt(63&h>>18)),o.push(n.charAt(63&h>>12)),o.push(n.charAt(63&h>>6)),o.push("=")}else if(1==r.length-e){h=r[e]<<16;o.push(n.charAt(63&h>>18)),o.push(n.charAt(63&h>>12)),o.push("==")}return o.join("")},t=function(){for(var r=[],e=0;e<n.length;++e)r[n.charCodeAt(e)]=e;return r["=".charCodeAt(0)]=0,r}(),h=function(r){for(var e=0,n=[],o=0|r.length/4;0<o--;){var h=(t[r.charCodeAt(e)]<<18)+(t[r.charCodeAt(e+1)]<<12)+(t[r.charCodeAt(e+2)]<<6)+t[r.charCodeAt(e+3)];n.push(255&h>>16),n.push(255&h>>8),n.push(255&h),e+=4}return n&&("="==r.charAt(e-2)?(n.pop(),n.pop()):"="==r.charAt(e-1)&&n.pop()),n},c={encode:function(r){for(var e=[],n=0;n<r.length;++n)e.push(r.charCodeAt(n));return e},decode:function(r){for(var e=0;e<s.length;++e)a[e]=String.fromCharCode(a[e]);return a.join("")}};e.decodeArray=function(r){var e=h(r);return new Uint8Array(e)},e.encodeASCII=function(r){var e=c.encode(r);return o(e)},e.decodeASCII=function(r){var e=h(r);return c.decode(e)},e.encode=function(e){var n=r.encode(e);return o(n)},e.decode=function(e){var n=h(e);return r.decode(n)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),"undefined"!=typeof exports&&(exports.decode=e.decode,exports.decodeArray=e.decodeArray,exports.encode=e.encode,exports.encodeASCII=e.encodeASCII);
},{}],"nHmL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../externals/cea608-parser"),t=ge(e),r=require("./constants/Constants"),n=ge(r),i=require("./constants/MetricsConstants"),o=ge(i),a=require("./controllers/PlaybackController"),u=ge(a),l=require("./controllers/StreamController"),s=ge(l),f=require("./controllers/MediaController"),d=ge(f),c=require("./controllers/BaseURLController"),g=ge(c),m=require("./ManifestLoader"),v=ge(m),T=require("./utils/ErrorHandler"),h=ge(T),C=require("./utils/Capabilities"),I=ge(C),M=require("./text/TextTracks"),S=ge(M),y=require("./utils/RequestModifier"),p=ge(y),R=require("./text/TextController"),D=ge(R),b=require("./models/URIFragmentModel"),E=ge(b),w=require("./models/ManifestModel"),A=ge(w),x=require("./models/MediaPlayerModel"),k=ge(x),q=require("./controllers/AbrController"),F=ge(q),P=require("./models/VideoModel"),L=ge(P),_=require("./utils/DOMStorage"),B=ge(_),N=require("./../core/Debug"),V=ge(N),U=require("./../core/errors/Errors"),z=ge(U),O=require("./../core/EventBus"),H=ge(O),W=require("./../core/events/Events"),j=ge(W),G=require("./MediaPlayerEvents"),X=ge(G),Y=require("../core/FactoryMaker"),Q=ge(Y),J=require("../core/Settings"),K=ge(J),Z=require("./../core/Version"),$=require("../dash/DashAdapter"),ee=ge($),te=require("../dash/DashMetrics"),re=ge(te),ne=require("../dash/utils/TimelineConverter"),ie=ge(ne),oe=require("./vo/metrics/HTTPRequest"),ae=require("../../externals/base64"),ue=ge(ae),le=require("codem-isoboxer"),se=ge(le),fe=require("./vo/DashJSError"),de=ge(fe),ce=require("./utils/SupervisorTools");function ge(e){return e&&e.__esModule?e:{default:e}}function me(){var e="You must first call initialize() and set a source before calling this method",r="You must first call initialize() and set a valid source and view before calling this method",i="You must first call attachView() to set the video element before calling this method",a="You must first call attachSource() with a valid source before calling this method",l="MediaPlayer not initialized!",f=this.context,c=(0,H.default)(f).getInstance(),m=(0,K.default)(f).getInstance(),T=(0,V.default)(f).getInstance(),C=void 0,M=void 0,y=void 0,R=void 0,b=void 0,w=void 0,x=void 0,q=void 0,P=void 0,_=void 0,N=void 0,U=void 0,O=void 0,W=void 0,G=void 0,Y=void 0,J=void 0,$=void 0,te=void 0,ne=void 0,ae=void 0,le=void 0,fe=void 0,ge=void 0,me=void 0,ve=void 0;function Te(){return!!y&&!!fe.getElement()}function he(){return(0,Z.getVersionString)()}function Ce(){if(!x)throw r;return ne.isPaused()}function Ie(e){var t=ae.getCurrentDVRInfo();if(!t)return 0;var r=ne.getLiveDelay(),n=t.range.start+e;return n>t.range.end-r&&(n=t.range.end-r),n}function Me(e){if(!x)throw r;var t=De().currentTime;if(void 0!==e)t=te.getTimeRelativeToStreamId(t,e);else if(ne.getIsDynamic()){var n=ae.getCurrentDVRInfo();t=null===n?0:Se()-(n.range.end-n.time)}return t}function Se(){if(!x)throw r;var e=De().duration;if(ne.getIsDynamic()){var t,n=ae.getCurrentDVRInfo();if(!n)return 0;e=(t=n.range.end-n.range.start)<n.manifestInfo.DVRWindowSize?t:n.manifestInfo.DVRWindowSize}return e}function ye(e){(0,ce.checkParameterType)(e,"boolean"),q=e}function pe(){Y.restoreDefaultUTCTimingSources()}function Re(){return ae}function De(){if(!fe.getElement())throw i;return fe.getElement()}function be(e){if(!b)throw l;fe.setElement(e),e&&(qe(),function(){if(O)return;var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(f).create();O=t.createMetricsReporting({debug:T,eventBus:c,mediaElement:De(),adapter:G,dashMetrics:ae,events:j.default,constants:n.default,metricsConstants:o.default})}}(),function(){if(W)return;var e=dashjs.MssHandler;"function"==typeof e&&(z.default.extend(e.errors),W=e(f).create({eventBus:c,mediaPlayerModel:Y,dashMetrics:ae,manifestModel:le,playbackController:ne,protectionController:U,baseURLController:(0,g.default)(f).getInstance(),errHandler:J,events:j.default,constants:n.default,debug:T,initSegmentType:oe.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:ue.default,ISOBoxer:se.default}))}(),te&&te.switchToVideoElement()),x&&xe(),Pe()}function Ee(t){if(!w)throw e;var r=te.getActiveStreamInfo();return N.getTracksFor(t,r)}function we(e){if(!b)throw l;"string"==typeof e&&me.initialize(e),y=e,(w||x)&&xe(),Te()&&Pe()}function Ae(){if(!w)throw e;var t=te.getActiveStreamInfo();return t?te.getStreamById(t.id):null}function xe(){x=!1,w=!1,G.reset(),te.reset(),ne.reset(),P.reset(),N.reset(),ge.reset(),U&&(m.get().streaming.keepProtectionMediaKeys?U.stop():(U.reset(),U=null,qe()))}function ke(){return(0,v.default)(f).create({errHandler:J,dashMetrics:ae,mediaPlayerModel:Y,requestModifier:(0,p.default)(f).getInstance(),mssHandler:W,settings:m})}function qe(){if(U)return U;var e=dashjs.Protection;if("function"==typeof e){var t=e(f).create();return j.default.extend(e.events),X.default.extend(e.events,{publicOnly:!0}),z.default.extend(e.errors),$||($=(0,I.default)(f).getInstance()),U=t.createProtectionSystem({debug:T,errHandler:J,videoModel:fe,capabilities:$,eventBus:c,events:j.default,BASE64:ue.default,constants:n.default})}return null}function Fe(e){var t=ae.getCurrentDVRInfo();return t?e+(t.manifestInfo.availableFrom.getTime()/1e3+t.range.start):0}function Pe(){var e;!w&&y&&(w=!0,M.info("Streaming Initialized"),e=ke(),te||(te=(0,s.default)(f).getInstance()),N.setConfig({domStorage:ve}),te.setConfig({capabilities:$,manifestLoader:e,manifestModel:le,mediaPlayerModel:Y,protectionController:U,adapter:G,dashMetrics:ae,errHandler:J,timelineConverter:_,videoModel:fe,playbackController:ne,abrController:P,mediaController:N,textController:ge,settings:m}),ne.setConfig({streamController:te,dashMetrics:ae,mediaPlayerModel:Y,adapter:G,videoModel:fe,timelineConverter:_,uriFragmentModel:me,settings:m}),P.setConfig({streamController:te,domStorage:ve,mediaPlayerModel:Y,dashMetrics:ae,adapter:G,videoModel:fe,settings:m}),P.createAbrRulesCollection(),ge.setConfig({errHandler:J,manifestModel:le,adapter:G,mediaController:N,streamController:te,videoModel:fe}),te.initialize(q,R),"string"==typeof y?te.load(y):te.loadWithManifest(y)),!x&&Te()&&(x=!0,M.info("Playback Initialized"))}return C={initialize:function(e,r,i){$||($=(0,I.default)(f).getInstance()),J=(0,h.default)(f).getInstance(),$.supportsMediaSource()?b||(b=!0,_=(0,ie.default)(f).getInstance(),P||(P=(0,F.default)(f).getInstance()),ne||(ne=(0,u.default)(f).getInstance()),N||(N=(0,d.default)(f).getInstance()),G=(0,ee.default)(f).getInstance(),le=(0,A.default)(f).getInstance(),ae=(0,re.default)(f).getInstance({settings:m}),ge=(0,D.default)(f).getInstance(),ve=(0,B.default)(f).getInstance({settings:m}),G.setConfig({constants:n.default,cea608parser:t.default,errHandler:J,BASE64:ue.default}),pe(),ye(void 0===i||i),e&&be(e),r&&we(r),M.info("[dash.js "+he()+"] MediaPlayer has been initialized")):J.error(new de.default(z.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,z.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&($=e.capabilities),e.streamController&&(te=e.streamController),e.playbackController&&(ne=e.playbackController),e.mediaPlayerModel&&(Y=e.mediaPlayerModel),e.abrController&&(P=e.abrController),e.mediaController&&(N=e.mediaController),e.settings&&(m=e.settings))},on:function(e,t,r){c.on(e,t,r)},off:function(e,t,r){c.off(e,t,r)},extend:function(e,t,r){Q.default.extend(e,t,r,f)},attachView:be,attachSource:we,isReady:Te,preload:function(){if(fe.getElement()||w)return!1;if(!y)throw a;Pe()},play:function(){if(!x)throw r;(!q||Ce()&&x)&&ne.play()},isPaused:Ce,pause:function(){if(!x)throw r;ne.pause()},isSeeking:function(){if(!x)throw r;return ne.isSeeking()},isDynamic:function(){if(!x)throw r;return ne.getIsDynamic()},seek:function(e){if(!x)throw r;if((0,ce.checkParameterType)(e,"number"),isNaN(e))throw n.default.BAD_ARGUMENT_ERROR;var t=ne.getIsDynamic()?Ie(e):e;ne.seek(t)},setPlaybackRate:function(e){De().playbackRate=e},getPlaybackRate:function(){return De().playbackRate},setMute:function(e){(0,ce.checkParameterType)(e,"boolean"),De().muted=e},isMuted:function(){return De().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw n.default.BAD_ARGUMENT_ERROR;De().volume=e},getVolume:function(){return De().volume},time:Me,duration:Se,timeAsUTC:function(){if(!x)throw r;return Me()<0?NaN:Fe(Me())},durationAsUTC:function(){if(!x)throw r;return Fe(Se())},getActiveStream:Ae,getDVRWindowSize:function(){var e=ae.getCurrentDVRInfo();return e?e.manifestInfo.DVRWindowSize:0},getDVRSeekOffset:Ie,convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(r<10?"0"+r.toString():r.toString())+":"+(n<10?"0"+n.toString():n.toString())},formatUTC:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),o=i.toLocaleDateString(t),a=i.toLocaleTimeString(t,{hour12:r});return n?a+" "+o:a},getVersion:he,getDebug:function(){return T},getBufferLength:function(e){var t=[n.default.VIDEO,n.default.AUDIO,n.default.FRAGMENTED_TEXT];if(e){if(-1!==t.indexOf(e)){var r=Re().getCurrentBufferLevel(e);return r||NaN}return M.warn("getBufferLength requested for invalid type"),NaN}var i=t.map(function(e){return Ee(e).length>0?Re().getCurrentBufferLevel(e):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)});return i===Number.MAX_VALUE?NaN:i},getTTMLRenderingDiv:function(){return fe?fe.getTTMLRenderingDiv():null},getVideoElement:De,getSource:function(){if(!y)throw a;return y},getCurrentLiveLatency:function(){if(!b)throw l;return x?ne.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(t){if(!w)throw e;return P.getTopBitrateInfoFor(t)},setAutoPlay:ye,getAutoPlay:function(){return q},getDashMetrics:Re,getQualityFor:function(t){if(!w)throw e;if(t===n.default.IMAGE){var r=Ae();if(!r)return-1;var i=r.getThumbnailController();return i?i.getCurrentTrackIndex():-1}return P.getQualityFor(t)},setQualityFor:function(t,r){if(!w)throw e;if(t===n.default.IMAGE){var i=Ae();if(!i)return;var o=i.getThumbnailController();o&&o.setTrackByIndex(r)}P.setPlaybackQuality(t,te.getActiveStreamInfo(),r)},updatePortalSize:function(){P.setElementSize(),P.setWindowResizeEventCalled(!0)},setTextDefaultLanguage:function(e){void 0===ge&&(ge=(0,D.default)(f).getInstance()),ge.setTextDefaultLanguage(e)},getTextDefaultLanguage:function(){return void 0===ge&&(ge=(0,D.default)(f).getInstance()),ge.getTextDefaultLanguage()},setTextDefaultEnabled:function(e){void 0===ge&&(ge=(0,D.default)(f).getInstance()),ge.setTextDefaultEnabled(e)},getTextDefaultEnabled:function(){return void 0===ge&&(ge=(0,D.default)(f).getInstance()),ge.getTextDefaultEnabled()},enableText:function(e){void 0===ge&&(ge=(0,D.default)(f).getInstance()),ge.enableText(e)},enableForcedTextStreaming:function(e){void 0===ge&&(ge=(0,D.default)(f).getInstance()),ge.enableForcedTextStreaming(e)},isTextEnabled:function(){return void 0===ge&&(ge=(0,D.default)(f).getInstance()),ge.isTextEnabled()},setTextTrack:function(e){if(!x)throw r;void 0===ge&&(ge=(0,D.default)(f).getInstance()),ge.setTextTrack(e)},getBitrateInfoListFor:function(t){if(!w)throw e;var r=Ae();return r?r.getBitrateListFor(t):[]},getStreamsFromManifest:function(t){if(!w)throw e;return G.getStreamsInfo(t)},getTracksFor:Ee,getTracksForTypeFromManifest:function(t,r,n){if(!w)throw e;return(n=n||G.getStreamsInfo(r,1)[0])?G.getAllMediaInfoForType(n,t,r):[]},getCurrentTrackFor:function(t){if(!w)throw e;var r=te.getActiveStreamInfo();return N.getCurrentTrackFor(t,r)},setInitialMediaSettingsFor:function(e,t){if(!b)throw l;N.setInitialSettings(e,t)},getInitialMediaSettingsFor:function(e){if(!b)throw l;return N.getInitialSettings(e)},setCurrentTrack:function(t){if(!w)throw e;N.setTrack(t)},getTrackSwitchModeFor:function(e){if(!b)throw l;return N.getSwitchMode(e)},setTrackSwitchModeFor:function(e,t){if(!b)throw l;N.setSwitchMode(e,t)},setSelectionModeForInitialTrack:function(e){if(!b)throw l;N.setSelectionModeForInitialTrack(e)},getSelectionModeForInitialTrack:function(){if(!b)throw l;return N.getSelectionModeForInitialTrack()},addABRCustomRule:function(e,t,r){Y.addABRCustomRule(e,t,r)},removeABRCustomRule:function(e){Y.removeABRCustomRule(e)},removeAllABRCustomRule:function(){Y.removeABRCustomRule()},getAverageThroughput:function(e){var t=P.getThroughputHistory();return t?t.getAverageThroughput(e):0},retrieveManifest:function(e,t){var r=ke(),n=this;c.on(j.default.INTERNAL_MANIFEST_LOADED,function e(i){i.error?t(null,i.error):t(i.manifest),c.off(j.default.INTERNAL_MANIFEST_LOADED,e,n),r.reset()},n),me.initialize(e),r.load(e)},addUTCTimingSource:function(e,t){Y.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){Y.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){Y.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:pe,setXHRWithCredentialsForType:function(e,t){Y.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return Y.getXHRWithCredentialsForType(e)},getProtectionController:function(){return qe()},attachProtectionController:function(e){U=e},setProtectionData:function(e){R=e,te&&te.setProtectionData(R)},displayCaptionsOnTop:function(e){var t=(0,S.default)(f).getInstance();t.setConfig({videoModel:fe}),t.initialize(),t.setDisplayCConTop(e)},attachTTMLRenderingDiv:function(e){if(!fe.getElement())throw i;fe.setTTMLRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=NaN;return ge&&(e=ge.getCurrentTrackIdx()),e},getThumbnail:function(e,t){if(e<0)return null;var r=ne.getIsDynamic()?Ie(e):e,n=te.getStreamForTime(r);if(null===n)return null;var i=n.getThumbnailController();if(!i)return null;var o=te.getTimeRelativeToStreamId(r,n.getId());return i.get(o,t)},getDashAdapter:function(){return G},getSettings:function(){return m.get()},updateSettings:function(e){m.update(e)},resetSettings:function(){m.reset()},reset:function(){we(null),be(null),R=null,U&&(U.reset(),U=null),O&&(O.reset(),O=null),m.reset()}},M=T.getLogger(C),b=!1,x=!1,w=!1,q=!0,U=null,R=null,G=null,j.default.extend(X.default),Y=(0,k.default)(f).getInstance(),fe=(0,L.default)(f).getInstance(),me=(0,E.default)(f).getInstance(),C}me.__dashjs_factory_name="MediaPlayer";var ve=Q.default.getClassFactory(me);ve.events=X.default,ve.errors=z.default,Q.default.updateClassFactory(me.__dashjs_factory_name,ve),exports.default=ve;
},{"../../externals/cea608-parser":"xj1q","./constants/Constants":"jJgo","./constants/MetricsConstants":"RxE2","./controllers/PlaybackController":"PWsS","./controllers/StreamController":"P6bB","./controllers/MediaController":"xiaR","./controllers/BaseURLController":"W31W","./ManifestLoader":"JmtG","./utils/ErrorHandler":"UAeI","./utils/Capabilities":"e9Cw","./text/TextTracks":"cnD0","./utils/RequestModifier":"NKNS","./text/TextController":"IrZJ","./models/URIFragmentModel":"OQcj","./models/ManifestModel":"EELk","./models/MediaPlayerModel":"sSCB","./controllers/AbrController":"pZlR","./models/VideoModel":"GvOP","./utils/DOMStorage":"H4bj","./../core/Debug":"iL1O","./../core/errors/Errors":"Wrqa","./../core/EventBus":"Opee","./../core/events/Events":"W3G1","./MediaPlayerEvents":"yxZg","../core/FactoryMaker":"FHM8","../core/Settings":"yjrH","./../core/Version":"FY0Q","../dash/DashAdapter":"zB5j","../dash/DashMetrics":"Sn7l","../dash/utils/TimelineConverter":"nuFG","./vo/metrics/HTTPRequest":"yMBz","../../externals/base64":"BwRq","codem-isoboxer":"tss1","./vo/DashJSError":"gyaG","./utils/SupervisorTools":"A0aa"}],"IV4C":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.Debug=exports.FactoryMaker=exports.MediaPlayer=void 0;var r=require("./src/streaming/MediaPlayer"),a=i(r),t=require("./src/core/FactoryMaker"),o=i(t),s=require("./src/core/Debug"),u=i(s),d=require("./src/core/Version");function i(e){return e&&e.__esModule?e:{default:e}}var l="undefined"!=typeof window&&window||e,n=l.dashjs;n||(n=l.dashjs={}),n.MediaPlayer=a.default,n.FactoryMaker=o.default,n.Debug=u.default,n.Version=(0,d.getVersionString)(),exports.default=n,exports.MediaPlayer=a.default,exports.FactoryMaker=o.default,exports.Debug=u.default;
},{"./src/streaming/MediaPlayer":"nHmL","./src/core/FactoryMaker":"FHM8","./src/core/Debug":"iL1O","./src/core/Version":"FY0Q"}],"zoeP":[function(require,module,exports) {
"use strict";function t(t,E){if(!(t instanceof E))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var E=function E(){t(this,E),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};E.SSL_CONNECTION_FAILED_PREFIX="SSL",E.DNS_RESOLUTION_FAILED="C00",E.HOST_UNREACHABLE="C01",E.CONNECTION_REFUSED="C02",E.CONNECTION_ERROR="C03",E.CORRUPT_MEDIA_ISOBMFF="M00",E.CORRUPT_MEDIA_OTHER="M01",E.BASE_URL_CHANGED="F00",E.BECAME_REPORTER="S00",exports.default=E;
},{}],"AKp0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/events/EventsBase"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(e){function r(){n(this,r);var e=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e}return i(r,t.default),r}(),u=new a;exports.default=u;
},{"../../core/events/EventsBase":"zN1Q"}],"AdCW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../vo/DVBErrors"),e=n(r),o=require("../MetricsReportingEvents"),t=n(o);function n(r){return r&&r.__esModule?r:{default:r}}function E(r){var o=void 0,n=void 0,E=(r=r||{}).eventBus,s=r.dashMetrics,a=r.metricsConstants,i=r.events;function c(r){var o=new e.default;if(n){for(var t in r)r.hasOwnProperty(t)&&(o[t]=r[t]);o.mpdurl||(o.mpdurl=n.originalUrl||n.url),o.terror||(o.terror=new Date),s.addDVBErrors(o)}}function _(r){r.error||(n=r.manifest)}function f(r){c({errorcode:e.default.BASE_URL_CHANGED,servicelocation:r.entry})}function R(){c({errorcode:e.default.BECAME_REPORTER})}function u(r){switch(r.metric){case a.HTTP_REQUEST:(0===(o=r.value).responsecode||o.responsecode>=400||o.responsecode<100||o.responsecode>=600)&&c({errorcode:o.responsecode||e.default.CONNECTION_ERROR,url:o.url,terror:o.tresponse,servicelocation:o._serviceLocation})}var o}function d(r){var o=void 0;switch(r.error?r.error.code:0){case MediaError.MEDIA_ERR_NETWORK:o=e.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:o=e.default.CORRUPT_MEDIA_OTHER;break;default:return}c({errorcode:o})}function A(){E.on(i.MANIFEST_UPDATED,_,o),E.on(i.SERVICE_LOCATION_BLACKLIST_CHANGED,f,o),E.on(i.METRIC_ADDED,u,o),E.on(i.METRIC_UPDATED,u,o),E.on(i.PLAYBACK_ERROR,d,o),E.on(t.default.BECAME_REPORTING_PLAYER,R,o)}return o={initialise:A,reset:function(){E.off(i.MANIFEST_UPDATED,_,o),E.off(i.SERVICE_LOCATION_BLACKLIST_CHANGED,f,o),E.off(i.METRIC_ADDED,u,o),E.off(i.METRIC_UPDATED,u,o),E.off(i.PLAYBACK_ERROR,d,o),E.off(t.default.BECAME_REPORTING_PLAYER,R,o)}},A(),o}E.__dashjs_factory_name="DVBErrorsTranslator",exports.default=dashjs.FactoryMaker.getSingletonFactory(E);
},{"../vo/DVBErrors":"zoeP","../MetricsReportingEvents":"AKp0"}],"Ovrw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../utils/CustomTimeRanges"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function a(e){e=e||{};var r,a=!1,n=this.context,i=void 0,u=e.mediaElement;return r={initialize:function(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,r=t+e.duration;i.add(t,r)}),a=!!e[0]._useWallClockTime)},reset:function(){i.clear()},isEnabled:function(){var e,t=i.length;if(!t)return!0;e=a?(new Date).getTime()/1e3:u.currentTime;for(var r=0;r<t;r+=1){var n=i.start(r),o=i.end(r);if(n<=e&&e<o)return!0}return!1}},i=(0,t.default)(n).create(),r}a.__dashjs_factory_name="RangeController",exports.default=dashjs.FactoryMaker.getClassFactory(a);
},{"../../utils/CustomTimeRanges":"j59Z"}],"NGRW":[function(require,module,exports) {
"use strict";function e(){return{serialise:function e(t){var n=[],o=[],r=void 0,i=void 0;for(r in t)if(t.hasOwnProperty(r)&&0!==r.indexOf("_")){if(null==(i=t[r])&&(i=""),Array.isArray(i)){if(!i.length)continue;o=[],i.forEach(function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);o.push(n?t:e(t))}),i=o.map(encodeURIComponent).join(",")}else"string"==typeof i?i=encodeURIComponent(i):i instanceof Date?i=i.toISOString():"number"==typeof i&&(i=Math.round(i));n.push(r+"="+i)}return n.join("&")}}}Object.defineProperty(exports,"__esModule",{value:!0}),e.__dashjs_factory_name="MetricSerialiser",exports.default=dashjs.FactoryMaker.getSingletonFactory(e);
},{}],"mBkm":[function(require,module,exports) {
"use strict";function t(){var t,o=window.crypto||window.msCrypto,e=Uint32Array,r=Math.pow(2,8*e.BYTES_PER_ELEMENT)-1,n=10,a=void 0,d=void 0;function i(){o&&(a||(a=new e(n)),o.getRandomValues(a),d=0)}return t={random:function(t,e){var n=void 0;return t||(t=0),e||(e=1),o?(d===a.length&&i(),n=a[d]/r,d+=1):n=Math.random(),n*(e-t)+t}},i(),t}Object.defineProperty(exports,"__esModule",{value:!0}),t.__dashjs_factory_name="RNG",exports.default=dashjs.FactoryMaker.getSingletonFactory(t);
},{}],"Yw4z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../../utils/MetricSerialiser"),e=i(r),t=require("../../utils/RNG"),n=i(t);function i(r){return r&&r.__esModule?r:{default:r}}function o(r){r=r||{};var t,i=this.context,o=void 0,a=void 0,s=void 0,u=void 0,c=void 0,d=void 0,l=!0,f=!0,v=[],p=r.metricsConstants;function b(){s=!1,u=!1,c=null,d=null}return t={report:function(r,e){Array.isArray(e)||(e=[e]),u&&d.isEnabled()&&e.forEach(function(e){var t=o.serialise(e);l&&r!==p.DVB_ERRORS&&(t="metricname="+r+"&"+t),function(r,e,t){var n=new XMLHttpRequest,i=function(){var r=v.indexOf(n);-1!==r&&(v.splice(r,1),n.status>=200&&n.status<300?e&&e():t&&t())};v.push(n);try{n.open("GET",r),n.onloadend=i,n.onerror=i,n.send()}catch(o){n.onerror()}}(t=c+"?"+t,null,function(){u=!1})})},initialize:function(r,e){var t=void 0;if(d=e,!(c=r["dvb:reportingUrl"]))throw new Error("required parameter missing (dvb:reportingUrl)");s||((t=r["dvb:probability"]||r["dvb:priority"]||0)&&(1e3===t||t/1e3>=a.random())&&(u=!0),s=!0)},reset:function(){f||(v.forEach(function(r){return r.abort()}),v=[]),b()}},o=(0,e.default)(i).getInstance(),a=(0,n.default)(i).getInstance(),b(),t}o.__dashjs_factory_name="DVBReporting",exports.default=dashjs.FactoryMaker.getClassFactory(o);
},{"../../utils/MetricSerialiser":"NGRW","../../utils/RNG":"mBkm"}],"AS9b":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./reporters/DVBReporting"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(e){e=e||{};var r={"urn:dvb:dash:reporting:2014":t.default},n=this.context,o=e.debug,i=e.metricsConstants;return{create:function(e,t){var s=void 0;try{(s=r[e.schemeIdUri](n).create({metricsConstants:i})).initialize(e,t)}catch(a){s=null,o.error("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+a.message+")")}return s},register:function(e,t){r[e]=t},unregister:function(e){delete r[e]}}}n.__dashjs_factory_name="ReportingFactory",exports.default=dashjs.FactoryMaker.getSingletonFactory(n);
},{"./reporters/DVBReporting":"Yw4z"}],"DD5Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../reporting/ReportingFactory"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(e){var r=[],n=(0,t.default)(this.context).getInstance(e);return{initialize:function(e,t){e.some(function(e){var o=n.create(e,t);if(o)return r.push(o),!0})},reset:function(){r.forEach(function(e){return e.reset()}),r=[]},report:function(e,t){r.forEach(function(r){return r.report(e,t)})}}}n.__dashjs_factory_name="ReportingController",exports.default=dashjs.FactoryMaker.getClassFactory(n);
},{"../reporting/ReportingFactory":"AS9b"}],"Tdac":[function(require,module,exports) {
"use strict";function r(){return{reconstructFullMetricName:function(r,e,t){var n=r;return e&&(n+="("+e,t&&t.length&&(n+=","+t),n+=")"),n},validateN:function(r){if(!r)throw new Error("missing n");if(isNaN(r))throw new Error("n is NaN");if(r<0)throw new Error("n must be positive");return r}}}Object.defineProperty(exports,"__esModule",{value:!0}),r.__dashjs_factory_name="HandlerHelpers",exports.default=dashjs.FactoryMaker.getSingletonFactory(r);
},{}],"GNap":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../utils/HandlerHelpers"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(e){e=e||{};var r=void 0,n=void 0,u=void 0,l=void 0,a=void 0,i=this.context,c=(0,t.default)(i).getInstance(),o=[],s=e.metricsConstants;function d(){var e=function(){try{return Object.keys(o).map(function(e){return o[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}();e&&a!==e.t&&(a=e.t,r.report(u,e))}return{initialize:function(e,t,a){t&&(n=c.validateN(a),r=t,u=c.reconstructFullMetricName(e,a),l=setInterval(d,n))},reset:function(){clearInterval(l),l=null,n=0,r=null,a=null},handleNewMetric:function(e,t,r){e===s.BUFFER_LEVEL&&(o[r]=t)}}}n.__dashjs_factory_name="BufferLevelHandler",exports.default=dashjs.FactoryMaker.getClassFactory(n);
},{"../../utils/HandlerHelpers":"Tdac"}],"wetI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../MetricsReportingEvents"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function n(e){var r=void 0,n=(e=e||{}).eventBus,i=e.metricsConstants;function u(){n.off(t.default.METRICS_INITIALISATION_COMPLETE,u,this),n.trigger(t.default.BECAME_REPORTING_PLAYER)}return{initialize:function(e,i){i&&(r=i,n.on(t.default.METRICS_INITIALISATION_COMPLETE,u,this))},reset:function(){r=null},handleNewMetric:function(e,t){e===i.DVB_ERRORS&&r&&r.report(e,t)}}}exports.default=dashjs.FactoryMaker.getClassFactory(n);
},{"../../MetricsReportingEvents":"AKp0"}],"H5wO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../utils/HandlerHelpers"),t=n(e);function n(e){return e&&e.__esModule?e:{default:e}}function r(e){e=e||{};var n=void 0,r=void 0,l=void 0,a=void 0,i=void 0,s=[],u=(0,t.default)(this.context).getInstance(),o=e.metricsConstants;function c(){var e=s;e.length&&n&&n.report(a,e),s=[]}return{initialize:function(e,t,s,o){t&&(r=u.validateN(s),n=t,o&&o.length&&(l=o),a=u.reconstructFullMetricName(e,s,o),i=setInterval(c,r))},reset:function(){clearInterval(i),i=null,r=null,l=null,s=[],n=null},handleNewMetric:function(e,t){e===o.HTTP_REQUEST&&(l&&l!==t.type||s.push(t))}}}r.__dashjs_factory_name="HttpListHandler",exports.default=dashjs.FactoryMaker.getClassFactory(r);
},{"../../utils/HandlerHelpers":"Tdac"}],"Q4VO":[function(require,module,exports) {
"use strict";function e(){var e=void 0,t=void 0;return{initialize:function(r,i){e=r,t=i},reset:function(){t=null,e=void 0},handleNewMetric:function(r,i){r===e&&t&&t.report(e,i)}}}Object.defineProperty(exports,"__esModule",{value:!0}),e.__dashjs_factory_name="GenericMetricHandler",exports.default=dashjs.FactoryMaker.getClassFactory(e);
},{}],"Xgqg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./handlers/BufferLevelHandler"),r=l(e),t=require("./handlers/DVBErrorsHandler"),a=l(t),n=require("./handlers/HttpListHandler"),s=l(n),i=require("./handlers/GenericMetricHandler"),u=l(i);function l(e){return e&&e.__esModule?e:{default:e}}function c(e){var t=(e=e||{}).debug,n=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,i=this.context,l={BufferLevel:r.default,DVBErrors:a.default,HttpList:s.default,PlayList:u.default,RepSwitchList:u.default,TcpList:u.default};return{create:function(r,a){var s,u=r.match(n);if(u){try{(s=l[u[1]](i).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(u[1],a,u[3],u[5])}catch(c){s=null,t.error("MetricsHandlerFactory: Could not create handler for type "+u[1]+" with args "+u[3]+", "+u[5]+" ("+c.message+")")}return s}},register:function(e,r){l[e]=r},unregister:function(e){delete l[e]}}}c.__dashjs_factory_name="MetricsHandlerFactory",exports.default=dashjs.FactoryMaker.getSingletonFactory(c);
},{"./handlers/BufferLevelHandler":"GNap","./handlers/DVBErrorsHandler":"wetI","./handlers/HttpListHandler":"H5wO","./handlers/GenericMetricHandler":"Q4VO"}],"hr5o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../metrics/MetricsHandlerFactory"),t=n(e);function n(e){return e&&e.__esModule?e:{default:e}}function r(e){e=e||{};var n=[],r=void 0,s=this.context,i=e.eventBus,a=e.events,o=(0,t.default)(s).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function c(e){n.forEach(function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)})}return r={initialize:function(e,t){e.split(",").forEach(function(e,r,s){var i;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var a=s[r+1];a&&-1===a.indexOf("(")&&-1!==a.indexOf(")")&&(e+=","+a,delete s[r+1])}(i=o.create(e,t))&&n.push(i)}),i.on(a.METRIC_ADDED,c,r),i.on(a.METRIC_UPDATED,c,r)},reset:function(){i.off(a.METRIC_ADDED,c,r),i.off(a.METRIC_UPDATED,c,r),n.forEach(function(e){return e.reset()}),n=[]}}}r.__dashjs_factory_name="MetricsHandlersController",exports.default=dashjs.FactoryMaker.getClassFactory(r);
},{"../metrics/MetricsHandlerFactory":"Xgqg"}],"uq1e":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./RangeController"),t=a(e),r=require("./ReportingController"),i=a(r),n=require("./MetricsHandlersController"),s=a(n);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var r=void 0,n=void 0,a=void 0,o=this.context;function l(){r&&r.reset(),n&&n.reset(),a&&a.reset()}return{initialize:function(u){try{(a=(0,t.default)(o).create({mediaElement:e.mediaElement})).initialize(u.Range),(n=(0,i.default)(o).create({debug:e.debug,metricsConstants:e.metricsConstants})).initialize(u.Reporting,a),(r=(0,s.default)(o).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(u.metrics,n)}catch(c){throw l(),c}},reset:l}}o.__dashjs_factory_name="MetricsController",exports.default=dashjs.FactoryMaker.getClassFactory(o);
},{"./RangeController":"Ovrw","./ReportingController":"DD5Z","./MetricsHandlersController":"hr5o"}],"hmO6":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.metrics="",this.Range=[],this.Reporting=[]};exports.default=e;
},{}],"RH6O":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(){t(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};exports.default=e;
},{}],"oUTO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../vo/Metrics"),e=s(r),t=require("../vo/Range"),a=s(t),n=require("../vo/Reporting"),i=s(n);function s(r){return r&&r.__esModule?r:{default:r}}function o(r){var t=(r=r||{}).adapter,n=r.constants;return{getMetrics:function(r){var s=[];return r&&r.Metrics_asArray&&r.Metrics_asArray.forEach(function(o){var u=new e.default,c=t.getIsDynamic(r);o.hasOwnProperty("metrics")&&(u.metrics=o.metrics,o.Range_asArray&&o.Range_asArray.forEach(function(e){var i=new a.default;i.starttime=function(r,e,a){var i=t.getMpd(r),s=void 0,o=void 0,u=0;return e?u=t.getAvailabilityStartTime(i)/1e3:(s=t.getRegularPeriods(i)).length&&(u=s[0].start),o=u,a&&a.hasOwnProperty(n.START_TIME)&&(o+=a.starttime),o}(r,c,e),e.hasOwnProperty("duration")?i.duration=e.duration:i.duration=t.getDuration(r),i._useWallClockTime=c,u.Range.push(i)}),o.Reporting_asArray&&(o.Reporting_asArray.forEach(function(r){var e=new i.default;if(r.hasOwnProperty(n.SCHEME_ID_URI)){for(var t in e.schemeIdUri=r.schemeIdUri,r)r.hasOwnProperty(t)&&(e[t]=r[t]);u.Reporting.push(e)}}),s.push(u)))}),s}}}o.__dashjs_factory_name="ManifestParsing",exports.default=dashjs.FactoryMaker.getSingletonFactory(o);
},{"../vo/Metrics":"hmO6","../vo/Range":"RH6O","../vo/Reporting":"KFq0"}],"ezrE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./MetricsController"),t=o(e),r=require("../utils/ManifestParsing"),n=o(r),s=require("../MetricsReportingEvents"),a=o(s);function o(e){return e&&e.__esModule?e:{default:e}}function i(e){e=e||{};var r={},s=this.context,o=e.eventBus,i=e.events;function c(i){if(!i.error){var c=Object.keys(r);(0,n.default)(s).getInstance({adapter:e.adapter,constants:e.constants}).getMetrics(i.manifest).forEach(function(n){var a=JSON.stringify(n);if(r.hasOwnProperty(a))c.splice(a,1);else try{var o=(0,t.default)(s).create(e);o.initialize(n),r[a]=o}catch(i){}}),c.forEach(function(e){r[e].reset(),delete r[e]}),o.trigger(a.default.METRICS_INITIALISATION_COMPLETE)}}function f(){Object.keys(r).forEach(function(e){r[e].reset()}),r={}}return o.on(i.MANIFEST_UPDATED,c),o.on(i.STREAM_TEARDOWN_COMPLETE,f),{reset:function(){o.off(i.MANIFEST_UPDATED,c),o.off(i.STREAM_TEARDOWN_COMPLETE,f)}}}i.__dashjs_factory_name="MetricsCollectionController",exports.default=dashjs.FactoryMaker.getClassFactory(i);
},{"./MetricsController":"uq1e","../utils/ManifestParsing":"oUTO","../MetricsReportingEvents":"AKp0"}],"eTIY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./utils/DVBErrorsTranslator"),t=l(e),r=require("./MetricsReportingEvents"),s=l(r),n=require("./controllers/MetricsCollectionController"),a=l(n),o=require("./metrics/MetricsHandlerFactory"),c=l(o),i=require("./reporting/ReportingFactory"),u=l(i);function l(e){return e&&e.__esModule?e:{default:e}}function d(){var e=this.context;return{createMetricsReporting:function(r){return(0,t.default)(e).getInstance({eventBus:r.eventBus,dashMetrics:r.dashMetrics,metricsConstants:r.metricsConstants,events:r.events}),(0,a.default)(e).create(r)},getReportingFactory:function(){return(0,u.default)(e).getInstance()},getMetricsHandlerFactory:function(){return(0,c.default)(e).getInstance()}}}d.__dashjs_factory_name="MetricsReporting";var f=dashjs.FactoryMaker.getClassFactory(d);f.events=s.default,dashjs.FactoryMaker.updateClassFactory(d.__dashjs_factory_name,f),exports.default=f;
},{"./utils/DVBErrorsTranslator":"AdCW","./MetricsReportingEvents":"AKp0","./controllers/MetricsCollectionController":"ezrE","./metrics/MetricsHandlerFactory":"Xgqg","./reporting/ReportingFactory":"AS9b"}],"MyHL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function n(){t(this,n)}return e(n,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"===r.schemeIdUri.toLowerCase()&&"cenc"===r.value.toLowerCase()&&(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(e,t){var r=n.parsePSSHList(t);return e&&r.hasOwnProperty(e.uuid.toLowerCase())?r[e.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?t.decodeArray(e.pssh.__text).buffer:null}},{key:"parsePSSHList",value:function(e){if(null==e)return[];for(var t=new DataView(e.buffer||e),n={},r=0;;){var o,i,a=void 0,u=r;if(r>=t.buffer.byteLength)break;if(o=r+t.getUint32(r),r+=4,1886614376===t.getUint32(r))if(r+=4,0===(i=t.getUint8(r))||1===i){r++,r+=3,a="";var f=void 0,l=void 0;for(f=0;f<4;f++)a+=1===(l=t.getUint8(r+f).toString(16)).length?"0"+l:l;for(r+=4,a+="-",f=0;f<2;f++)a+=1===(l=t.getUint8(r+f).toString(16)).length?"0"+l:l;for(r+=2,a+="-",f=0;f<2;f++)a+=1===(l=t.getUint8(r+f).toString(16)).length?"0"+l:l;for(r+=2,a+="-",f=0;f<2;f++)a+=1===(l=t.getUint8(r+f).toString(16)).length?"0"+l:l;for(r+=2,a+="-",f=0;f<6;f++)a+=1===(l=t.getUint8(r+f).toString(16)).length?"0"+l:l;r+=6,a=a.toLowerCase(),t.getUint32(r),r+=4,n[a]=t.buffer.slice(u,o),r=o}else r=o;else r=o}return n}}]),n}();exports.default=n;
},{}],"Ahrd":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(n,s){t(this,e),this.contentType=n,this.robustness=s};exports.default=e;
},{}],"yEQC":[function(require,module,exports) {
"use strict";function t(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var i=function i(e,s,n,a,o){t(this,i),this.initDataTypes=["cenc"],e&&e.length&&(this.audioCapabilities=e),s&&s.length&&(this.videoCapabilities=s),this.distinctiveIdentifier=n,this.persistentState=a,this.sessionTypes=o};exports.default=i;
},{}],"wa5g":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var E=require("../../../core/errors/ErrorsBase"),e=_(E);function _(E){return E&&E.__esModule?E:{default:E}}function r(E,e){if(!(E instanceof e))throw new TypeError("Cannot call a class as a function")}function t(E,e){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?E:e}function R(E,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);E.prototype=Object.create(e&&e.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(E,e):E.__proto__=e)}var o=function(E){function _(){r(this,_);var E=t(this,(_.__proto__||Object.getPrototypeOf(_)).call(this));return E.MEDIA_KEYERR_CODE=100,E.MEDIA_KEYERR_UNKNOWN_CODE=101,E.MEDIA_KEYERR_CLIENT_CODE=102,E.MEDIA_KEYERR_SERVICE_CODE=103,E.MEDIA_KEYERR_OUTPUT_CODE=104,E.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,E.MEDIA_KEYERR_DOMAIN_CODE=106,E.MEDIA_KEY_MESSAGE_ERROR_CODE=107,E.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,E.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,E.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,E.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,E.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,E.KEY_SESSION_CREATED_ERROR_CODE=113,E.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,E.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",E.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",E.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",E.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",E.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",E.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",E.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",E.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",E.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",E.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",E.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",E.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",E.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",E.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",E}return R(_,e.default),_}(),n=new o;exports.default=n;
},{"../../../core/errors/ErrorsBase":"zN1Q"}],"Usvx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=require("../CommonEncryption"),n=f(t),r=require("../vo/MediaCapability"),s=f(r),i=require("../vo/KeySystemConfiguration"),o=f(i),a=require("../errors/ProtectionErrors"),E=f(a),S=require("../../vo/DashJSError"),u=f(S);function f(e){return e&&e.__esModule?e:{default:e}}var d=5,_=500,l=3,y=1e3,c=8e3;function R(t){var r=(t=t||{}).protectionKeyController,i=t.protectionModel,a=t.eventBus,S=t.events,f=t.debug,R=t.BASE64,g=t.constants,D=[],C=void 0,p=void 0,M=void 0,v=void 0,K=void 0,T=void 0,A=void 0,m=void 0;function Y(){if(!(a&&a.hasOwnProperty("on")&&r&&r.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function h(e,t){var s=n.default.getPSSHForKeySystem(m,e),o=I(m);if(s){for(var f=i.getAllInitData(),d=0;d<f.length;d++)if(r.initDataEquals(s,f[d]))return void p.warn("DRM: Ignoring initData because we have already seen it!");try{i.createKeySession(s,o,b(m),t)}catch(_){a.trigger(S.KEY_SESSION_CREATED,{data:null,error:new u.default(E.default.KEY_SESSION_CREATED_ERROR_CODE,E.default.KEY_SESSION_CREATED_ERROR_MESSAGE+_.message)})}}else e?i.createKeySession(e,o,b(m),t):a.trigger(S.KEY_SESSION_CREATED,{data:null,error:new u.default(E.default.KEY_SESSION_CREATED_ERROR_CODE,E.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(m?m.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function L(e,t){Y(),i.loadKeySession(e,t,b(m))}function O(e){Y(),e?(i.setMediaElement(e),a.on(S.NEED_KEY,q,this)):null===e&&(i.setMediaElement(e),a.off(S.NEED_KEY,q,this))}function I(e){var t=null;if(e){var n=e.systemString;K&&(t=n in K?K[n]:null)}return t}function N(e){var t=I(e),n=[],r=[],i=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:A,a=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:A,E=b(e),S=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",u=t&&t.persistentState?t.persistentState:"temporary"===E?"optional":"required";return v.forEach(function(e){e.type===g.AUDIO?n.push(new s.default(e.codec,i)):e.type===g.VIDEO&&r.push(new s.default(e.codec,a))}),new o.default(n,r,S,u,[E])}function b(e){var t=I(e);return t&&t.sessionType?t.sessionType:T}function w(e,t){var n=this,s=[],o=void 0;if(m)for(o=0;o<e.length;o++){if(m===e[o].ks)if("break"===function(){s.push({ks:e[o].ks,configs:[N(m)]});return a.on(S.KEY_SYSTEM_ACCESS_COMPLETE,function r(s){a.off(S.KEY_SYSTEM_ACCESS_COMPLETE,r,n),s.error?t||a.trigger(S.KEY_SYSTEM_SELECTED,{error:new u.default(E.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,E.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+s.error)}):(p.info("DRM: KeySystem Access Granted"),a.trigger(S.KEY_SYSTEM_SELECTED,{data:s.data}),e[o].sessionId?L(e[o].sessionId,e[o].initData):e[o].initData&&h(e[o].initData,e[o].cdmData))},n),i.requestKeySystemAccess(s),"break"}())break}else if(void 0===m){m=null,M.push(e);for(var f=0;f<e.length;f++)s.push({ks:e[f].ks,configs:[N(e[f].ks)]});var d=void 0,_=function e(r){a.off(S.KEY_SYSTEM_ACCESS_COMPLETE,e,n),r.error?(m=void 0,a.off(S.INTERNAL_KEY_SYSTEM_SELECTED,l,n),t||a.trigger(S.KEY_SYSTEM_SELECTED,{data:null,error:new u.default(E.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,E.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+r.error)})):(d=r.data,p.info("DRM: KeySystem Access Granted ("+d.keySystem.systemString+")!  Selecting key system..."),i.selectKeySystem(d))},l=function e(s){if(a.off(S.INTERNAL_KEY_SYSTEM_SELECTED,e,n),a.off(S.KEY_SYSTEM_ACCESS_COMPLETE,_,n),s.error)m=void 0,t||a.trigger(S.KEY_SYSTEM_SELECTED,{data:null,error:new u.default(E.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,E.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+s.error)});else{if(!i)return;m=i.getKeySystem(),a.trigger(S.KEY_SYSTEM_SELECTED,{data:d});var f=I(m);f&&f.serverCertificate&&f.serverCertificate.length>0&&i.setServerCertificate(R.decodeArray(f.serverCertificate).buffer);for(var l=0;l<M.length;l++)for(o=0;o<M[l].length;o++)if(m===M[l][o].ks){if(r.isClearKey(m)&&f&&f.hasOwnProperty("clearkeys")){var y={kids:Object.keys(f.clearkeys)};M[l][o].initData=(new TextEncoder).encode(JSON.stringify(y))}M[l][o].sessionId?L(M[l][o].sessionId,M[l][o].initData):null!==M[l][o].initData&&h(M[l][o].initData,M[l][o].cdmData);break}}};a.on(S.INTERNAL_KEY_SYSTEM_SELECTED,l,n),a.on(S.KEY_SYSTEM_ACCESS_COMPLETE,_,n),i.requestKeySystemAccess(s)}else M.push(e)}function k(e,t){a.trigger(S.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function G(e){e.error?a.trigger(S.KEY_STATUSES_CHANGED,{data:null,error:e.error}):p.debug("DRM: key status = "+e.status)}function P(t){p.debug("DRM: onKeyMessage");var s=t.data;a.trigger(S.KEY_MESSAGE,{data:s});var o=s.messageType?s.messageType:"license-request",f=s.message,d=s.sessionToken,_=I(m),R=m?m.systemString:null,g=r.getLicenseServer(m,_,o),D={sessionToken:d,messageType:o};if(f&&0!==f.byteLength){if(!g)return p.debug("DRM: License server request not required for this message (type = "+t.data.messageType+").  Session ID = "+d.getSessionID()),void k(D);if(r.isClearKey(m)){var C=r.processClearKeyLicenseRequest(m,_,f);if(C)return p.debug("DRM: ClearKey license request handled by application!"),k(D),void i.updateKeySession(d,C)}var M=null;if(_&&_.serverURL){var v=_.serverURL;"string"==typeof v&&""!==v?M=v:"object"===(void 0===v?"undefined":e(v))&&v.hasOwnProperty(o)&&(M=v[o])}else _&&_.laURL&&""!==_.laURL?M=_.laURL:(M=m.getLicenseServerURLFromInitData(n.default.getPSSHData(d.initData)))||(M=t.data.laURL);if(M=g.getServerURLFromMessage(M,f,o)){var K={},T=!1,A=function(e){if(e)for(var t in e)"authorization"===t.toLowerCase()&&(T=!0),K[t]=e[t]};_&&A(_.httpRequestHeaders),A(m.getRequestHeadersFromMessage(f)),_&&"boolean"==typeof _.withCredentials&&(T=_.withCredentials);var Y=function(e,t,n,r){var s=e.response?g.getErrorResponse(e.response,n,r):"NONE";k(t,new u.default(E.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,E.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+s))},h=m.getLicenseRequestFromMessage(f),L=g.getHTTPMethod(o),O=g.getResponseType(R,o),N=_&&!isNaN(_.httpTimeout)?_.httpTimeout:c;!function e(t,n,r,s,i,o,a,E,S,u,f){var d=new XMLHttpRequest;d.open(r,t,!0);d.responseType=s;d.withCredentials=i;E>0&&(d.timeout=E);for(var _ in n)d.setRequestHeader(_,n[_]);var l=function(){a--,setTimeout(function(){e(t,n,r,s,i,o,a,E,S,u,f)},y)};d.onload=function(){200===this.status||a<=0?S(this):(p.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+a),l())};d.ontimeout=d.onerror=function(){a<=0?f(this):(p.warn("License request network request failed . Retrying it... Pending retries: "+a),l())};d.onabort=function(){u(this)};d.send(o)}(M,K,L,O,T,h,l,N,function(e){if(i)if(200===e.status){var t=g.getLicenseMessage(e.response,R,o);null!==t?(k(D),i.updateKeySession(d,t)):Y(e,D,R,o)}else Y(e,D,R,o)},function(e){k(D,new u.default(E.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,E.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+R+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},function(e){k(D,new u.default(E.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,E.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+R+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))})}else k(D,new u.default(E.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,E.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}else k(D,new u.default(E.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,E.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function q(e,t){if(p.debug("DRM: onNeedKey"),"cenc"===e.key.initDataType)if(0===v.length&&(p.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<d))D.push(setTimeout(function(){q(e,t)},_));else{var s=e.key.initData;if(ArrayBuffer.isView(s)&&(s=s.buffer),m){var o=n.default.getPSSHForKeySystem(m,s);if(o)for(var a=i.getAllInitData(),E=0;E<a.length;E++)if(r.initDataEquals(o,a[E]))return void p.warn("DRM: Ignoring initData because we have already seen it!")}p.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(s)));var S=r.getSupportedKeySystems(s,K);0!==S.length?w(S,!1):p.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!")}else p.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType)}return C={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");Y(),a.on(S.INTERNAL_KEY_MESSAGE,P,this),a.on(S.INTERNAL_KEY_STATUS_CHANGED,G,this),v.push(e);var t=r.getSupportedKeySystemsFromContentProtection(e.contentProtection);t&&t.length>0&&w(t,!0)},createKeySession:h,loadKeySession:L,removeKeySession:function(e){Y(),i.removeKeySession(e)},closeKeySession:function(e){Y(),i.closeKeySession(e)},setServerCertificate:function(e){Y(),i.setServerCertificate(e)},setMediaElement:O,setSessionType:function(e){T=e},setRobustnessLevel:function(e){A=e},setProtectionData:function(e){K=e,r.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return Y(),r.getSupportedKeySystemsFromContentProtection(e)},getKeySystems:function(){return r?r.getKeySystems():[]},setKeySystems:function(e){r&&r.setKeySystems(e)},stop:function(){i&&i.stop()},reset:function(){Y(),a.off(S.INTERNAL_KEY_MESSAGE,P,this),a.off(S.INTERNAL_KEY_STATUS_CHANGED,G,this),O(null),m=void 0,i&&(i.reset(),i=null),D.forEach(function(e){return clearTimeout(e)}),D=[],v=[]}},p=f.getLogger(C),M=[],v=[],T="temporary",A="",C}R.__dashjs_factory_name="ProtectionController",exports.default=dashjs.FactoryMaker.getClassFactory(R);
},{"../CommonEncryption":"MyHL","../vo/MediaCapability":"Ahrd","../vo/KeySystemConfiguration":"yEQC","../errors/ProtectionErrors":"wa5g","../../vo/DashJSError":"gyaG"}],"xw6I":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function t(n,s){e(this,t),this.keyID=n,this.key=s};exports.default=t;
},{}],"yr9E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function r(e,n){if(t(this,r),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=e,this.type=n}return e(r,[{key:"toJWK",value:function(){var e=void 0,t=this.keyPairs.length,r={keys:[]};for(e=0;e<t;e++){var n={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};r.keys.push(n)}this.type&&(r.type=this.type);var i=JSON.stringify(r),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),r}();exports.default=r;
},{}],"ePRW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var t=function(){function t(){n(this,t),this.init()}return e(t,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready"}}]),t}(),r=new t;exports.default=r;
},{}],"w9HH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../vo/KeyPair"),r=i(e),t=require("../vo/ClearKeyKeySet"),n=i(t),a=require("../CommonEncryption"),u=i(a),o=require("../../constants/ProtectionConstants"),s=i(o);function i(e){return e&&e.__esModule?e:{default:e}}var l="e2719d58-a985-b3c9-781a-b030af78d30e",c=s.default.CLEARKEY_KEYSTEM_STRING,f="urn:uuid:"+l;function y(e){var t=(e=e||{}).BASE64;return{uuid:l,schemeIdURI:f,systemString:c,getInitData:function(e){return u.default.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var a=null;if(e){for(var u=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),o=[],s=0;s<u.kids.length;s++){var i=u.kids[s],l=e.clearkeys&&e.clearkeys.hasOwnProperty(i)?e.clearkeys[i]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+i+") is not known!");o.push(new r.default(i,l))}a=new n.default(o)}return a}}}y.__dashjs_factory_name="KeySystemClearKey",exports.default=dashjs.FactoryMaker.getSingletonFactory(y);
},{"../vo/KeyPair":"xw6I","../vo/ClearKeyKeySet":"yr9E","../CommonEncryption":"MyHL","../../constants/ProtectionConstants":"ePRW"}],"Bgmy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../vo/KeyPair"),r=i(e),t=require("../vo/ClearKeyKeySet"),n=i(t),a=require("../CommonEncryption"),o=i(a),u=require("../../constants/ProtectionConstants"),s=i(u);function i(e){return e&&e.__esModule?e:{default:e}}var c="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",l=s.default.CLEARKEY_KEYSTEM_STRING,f="urn:uuid:"+c;function d(e){var t=void 0,a=e.BASE64,u=e.debug.getLogger(t);return t={uuid:c,schemeIdURI:f,systemString:l,getInitData:function(e){return o.default.parseInitDataFromContentProtection(e,a)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var a=null;if(e){for(var o=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),s=[],i=0;i<o.kids.length;i++){var c=o.kids[i],l=e.clearkeys&&e.clearkeys.hasOwnProperty(c)?e.clearkeys[c]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+c+") is not known!");s.push(new r.default(c,l))}a=new n.default(s),u.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return a}}}d.__dashjs_factory_name="KeySystemW3CClearKey",exports.default=dashjs.FactoryMaker.getSingletonFactory(d);
},{"../vo/KeyPair":"xw6I","../vo/ClearKeyKeySet":"yr9E","../CommonEncryption":"MyHL","../../constants/ProtectionConstants":"ePRW"}],"MBOP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../CommonEncryption"),t=s(e),n=require("../../constants/ProtectionConstants"),r=s(n);function s(e){return e&&e.__esModule?e:{default:e}}var u="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",o=r.default.WIDEVINE_KEYSTEM_STRING,i="urn:uuid:"+u;function a(e){var n=null,r=(e=e||{}).BASE64;return{uuid:u,schemeIdURI:i,systemString:o,init:function(e){e&&(n=e)},getInitData:function(e){return t.default.parseInitDataFromContentProtection(e,r)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(e){return n&&n.sessionId?n.sessionId:e&&e.sessionId?e.sessionId:null}}}a.__dashjs_factory_name="KeySystemWidevine",exports.default=dashjs.FactoryMaker.getSingletonFactory(a);
},{"../CommonEncryption":"MyHL","../../constants/ProtectionConstants":"ePRW"}],"fgAQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../CommonEncryption"),t=a(e),n=require("../../constants/ProtectionConstants"),r=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var i="9a04f079-9840-4286-ab92-e65be0885f95",o=r.default.PLAYREADY_KEYSTEM_STRING,s="urn:uuid:"+i,l='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>',u=void 0;function d(e){var n="utf-16",r=(e=e||{}).BASE64;function a(){if(!r||!r.hasOwnProperty("decodeArray")||!r.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:i,schemeIdURI:s,systemString:o,getInitData:function(e){var n,i,o,s=new Uint8Array([112,115,115,104,0,0,0,0]),l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=0,d=null,f=void 0,c=void 0;if(a(),!e)return null;if("pssh"in e)return t.default.parseInitDataFromContentProtection(e,r);if("pro"in e)d=r.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;d=r.decodeArray(e.prheader.__text)}return n=d.length,i=4+s.length+l.length+4+n,o=new ArrayBuffer(i),f=new Uint8Array(o),(c=new DataView(o)).setUint32(u,i),u+=4,f.set(s,u),u+=s.length,f.set(l,u),u+=l.length,c.setUint32(u,n),u+=4,f.set(d,u),u+=n,f.buffer},getRequestHeadersFromMessage:function(e){var t,r=void 0,a={},i=new DOMParser,o="utf-16"===n?new Uint16Array(e):new Uint8Array(e);t=String.fromCharCode.apply(null,o);for(var s=(r=i.parseFromString(t,"application/xml")).getElementsByTagName("name"),l=r.getElementsByTagName("value"),u=0;u<s.length;u++)a[s[u].childNodes[0].nodeValue]=l[u].childNodes[0].nodeValue;return a.hasOwnProperty("Content")&&(a["Content-Type"]=a.Content,delete a.Content),a.hasOwnProperty("Content-Type")||(a["Content-Type"]="text/xml; charset="+n),a},getLicenseRequestFromMessage:function(e){var t=null,i=new DOMParser,o="utf-16"===n?new Uint16Array(e):new Uint8Array(e);a();var s=String.fromCharCode.apply(null,o),l=i.parseFromString(s,"application/xml");if(!l.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var u=l.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return u&&(t=r.decode(u)),t},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,a=new DOMParser,i=0;i<n;i++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var l=e.slice(r,r+s),u=String.fromCharCode.apply(null,new Uint16Array(l)),d=a.parseFromString(u,"application/xml");if(d.getElementsByTagName("LA_URL")[0]){var f=d.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(f)return f}if(d.getElementsByTagName("LUI_URL")[0]){var c=d.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(c)return c}}else r+=s}return null},getCDMData:function(){var e=void 0,t=void 0,n=void 0,i=void 0;if(a(),u&&u.cdmData){for(e=[],i=0;i<u.cdmData.length;++i)e.push(u.cdmData.charCodeAt(i)),e.push(0);for(e=String.fromCharCode.apply(null,e),e=r.encode(e),t=l.replace("%CUSTOMDATA%",e),n=[],i=0;i<t.length;++i)n.push(t.charCodeAt(i)),n.push(0);return new Uint8Array(n).buffer}return null},getSessionId:function(e){return u&&u.sessionId?u.sessionId:e&&e.sessionId?e.sessionId:null},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');n=e},init:function(e){e&&(u=e)}}}d.__dashjs_factory_name="KeySystemPlayReady",exports.default=dashjs.FactoryMaker.getSingletonFactory(d);
},{"../CommonEncryption":"MyHL","../../constants/ProtectionConstants":"ePRW"}],"QEiN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../constants/ProtectionConstants"),r=n(e);function n(e){return e&&e.__esModule?e:{default:e}}function t(e){var n=(e=e||{}).BASE64,t={};t[r.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return n.decodeArray(e.license)},getErrorResponse:function(e){return e}},t[r.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}};return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return t[e].responseType},getLicenseMessage:function(e,r){return function(){if(!n||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),t[r].getLicenseMessage(e)},getErrorResponse:function(e,r){return t[r].getErrorResponse(e)}}}t.__dashjs_factory_name="DRMToday",exports.default=dashjs.FactoryMaker.getSingletonFactory(t);
},{"../../constants/ProtectionConstants":"ePRW"}],"uv7F":[function(require,module,exports) {
"use strict";function e(){var e="http://schemas.xmlsoap.org/soap/envelope/";function n(e){var n=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(n))}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(t){return function(t){if(window.DOMParser){var r=n(t),a=(new window.DOMParser).parseFromString(r,"text/xml"),l=a?a.getElementsByTagNameNS(e,"Envelope")[0]:null,s=l?l.getElementsByTagNameNS(e,"Body")[0]:null;if(s&&s.getElementsByTagNameNS(e,"Fault")[0])return null}return t}.call(this,t)},getErrorResponse:function(t){return function(t){var r="",a="",l="",s=-1,u=-1;if(window.DOMParser){var o=n(t),g=(new window.DOMParser).parseFromString(o,"text/xml"),i=g?g.getElementsByTagNameNS(e,"Envelope")[0]:null,m=i?i.getElementsByTagNameNS(e,"Body")[0]:null,d=m?m.getElementsByTagNameNS(e,"Fault")[0]:null,f=d?d.getElementsByTagName("detail")[0]:null,y=f?f.getElementsByTagName("Exception")[0]:null,c=null;if(null===d)return o;r=(c=d.getElementsByTagName("faultstring")[0].firstChild)?c.nodeValue:null,null!==y&&(a=(c=y.getElementsByTagName("StatusCode")[0])?c.firstChild.nodeValue:null,s=(l=(c=y.getElementsByTagName("Message")[0])?c.firstChild.nodeValue:null)?l.lastIndexOf("[")+1:-1,u=l?l.indexOf("]"):-1,l=l?l.substring(s,u):"")}var p="code: "+a+", name: "+r;return l&&(p+=", message: "+l),p}.call(this,t)}}}Object.defineProperty(exports,"__esModule",{value:!0}),e.__dashjs_factory_name="PlayReady",exports.default=dashjs.FactoryMaker.getSingletonFactory(e);
},{}],"wuSm":[function(require,module,exports) {
"use strict";function e(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}Object.defineProperty(exports,"__esModule",{value:!0}),e.__dashjs_factory_name="Widevine",exports.default=dashjs.FactoryMaker.getSingletonFactory(e);
},{}],"RJAB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../vo/KeyPair"),r=a(e),n=require("../vo/ClearKeyKeySet"),t=a(n);function a(e){return e&&e.__esModule?e:{default:e}}function o(){return{getServerURLFromMessage:function(e,r){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(r)));e+="/?";for(var t=0;t<n.kids.length;t++)e+=n.kids[t]+"&";return e=e.substring(0,e.length-1)},getHTTPMethod:function(){return"GET"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var n=[],a=0;a<e.keys.length;a++){var o=e.keys[a],s=o.kid.replace(/=/g,""),u=o.k.replace(/=/g,"");n.push(new r.default(s,u))}return new t.default(n)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}o.__dashjs_factory_name="ClearKey",exports.default=dashjs.FactoryMaker.getSingletonFactory(o);
},{"../vo/KeyPair":"xw6I","../vo/ClearKeyKeySet":"yr9E"}],"mMyc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./../CommonEncryption"),t=E(e),r=require("./../drm/KeySystemClearKey"),n=E(r),i=require("./../drm/KeySystemW3CClearKey"),s=E(i),a=require("./../drm/KeySystemWidevine"),o=E(a),u=require("./../drm/KeySystemPlayReady"),d=E(u),l=require("./../servers/DRMToday"),y=E(l),c=require("./../servers/PlayReady"),f=E(c),g=require("./../servers/Widevine"),S=E(g),v=require("./../servers/ClearKey"),m=E(v),h=require("../../constants/ProtectionConstants"),I=E(h);function E(e){return e&&e.__esModule?e:{default:e}}function K(){var e=this.context,r=void 0,i=void 0,a=void 0,u=void 0,l=void 0,c=void 0,g=void 0;return r={initialize:function(){u=[];var t=void 0;t=(0,d.default)(e).getInstance({BASE64:l}),u.push(t),t=(0,o.default)(e).getInstance({BASE64:l}),u.push(t),t=(0,n.default)(e).getInstance({BASE64:l}),u.push(t),c=t,t=(0,s.default)(e).getInstance({BASE64:l,debug:i}),u.push(t),g=t},setProtectionData:function(e){for(var t,r,n=0;n<u.length;n++){var i=u[n];i.hasOwnProperty("init")&&i.init((t=i.systemString,r=void 0,r=null,e&&(r=t in e?e[t]:null),r))}},isClearKey:function(e){return e===c||e===g},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var r=new Uint8Array(e),n=new Uint8Array(t),i=0;i<r.length;i++)if(r[i]!==n[i])return!1;return!0}return!1},getKeySystems:function(){return u},setKeySystems:function(e){u=e},getKeySystemBySystemString:function(e){for(var t=0;t<u.length;t++)if(u[t].systemString===e)return u[t];return null},getSupportedKeySystemsFromContentProtection:function(e){var t=void 0,r=void 0,n=void 0,i=void 0,s=[];if(e)for(n=0;n<u.length;++n)for(r=u[n],i=0;i<e.length;++i)if((t=e[i]).schemeIdUri.toLowerCase()===r.schemeIdURI){var a=r.getInitData(t);s.push({ks:u[n],initData:a,cdmData:r.getCDMData(),sessionId:r.getSessionId(t)})}return s},getSupportedKeySystems:function(e,r){for(var n=[],i=t.default.parsePSSHList(e),s=void 0,a=void 0,o=void 0,d=0;d<u.length;++d)a=(s=u[d]).systemString,o=!r||a in r,s.uuid in i&&o&&n.push({ks:s,initData:i[s.uuid],cdmData:s.getCDMData(),sessionId:s.getSessionId()});return n},getLicenseServer:function(t,r,n){if("license-release"===n||"individualization-request"===n)return null;var i=null;return r&&r.hasOwnProperty("drmtoday")?i=(0,y.default)(e).getInstance({BASE64:l}):t.systemString===I.default.WIDEVINE_KEYSTEM_STRING?i=(0,S.default)(e).getInstance():t.systemString===I.default.PLAYREADY_KEYSTEM_STRING?i=(0,f.default)(e).getInstance():t.systemString===I.default.CLEARKEY_KEYSTEM_STRING&&(i=(0,m.default)(e).getInstance()),i},processClearKeyLicenseRequest:function(e,t,r){try{return e.getClearKeysFromProtectionData(t,r)}catch(n){return a.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(e){e&&(e.debug&&(i=e.debug,a=i.getLogger(r)),e.BASE64&&(l=e.BASE64))}}}K.__dashjs_factory_name="ProtectionKeyController",exports.default=dashjs.FactoryMaker.getSingletonFactory(K);
},{"./../CommonEncryption":"MyHL","./../drm/KeySystemClearKey":"w9HH","./../drm/KeySystemW3CClearKey":"Bgmy","./../drm/KeySystemWidevine":"MBOP","./../drm/KeySystemPlayReady":"fgAQ","./../servers/DRMToday":"QEiN","./../servers/PlayReady":"uv7F","./../servers/Widevine":"wuSm","./../servers/ClearKey":"RJAB","../../constants/ProtectionConstants":"ePRW"}],"Tro5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/events/EventsBase"),t=E(e);function E(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _=function(e){function E(){o(this,E);var e=n(this,(E.__proto__||Object.getPrototypeOf(E)).call(this));return e.INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e}return r(E,t.default),E}(),i=new _;exports.default=i;
},{"../../core/events/EventsBase":"zN1Q"}],"FvY9":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(a,i){t(this,e),this.initData=a,this.initDataType=i};exports.default=e;
},{}],"JAmi":[function(require,module,exports) {
"use strict";function e(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var s=function s(t,n,i,a){e(this,s),this.sessionToken=t,this.message=n,this.defaultURL=i,this.messageType=a||"license-request"};exports.default=s;
},{}],"O96N":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(n,s){t(this,e),this.keySystem=n,this.ksConfiguration=s};exports.default=e;
},{}],"x11l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../controllers/ProtectionKeyController"),t=f(e),n=require("../vo/NeedKey"),s=f(n),r=require("../errors/ProtectionErrors"),i=f(r),a=require("../../vo/DashJSError"),o=f(a),E=require("../vo/KeyMessage"),u=f(E),c=require("../vo/KeySystemAccess"),S=f(c),d=require("../../constants/ProtectionConstants"),g=f(d);function f(e){return e&&e.__esModule?e:{default:e}}function _(e){e=e||{};var n=this.context,r=e.eventBus,a=e.events,E=e.debug,c=void 0,d=void 0,f=void 0,_=void 0,l=void 0,y=void 0,R=void 0,D=void 0;function v(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function T(e){for(var t=0;t<y.length;t++)if(y[t]===e){y.splice(t,1);break}}function C(e){var t=void 0,n=void 0;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function K(e,t,n,s){var E={session:e,initData:t,sessionId:s,handleEvent:function(e){switch(e.type){case"keystatuseschange":r.trigger(a.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach(function(){var e=C(arguments);switch(e.status){case"expired":r.trigger(a.INTERNAL_KEY_STATUS_CHANGED,{error:new o.default(i.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,i.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:r.trigger(a.INTERNAL_KEY_STATUS_CHANGED,e)}});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;r.trigger(a.INTERNAL_KEY_MESSAGE,{data:new u.default(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach(function(){"usable"===C(arguments).status&&(t=!0)}),t},getSessionType:function(){return n}};return e.addEventListener("keystatuseschange",E),e.addEventListener("message",E),e.closed.then(function(){T(E),d.debug("DRM: Session closed.  SessionID = "+E.getSessionID()),r.trigger(a.KEY_SESSION_CLOSED,{data:E.getSessionID()})}),y.push(E),E}return c={getAllInitData:function(){for(var e=[],t=0;t<y.length;t++)y[t].initData&&e.push(y[t].initData);return e},requestKeySystemAccess:function(e){!function e(t,n){var s,i,o,E;void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess?(i=t[s=n].ks,o=t[s].configs,(E=i.systemString)===g.default.PLAYREADY_KEYSTEM_STRING&&"required"===o[0].persistentState&&(E+=".recommendation"),navigator.requestMediaKeySystemAccess(E,o).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,n=new S.default(i,t);n.mksa=e,r.trigger(a.KEY_SYSTEM_ACCESS_COMPLETE,{data:n})}).catch(function(n){++s<t.length?e(t,s):r.trigger(a.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! "+n.message})})):r.trigger(a.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Insecure origins are not allowed"})}(e,0)},getKeySystem:function(){return f},selectKeySystem:function(e){e.mksa.createMediaKeys().then(function(t){f=e.keySystem,l=t,_?_.setMediaKeys(l).then(function(){r.trigger(a.INTERNAL_KEY_SYSTEM_SELECTED)}):r.trigger(a.INTERNAL_KEY_SYSTEM_SELECTED)}).catch(function(){r.trigger(a.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})},setMediaElement:function(e){_!==e&&(_&&(_.removeEventListener("encrypted",R),_.setMediaKeys&&_.setMediaKeys(null)),(_=e)&&(_.addEventListener("encrypted",R),_.setMediaKeys&&l&&_.setMediaKeys(l)))},setServerCertificate:function(e){if(!f||!l)throw new Error("Can not set server certificate until you have selected a key system");l.setServerCertificate(e).then(function(){d.info("DRM: License server certificate successfully updated."),r.trigger(a.SERVER_CERTIFICATE_UPDATED)}).catch(function(e){r.trigger(a.SERVER_CERTIFICATE_UPDATED,{error:new o.default(i.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,i.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})})},createKeySession:function(e,t,n){if(!f||!l)throw new Error("Can not create sessions until you have selected a key system");var s=l.createSession(n),E=K(s,e,n),u=this.getKeySystem().systemString===g.default.CLEARKEY_KEYSTEM_STRING&&t&&t.clearkeys?"keyids":"cenc";s.generateRequest(u,e).then(function(){d.debug("DRM: Session created.  SessionID = "+E.getSessionID()),r.trigger(a.KEY_SESSION_CREATED,{data:E})}).catch(function(e){T(E),r.trigger(a.KEY_SESSION_CREATED,{data:null,error:new o.default(i.default.KEY_SESSION_CREATED_ERROR_CODE,i.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})})},updateKeySession:function(e,t){var n=e.session;D.isClearKey(f)&&(t=t.toJWK()),n.update(t).catch(function(t){r.trigger(a.KEY_ERROR,{data:new o.default(i.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})})},loadKeySession:function(e,t,n){if(!f||!l)throw new Error("Can not load sessions until you have selected a key system");for(var s=0;s<y.length;s++)if(e===y[s].sessionId)return void d.warn("DRM: Ignoring session ID because we have already seen it!");var E=l.createSession(n),u=K(E,t,n,e);E.load(e).then(function(t){t?(d.debug("DRM: Session loaded.  SessionID = "+u.getSessionID()),r.trigger(a.KEY_SESSION_CREATED,{data:u})):(T(u),r.trigger(a.KEY_SESSION_CREATED,{data:null,error:new o.default(i.default.KEY_SESSION_CREATED_ERROR_CODE,i.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+e+")")}))}).catch(function(t){T(u),r.trigger(a.KEY_SESSION_CREATED,{data:null,error:new o.default(i.default.KEY_SESSION_CREATED_ERROR_CODE,i.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+e+")! "+t.name)})})},removeKeySession:function(e){e.session.remove().then(function(){d.debug("DRM: Session removed.  SessionID = "+e.getSessionID()),r.trigger(a.KEY_SESSION_REMOVED,{data:e.getSessionID()})},function(t){r.trigger(a.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})})},closeKeySession:function(e){v(e).catch(function(t){T(e),r.trigger(a.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})})},stop:function(){for(var e=void 0,t=0;t<y.length;t++)(e=y[t]).getUsable()||v(e).catch(function(){T(e)})},reset:function(){var e=y.length,t=void 0;0!==e?function(){for(var n=function(e){T(e),0===y.length&&(_?(_.removeEventListener("encrypted",R),_.setMediaKeys(null).then(function(){r.trigger(a.TEARDOWN_COMPLETE)})):r.trigger(a.TEARDOWN_COMPLETE))},s=0;s<e;s++)!function(e){t.session.closed.then(function(){n(e)}),v(t).catch(function(){n(e)})}(t=y[s])}():r.trigger(a.TEARDOWN_COMPLETE)}},d=E.getLogger(c),f=null,_=null,l=null,y=[],D=(0,t.default)(n).getInstance(),R={handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;r.trigger(a.NEED_KEY,{key:new s.default(t,e.initDataType)})}}}},c}_.__dashjs_factory_name="ProtectionModel_21Jan2015",exports.default=dashjs.FactoryMaker.getClassFactory(_);
},{"../controllers/ProtectionKeyController":"mMyc","../vo/NeedKey":"FvY9","../errors/ProtectionErrors":"wa5g","../../vo/DashJSError":"gyaG","../vo/KeyMessage":"JAmi","../vo/KeySystemAccess":"O96N","../../constants/ProtectionConstants":"ePRW"}],"tJnn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../controllers/ProtectionKeyController"),t=c(e),n=require("../vo/NeedKey"),r=c(n),i=require("../../vo/DashJSError"),s=c(i),a=require("../errors/ProtectionErrors"),o=c(a),d=require("../vo/KeyMessage"),u=c(d),l=require("../vo/KeySystemConfiguration"),E=c(l),g=require("../vo/KeySystemAccess"),y=c(g);function c(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var n=this.context,i=e.eventBus,a=e.events,d=e.debug,l=e.api,g=void 0,c=void 0,f=void 0,v=void 0,S=void 0,m=void 0,K=void 0,h=void 0,p=void 0;function C(){try{for(var e=0;e<K.length;e++)_(K[e]);f&&f.removeEventListener(l.needkey,h),i.trigger(a.TEARDOWN_COMPLETE)}catch(t){i.trigger(a.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+t.message})}}function _(e){var t=e.session;t.removeEventListener(l.error,e),t.removeEventListener(l.message,e),t.removeEventListener(l.ready,e),t.removeEventListener(l.close,e);for(var n=0;n<K.length;n++)if(K[n]===e){K.splice(n,1);break}t[l.release]()}function D(){var e=null,t=function(){f.removeEventListener("loadedmetadata",e),f[l.setMediaKeys](S),i.trigger(a.VIDEO_ELEMENT_SELECTED)};f.readyState>=1?t():(e=t.bind(this),f.addEventListener("loadedmetadata",e))}return g={getAllInitData:function(){for(var e=[],t=0;t<K.length;t++)e.push(K[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,n=0;n<e.length;n++)for(var r=e[n].ks.systemString,s=e[n].configs,o=null,d=null,u=0;u<s.length;u++){var g=s[u].audioCapabilities,c=s[u].videoCapabilities;if(g&&0!==g.length){o=[];for(var f=0;f<g.length;f++)window[l.MediaKeys].isTypeSupported(r,g[f].contentType)&&o.push(g[f])}if(c&&0!==c.length){d=[];for(var v=0;v<c.length;v++)window[l.MediaKeys].isTypeSupported(r,c[v].contentType)&&d.push(c[v])}if(!(!o&&!d||o&&0===o.length||d&&0===d.length)){t=!0;var S=new E.default(o,d),m=p.getKeySystemBySystemString(r);i.trigger(a.KEY_SYSTEM_ACCESS_COMPLETE,{data:new y.default(m,S)});break}}t||i.trigger(a.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return v},selectKeySystem:function(e){try{S=e.mediaKeys=new window[l.MediaKeys](e.keySystem.systemString),v=e.keySystem,m=e,f&&D(),i.trigger(a.INTERNAL_KEY_SYSTEM_SELECTED)}catch(t){i.trigger(a.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+v.systemString+")! Could not create MediaKeys -- TODO"})}},setMediaElement:function(e){f!==e&&(f&&f.removeEventListener(l.needkey,h),(f=e)&&(f.addEventListener(l.needkey,h),S&&D()))},createKeySession:function(e,t,n,r){if(!v||!S||!m)throw new Error("Can not create sessions until you have selected a key system");var d=null;if(m.ksConfiguration.videoCapabilities&&m.ksConfiguration.videoCapabilities.length>0&&(d=m.ksConfiguration.videoCapabilities[0]),null===d&&m.ksConfiguration.audioCapabilities&&m.ksConfiguration.audioCapabilities.length>0&&(d=m.ksConfiguration.audioCapabilities[0]),null===d)throw new Error("Can not create sessions for unknown content types.");var E=d.contentType,g=S.createSession(E,new Uint8Array(e),r?new Uint8Array(r):null),y=function(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case l.error:i.trigger(a.KEY_ERROR,{data:new s.default(o.default.MEDIA_KEYERR_CODE,"KeyError",this)});break;case l.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;i.trigger(a.INTERNAL_KEY_MESSAGE,{data:new u.default(this,t,e.destinationURL)});break;case l.ready:c.debug("DRM: Key added."),i.trigger(a.KEY_ADDED);break;case l.close:c.debug("DRM: Session closed.  SessionID = "+this.getSessionID()),i.trigger(a.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}(g,e);g.addEventListener(l.error,y),g.addEventListener(l.message,y),g.addEventListener(l.ready,y),g.addEventListener(l.close,y),K.push(y),c.debug("DRM: Session created.  SessionID = "+y.getSessionID()),i.trigger(a.KEY_SESSION_CREATED,{data:y})},updateKeySession:function(e,t){var n=e.session;p.isClearKey(v)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))},closeKeySession:_,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:C,reset:C},c=d.getLogger(g),f=null,v=null,S=null,m=null,K=[],p=(0,t.default)(n).getInstance(),h={handleEvent:function(e){switch(e.type){case l.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;i.trigger(a.NEED_KEY,{key:new r.default(t,"cenc")})}}}},g}f.__dashjs_factory_name="ProtectionModel_3Feb2014",exports.default=dashjs.FactoryMaker.getClassFactory(f);
},{"../controllers/ProtectionKeyController":"mMyc","../vo/NeedKey":"FvY9","../../vo/DashJSError":"gyaG","../errors/ProtectionErrors":"wa5g","../vo/KeyMessage":"JAmi","../vo/KeySystemConfiguration":"yEQC","../vo/KeySystemAccess":"O96N"}],"zTaY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../controllers/ProtectionKeyController"),t=y(e),r=require("../vo/NeedKey"),s=y(r),n=require("../../vo/DashJSError"),E=y(n),a=require("../vo/KeyMessage"),i=y(a),o=require("../vo/KeySystemConfiguration"),d=y(o),u=require("../vo/KeySystemAccess"),l=y(u),_=require("../errors/ProtectionErrors"),f=y(_);function y(e){return e&&e.__esModule?e:{default:e}}function g(e){e=e||{};var r=this.context,n=e.eventBus,a=e.events,o=e.debug,u=e.api,_=e.errHandler,y=void 0,g=void 0,c=void 0,S=void 0,D=void 0,R=void 0,v=void 0,A=void 0,I=void 0;function K(){c&&C();for(var e=0;e<v.length;e++)M(v[e]);n.trigger(a.TEARDOWN_COMPLETE)}function M(e){try{c[u.cancelKeyRequest](S.systemString,e.sessionID)}catch(t){n.trigger(a.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionID+") "+t.message})}}function k(e,t){if(t&&e){for(var r=e.length,s=0;s<r;s++)if(e[s].sessionID==t)return e[s];return null}return null}function C(){c.removeEventListener(u.keyerror,I),c.removeEventListener(u.needkey,I),c.removeEventListener(u.keymessage,I),c.removeEventListener(u.keyadded,I)}return y={getAllInitData:function(){for(var e=[],t=0;t<R.length;t++)e.push(R[t].initData);for(var r=0;r<v.length;r++)e.push(v[r].initData);return e},requestKeySystemAccess:function(e){var t=c;t||(t=document.createElement("video"));for(var r=!1,s=0;s<e.length;s++)for(var E=e[s].ks.systemString,i=e[s].configs,o=null,u=0;u<i.length;u++){var _=i[u].videoCapabilities;if(_&&0!==_.length){o=[];for(var f=0;f<_.length;f++)""!==t.canPlayType(_[f].contentType,E)&&o.push(_[f])}if(o&&(!o||0!==o.length)){r=!0;var y=new d.default(null,o),g=D.getKeySystemBySystemString(E);n.trigger(a.KEY_SYSTEM_ACCESS_COMPLETE,{data:new l.default(g,y)});break}}r||n.trigger(a.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return S},selectKeySystem:function(e){S=e.keySystem,n.trigger(a.INTERNAL_KEY_SYSTEM_SELECTED)},setMediaElement:function(e){if(c!==e){if(c){C();for(var t=0;t<v.length;t++)M(v[t]);v=[]}(c=e)&&(c.addEventListener(u.keyerror,I),c.addEventListener(u.needkey,I),c.addEventListener(u.keymessage,I),c.addEventListener(u.keyadded,I),n.trigger(a.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!S)throw new Error("Can not create sessions until you have selected a key system");if(A||0===v.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return R.push(t),c[u.generateKeyRequest](S.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var r=e.sessionID;if(D.isClearKey(S))for(var s=0;s<t.keyPairs.length;s++)c[u.addKey](S.systemString,t.keyPairs[s].key,t.keyPairs[s].keyID,r);else c[u.addKey](S.systemString,new Uint8Array(t),new Uint8Array(e.initData),r)},closeKeySession:M,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:K,reset:K},g=o.getLogger(y),c=null,S=null,R=[],v=[],D=(0,t.default)(r).getInstance(),I={handleEvent:function(e){var t=null;switch(e.type){case u.needkey:var r=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(a.NEED_KEY,{key:new s.default(r,"cenc")});break;case u.keyerror:if((t=k(v,e.sessionId))||(t=k(R,e.sessionId)),t){var o=f.default.MEDIA_KEYERR_CODE,d="";switch(e.errorCode.code){case 1:o=f.default.MEDIA_KEYERR_UNKNOWN_CODE,d+="MEDIA_KEYERR_UNKNOWN - "+f.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:o=f.default.MEDIA_KEYERR_CLIENT_CODE,d+="MEDIA_KEYERR_CLIENT - "+f.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:o=f.default.MEDIA_KEYERR_SERVICE_CODE,d+="MEDIA_KEYERR_SERVICE - "+f.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:o=f.default.MEDIA_KEYERR_OUTPUT_CODE,d+="MEDIA_KEYERR_OUTPUT - "+f.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:o=f.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,d+="MEDIA_KEYERR_HARDWARECHANGE - "+f.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:o=f.default.MEDIA_KEYERR_DOMAIN_CODE,d+="MEDIA_KEYERR_DOMAIN - "+f.default.MEDIA_KEYERR_DOMAIN_MESSAGE}d+="  System Code = "+e.systemCode,n.trigger(a.KEY_ERROR,{data:new E.default(o,d,t)})}else g.error("No session token found for key error");break;case u.keyadded:(t=k(v,e.sessionId))||(t=k(R,e.sessionId)),t?(g.debug("DRM: Key added."),n.trigger(a.KEY_ADDED,{data:t})):g.debug("No session token found for key added");break;case u.keymessage:if((A=null!==e.sessionId&&void 0!==e.sessionId)?!(t=k(v,e.sessionId))&&R.length>0&&(t=R.shift(),v.push(t),t.sessionID=e.sessionId,n.trigger(a.KEY_SESSION_CREATED,{data:t})):R.length>0&&(t=R.shift(),v.push(t),0!==R.length&&_.error(new E.default(f.default.MEDIA_KEY_MESSAGE_ERROR_CODE,f.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var l=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=l,n.trigger(a.INTERNAL_KEY_MESSAGE,{data:new i.default(t,l,e.defaultURL)})}else g.warn("No session token found for key message")}}},y}g.__dashjs_factory_name="ProtectionModel_01b",exports.default=dashjs.FactoryMaker.getClassFactory(g);
},{"../controllers/ProtectionKeyController":"mMyc","../vo/NeedKey":"FvY9","../../vo/DashJSError":"gyaG","../vo/KeyMessage":"JAmi","../vo/KeySystemConfiguration":"yEQC","../vo/KeySystemAccess":"O96N","../errors/ProtectionErrors":"wa5g"}],"WVg9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./controllers/ProtectionController"),t=v(e),r=require("./controllers/ProtectionKeyController"),s=v(r),o=require("./ProtectionEvents"),n=v(o),d=require("./errors/ProtectionErrors"),a=v(d),i=require("./models/ProtectionModel_21Jan2015"),y=v(i),l=require("./models/ProtectionModel_3Feb2014"),u=v(l),c=require("./models/ProtectionModel_01b"),k=v(c);function v(e){return e&&e.__esModule?e:{default:e}}var g=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],f=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function M(){var e=void 0,r=this.context;function o(e,t){for(var r=0;r<t.length;r++){var s=t[r];if("function"==typeof e[s[Object.keys(s)[0]]])return s}return null}return e={createProtectionSystem:function(n){var d=null,a=(0,s.default)(r).getInstance();a.setConfig({debug:n.debug,BASE64:n.BASE64}),a.initialize();var i=function(t){var s=t.debug,n=s.getLogger(e),d=t.eventBus,a=t.errHandler,i=t.videoModel?t.videoModel.getElement():null;return i&&void 0===i.onencrypted||i&&void 0===i.mediaKeys?o(i,f)?(n.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,u.default)(r).create({debug:s,eventBus:d,events:t.events,api:o(i,f)})):o(i,g)?(n.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,k.default)(r).create({debug:s,eventBus:d,errHandler:a,events:t.events,api:o(i,g)})):(n.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(n.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,y.default)(r).create({debug:s,eventBus:d,events:t.events}))}(n);return!d&&i&&(d=(0,t.default)(r).create({protectionModel:i,protectionKeyController:a,eventBus:n.eventBus,debug:n.debug,events:n.events,BASE64:n.BASE64,constants:n.constants}),n.capabilities.setEncryptedMediaSupported(!0)),d}}}M.__dashjs_factory_name="Protection";var m=dashjs.FactoryMaker.getClassFactory(M);m.events=n.default,m.errors=a.default,dashjs.FactoryMaker.updateClassFactory(M.__dashjs_factory_name,m),exports.default=m;
},{"./controllers/ProtectionController":"Usvx","./controllers/ProtectionKeyController":"mMyc","./ProtectionEvents":"Tro5","./errors/ProtectionErrors":"wa5g","./models/ProtectionModel_21Jan2015":"x11l","./models/ProtectionModel_3Feb2014":"tJnn","./models/ProtectionModel_01b":"zTaY"}],"vPMl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./MediaPlayer"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}function n(){var e="application/dash+xml",t=void 0;function n(n,a,d){if(!n||!/^VIDEO$/i.test(n.nodeName))return null;if(n._dashjs_player)return n._dashjs_player;var o=void 0,l=n.id||n.name||"video element";if(!(a=a||[].slice.call(n.querySelectorAll("source")).filter(function(r){return r.type==e})[0])&&n.src)(a=document.createElement("source")).src=n.src;else if(!a&&!n.src)return null;return d=d||{},(o=(0,r.default)(d).create()).initialize(n,a.src,n.autoplay),t||(t=o.getDebug().getLogger()),t.debug("Converted "+l+" to dash.js player and added content: "+a.src),n._dashjs_player=o,o}function a(e){return/^VIDEO$/i.test(e.nodeName)?e:a(e.parentNode)}return{create:n,createAll:function(r,t){var d=[];r=r||"[data-dashjs-player]";for(var o=(t=t||document).querySelectorAll(r),l=0;l<o.length;l++){var i=n(o[l],null);d.push(i)}for(var u=t.querySelectorAll('source[type="'+e+'"]'),s=0;s<u.length;s++){var c=n(a(u[s]),null);d.push(c)}return d}}}var a=n(),d=void 0;function o(){window.removeEventListener("load",o),a.createAll()}function l(){window.dashjs&&(window.clearInterval(d),a.createAll())}var i="undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate;!i&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?a.createAll():d=window.setInterval(l,500):window.addEventListener("load",o)),exports.default=a;
},{"./MediaPlayer":"nHmL"}],"lTOo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Debug=exports.MediaPlayerFactory=exports.MetricsReporting=exports.Protection=exports.MediaPlayer=void 0;var e=require("./index_mediaplayerOnly"),r=require("./src/streaming/metrics/MetricsReporting"),t=c(r),a=require("./src/streaming/protection/Protection"),s=c(a),o=require("./src/streaming/MediaPlayerFactory"),i=c(o),d=require("./src/core/Debug"),u=c(d);function c(e){return e&&e.__esModule?e:{default:e}}dashjs.Protection=s.default,dashjs.MetricsReporting=t.default,dashjs.MediaPlayerFactory=i.default,dashjs.Debug=u.default,exports.default=dashjs,exports.MediaPlayer=e.MediaPlayer,exports.Protection=s.default,exports.MetricsReporting=t.default,exports.MediaPlayerFactory=i.default,exports.Debug=u.default;
},{"./index_mediaplayerOnly":"IV4C","./src/streaming/metrics/MetricsReporting":"eTIY","./src/streaming/protection/Protection":"WVg9","./src/streaming/MediaPlayerFactory":"vPMl","./src/core/Debug":"iL1O"}],"f8QH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../core/events/EventsBase"),t=o(e);function o(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(e){function o(){n(this,o);var e=r(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.FRAGMENT_INFO_LOADING_COMPLETED="fragmentInfoLoadingCompleted",e}return u(o,t.default),o}(),f=new i;exports.default=f;
},{"../core/events/EventsBase":"zN1Q"}],"JLAN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../core/errors/ErrorsBase"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){function r(){o(this,r);var e=n(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.MSS_NO_TFRF_CODE=200,e.MSS_UNSUPPORTED_CODEC_CODE=201,e.MSS_NO_TFRF_MESSAGE="Missing tfrf in live media segment",e.MSS_UNSUPPORTED_CODEC_MESSAGE="Unsupported codec",e}return i(r,t.default),r}(),s=new u;exports.default=s;
},{"../../core/errors/ErrorsBase":"zN1Q"}],"LMZz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../streaming/vo/DashJSError"),t=i(e),r=require("./errors/MssErrors"),a=i(r),n=require("../streaming/MediaPlayerEvents"),s=i(n);function i(e){return e&&e.__esModule?e:{default:e}}function f(e){var r=void 0,n=void 0,i=void 0,f=(e=e||{}).dashMetrics,o=e.playbackController,l=e.errHandler,d=e.eventBus,u=e.ISOBoxer,m=e.debug;function p(e,r,f,o){var u=o.getRepresentationController().getCurrentRepresentation(),m=o.getIndexHandler(),p=u.adaptation.period.mpd.manifest,c=p.Period_asArray[u.adaptation.period.index].AdaptationSet_asArray[u.adaptation.index],_=c.SegmentTemplate.timescale;if(n=o.getType(),"dynamic"===p.type||p.timeShiftBufferDepth)if(r){var h,v=c.SegmentTemplate.SegmentTimeline.S,b=r.entry,M=void 0,x=void 0,y=null,S=0,D=null;if(0!==b.length&&(h=b[0],!("static"===p.type&&(M=v[0].tManifest?parseFloat(v[0].tManifest):v[0].t,h.fragment_absolute_time>M+p.timeShiftBufferDepth*_)))){if(i.debug("entry - t = ",h.fragment_absolute_time/_),M=v[v.length-1].tManifest?parseFloat(v[v.length-1].tManifest):v[v.length-1].t,i.debug("Last segment - t = ",M/_),h.fragment_absolute_time<=M)return x={start:v[0].t/_,end:f.baseMediaDecodeTime/_+e.duration},void g(e.mediaType,x,o.getStreamInfo().manifestInfo);if(i.debug("Add new segment - t = ",h.fragment_absolute_time/_),(y={}).t=h.fragment_absolute_time,y.d=h.fragment_duration,v[0].tManifest&&(y.t-=parseFloat(v[0].tManifest)-v[0].t,y.tManifest=h.fragment_absolute_time),v.push(y),"static"!==p.type){if(p.timeShiftBufferDepth&&p.timeShiftBufferDepth>0){for(S=(y=v[v.length-1]).t,D=Math.round((S-p.timeShiftBufferDepth*_)/_),y=v[0];Math.round(y.t/_)<D;)i.debug("Remove segment  - t = "+y.t/_),v.splice(0,1),y=v[0];x={start:v[0].t/_,end:f.baseMediaDecodeTime/_+e.duration},g(n,x,o.getStreamInfo().manifestInfo)}m.updateRepresentation(u,!0)}else if("video"===n){var T=((y=v[v.length-1]).t+y.d)/_;T>u.adaptation.period.duration&&d.trigger(s.default.MANIFEST_VALIDITY_CHANGED,{sender:this,newDuration:T})}}}else l.error(new t.default(a.default.MSS_NO_TFRF_CODE,a.default.MSS_NO_TFRF_MESSAGE))}function g(e,t,r){var a=f.getCurrentDVRInfo(e);(!a||t.end>a.range.end)&&(i.debug("Update DVR Infos ["+t.start+" - "+t.end+"]"),f.addDVRInfo(e,o.getTime(),r,t))}function c(e,t){var r=8,a=0;for(a=0;a<e.boxes.length;a++){if(e.boxes[a].type===t)return r;r+=e.boxes[a].size}return r}return r={convertFragment:function(e,t){var r=void 0,a=u.parseBuffer(e.response),n=a.fetch("tfhd");n.track_ID=e.request.mediaInfo.index+1;var s=a.fetch("tfdt"),i=a.fetch("traf");null===s&&((s=u.createFullBox("tfdt",i,n)).version=1,s.flags=0,s.baseMediaDecodeTime=Math.floor(e.request.startTime*e.request.timescale));var f=a.fetch("trun"),o=a.fetch("tfxd");o&&(o._parent.boxes.splice(o._parent.boxes.indexOf(o),1),o=null);var l=a.fetch("tfrf");p(e.request,l,s,t),l&&(l._parent.boxes.splice(l._parent.boxes.indexOf(l),1),l=null);var d=a.fetch("sepiff");if(null!==d){d.type="senc",d.usertype=void 0;var m=a.fetch("saio");if(null===m){(m=u.createFullBox("saio",i)).version=0,m.flags=0,m.entry_count=1,m.offset=[0];var g=u.createFullBox("saiz",i);if(g.version=0,g.flags=0,g.sample_count=d.sample_count,g.default_sample_info_size=0,g.sample_info_size=[],2&d.flags)for(r=0;r<d.sample_count;r+=1)g.sample_info_size[r]=10+6*d.entry[r].NumberOfEntries;else g.default_sample_info_size=8}}n.flags&=16777214,n.flags|=131072,f.flags|=1;var _=a.fetch("moof"),h=_.getLength();f.data_offset=h+8;var v=a.fetch("saio");if(null!==v){var b=c(_,"traf"),M=c(i,"senc");v.offset[0]=b+M+16}e.response=a.write()},updateSegmentList:function(e,t){if(!e.response)throw new Error("e.response parameter is missing");var r=u.parseBuffer(e.response),a=r.fetch("tfhd");a.track_ID=e.request.mediaInfo.index+1;var n=r.fetch("tfdt"),s=r.fetch("traf");null===n&&((n=u.createFullBox("tfdt",s,a)).version=1,n.flags=0,n.baseMediaDecodeTime=Math.floor(e.request.startTime*e.request.timescale));var i=r.fetch("tfrf");p(e.request,i,n,t),i&&(i._parent.boxes.splice(i._parent.boxes.indexOf(i),1),i=null)},getType:function(){return n}},i=m.getLogger(r),n="",r}f.__dashjs_factory_name="MssFragmentMoofProcessor",exports.default=dashjs.FactoryMaker.getClassFactory(f);
},{"../streaming/vo/DashJSError":"gyaG","./errors/MssErrors":"JLAN","../streaming/MediaPlayerEvents":"yxZg"}],"FnmF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./MssEvents"),t=i(e),r=require("./MssFragmentMoofProcessor"),n=i(r),a=require("../streaming/vo/FragmentRequest"),o=i(a);function i(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var r=this.context,a=void 0,i=void 0,l=void 0,s=void 0,d=void 0,u=void 0,m=void 0,g=void 0,f=void 0,c=e.streamProcessor,p=e.eventBus,v=e.dashMetrics,T=e.playbackController,M=e.ISOBoxer,I=e.baseURLController,F=e.debug;function _(){if(s){var e=c.getRepresentationController().getCurrentRepresentation(),t=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],r=t.SegmentTemplate.SegmentTimeline.S_asArray,n=r[r.length-1];i.debug("Last fragment time: "+n.t/t.SegmentTemplate.timescale);var a=function(e,t,r){var n=e.SegmentTemplate.timescale,a=new o.default;return a.mediaType=d,a.type="FragmentInfoSegment",a.startTime=r.t/n,a.duration=r.d/n,a.timescale=n,a.quality=t.index,a.index=f++,a.mediaInfo=c.getMediaInfo(),a.adaptationIndex=t.adaptation.index,a.representationId=t.id,a.url=I.resolve(t.path).url+e.SegmentTemplate.media,a.url=a.url.replace("$Bandwidth$",t.bandwidth),a.url=a.url.replace("$Time$",r.tManifest?r.tManifest:r.t),a.url=a.url.replace("/Fragments(","/FragmentInfo("),a}(t,e,n);(function(e){if(i.debug("Load fragment for time: "+e.startTime),c.getFragmentModel().isFragmentLoadedOrPending(e))return void i.debug("No more fragments");l.executeRequest(e)}).call(this,a)}}function y(e){if(e.streamProcessor===c){var t=e.fragmentInfo.request;if(e.fragmentInfo.response){var a,o=void 0,l=void 0;i.debug("FragmentInfo loaded: ",t.url),g||(g=t.startTime);try{(0,n.default)(r).create({dashMetrics:v,playbackController:T,ISOBoxer:M,eventBus:p,debug:F}).updateSegmentList(e.fragmentInfo,c),l=((new Date).getTime()-m)/1e3,o=t.startTime+t.duration-g,a=Math.max(0,o-l),clearTimeout(u),u=setTimeout(function(){u=null,_()},1e3*a)}catch(e){i.fatal("Internal error while processing fragment info segment ")}}else i.error("Load error",t.url)}}return a={initialize:function(){s=!1,m=null,g=null,c.registerExternalController(a),d=c.getType(),l=c.getFragmentModel()},controllerType:"MssFragmentInfoController",start:function(){!0!==s&&(i.debug("Do start"),p.on(t.default.FRAGMENT_INFO_LOADING_COMPLETED,y,a),s=!0,m=(new Date).getTime(),f=0,_())},getType:function(){return d},reset:function(){s&&(i.debug("Do stop"),p.off(t.default.FRAGMENT_INFO_LOADING_COMPLETED,y,a),clearTimeout(u),s=!1,m=null,g=null),c.unregisterExternalController(a)}},i=F.getLogger(a),a}l.__dashjs_factory_name="MssFragmentInfoController",exports.default=dashjs.FactoryMaker.getClassFactory(l);
},{"./MssEvents":"f8QH","./MssFragmentMoofProcessor":"LMZz","../streaming/vo/FragmentRequest":"Vb3t"}],"Fm79":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./errors/MssErrors"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}function a(e){var r=7,a=8,n=(e=e||{}).constants,o=e.ISOBoxer,i=e.protectionController,d=void 0,s=void 0,c=void 0,l=void 0,u=void 0,f=void 0;function v(e){var v=o.createBox("moov",e);!function(e){var t=o.createFullBox("mvhd",e);t.version=1,t.creation_time=0,t.modification_time=0,t.timescale=u,t.duration=Math.round(d.duration*u),t.rate=1,t.volume=1,t.reserved1=0,t.reserved2=[0,0],t.matrix=[1,0,0,0,1,0,0,0,16384],t.pre_defined=[0,0,0,0,0,0],t.next_track_ID=f+1}(v);var g=o.createBox("trak",v);!function(e){var t=o.createFullBox("tkhd",e);t.version=1,t.flags=7,t.creation_time=0,t.modification_time=0,t.track_ID=f,t.reserved1=0,t.duration=Math.round(d.duration*u),t.reserved2=[0,0],t.layer=0,t.alternate_group=0,t.volume=1,t.reserved3=0,t.matrix=[1,0,0,0,1,0,0,0,16384],t.width=c.width,t.height=c.height}(g);var x=o.createBox("mdia",g);!function(e){var t=o.createFullBox("mdhd",e);t.version=1,t.creation_time=0,t.modification_time=0,t.timescale=u,t.duration=Math.round(d.duration*u),t.language=s.lang||"und",t.pre_defined=0}(x),function(e){var t=o.createFullBox("hdlr",e);switch(t.pre_defined=0,s.type){case n.VIDEO:t.handler_type="vide";break;case n.AUDIO:t.handler_type="soun";break;default:t.handler_type="meta"}t.name=c.id,t.reserved=[0,0,0]}(x);var B=o.createBox("minf",x);switch(s.type){case n.VIDEO:!function(e){var t=o.createFullBox("vmhd",e);t.flags=1,t.graphicsmode=0,t.opcolor=[0,0,0]}(B);break;case n.AUDIO:!function(e){var t=o.createFullBox("smhd",e);t.flags=1,t.balance=0,t.reserved=0}(B)}!function(e){var t=o.createFullBox("dref",e);t.entry_count=1,t.entries=[];var r=o.createFullBox("url ",t,!1);r.location="",r.flags=1,t.entries.push(r)}(o.createBox("dinf",B));var b=o.createBox("stbl",B);(o.createFullBox("stts",b)._data=[0,0,0,0,0,0,0,0],o.createFullBox("stsc",b)._data=[0,0,0,0,0,0,0,0],o.createFullBox("stco",b)._data=[0,0,0,0,0,0,0,0],o.createFullBox("stsz",b)._data=[0,0,0,0,0,0,0,0,0,0,0,0],function(e){var i=o.createFullBox("stsd",e);switch(i.entries=[],s.type){case n.VIDEO:case n.AUDIO:i.entries.push(function(e){var n=c.codecs.substring(0,c.codecs.indexOf("."));switch(n){case"avc1":return function(e,t){var n=void 0;n=l?o.createBox("encv",e,!1):o.createBox("avc1",e,!1);if(n.reserved1=[0,0,0,0,0,0],n.data_reference_index=1,n.pre_defined1=0,n.reserved2=0,n.pre_defined2=[0,0,0],n.height=c.height,n.width=c.width,n.horizresolution=72,n.vertresolution=72,n.reserved3=0,n.frame_count=1,n.compressorname=[10,65,86,67,32,67,111,100,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n.depth=24,n.pre_defined3=65535,n.config=function(){for(var e=null,t=15,n=[],o=[],i=0,d=0,s=0,l=c.codecPrivateData.split("00000001").slice(1),u=void 0,f=0;f<l.length;f++)switch(u=p(l[f]),31&u[0]){case r:n.push(u),t+=u.length+2;break;case a:o.push(u),t+=u.length+2}n.length>0&&(i=n[0][1],s=n[0][2],d=n[0][3]),e=new Uint8Array(t);var v=0;e[v++]=(4278190080&t)>>24,e[v++]=(16711680&t)>>16,e[v++]=(65280&t)>>8,e[v++]=255&t,e.set([97,118,99,67],v),v+=4,e[v++]=1,e[v++]=i,e[v++]=s,e[v++]=d,e[v++]=255,e[v++]=224|n.length;for(var h=0;h<n.length;h++)e[v++]=(65280&n[h].length)>>8,e[v++]=255&n[h].length,e.set(n[h],v),v+=n[h].length;e[v++]=o.length;for(var _=0;_<o.length;_++)e[v++]=(65280&o[_].length)>>8,e[v++]=255&o[_].length,e.set(o[_],v),v+=o[_].length;return e}(),l){var i=o.createBox("sinf",n);h(i,t),_(i),m(i)}return n}(e,n);case"mp4a":return function(e,t){var r=void 0;r=l?o.createBox("enca",e,!1):o.createBox("mp4a",e,!1);if(r.reserved1=[0,0,0,0,0,0],r.data_reference_index=1,r.reserved2=[0,0],r.channelcount=c.audioChannels,r.samplesize=16,r.pre_defined=0,r.reserved_3=0,r.samplerate=c.audioSamplingRate<<16,r.esds=(n=p(c.codecPrivateData),i=34+n.length,d=new Uint8Array(i),s=0,d[s++]=(4278190080&i)>>24,d[s++]=(16711680&i)>>16,d[s++]=(65280&i)>>8,d[s++]=255&i,d.set([101,115,100,115],s),s+=4,d.set([0,0,0,0],s),s+=4,d[s++]=3,d[s++]=20+n.length,d[s++]=(65280&f)>>8,d[s++]=255&f,d[s++]=0,d[s++]=4,d[s++]=15+n.length,d[s++]=64,d[s]=20,d[s]|=0,d[s++]|=1,d[s++]=255,d[s++]=255,d[s++]=255,d[s++]=(4278190080&c.bandwidth)>>24,d[s++]=(16711680&c.bandwidth)>>16,d[s++]=(65280&c.bandwidth)>>8,d[s++]=255&c.bandwidth,d[s++]=(4278190080&c.bandwidth)>>24,d[s++]=(16711680&c.bandwidth)>>16,d[s++]=(65280&c.bandwidth)>>8,d[s++]=255&c.bandwidth,d[s++]=5,d[s++]=n.length,d.set(n,s),d),l){var a=o.createBox("sinf",r);h(a,t),_(a),m(a)}var n,i,d,s;return r}(e,n);default:throw{code:t.default.MSS_UNSUPPORTED_CODEC_CODE,message:t.default.MSS_UNSUPPORTED_CODEC_MESSAGE,data:{codec:n}}}}(i))}i.entry_count=i.entries.length}(b),function(e){var t=o.createFullBox("trex",e);t.track_ID=f,t.default_sample_description_index=1,t.default_sample_duration=0,t.default_sample_size=0,t.default_sample_flags=0}(o.createBox("mvex",v)),l&&i)&&function(e,t){var r=void 0,a=void 0,n=void 0,i=void 0;for(n=0;n<t.length;n+=1)(r=t[n].initData)&&(i=o.parseBuffer(r),(a=i.fetch("pssh"))&&o.Utils.appendBox(e,a))}(v,i.getSupportedKeySystemsFromContentProtection(l))}function h(e,t){o.createBox("frma",e).data_format=function(e){var t=0,r=void 0;for(r=0;r<e.length;r+=1)t|=e.charCodeAt(r)<<8*(e.length-r-1);return t}(t)}function _(e){var t=o.createFullBox("schm",e);t.flags=0,t.version=0,t.scheme_type=1667591779,t.scheme_version=65536}function m(e){!function(e){var t=o.createFullBox("tenc",e);t.flags=0,t.version=0,t.default_IsEncrypted=1,t.default_IV_size=8,t.default_KID=l&&l.length>0&&l[0]["cenc:default_KID"]?l[0]["cenc:default_KID"]:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}(o.createBox("schi",e))}function p(e){var t=new Uint8Array(e.length/2),r=void 0;for(r=0;r<e.length/2;r+=1)t[r]=parseInt(""+e[2*r]+e[2*r+1],16);return t}return{generateMoov:function(e){if(e&&e.adaptation){var t=void 0;return s=(c=e).adaptation,d=s.period,f=s.index+1,l=d.mpd.manifest.Period_asArray[d.index].AdaptationSet_asArray[s.index].ContentProtection,u=d.mpd.manifest.Period_asArray[d.index].AdaptationSet_asArray[s.index].SegmentTemplate.timescale,function(e){var t=o.createBox("ftyp",e);t.major_brand="iso6",t.minor_version=1,t.compatible_brands=[],t.compatible_brands[0]="isom",t.compatible_brands[1]="iso6",t.compatible_brands[2]="msdh"}(t=o.createFile()),v(t),t.write()}}}}a.__dashjs_factory_name="MssFragmentMoovProcessor",exports.default=dashjs.FactoryMaker.getClassFactory(a);
},{"./errors/MssErrors":"JLAN"}],"iD6g":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./MssFragmentMoofProcessor"),e=o(t),r=require("./MssFragmentMoovProcessor"),i=o(r),s=require("./MssEvents"),n=o(s);function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e){return t.length===e.length&&t.every(function(t,r){return t===e[r]})}function u(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)}function c(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}function l(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("IV_size","uint",8),this._procEntries("entry",this.sample_count,function(t){this._procEntryField(t,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(t,"NumberOfEntries","uint",16),this._procSubEntries(t,"clearAndCryptedData",t.NumberOfEntries,function(t){this._procEntryField(t,"BytesOfClearData","uint",16),this._procEntryField(t,"BytesOfEncryptedData","uint",32)}))})}function _(){a(this.usertype,[109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178])&&(this._procFullBox(),this._parsing&&(this.type="tfxd"),this._procField("fragment_absolute_time","uint",1===this.version?64:32),this._procField("fragment_duration","uint",1===this.version?64:32)),a(this.usertype,[212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159])&&(this._procFullBox(),this._parsing&&(this.type="tfrf"),this._procField("fragment_count","uint",8),this._procEntries("entry",this.fragment_count,function(t){this._procEntryField(t,"fragment_absolute_time","uint",1===this.version?64:32),this._procEntryField(t,"fragment_duration","uint",1===this.version?64:32)})),a(this.usertype,[162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244])&&(this._parsing&&(this.type="sepiff"),l.call(this))}function p(t){t=t||{};var r,s=this.context,o=t.dashMetrics,a=t.playbackController,p=t.eventBus,h=t.protectionController,d=t.ISOBoxer,f=t.debug,y=void 0,F=void 0;return r={generateMoov:function(t){return y.generateMoov(t)},processFragment:function(t,e){if(!t||!t.request||!t.response)throw new Error("e parameter is missing or malformed");var r=t.request;"MediaSegment"===r.type?F.convertFragment(t,e):"FragmentInfoSegment"===r.type&&(p.trigger(n.default.FRAGMENT_INFO_LOADING_COMPLETED,{fragmentInfo:t,streamProcessor:e}),t.sender=null)}},d.addBoxProcessor("uuid",_),d.addBoxProcessor("saio",u),d.addBoxProcessor("saiz",c),d.addBoxProcessor("senc",l),y=(0,i.default)(s).create({protectionController:h,constants:t.constants,ISOBoxer:d}),F=(0,e.default)(s).create({dashMetrics:o,playbackController:a,ISOBoxer:d,eventBus:p,debug:f,errHandler:t.errHandler}),r}p.__dashjs_factory_name="MssFragmentProcessor",exports.default=dashjs.FactoryMaker.getClassFactory(p);
},{"./MssFragmentMoofProcessor":"LMZz","./MssFragmentMoovProcessor":"Fm79","./MssEvents":"f8QH"}],"S74k":[function(require,module,exports) {
"use strict";function e(e){var t=(e=e||{}).BASE64,a=e.debug,i=e.constants,r=e.manifestModel,n=1e7,o=["AAC","AACL","AVC1","H264","TTML","DFXP"],s={CAPT:"main",SUBT:"alternate",DESC:"main"},d={DESC:"2"},l={96000:0,88200:1,64000:2,48000:3,44100:4,32000:5,24000:6,22050:7,16000:8,12000:9,11025:10,8000:11,7350:12},m={video:"video/mp4",audio:"audio/mp4",text:"application/mp4"},u=void 0,p=void 0;function f(e,t){var a,i={},r=[],n=void 0,o=void 0,l=void 0;if(i.id=e.getAttribute("Name")?e.getAttribute("Name"):e.getAttribute("Type"),i.contentType=e.getAttribute("Type"),i.lang=e.getAttribute("Language")||"und",i.mimeType=m[i.contentType],i.subType=e.getAttribute("Subtype"),i.maxWidth=e.getAttribute("MaxWidth"),i.maxHeight=e.getAttribute("MaxHeight"),i.subType){if(s[i.subType]){var u={schemeIdUri:"urn:mpeg:dash:role:2011",value:s[i.subType]};i.Role=u,i.Role_asArray=[u]}if(d[i.subType]){var p={schemeIdUri:"urn:tva:metadata:cs:AudioPurposeCS:2007",value:d[i.subType]};i.Accessibility=p,i.Accessibility_asArray=[p]}}for(a=function(e,t){var a={},i=void 0,r=void 0,n=void 0;return n=e.getAttribute("Url"),i=(i=n?n.replace("{bitrate}","$Bandwidth$"):null)?i.replace("{start time}","$Time$"):null,r=(r=e.getAttribute("TimeScale"))?parseFloat(r):t,a.media=i,a.timescale=r,a.SegmentTimeline=function(e,t){var a={},i=e.getElementsByTagName("c"),r=[],n=void 0,o=void 0,s=void 0,d=void 0,l=void 0,m=void 0,u=0;for(d=0;d<i.length;d++)if(n={},s=i[d].getAttribute("t"),n.tManifest=parseFloat(s),n.t=parseFloat(s),n.d=parseFloat(i[d].getAttribute("d")),0!==d||n.t||(n.t=0),d>0&&((o=r[r.length-1]).d||(o.tManifest?o.d=parseFloat(s)-parseFloat(o.tManifest):o.d=n.t-o.t,u+=o.d),n.t||(o.tManifest?(n.tManifest=parseFloat(o.tManifest)+o.d,n.t=parseFloat(n.tManifest)):n.t=o.t+o.d)),n.d&&(u+=n.d),r.push(n),m=parseFloat(i[d].getAttribute("r")))for(l=0;l<m-1;l++)o=r[r.length-1],(n={}).t=o.t+o.d,n.d=o.d,o.tManifest&&(n.tManifest=parseFloat(o.tManifest)+o.d),u+=n.d,r.push(n);return a.S=r,a.S_asArray=r,a.duration=u/t,a}(e,a.timescale),a}(e,t),n=e.getElementsByTagName("QualityLevel"),l=0;l<n.length;l++)n[l].BaseURL=i.BaseURL,n[l].mimeType=i.mimeType,n[l].Id=i.id+"_"+n[l].getAttribute("Index"),null!==(o=g(n[l],e))&&(o.SegmentTemplate=a,r.push(o));return 0===r.length?null:(i.Representation=r.length>1?r:r[0],i.Representation_asArray=r,i.SegmentTemplate=a,a.SegmentTimeline.S_asArray,i)}function g(e,t){var a={},r=t.getAttribute("Type"),n=null;if(a.id=e.Id,a.bandwidth=parseInt(e.getAttribute("Bitrate"),10),a.mimeType=e.mimeType,a.width=parseInt(e.getAttribute("MaxWidth"),10),a.height=parseInt(e.getAttribute("MaxHeight"),10),null!==(n=e.getAttribute("FourCC"))&&""!==n||(n=t.getAttribute("FourCC")),null===n||""===n)if("audio"===r)n="AAC";else if("video"===r)return p.debug('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;return-1===o.indexOf(n.toUpperCase())?(p.warn("Codec not supported: "+n),null):("H264"===n||"AVC1"===n?a.codecs=function(e){var t=e.getAttribute("CodecPrivateData").toString(),a=void 0;return a=/00000001[0-9]7/.exec(t),"avc1."+(a&&a[0]?t.substr(t.indexOf(a[0])+10,6):void 0)}(e):n.indexOf("AAC")>=0?(a.codecs=function(e,t){var a=parseInt(e.getAttribute("SamplingRate"),10),i=e.getAttribute("CodecPrivateData").toString(),r=0,n=void 0,o=void 0,s=void 0,d=void 0;"AACH"===t&&(r=5);void 0===i||""===i?(r=2,s=l[a],"AACH"===t?(r=5,i=new Uint8Array(4),d=l[2*a],i[0]=r<<3|s>>1,i[1]=s<<7|e.Channels<<3|d>>1,i[2]=d<<7|8,i[3]=0,(o=new Uint16Array(2))[0]=(i[0]<<8)+i[1],o[1]=(i[2]<<8)+i[3],n=o[0].toString(16),n=o[0].toString(16)+o[1].toString(16)):((i=new Uint8Array(2))[0]=r<<3|s>>1,i[1]=s<<7|parseInt(e.getAttribute("Channels"),10)<<3,(o=new Uint16Array(1))[0]=(i[0]<<8)+i[1],n=o[0].toString(16)),i=(i=""+n).toUpperCase(),e.setAttribute("CodecPrivateData",i)):0===r&&(r=(248&parseInt(i.substr(0,2),16))>>3);return"mp4a.40."+r}(e,n),a.audioSamplingRate=parseInt(e.getAttribute("SamplingRate"),10),a.audioChannels=parseInt(e.getAttribute("Channels"),10)):(n.indexOf("TTML")||n.indexOf("DFXP"))&&(a.codecs=i.STPP),a.codecPrivateData=""+e.getAttribute("CodecPrivateData"),a.BaseURL=e.BaseURL,a)}function c(e){var a,i=void 0,r=void 0;return(i=function(e){var t=void 0,a=void 0,i=void 0,r=0;(e[r+3]<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r],(e[(r+=4)+1]<<8)+e[r],r+=2;for(;r<e.length;)if(t=(e[r+1]<<8)+e[r],r+=2,1===t)return a=(e[r+1]<<8)+e[r],r+=2,(i=new Uint8Array(a)).set(e.subarray(r,r+a)),i;return null}(t.decodeArray(e.firstChild.data)))&&(i=new Uint16Array(i.buffer),i=String.fromCharCode.apply(null,i),r=(new DOMParser).parseFromString(i,"application/xml").querySelector("KID").textContent,r=t.decodeArray(r),A(a=r,0,3),A(a,1,2),A(a,4,5),A(a,6,7)),r}function A(e,t,a){var i=e[t];e[t]=e[a],e[a]=i}function h(e,a){var i,o={},s=[],d=e.getElementsByTagName("SmoothStreamingMedia")[0],l=e.getElementsByTagName("Protection")[0],m=null,u=void 0,p=void 0,g=void 0,A=void 0,h=void 0,v=void 0,y=void 0,S=void 0,T=void 0;o.protocol="MSS",o.profiles="urn:mpeg:dash:profile:isoff-live:2011",o.type="TRUE"===d.getAttribute("IsLive")?"dynamic":"static",i=d.getAttribute("TimeScale"),o.timescale=i?parseFloat(i):n;var b=parseFloat(d.getAttribute("DVRWindowLength"));0===b&&"TRUE"===d.getAttribute("CanSeek")&&(b=1/0),b>0&&(o.timeShiftBufferDepth=b/o.timescale);var C=parseFloat(d.getAttribute("Duration"));for(o.mediaPresentationDuration=0===C?1/0:C/o.timescale,o.minBufferTime=2,o.ttmlTimeIsRelative=!0,"dynamic"===o.type&&C>0&&(o.type="static",o.timeShiftBufferDepth=C/o.timescale),"dynamic"===o.type&&o.timeShiftBufferDepth<1/0&&(o.refreshManifestOnSwitchTrack=!0,o.doNotUpdateDVRWindowOnBufferUpdated=!0,o.ignorePostponeTimePeriod=!0),o.Period=function(e,t){var a,i={},r=void 0;i.AdaptationSet_asArray=[],a=e.getElementsByTagName("StreamIndex");for(var n=0;n<a.length;n++)null!==(r=f(a[n],t))&&i.AdaptationSet_asArray.push(r);return i.AdaptationSet_asArray.length>0&&(i.AdaptationSet=i.AdaptationSet_asArray.length>1?i.AdaptationSet_asArray:i.AdaptationSet_asArray[0]),i}(d,o.timescale),o.Period_asArray=[o.Period],(u=o.Period).start=0,void 0!==l&&((m=e.getElementsByTagName("ProtectionHeader")[0]).firstChild.data=m.firstChild.data.replace(/\n|\r/g,""),A=c(m),(g=function(e){var t={__text:e.firstChild.data,__prefix:"mspr"};return{schemeIdUri:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",value:"com.microsoft.playready",pro:t,pro_asArray:t}}(m))["cenc:default_KID"]=A,s.push(g),(g=function(e){var a={schemeIdUri:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",value:"com.widevine.alpha"};if(!e)return a;var i=new Uint8Array(2+e.length);i[0]=18,i[1]=16,i.set(e,2);var r=32+i.length,n=new Uint8Array(r),o=0;return n[o++]=(4278190080&r)>>24,n[o++]=(16711680&r)>>16,n[o++]=(65280&r)>>8,n[o++]=255&r,n.set([112,115,115,104,0,0,0,0],o),o+=8,n.set([237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237],o),o+=16,n[o++]=(4278190080&i.length)>>24,n[o++]=(16711680&i.length)>>16,n[o++]=(65280&i.length)>>8,n[o++]=255&i.length,n.set(i,o),n=String.fromCharCode.apply(null,n),n=t.encodeASCII(n),a.pssh={__text:n},a}(A))["cenc:default_KID"]=A,s.push(g),o.ContentProtection=s,o.ContentProtection_asArray=s),p=u.AdaptationSet_asArray,S=0;S<p.length;S+=1)if(p[S].SegmentTemplate.initialization="$Bandwidth$",void 0!==o.ContentProtection&&(p[S].ContentProtection=o.ContentProtection,p[S].ContentProtection_asArray=o.ContentProtection_asArray),"video"===p[S].contentType&&(o.minBufferTime=p[S].SegmentTemplate.SegmentTimeline.S_asArray[0].d/p[S].SegmentTemplate.timescale*2,"dynamic"===o.type)){var P=((y=p[S].SegmentTemplate.SegmentTimeline.S_asArray)[y.length-1].t+y[y.length-1].d)/p[S].SegmentTemplate.timescale*1e3;o.availabilityStartTime=new Date(a.getTime()-P),o.timeShiftBufferDepth>0&&o.timeShiftBufferDepth!==1/0&&o.timeShiftBufferDepth>p[S].SegmentTemplate.SegmentTimeline.duration&&(o.timeShiftBufferDepth=p[S].SegmentTemplate.SegmentTimeline.duration)}if(o.timeShiftBufferDepth<o.minBufferTime&&(o.minBufferTime=o.timeShiftBufferDepth),delete o.ContentProtection,delete o.ContentProtection_asArray,"static"===o.type){var w=r.getValue();if(w&&w.timestampOffset)h=w.timestampOffset;else for(S=0;S<p.length;S++)"audio"!==p[S].contentType&&"video"!==p[S].contentType||(v=(y=p[S].SegmentTemplate.SegmentTimeline.S_asArray)[0].t/p[S].SegmentTemplate.timescale,void 0===h&&(h=v),h=Math.min(h,v),o.mediaPresentationDuration=Math.min(o.mediaPresentationDuration,p[S].SegmentTemplate.SegmentTimeline.duration));if(h>0){for(o.timestampOffset=h,S=0;S<p.length;S++){for(y=p[S].SegmentTemplate.SegmentTimeline.S_asArray,T=0;T<y.length;T++)y[T].tManifest||(y[T].tManifest=y[T].t),y[T].t-=h*p[S].SegmentTemplate.timescale;"audio"!==p[S].contentType&&"video"!==p[S].contentType||(u.start=Math.max(y[0].t,u.start),p[S].SegmentTemplate.presentationTimeOffset=u.start)}u.start/=o.timescale}}return o.mediaPresentationDuration=Math.floor(1e3*o.mediaPresentationDuration)/1e3,u.duration=o.mediaPresentationDuration,o}return u={parse:function(e){var t,a,i=window.performance.now();t=function(e){var t=null;if(window.DOMParser&&(t=(new window.DOMParser).parseFromString(e,"text/xml")).getElementsByTagName("parsererror").length>0)throw new Error("parsing the manifest failed");return t}(e);var r=window.performance.now();if(null===t)return null;a=h(t,new Date);var n=window.performance.now();return p.info("Parsing complete: (xmlParsing: "+(r-i).toPrecision(3)+"ms, mss2dash: "+(n-r).toPrecision(3)+"ms, total: "+((n-i)/1e3).toPrecision(3)+"s)"),a},getMatchers:function(){return null},getIron:function(){return null}},p=a.getLogger(u),e.mediaPlayerModel,u}Object.defineProperty(exports,"__esModule",{value:!0}),e.__dashjs_factory_name="MssParser",exports.default=dashjs.FactoryMaker.getClassFactory(e);
},{}],"mSYu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../streaming/vo/DataChunk"),t=m(e),r=require("../streaming/vo/FragmentRequest"),a=m(r),n=require("./MssFragmentInfoController"),o=m(n),s=require("./MssFragmentProcessor"),i=m(s),l=require("./parser/MssParser"),d=m(l),c=require("./errors/MssErrors"),g=m(c),u=require("../streaming/vo/DashJSError"),f=m(u);function m(e){return e&&e.__esModule?e:{default:e}}function E(e){e=e||{};var r=this.context,n=e.eventBus,s=e.events,l=e.constants,c=e.initSegmentType,g=e.dashMetrics,u=e.playbackController,m=e.protectionController,E=(0,i.default)(r).create({dashMetrics:g,playbackController:u,protectionController:m,eventBus:n,constants:l,ISOBoxer:e.ISOBoxer,debug:e.debug,errHandler:e.errHandler}),I=void 0;function y(r){var o=r.sender.getStreamProcessor(),i=new a.default,l=o.getRepresentationController().getCurrentRepresentation();i.mediaType=l.adaptation.type,i.type=c,i.range=l.range,i.quality=l.index,i.mediaInfo=o.getMediaInfo(),i.representationId=l.id;var d=function(e,r,a){var n=new t.default;return n.streamId=r,n.mediaInfo=e.mediaInfo,n.segmentType=e.type,n.start=e.startTime,n.duration=e.duration,n.end=n.start+n.duration,n.index=e.index,n.quality=e.quality,n.representationId=e.representationId,n.endFragment=a,n}(i,o.getStreamInfo().id,r.type!==s.FRAGMENT_LOADING_PROGRESS);try{d.bytes=E.generateMoov(l)}catch(r){e.errHandler.error(new f.default(r.code,r.message,r.data))}n.trigger(s.INIT_FRAGMENT_LOADED,{chunk:d,fragmentModel:o.getFragmentModel()}),r.sender=null}function _(){var t=u.getStreamController();t&&t.getActiveStreamProcessors().forEach(function(t){if(t.getType()===l.VIDEO||t.getType()===l.AUDIO||t.getType()===l.FRAGMENTED_TEXT){var a=void 0,s=!1,i=t.getExternalControllers();for(a=0;a<i.length;a++)i[a].controllerType&&"MssFragmentInfoController"===i[a].controllerType&&(s=!0);if(!s){var d=(0,o.default)(r).create({streamProcessor:t,eventBus:n,dashMetrics:g,playbackController:u,baseURLController:e.baseURLController,ISOBoxer:e.ISOBoxer,debug:e.debug});d.initialize(),d.start()}}})}function T(e){if(!e.error){var t=e.sender.getStreamProcessor();E.processFragment(e,t);var r=t.getStreamInfo();r.manifestInfo.isDynamic||r.manifestInfo.DVRWindowSize===1/0||_()}}function p(){u.getIsDynamic()&&0!==u.getTime()&&_()}function M(){u.getIsDynamic()&&0!==u.getTime()&&_()}function S(e){e&&e.data&&(e.data=e.data.replace(/http:\/\/www.w3.org\/2006\/10\/ttaf1/gi,"http://www.w3.org/ns/ttml"))}return I={reset:function(){n.off(s.INIT_REQUESTED,y,this),n.off(s.PLAYBACK_PAUSED,p,this),n.off(s.PLAYBACK_SEEK_ASKED,M,this),n.off(s.FRAGMENT_LOADING_COMPLETED,T,this),n.off(s.TTML_TO_PARSE,S,this)},createMssParser:function(){return(0,d.default)(r).create(e)},registerEvents:function(){n.on(s.INIT_REQUESTED,y,I,dashjs.FactoryMaker.getSingletonFactoryByName(n.getClassName()).EVENT_PRIORITY_HIGH),n.on(s.PLAYBACK_PAUSED,p,I,dashjs.FactoryMaker.getSingletonFactoryByName(n.getClassName()).EVENT_PRIORITY_HIGH),n.on(s.PLAYBACK_SEEK_ASKED,M,I,dashjs.FactoryMaker.getSingletonFactoryByName(n.getClassName()).EVENT_PRIORITY_HIGH),n.on(s.FRAGMENT_LOADING_COMPLETED,T,I,dashjs.FactoryMaker.getSingletonFactoryByName(n.getClassName()).EVENT_PRIORITY_HIGH),n.on(s.TTML_TO_PARSE,S,I)}}}E.__dashjs_factory_name="MssHandler";var I=dashjs.FactoryMaker.getClassFactory(E);I.errors=g.default,dashjs.FactoryMaker.updateClassFactory(E.__dashjs_factory_name,I),exports.default=I;
},{"../streaming/vo/DataChunk":"NpwA","../streaming/vo/FragmentRequest":"Vb3t","./MssFragmentInfoController":"FnmF","./MssFragmentProcessor":"iD6g","./parser/MssParser":"S74k","./errors/MssErrors":"JLAN","../streaming/vo/DashJSError":"gyaG"}],"JV45":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.MssHandler=void 0;var s=require("./MssHandler"),d=r(s);function r(e){return e&&e.__esModule?e:{default:e}}var a="undefined"!=typeof window&&window||e,t=a.dashjs;t||(t=a.dashjs={}),t.MssHandler=d.default,exports.default=t,exports.MssHandler=d.default;
},{"./MssHandler":"mSYu"}],"tQnD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MssPlayer=void 0;var e=s(require("@babel/runtime/helpers/classCallCheck")),t=s(require("@babel/runtime/helpers/createClass")),r=s(require("@babel/runtime/helpers/inherits")),n=s(require("@babel/runtime/helpers/possibleConstructorReturn")),i=s(require("@babel/runtime/helpers/getPrototypeOf")),a=require("./interface"),u=require("dashjs");function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var t,r=(0,i.default)(e);if(c()){var a=(0,i.default)(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return(0,n.default)(this,t)}}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var o=require("dashjs/build/es5/src/mss"),f=function(n){(0,r.default)(a,n);var i=l(a);function a(t,r){return(0,e.default)(this,a),i.call(this,t,r)}return(0,t.default)(a,[{key:"load",value:function(){var e=this;return new Promise(function(t,r){var n=(0,u.MediaPlayer)().create();n.initialize(),n.attachView(e.videoElement_),n.attachSource(e.manifestUrl_),n.on(u.MediaPlayer.events.MANIFEST_LOADED,function(){t()}),n.on(u.MediaPlayer.events.ERROR,function(e){r("Failed to load Mss Player: ".concat(e.error.message))}),e.mediaPlayer_=n})}},{key:"isLive",get:function(){return this.mediaPlayer_.isDynamic()}}]),a}(a.PlayerTechInterface);exports.MssPlayer=f;
},{"@babel/runtime/helpers/classCallCheck":"ZBnv","@babel/runtime/helpers/createClass":"NoOd","@babel/runtime/helpers/inherits":"qngw","@babel/runtime/helpers/possibleConstructorReturn":"GFCP","@babel/runtime/helpers/getPrototypeOf":"WQgz","./interface":"Sxab","dashjs":"lTOo","dashjs/build/es5/src/mss":"JV45"}],"aDEZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ENUM_TYPE_MSS=exports.ENUM_TYPE_MPEGDASH=exports.ENUM_TYPE_HLS=exports.CONTENT_TYPE_MAP=void 0;var p="BAD_CONTENT_TYPE",e={"application/x-mpegURL":t,"application/octet-stream":p,"binary/octet-stream":p,"application/vnd.apple.mpegurl":t,"application/dash+xml":a,"application/vnd.apple.mpegurl;charset=UTF-8":t,"application/vnd.ms-sstr+xml":r};exports.CONTENT_TYPE_MAP=e;var t="HLS";exports.ENUM_TYPE_HLS=t;var a="MPD";exports.ENUM_TYPE_MPEGDASH=a;var r="MSS";exports.ENUM_TYPE_MSS=r;
},{}],"oevK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerTechFactory=void 0;var e=l(require("@babel/runtime/helpers/classCallCheck")),r=l(require("@babel/runtime/helpers/createClass")),t=require("./playerTechs/hls_player"),a=require("./playerTechs/dash_player"),n=require("./playerTechs/mss_player"),s=require("./utils/constants");function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function l(r,t){(0,e.default)(this,l),this.wrapperId_=r,this.manifestUrl_=t}return(0,r.default)(l,[{key:"constructPlayerTech",value:function(){var e=this;return new Promise(function(r,l){e.determineType_(e.manifestUrl_).then(function(c){var i;c===s.ENUM_TYPE_HLS?i=new t.HlsPlayer(e.wrapperId_,e.manifestUrl_):c===s.ENUM_TYPE_MPEGDASH?i=new a.DashPlayer(e.wrapperId_,e.manifestUrl_):c===s.ENUM_TYPE_MSS?i=new n.MssPlayer(e.wrapperId_,e.manifestUrl_):l("Internal error: no available player tech found!"),i.load().then(function(){r(i)}).catch(l)}).catch(l)})}},{key:"determineType_",value:function(e){return new Promise(function(r,t){fetch(e).then(function(t){var a=s.CONTENT_TYPE_MAP[t.headers["content-type"]];a||(e.match(/\.m3u8/)?a=s.ENUM_TYPE_HLS:e.match(/\.mpd/)?a=s.ENUM_TYPE_MPEGDASH:e.match(/\/Manifest/)?a=s.ENUM_TYPE_MSS:e.match(/\/manifest/)&&(a=s.ENUM_TYPE_MSS)),r(a)}).catch(function(e){console.error(e),t(e)})})}}]),l}();exports.PlayerTechFactory=c;
},{"@babel/runtime/helpers/classCallCheck":"ZBnv","@babel/runtime/helpers/createClass":"NoOd","./playerTechs/hls_player":"K5S2","./playerTechs/dash_player":"TN90","./playerTechs/mss_player":"tQnD","./utils/constants":"aDEZ"}],"tgQS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerSkin=void 0;var e=a(require("@babel/runtime/helpers/classCallCheck")),t=a(require("@babel/runtime/helpers/createClass"));function a(e){return e&&e.__esModule?e:{default:e}}var n=function(){function a(t){(0,e.default)(this,a),this.playerInterface_=t}return(0,t.default)(a,[{key:"init",value:function(){return this.setupControllers_(this.playerInterface_.wrapper)}},{key:"showBigPlayButton",value:function(){this.bigPlayButton_.className="player-btn-big player-btn-big-visible"}},{key:"setupControllers_",value:function(e){var t=this,a=document.createElement("div");a.className="player-controller player-controller-hidden";var n=document.createElement("div");n.className="player-logo",a.appendChild(n),this.playerInterface_.isLive||a.appendChild(this.setupTimeline_());var r=document.createElement("div");r.className="player-btn-toggle-play player-btn-play",r.addEventListener("mouseover",function(e){e.target.className+=" player-btn-hover"}),r.addEventListener("mouseout",function(e){e.target.className=e.target.className.replace("player-btn-hover","")}),r.addEventListener("click",function(){t.playerInterface_.isPlaying?t.playerInterface_.pause():t.playerInterface_.play()}),a.appendChild(r);var l=document.createElement("div");l.className="player-btn-big player-btn-big-hidden",e.appendChild(l),this.bigPlayButton_=l,this.bigPlayButton_.addEventListener("click",function(){t.playerInterface_.play()});var i=document.createElement("div");i.className="player-btn-toggle-audio player-btn-audio-on",i.addEventListener("mouseover",function(e){e.target.className+=" player-btn-hover"}),i.addEventListener("mouseout",function(e){e.target.className=e.target.className.replace("player-btn-hover","")}),i.addEventListener("click",function(){t.playerInterface_.isMuted?t.playerInterface_.unmute():t.playerInterface_.mute()}),a.appendChild(i),this.playerInterface_.on("playing",function(){r.className="player-btn-toggle-play player-btn-pause",t.bigPlayButton_.className="player-btn-big player-btn-big-hidden"}),this.playerInterface_.on("paused",function(){r.className="player-btn-toggle-play player-btn-play"}),this.playerInterface_.on("muted",function(){i.className="player-btn-toggle-audio player-btn-audio-off"}),this.playerInterface_.on("unmuted",function(){i.className="player-btn-toggle-audio player-btn-audio-on"}),e.appendChild(a),e.addEventListener("mousemove",function(){a.className="player-controller player-controller-visible",t.controllerTimer=setTimeout(function(){a.className="player-controller player-controller-hidden"},5e3)})}},{key:"setupTimeline_",value:function(){var e=this,t=document.createElement("div");t.className="player-timeline-container";var a=document.createElement("div");a.className="player-timeline";var n=document.createElement("div");n.className="player-timeline-duration";var r=document.createElement("div");return r.className="player-timeline-position",t.appendChild(r),t.appendChild(a),t.appendChild(n),this.timelineUpdateTimer=setInterval(function(){n.innerHTML=e.formatPlayerTime_(e.playerInterface_.duration);var t=e.playerInterface_.position;r.innerHTML=e.formatPlayerTime_(t);var l=t/e.playerInterface_.duration*100;a.setAttribute("style","background: linear-gradient(90deg, #0FBAF0 ".concat(l,"%, #000000 ").concat(l,"%)"))},1e3),a.addEventListener("click",function(t){var a=t.target.clientWidth,n=t.offsetX/a*e.playerInterface_.duration;e.playerInterface_.position=n}),t}},{key:"formatPlayerTime_",value:function(e){var t=parseInt(e,10);return[Math.floor(t/3600)%24,Math.floor(t/60)%60,t%60].map(function(e){return e<10?"0"+e:e}).filter(function(e,t){return"00"!==e||t>0}).join(":")}}]),a}();exports.PlayerSkin=n;
},{"@babel/runtime/helpers/classCallCheck":"ZBnv","@babel/runtime/helpers/createClass":"NoOd"}],"KcYi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Player=void 0;var e=u(require("@babel/runtime/regenerator")),r=u(require("@babel/runtime/helpers/asyncToGenerator")),t=u(require("@babel/runtime/helpers/classCallCheck")),a=u(require("@babel/runtime/helpers/createClass")),n=require("./player_tech_factory"),i=require("./player_skin");function u(e){return e&&e.__esModule?e:{default:e}}var l=function(){function u(e,r){(0,t.default)(this,u),this.wrapperId_=e,this.manifestUrl_=r,this.playerTechFactory_=new n.PlayerTechFactory(this.wrapperId_,this.manifestUrl_)}return(0,a.default)(u,[{key:"init",value:function(){var t=(0,r.default)(e.default.mark(function r(){var t,a;return e.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.playerTechFactory_.constructPlayerTech();case 2:return t=e.sent,(a=new i.PlayerSkin(t)).init(),t.attachControllerSkin(a),e.abrupt("return",t);case 7:case"end":return e.stop()}},r,this)}));return function(){return t.apply(this,arguments)}}()}]),u}();exports.Player=l;
},{"@babel/runtime/regenerator":"m4eR","@babel/runtime/helpers/asyncToGenerator":"fwsn","@babel/runtime/helpers/classCallCheck":"ZBnv","@babel/runtime/helpers/createClass":"NoOd","./player_tech_factory":"oevK","./player_skin":"tgQS"}],"Focm":[function(require,module,exports) {
"use strict";var e=t(require("@babel/runtime/regenerator")),r=t(require("@babel/runtime/helpers/asyncToGenerator")),n=require("./src/player");function t(e){return e&&e.__esModule?e:{default:e}}window.setupEyevinnPlayer=function(){var t=(0,r.default)(e.default.mark(function r(t,u){var a;return e.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new n.Player(t,u),e.next=3,a.init();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},r)}));return function(e,r){return t.apply(this,arguments)}}();
},{"@babel/runtime/regenerator":"m4eR","@babel/runtime/helpers/asyncToGenerator":"fwsn","./src/player":"KcYi"}]},{},["Focm"], null)